<!DOCTYPE html>
<html class="writer-html5" lang="ja">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. 誘電応答解析機能 UVSOR &mdash; PHASE/0 Manual 2024.01 ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/phase0.css?v=84baaed2" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=df52f328"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/translations.js?v=4dbe4bdc"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="11. 補遺" href="../supplement/supplement.html" />
    <link rel="prev" title="9. 原子ダイナミクス" href="../ion_dynamics/ion_dynamics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PHASE/0 Manual
              <img src="../_static/image1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">2. PHASE/0のインストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_step/first_step.html">3. PHASE/0の基本的な利用方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_parameters/input_parameters.html">4. 入力パラメータファイル：nfinp.data（詳細版）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/basics.html">5. 基本機能を利用した計算例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../electronic_structure/electronic_structure.html">6. 電子状態解析：バンド構造と状態密度</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_electronic_structure/advanced_electronic_structure.html">7. 高度な電子状態計算</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/analysis.html">8. 解析機能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ion_dynamics/ion_dynamics.html">9. 原子ダイナミクス</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10. 誘電応答解析機能 UVSOR</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">10.1. はじめに</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">10.1.1. UVSORとは</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">10.1.2. UVSORの特徴と機能</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">10.1.3. 更新履歴</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">10.1.4. パッケージの構成</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id13">10.2. 計算手法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">10.2.1. 電子系</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">10.2.2. 格子系</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#uvsor-epsilon">10.3. UVSOR-Epsilon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id34">10.3.1. ファイルの設定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">10.3.2. 入力データの設定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id42">10.3.3. 計算の実行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">10.3.4. 計算結果の解析</a></li>
<li class="toctree-l3"><a class="reference internal" href="#si2">10.3.5. 計算例：Si2-電子誘電関数計算</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#uvsor-berry-phonon">10.4. UVSOR-Berry-Phonon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id46">10.4.1. 入出力の説明</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quartz">10.4.2. 計算例：水晶(α-quartz)の格子誘電率計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aln">10.4.3. 計算例：AlNの圧電定数の計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaas">10.4.4. 計算例：GaAs-格子誘電率計算</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id53">10.5. UVSOR-Berry-Phonon（改良版）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id54">10.5.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id56">10.5.2. 使用方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id57">10.5.3. 計算例題：AlNの格子誘電率、圧電定数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lr-tddft">10.6. 線形応答時間依存密度汎関数法（LR-TDDFT）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id62">10.6.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id64">10.6.2. 入力ファイルの記述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id65">10.6.3. 計算の実行方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id66">10.6.4. 出力ファイル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id67">10.6.5. 例題</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id68">10.6.6. 使用上の注意点</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../supplement/supplement.html">11. 補遺</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PHASE/0 Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>誘電応答解析機能 UVSOR</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/uvsor/uvsor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="uvsor">
<span id="uvsor-chapter"></span><h1><span class="section-number">10. </span>誘電応答解析機能 UVSOR<a class="headerlink" href="#uvsor" title="この見出しへのパーマリンク"></a></h1>
<section id="id1">
<h2><span class="section-number">10.1. </span>はじめに<a class="headerlink" href="#id1" title="この見出しへのパーマリンク"></a></h2>
<section id="id2">
<h3><span class="section-number">10.1.1. </span>UVSORとは<a class="headerlink" href="#id2" title="この見出しへのパーマリンク"></a></h3>
<p>UVSOR(Universal Virtual Spectroscope for Optoelectronics Research)は第一原理擬ポテンシャル法に基づいて、物質の誘電・光学応答を原子レベルで計算する機能の総称です。２つのプログラムepsmainとtdlrmainが含まれます。またプログラムphaseおよびekcalにも誘電応答解析機能UVSORが含まれています。UVSORは、プログラムphaseでのSCF計算結果をもとに、物質の誘電関数を0Hz～紫外波長域の周波数で計算することができます。
誘電関数は、物質の電気的・光学的性質を決定する重要な物理量で、その測定はエレクトロニクス及び光学における主要な課題です。誘電関数は分光器を用いて測定することができますが、現実の分光器は測定周波数域が限られているので、実験的に誘電関数を決定するには、いろいろな種類の分光器を使い分けます。たとえば、エレクトロニクス分野で興味がある10<sup>6</sup> (Mega) 10<sup>9</sup> (Giga)Hz域での誘電関数を測定するには、その周波数域の電磁波を発生させるRF(Radio Frequency)発振器を使用します。また、光学において興味がある赤外、可視、紫外波長域における誘電関数を測定するには、それぞれの波長域専用の分光器を使用します。
しかし、発振器および分光器の調整はかならずしも容易ではなく、このことが誘電関数の測定を困難にしています。</p>
<p>UVSORはこのような問題を解決する材料シミュレーション・ソフトウェアです。解析可能な波長域が、0Hz～紫外波長域の周波数と極めて広く、エレクトロニクス・光学の分野において興味あるほとんど全ての波長域における誘電関数を第一原理法に基づいて計算することができます。UVSORは、その名が示すように、一種の&quot;万能仮想分光器&quot;として作用し、電子・光学材料の開発に用いることができます。</p>
<p><a class="reference internal" href="#uvsor-fig1"><span class="std std-numref">図 10.1</span></a> は、物質の誘電関数（実部）の周波数依存性を模式的に示しています。</p>
<figure class="align-default" id="uvsor-fig1">
<img alt="../_images/uvsor_image1.svg" src="../_images/uvsor_image1.svg" /><figcaption>
<p><span class="caption-number">図 10.1 </span><span class="caption-text">誘電率の誘電分散</span><a class="headerlink" href="#uvsor-fig1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>物質の誘電率は、近似的に、物質の電子状態に起因する電子誘電率と、格子振動状態に起因する格子系誘電率の和で与えられ、電磁波の周波数が格子振動の周波数よりも低い場合の10T(Tera)Hz以下のRF領域では、全誘電率は電子系及び格子系誘電率の和で与えられます。一方、電磁波の周波数が格子振動の周波数よりも高い場合の10THz以上の光学域では、電子系誘電率のみが全誘電率に寄与します。</p>
<p>誘電率計算には、電子系の応答を解析するUVSOR-Epsilonの計算体系と、格子系の応答を解析するUVSOR-Berry-Phononの計算体系があり、これらの計算体系に従えば、はそれぞれ電子系及び格子系誘電関数を計算することができます。これにより、静的～光学波長域（0Hz～紫外域）に及ぶ極めて広い周波数帯域での誘電関数を得ることができます。UVSORは、誘電関数、非線形光学感受率（2次及び3次）、ならびに電子・正孔の有効質量を計算することができます。UVSORは一種の仮想分光器として作用し、誘電体材料ならびに光学・レーザ材料の設計に用いることができます。誘電応答解析機能UVSORは、高速化・MPI並列化されています。</p>
</section>
<section id="id3">
<h3><span class="section-number">10.1.2. </span>UVSORの特徴と機能<a class="headerlink" href="#id3" title="この見出しへのパーマリンク"></a></h3>
<p>UVSOR-Epsilon はプログラムPHASE
のSCF計算結果に基づき、電子バンド構造を計算し、電子系誘電関数の計算を行うプログラムである。その特徴は以下の通りである。</p>
<p>** UVSOR-Epsilon の特徴と機能 **</p>
<ol class="arabic">
<li><p>PHASE/EKCAL と入力ファイルを共用している</p>
<p>入力は、PHASE/EKCAL の入力ファイルに誘電関数計算用の入力タグを追加した形式となっており、容易に計算を行うことができる。</p>
</li>
<li><p>PHASE の計算結果を利用して誘電関数を計算する</p>
<p>PHASE計算により得られる電子密度より電子バンド構造を求め、電子系誘電関数を計算する。電子バンド 構造は、バンド数及びk 点数を任意に変えて誘電関数を計算でき、精度の高い誘電関数計算を行うことができる。</p>
</li>
<li><p>複素誘電関数の計算</p>
<p>乱雑位相近似（Random Phase Approximation）に基づき誘電関数の虚部を求め、虚部をクラマース・クロニッヒ変換することにより誘電関数の実部を計算している <a class="reference internal" href="#gunther72" id="id4"><span>[Gunther72]</span></a> 。</p>
</li>
<li><p>全電子計算と同じ結果を得ることができる</p>
<p>擬ポテンシャルが遷移モーメントに及ぼす効果 <a class="reference internal" href="#starace72" id="id5"><span>[Starace72]</span></a> , <a class="reference internal" href="#read91" id="id6"><span>[Read91]</span></a> , <a class="reference internal" href="#kageshima97" id="id7"><span>[Kageshima97]</span></a>
を補正することにより、全電子計算と同じ誘電関数を得ることができる。
擬ポテンシャルは、CIAO
を用いて作成したノルム保存Troullier-Martin(TM) 型ポテンシャル、及びノルム非保存ウルトラソフト型ポテンシャルを用いることができる。
局所ポテンシャルは、TM型で計算された軌道ポテンシャル、BHS、多項式ポテンシャルを扱うことができる。</p>
<p>遷移モーメント補正法は、Read and Needs(RN) 法 <a class="reference internal" href="#read91" id="id8"><span>[Read91]</span></a>
あるいはKageshima-Shiraishi(KS) 法 <a class="reference internal" href="#kageshima97" id="id9"><span>[Kageshima97]</span></a> のいずれかを選択できる。
ノルム保存型擬ポテンシャルの場合はRN 法あるいはKS法を、ウルトラソフト型擬ポテンシャルの場合はKS 法を用いて補正を行う。</p>
</li>
<li><p>半導体・絶縁体のほか、金属、磁性材料の取り扱いができる</p>
<p>半導体・絶縁体のほか、金属、磁性材料に対応したリニアテトラへドロン法 <a class="reference internal" href="#lehmann72" id="id10"><span>[Lehmann72]</span></a>
及びgaussian/parabolic smearing法を実装している。磁性材料の場合、各スピン状態の誘電関数への寄与を解析できる。
金属の場合、ドルーデ項を考慮した計算を行うことが可能である。リニアテトラへドロン計算は、UVSOR
1.00 の場合よりも約2倍高速化されている。</p>
</li>
<li><p>光学スペクトルの計算</p>
<p>誘電関数より光学スペクトル（屈折率、吸収係数、反射スペクトル）を計算できる。偏光は直線偏光及び非偏光を取り扱うことができる。</p>
</li>
<li><p>2 次非線形光学感受率の計算</p>
<p>第２高調波発生(Second Harmonic Generation(SHG)) 過程の2
次非線形光学感受率­<span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>及び
第３高調波発生（Third Harmonic Generation(THG)）の3
次非線形光学感受率<span class="math notranslate nohighlight">\(\chi^{(3)}\left( - 3\omega;\omega,\omega,\omega \right)\)</span>­の実部
及び虚数を波長依存性を考慮して、全電子計算と同じ精度で計算できる。</p>
</li>
<li><p>有効質量の計算</p>
<p>電子及び正孔の有効質量を計算できる。計算にはkp 摂動法を用いている。</p>
</li>
<li><p>ユーテリティプログラム</p>
<p>誘電関数、非線形光学感受率計算結果を取り扱うためのユーテリティプログラムを備えている。</p>
</li>
<li><p>並列計算</p></li>
</ol>
<blockquote>
<div><p>ソースコードはMPI 並列化されている。</p>
</div></blockquote>
<p><strong>UVSOR-Berry-Phonon の特徴と機能</strong></p>
<ol class="arabic">
<li><p>PHASE/EKCAL に組み込まれている。</p>
<p>入力は、PHASE/EKCAL の入力ファイルにBerry
位相計算用および格子誘電率計算用の入力タグを追加した形式となっており、容易に計算を行うことができる。</p>
</li>
<li><p>ボルン有効電荷の計算</p>
<p>ベリー位相分極理論に基づき結晶の分極の変化を計算して、ボルン有効電荷を計算することができる。</p>
</li>
<li><p>格子誘電率の計算</p>
<p>振動解析の結果とボルン有効電荷から格子誘電率を自動的に計算できる。</p>
</li>
<li><p>圧電定数の計算</p>
<p>ベリー位相分極理論に基づき結晶の分極の変化を計算して、圧電定数のイオン固定項を計算することができる。
振動解析の結果とボルン有効電荷とひずみ-力結合定数から圧電定数の内部ひずみ項を自動的に計算できる。</p>
</li>
</ol>
</section>
<section id="id11">
<h3><span class="section-number">10.1.3. </span>更新履歴<a class="headerlink" href="#id11" title="この見出しへのパーマリンク"></a></h3>
<p>2009 年6 月以降の更新履歴は下記の通り。</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>バージョン3.20</p></td>
<td><p>PHASE ver 8.00 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2009/06 公開</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>バージョン3.21</p></td>
<td><p>PHASE ver 8.01 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2010/03 公開</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>バージョン3.30</p></td>
<td><p>PHASE ver 9.00 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2010/06 公開</p></td>
<td><p>DFT+U を利用した誘電関数計算に対応</p></td>
</tr>
<tr class="row-odd"><td><p>バージョン3.40</p></td>
<td><p>PHASE ver 10.00 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2011/06　公開</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>バージョン3.41</p></td>
<td><p>PHASE ver 10.01 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2011/08 公開</p></td>
<td><p>TDDFT 計算機能の実装</p></td>
</tr>
<tr class="row-odd"><td><p>バージョン3.42</p></td>
<td><p>PHASE ver 11.00 に対応</p></td>
</tr>
<tr class="row-even"><td><p>2012/06 公開</p></td>
<td><p>不具合の修正</p></td>
</tr>
<tr class="row-odd"><td><p>2014/04 公開</p></td>
<td><p>PHASE /0 に統合</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id12">
<h3><span class="section-number">10.1.4. </span>パッケージの構成<a class="headerlink" href="#id12" title="この見出しへのパーマリンク"></a></h3>
<p>本プログラムは、プログラムパッケージPHASE/0に統合されています。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ディレクトリ</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>phase0_2023.01</p></td>
<td><p>bin</p></td>
<td><p>epsmain,
tdlrmain</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>samples/dielectric</p></td>
<td></td>
<td></td>
<td><p>本プログラムの入力例</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>electron</p></td>
<td><p>Si</p>
<p>Cu</p>
<p>AlN</p>
<p>NiO</p>
</td>
<td><p>UVSOR-Epsilonの入力例</p>
<p>Si
結晶の入力例</p>
<p>銅の入力例</p>
<p>窒化アルミニ
ウムの入力例</p>
<p>DFT+U法を利用
して誘電関数
を計算する例</p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>lattice</p></td>
<td><p>GaAs</p>
<p>AlN</p>
<p>Quartz</p>
</td>
<td><p>UVSOR-Berry-Phononの入力例</p>
<p>GaAs
結晶の入力例</p>
<p>窒化アルミニウムの入力例</p>
<p>水晶の入力例</p>
</td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>lr-tddft</p></td>
<td><p>C6H6</p>
<p>SiBulk</p>
</td>
<td><p>TDDFTの入力例</p>
<p>C<sub>6</sub>H<sub>6</sub>
分子の計算例</p>
<p>Si
結晶の計算例</p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>util</p></td>
<td><p>eps_file.f90,
nlo_file.f90</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric</span></code> 以下にあります。</p>
<p><code class="code docutils literal notranslate"><span class="pre">samples/dielectric/electron</span></code> にはUVSOR-Epsilonの入力例、 <code class="code docutils literal notranslate"><span class="pre">samples/uvsor/lattice</span></code> にはUVSOR-Berry-Phononの入力例があります。TDDFTの入力例は <code class="code docutils literal notranslate"><span class="pre">samples/tddft</span></code> にあります。</p>
<p><code class="code docutils literal notranslate"><span class="pre">samples/dielectric/electron</span></code> には、Si結晶の入力例、銅Cuの入力例、窒化アルミニウムAlNの入力例があります。NiOは、DFT+U法を利用して誘電関数を計算する例です。</p>
<p>各入力例ディレクトリ下位には、UVSOR-Epsilonの実行に必要な電子密度をphaseにより計算するためのディレクトリscf、およびUVSOR-Epsilonにより誘電関数計算を行うためのディレクトリeps、および擬ポテンシャルファイルを格納するディレクトリPPが存在する。
Si入力例ディレクトリ下位には、有効質量計算を行うためのディレクトリmass及び3次非線形光学感受率の計算を行うためのディレクトリchi3が存在する。AlN入力例ディレクトリ下位には、2次非線形光学感受率計算を行うためのディレクトリchi2_p及びchi2_tが存在する。chi2_pはparabolic
smearing計算用、chi2_tは、リニアテトラヘドロン計算用である。</p>
<p><code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice</span></code> には、GaAs結晶の入力例、窒化アルミニウムAlNの入力例、水晶Quartzの入力例がある。各入力例ディレクトリ下位には、ベリー位相を計算するためのディレクトリberry、および振動解析および格子誘電率計算を行うためのディレクトリphonon、および擬ポテンシャルファイルを格納するディレクトリPPが存在する。</p>
<p><code class="code docutils literal notranslate"><span class="pre">samples/tddft/lr_C6H6</span></code> には、C<sub>6</sub>H<sub>6</sub>分子の計算例、 <code class="code docutils literal notranslate"><span class="pre">samples/tddft/lr_bulkSi</span></code> にはSi結晶の計算例がある。</p>
</section>
</section>
<section id="id13">
<h2><span class="section-number">10.2. </span>計算手法<a class="headerlink" href="#id13" title="この見出しへのパーマリンク"></a></h2>
<section id="id14">
<h3><span class="section-number">10.2.1. </span>電子系<a class="headerlink" href="#id14" title="この見出しへのパーマリンク"></a></h3>
<p><strong>計算手法</strong> <a class="reference internal" href="#gunther72" id="id15"><span>[Gunther72]</span></a></p>
<p>電子系誘電率は、誘電体の電子が入射電磁波の電磁場と相互作用し、価電子帯から伝導帯に遷移することに起因する。電子系誘電率は、電磁波が引き起こす電子の遷移確率より求めることができる。本節では、以下電子の遷移確率を求め、電子系誘電率を計算する方法を説明する。</p>
<p><strong>遷移確率の計算</strong></p>
<p>電磁波と相互作用している誘電体結晶の１電子ハミルトニアンは <a class="reference internal" href="#equation-eq-uvsor1">(10.1)</a> 式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor1">
<span class="eqno">(10.1)<a class="headerlink" href="#equation-eq-uvsor1" title="この数式へのパーマリンク"></a></span>\[H = \frac{1}{2me}\left( \mathbf{p} + e\mathbf{A} \right)^{2} + V(\mathbf{r})\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(m\)</span>は電子の質量、<span class="math notranslate nohighlight">\(e\)</span>は電荷素量、<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>は運動量演算子、<span class="math notranslate nohighlight">\(\mathbf{A}\)</span>は電磁波のベクトルポテンシャル、<span class="math notranslate nohighlight">\(V(\mathbf{r})\)</span>は結晶のポテンシャルである。誘電体と電磁波の相互作用を表す１次の摂動ハミルトニアンは <a class="reference internal" href="#equation-eq-uvsor2">(10.2)</a> 式となる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor2">
<span class="eqno">(10.2)<a class="headerlink" href="#equation-eq-uvsor2" title="この数式へのパーマリンク"></a></span>\[H_{\text{int}} = (e/m)\mathbf{A} \cdot \mathbf{p}\]</div>
</div></blockquote>
<p>電磁波が平面波である場合、ベクトルポテンシャルは次式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor3">
<span class="eqno">(10.3)<a class="headerlink" href="#equation-eq-uvsor3" title="この数式へのパーマリンク"></a></span>\[\mathbf{A} = A_{0}\mathbf{u}{\exp\ }\left\lbrack i\left( \mathbf{k} \cdot \mathbf{r} - \omega t \right) \right\rbrack\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(\mathbf{u}\)</span>は電磁波の偏光ベクトル、<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>は波数ベクトル、<span class="math notranslate nohighlight">\(\mathbf{r}\)</span>は位置ベクトル、<span class="math notranslate nohighlight">\(\omega\)</span>は振動数、<span class="math notranslate nohighlight">\(t\)</span>は時間である。</p>
<p>電磁波との相互作用により価電子帯の電子が時間<span class="math notranslate nohighlight">\(t\)</span>の後に伝導帯の軌道に遷移する確率<span class="math notranslate nohighlight">\(ｗ\)</span>は、次式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor4">
<span class="eqno">(10.4)<a class="headerlink" href="#equation-eq-uvsor4" title="この数式へのパーマリンク"></a></span>\[w(\omega,t,\mathbf{k}_{v},\mathbf{k}_{c})= \frac{e^{2}}{m^{2}\hbar^{2}}\left| \int_{0}^{t}dt^{'}\int_{V}^{}d\mathbf{r}\Psi_{v}(\mathbf{k}_{v},\mathbf{r},t^{'})\mathbf{A}(\mathbf{k},\mathbf{r},t^{'}) \cdot \mathbf{p}\Psi_{c}(\mathbf{k}_{c},\mathbf{r},t^{'}) \right|^{2}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\Psi_{v}\)</span>は誘電体の価電子帯電子の軌道、<span class="math notranslate nohighlight">\(\mathbf{k}_{v}\)</span>は<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>の波数ベクトル、<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>は伝導帯の軌道、<span class="math notranslate nohighlight">\(\mathbf{k}_{c}\)</span>は<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>の波数ベクトルである。インデックス<span class="math notranslate nohighlight">\(c\)</span>及び<span class="math notranslate nohighlight">\(v\)</span>はスピンインデックスを含む。<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>及び<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>は同じスピンを有する軌道である。<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>及び<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>は以下のように書き表すことができる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor5">
<span class="eqno">(10.5)<a class="headerlink" href="#equation-eq-uvsor5" title="この数式へのパーマリンク"></a></span>\[\Psi_{v}(\mathbf{k}_{v},\mathbf{r},t^{'}) = {\exp\ }\left\lbrack –\frac{i}{\hbar}E_{v}\left( \mathbf{k}_{v}t^{'} \right) \right\rbrack{\exp\ }(i\mathbf{k}_{v} \cdot \mathbf{r})u_{v}(\mathbf{k}_{v},r)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor5p">
<span class="eqno">(10.6)<a class="headerlink" href="#equation-eq-uvsor5p" title="この数式へのパーマリンク"></a></span>\[\Psi_{c}(\mathbf{k}_{c},\mathbf{r},t^{'}) = {\exp\ }\left\lbrack - \frac{i}{\hbar}E_{c}(\mathbf{k}_{c}t^{'}) \right\rbrack{\exp\ }(i\mathbf{k}_{c} \cdot \mathbf{r})u_{c}(\mathbf{k}_{c},r)\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor5">(10.5)</a> 及び <a class="reference internal" href="#equation-eq-uvsor5p">(10.6)</a> 式を <a class="reference internal" href="#equation-eq-uvsor4">(10.4)</a> 式に代入し、<span class="math notranslate nohighlight">\(t^{'}\)</span>に関して部分積分を行うことにより、次式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor6">
<span class="eqno">(10.7)<a class="headerlink" href="#equation-eq-uvsor6" title="この数式へのパーマリンク"></a></span>\[w(\omega,t,\mathbf{k}_{v},\mathbf{k}_{c}) = \frac{e^{2}E_{0}^{2}}{m^{2}\omega_{\text{cv}}^{2}}\left| \int_{0}^{t}dt^{'}{\exp\ }\left\lbrack i\hbar^{- 1}(E_{c}(\mathbf{k}_{c}) - E_{v}(\mathbf{k}_{v}) - \hbar\omega)t^{'} \right\rbrack\mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(\mathbf{E} = - \partial\mathbf{A}/\partial t = E_{0}\mathbf{u}{\exp\ }\left\lbrack i\left( \mathbf{k} \cdot \mathbf{r} - \omega t \right) \right\rbrack\)</span>及び<span class="math notranslate nohighlight">\(\mathbf{p} = \frac{\hbar}{i}\nabla\)</span>の関係式を用いた。<span class="math notranslate nohighlight">\(\omega_{c,v}\)</span>及び<span class="math notranslate nohighlight">\(\mathbf{u} \cdot \mathbf{M}_{\text{vc}}\)</span>は、それぞれ <a class="reference internal" href="#equation-eq-uvsor7">(10.8)</a> 及び <a class="reference internal" href="#equation-eq-uvsor7p">(10.9)</a> 式で計算される量である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor7">
<span class="eqno">(10.8)<a class="headerlink" href="#equation-eq-uvsor7" title="この数式へのパーマリンク"></a></span>\[\omega_{c,v} = \frac{1}{\hbar}\left( E_{c}\left( \mathbf{k}_{c} \right) - E_{v}\left( \mathbf{k}_{v} \right) \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor7p">
<span class="eqno">(10.9)<a class="headerlink" href="#equation-eq-uvsor7p" title="この数式へのパーマリンク"></a></span>\[\mathbf{u} \cdot M_{\text{vc}} = \int_{V}^{}d\mathbf{r}{\exp\ }\left\lbrack - (\mathbf{k}_{c} - \mathbf{k} \cdot \mathbf{r} \right\rbrack u_{c}^{*}\mathbf{u} \cdot \nabla{\exp\ }(i\mathbf{k}_{v} \cdot \mathbf{r})u_{v}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\nabla\)</span>は <a class="reference internal" href="#equation-eq-uvsor8">(10.10)</a> 式で表される微分演算子である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor8">
<span class="eqno">(10.10)<a class="headerlink" href="#equation-eq-uvsor8" title="この数式へのパーマリンク"></a></span>\[\nabla = \mathbf{i}\frac{\partial}{\partial x} + \mathbf{j}\frac{\partial}{\partial y} + \mathbf{k}\frac{\partial}{\partial z}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\mathbf{i}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{j}\)</span>,<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>はそれぞれ、<span class="math notranslate nohighlight">\(x\)</span>,
<span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>方向の単位ベクトルである。
<a class="reference internal" href="#equation-eq-uvsor6">(10.7)</a> 式を積分することにより次式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor9">
<span class="eqno">(10.11)<a class="headerlink" href="#equation-eq-uvsor9" title="この数式へのパーマリンク"></a></span>\[w\left( \omega,t,\mathbf{k}_{v},\mathbf{k}_{c} \right) = \frac{e^{2}E_{0}^{2}}{m^{2}\omega_{\text{cv}}^{2}}\left| \frac{\text{exp}\left\lbrack \frac{i\left( E_{c} - E_{v} - \hbar\omega \right)t}{\hbar} \right\rbrack- 1}{\frac{i\left( E_{c} - E_{v} - \hbar\omega \right)t}{\hbar}}\mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor9">(10.11)</a> 式の両辺を<span class="math notranslate nohighlight">\(t\)</span>で微分することにより、次式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor10">
<span class="eqno">(10.12)<a class="headerlink" href="#equation-eq-uvsor10" title="この数式へのパーマリンク"></a></span>\[\frac{\partial w}{\partial t} = \frac{e^{2}E_{0}^{2}}{m^{2}\omega_{\text{cv}}^{2}}\left| \mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}2\pi \hbar\delta(E_{c} - E_{v} - \hbar\omega)\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor10">(10.12)</a> 式は、単位時間あたりに電子が<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>から<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>へ遷移する確率を与える。単位体積あたりの全電子遷移確率<span class="math notranslate nohighlight">\(W_{\text{vc}}\)</span>は、次式により得られる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor11">
<span class="eqno">(10.13)<a class="headerlink" href="#equation-eq-uvsor11" title="この数式へのパーマリンク"></a></span>\[W_{\text{vc}} = \frac{e^{2}E_{0}^{2}}{m^{2}V}\sum_{\mathbf{k},c,v}^{}\frac{\left| \mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}}{\omega_{\text{cv}}^{2}}2\pi \hbar\delta(E_{c} - E_{v} - \hbar\omega)\]</div>
</div></blockquote>
<p>ここで<span class="math notranslate nohighlight">\(V\)</span>は誘電体の体積であり、<span class="math notranslate nohighlight">\(\Sigma\)</span>は全ての<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>,
価電子・伝導帯軌道の組み合わせについて和をとることを意味する。</p>
<p><strong>電子系誘電率の計算</strong></p>
<p>誘電体に入射された電磁波は、誘電体の電子遷移を引き起こし、エネルギーを失う。そのエネルギー損失量は<span class="math notranslate nohighlight">\(W_{\text{vc}}\hbar\omega\)</span>である。一方、マックスウェルの理論では、その損失量は<span class="math notranslate nohighlight">\(\sigma\mathbf{E}_{0}^{2}\)</span>となる。<span class="math notranslate nohighlight">\(\sigma\)</span>は誘電体のオプティカルコンダクティビティである。従って、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor12">
<span class="eqno">(10.14)<a class="headerlink" href="#equation-eq-uvsor12" title="この数式へのパーマリンク"></a></span>\[W_{\text{vc}}\hbar\omega = \sigma\mathbf{E}_{0}^{2}/2\]</div>
</div></blockquote>
<p>一方、<span class="math notranslate nohighlight">\(\sigma\)</span>と電子系誘電率の虚部<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>の間には次の関係式がある。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor13">
<span class="eqno">(10.15)<a class="headerlink" href="#equation-eq-uvsor13" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = 4\pi\sigma/\omega\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor12">(10.14)</a> 及び <a class="reference internal" href="#equation-eq-uvsor13">(10.15)</a> 式より<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>の計算式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\epsilon_{2} = \frac{8\pi e^{2}\hbar^{2}}{m^{2}V}\sum_{\mathbf{k},c,v}^{}\frac{\left| \mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}}{\omega_{\text{cv}}^{2}}\delta\left( E_{c}\left( \mathbf{k}_{c} \right)- E_{v}\left( \mathbf{k}_{v} \right) - \hbar\omega \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor14">
<span class="eqno">(10.16)<a class="headerlink" href="#equation-eq-uvsor14" title="この数式へのパーマリンク"></a></span>\[= \frac{8\pi e^{2}\hbar^{4}}{m^{2}V}\sum_{\mathbf{k},c,v}^{}\frac{\left| \mathbf{u} \cdot \mathbf{M}_{\text{vc}} \right|^{2}}{(E_{c}(\mathbf{k}_{c}) - E_{v}(\mathbf{k}_{v}))^{2}}\delta(E_{c}(\mathbf{k}_{c}) - E_{v}(\mathbf{k}_{v}) - \hbar\omega)\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor14">(10.16)</a> 式の計算を導入するために近似を導入する。電磁波の波長は、誘電体結晶のユニットセルの大きさよりもはるかに長い。従って、<span class="math notranslate nohighlight">\(\mathbf{k}_{c},\mathbf{k}_{v} &gt; &gt; \mathbf{k}\)</span>であるので、以下のように近似できる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor15">
<span class="eqno">(10.17)<a class="headerlink" href="#equation-eq-uvsor15" title="この数式へのパーマリンク"></a></span>\[\mathbf{u} \cdot \mathbf{M}_{\text{vc}} \cong \int_{V}^{}d\mathbf{r}{\exp\ }\left( - \mathbf{k}_{c} \cdot \mathbf{r} \right)u_{c}^{*}\mathbf{u} \cdot \nabla{\exp\ }(i\mathbf{k}_{v} \cdot \mathbf{r})u_{v}\]</div>
</div></blockquote>
<p>運動量演算子<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>を使うと</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathbf{u} \cdot \mathbf{M}_{\text{vc}} \cong \frac{i}{\hbar}\left\langle \Psi_{c}\left( \mathbf{k}_{c} \right)\left| \mathbf{u} \cdot \mathbf{p} \right|\Psi_{v}\left( \mathbf{k}_{v} \right) \right\rangle\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor17">
<span class="eqno">(10.18)<a class="headerlink" href="#equation-eq-uvsor17" title="この数式へのパーマリンク"></a></span>\[= \frac{i}{\hbar}\left\langle \Psi_{c}(\mathbf{k}_{a})|\mathbf{u}\cdot \mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) \right\rangle\]</div>
</div></blockquote>
<p>となる。<span class="math notranslate nohighlight">\(\mathbf{k}_{c} = \mathbf{k}_{v} = \mathbf{k}_{a}\)</span>である。<span class="math notranslate nohighlight">\(\left\langle \Psi_{c}(\mathbf{k}_{c})|\mathbf{u} \cdot \mathbf{p}|\Psi_{v}(\mathbf{k}_{v}) \right\rangle\)</span>の値は、<span class="math notranslate nohighlight">\(\mathbf{k}_{c} = \mathbf{k}_{v}\)</span>の場合のみ零でない。<a class="reference internal" href="#equation-eq-uvsor14">(10.16)</a> 式及び <a class="reference internal" href="#equation-eq-uvsor17">(10.18)</a> 式より、<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>表示の<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>計算式が得られる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor18">
<span class="eqno">(10.19)<a class="headerlink" href="#equation-eq-uvsor18" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = \frac{8\pi e^{2}\hbar^{2}}{\text{me}^{2}V}\sum_{\mathbf{k}_{a},c,v}^{}\frac{\left| &lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{u} \cdot \mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) &gt; \right|^{2}}{(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}))}\delta(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) - \hbar\omega\]</div>
</div></blockquote>
<p>速度演算子<span class="math notranslate nohighlight">\(\mathbf{v} = \mathbf{p}/m\)</span>を用いると、<strong>v</strong>表示の計算式 <a class="reference internal" href="#adolf97" id="id16"><span>[Adolf97]</span></a> が得られる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor19">
<span class="eqno">(10.20)<a class="headerlink" href="#equation-eq-uvsor19" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = \frac{8\pi e^{2}\hbar^{2}}{V}\sum_{\mathbf{k}_{a},c,v}^{}\frac{\left| &lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{u} \cdot \mathbf{v}|\Psi_{v}(\mathbf{k}_{a}) &gt; \right|^{2}}{(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}))}\delta(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) - \hbar\omega\]</div>
</div></blockquote>
<p>遷移モーメントには、次の関係式が成り立つ。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor20">
<span class="eqno">(10.21)<a class="headerlink" href="#equation-eq-uvsor20" title="この数式へのパーマリンク"></a></span>\[&lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) &gt; = \frac{\text{im}}{\hbar}( _{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a})) &lt; \Psi_{c }(\mathbf{k}_{a})|\mathbf{r}|\Psi_{v}(\mathbf{k}_{a}) &gt;\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor18">(10.19)</a> 及び <a class="reference internal" href="#equation-eq-uvsor20">(10.21)</a> 式よりr位置演算子r表示の計算式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor21">
<span class="eqno">(10.22)<a class="headerlink" href="#equation-eq-uvsor21" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = \frac{8\pi e^{2}}{V}\sum_{\mathbf{k}_{a},c,v}^{}\left| &lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{u} \cdot \mathbf{r}|\Psi_{v}(\mathbf{k}_{a}) &gt; \right|^{2}\delta(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) - \hbar\omega\]</div>
</div></blockquote>
<p>比誘電率は、得られた<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>を真空の誘電率<span class="math notranslate nohighlight">\(\epsilon_{0}\)</span>で割ることにより得られる。電子系誘電率の実部<span class="math notranslate nohighlight">\(\epsilon_{1}\)</span>は<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>のクラマース・クロニッヒ変換（ <a class="reference internal" href="#equation-eq-uvsor22">(10.23)</a> 式）により計算される。Pはコーシーの主値を取ることを意味する</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor22">
<span class="eqno">(10.23)<a class="headerlink" href="#equation-eq-uvsor22" title="この数式へのパーマリンク"></a></span>\[\epsilon_{1}(\omega) = 1 + \frac{2}{\pi}P\int_{0}^{\infty}\frac{\Omega\epsilon_{2}(\Omega)}{\Omega^{2} - \omega^{2}}d\Omega\]</div>
</div></blockquote>
<p>本プログラムは <a class="reference internal" href="#equation-eq-uvsor21">(10.22)</a> 式により<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>を求め、<a class="reference internal" href="#equation-eq-uvsor22">(10.23)</a> 式により<span class="math notranslate nohighlight">\(\epsilon_{1}\)</span>を計算する。</p>
<p><strong>光学スペクトルの計算法</strong></p>
<p>電子系誘電率<span class="math notranslate nohighlight">\(\epsilon = \epsilon_{1} + i\epsilon_{2}\)</span>より、以下の光学スペクトルを計算することができる。</p>
<ul class="simple">
<li><p>複素屈折率 <span class="math notranslate nohighlight">\(N = n + ik\)</span>: N = <span class="math notranslate nohighlight">\(\epsilon^{1/2}\)</span></p></li>
<li><p>吸収係数<span class="math notranslate nohighlight">\(\eta\)</span>: <span class="math notranslate nohighlight">\(\eta = \frac{2k\omega}{c}\)</span></p></li>
<li><p>反射スペクトル <span class="math notranslate nohighlight">\(R\)</span>:
<span class="math notranslate nohighlight">\(R = \frac{(n - 1)^{2} + k^{2}}{(n + 1)^{2} + k^{2}}\)</span></p></li>
</ul>
<p><strong>第一原理法による計算法</strong></p>
<p>電子系誘電率には、遷移モーメント<span class="math notranslate nohighlight">\(&lt; \Psi_{c}|\mathbf{r}|\Psi_{v} &gt;\)</span>を計算することが必要である。本節では第一原理擬ポテンシャル法による遷移モーメントの計算法について説明する。第１原理擬ポテンシャル法では、内殻電子が価電子に及ぼす効果を擬ポテンシャルに置き換え、価電子のみを扱うことにより電子状態を計算する。擬ポテンシャル法での誘電体の１電子ハミルトニアンは次式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor23">
<span class="eqno">(10.24)<a class="headerlink" href="#equation-eq-uvsor23" title="この数式へのパーマリンク"></a></span>\[H = \frac{1}{2m}\mathbf{p}^{2} + V(\mathbf{r},\mathbf{p})\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(V\)</span>は結晶のポテンシャルである。擬ポテンシャル法では、電子の運動量<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>に依存するノンローカルポテンシャルを用いる。電磁波と相互作用する誘電体の１電子ハミルトニアンは、次式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor24">
<span class="eqno">(10.25)<a class="headerlink" href="#equation-eq-uvsor24" title="この数式へのパーマリンク"></a></span>\[H = \frac{1}{2m}(\mathbf{p + eA})^{\mathbf{2}}\mathbf{+ V(r,p + eA)}\]</div>
</div></blockquote>
<p>摂動ハミルトニアン<span class="math notranslate nohighlight">\(H_{\text{int}}\)</span>は <a class="reference internal" href="#equation-eq-uvsor25">(10.26)</a> 式である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor25">
<span class="eqno">(10.26)<a class="headerlink" href="#equation-eq-uvsor25" title="この数式へのパーマリンク"></a></span>\[H_{\text{int}} = (e/m)\mathbf{A} \cdot \mathbf{p} + ppc\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor25">(10.26)</a> 式の右辺第１項は、<a class="reference internal" href="#equation-eq-uvsor2">(10.2)</a> 式の摂動ハミルトニアンである。第２項（ppc項）は<span class="math notranslate nohighlight">\(V\)</span>に由来する摂動ハミルトニアンである。第一原理法で遷移モーメントを計算する場合、ppc項を考慮して計算を行う必要がある。第１項に起因する遷移モーメント成分をローカル項、ppc項に起因する成分をノンローカル項あるいはppc項と呼ぶことにする。ppc項を計算する方法としては、Read
and Needの方法(RN法) <a class="reference internal" href="#read91" id="id17"><span>[Read91]</span></a> とKageshima and
Shiraishiの方法(KS法) <a class="reference internal" href="#kageshima97" id="id18"><span>[Kageshima97]</span></a> がある。本プログラムはこれらの方法を用いてppc項を計算できるようになっている。</p>
<p id="uvsor-read-and-needs-section"><strong>Read and Needs 法</strong></p>
<p>** 理論 ** <a class="reference internal" href="#starace72" id="id19"><span>[Starace72]</span></a>  <a class="reference internal" href="#adolf97" id="id20"><span>[Adolf97]</span></a></p>
<p>RN法はノルム保存型擬ポテンシャルに対する補正項を計算する方法である。電磁場が<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>に及ぼす影響が小さいと仮定して、<a class="reference internal" href="#equation-eq-uvsor24">(10.25)</a> 式の<span class="math notranslate nohighlight">\(V(\mathbf{r},\mathbf{p} + e\mathbf{A})\)</span>を次のように展開する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor26">
<span class="eqno">(10.27)<a class="headerlink" href="#equation-eq-uvsor26" title="この数式へのパーマリンク"></a></span>\[V(\mathbf{r},\mathbf{p} + e\mathbf{A}) = V(\mathbf{r},\mathbf{p}) + \frac{\partial V}{\partial\mathbf{p}}e\mathbf{A}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\frac{\partial V}{\partial\mathbf{p}}\)</span>を求めるため、<span class="math notranslate nohighlight">\(\text{Vϕ}\)</span>を<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>で微分する。<span class="math notranslate nohighlight">\(\phi\)</span>は任意の関数である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor27">
<span class="eqno">(10.28)<a class="headerlink" href="#equation-eq-uvsor27" title="この数式へのパーマリンク"></a></span>\[\frac{\partial}{\partial\mathbf{p}}V\phi = \frac{\partial V}{\partial\mathbf{p}}\phi + V\frac{\partial\phi}{\partial\mathbf{p}}\]</div>
</div></blockquote>
<p>ゆえに、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor28">
<span class="eqno">(10.29)<a class="headerlink" href="#equation-eq-uvsor28" title="この数式へのパーマリンク"></a></span>\[\frac{\partial V}{\partial\mathbf{p}} = \frac{\partial}{\partial\mathbf{p}}V + V\frac{\partial}{\partial\mathbf{p}}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(i\hbar\frac{\partial}{\partial\mathbf{p}} = \mathbf{r}\)</span>と定義する。定義された<span class="math notranslate nohighlight">\(\mathbf{r}\)</span>は交換関係<span class="math notranslate nohighlight">\(\lbrack\mathbf{p}_{\alpha},\mathbf{r}_{\beta}\rbrack = - ih\delta_{\text{αβ}}\)</span>を満たす。<span class="math notranslate nohighlight">\(\alpha,\beta\)</span>は座標インデックス<span class="math notranslate nohighlight">\((x,y,z)\)</span>である。この定義を用いて <a class="reference internal" href="#equation-eq-uvsor28">(10.29)</a> 式を書き直すと次式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor29">
<span class="eqno">(10.30)<a class="headerlink" href="#equation-eq-uvsor29" title="この数式へのパーマリンク"></a></span>\[\frac{\partial V}{\partial\mathbf{p}} = \frac{\partial}{\partial\mathbf{p}}V +V\frac{\partial}{\partial\mathbf{p}} = \frac{1}{i\hbar}\lbrack\mathbf{r},V\rbrack = \frac{i}{\hbar}\lbrack V,r\rbrack\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor26">(10.27)</a> 及び <a class="reference internal" href="#equation-eq-uvsor29">(10.30)</a> 式を用いて補正項を計算すると、以下の式を得る。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor30">
<span class="eqno">(10.31)<a class="headerlink" href="#equation-eq-uvsor30" title="この数式へのパーマリンク"></a></span>\[ppc = \frac{i}{\hbar}\lbrack V,r\rbrack e\mathbf{A}\]</div>
</div></blockquote>
<p>従って、摂動ハミルトニアンは、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor31">
<span class="eqno">(10.32)<a class="headerlink" href="#equation-eq-uvsor31" title="この数式へのパーマリンク"></a></span>\[H_{\text{int}} = (e/m)\mathbf{A} \cdot \mathbf{p} + \frac{i}{\hbar}\lbrack V,\mathbf{r}\rbrack e\mathbf{A} = (e/m)\mathbf{A} \cdot (\mathbf{p} + \frac{\text{im}}{\hbar}\lbrack V,\mathbf{r}\rbrack\]</div>
</div></blockquote>
<p>となる。対応する<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>の計算式は、<a class="reference internal" href="#equation-eq-uvsor18">(10.19)</a> 式において<span class="math notranslate nohighlight">\(\mathbf{p} \rightarrow \mathbf{p} + \frac{\text{im}}{\hbar}\lbrack V,\mathbf{r}\rbrack\)</span>と置き換えることにより得られる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor32">
<span class="eqno">(10.33)<a class="headerlink" href="#equation-eq-uvsor32" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = \frac{8\pi e^{2}\hbar^{2}}{m^{2}V}\sum_{\mathbf{k}_{a},c,v}^{}\frac{\left| &lt; \Psi(\mathbf{k}_{a})|\mathbf{u} \cdot (\mathbf{p} + \frac{\text{im}}{\hbar}\lbrack \mathbf{r}\rbrack)|\Psi(\mathbf{k}_{a}) &gt; \right|^{2}}{E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a})}\delta(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) - \hbar\omega\]</div>
</div></blockquote>
<p>r表示の計算式は、<a class="reference internal" href="#equation-eq-uvsor21">(10.22)</a> 式において、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor33">
<span class="eqno">(10.34)<a class="headerlink" href="#equation-eq-uvsor33" title="この数式へのパーマリンク"></a></span>\[&lt;\Psi_{c}(\mathbf{k}_{a})|\mathbf{r}|\Psi_{v}(\mathbf{k}_{a}) &gt; = \frac{1}{i\omega_{\text{cv}}m} &lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) &gt; + \frac{1}{\hbar\omega_{\text{cv}}} &lt; \Psi_{c}(\mathbf{k}_{a}|\lbrack V,\mathbf{r}\rbrack|\Psi_{v}(\mathbf{k}_{a}) &gt;\]</div>
</div></blockquote>
<p>とすることにより得られる。<span class="math notranslate nohighlight">\(\omega_{\text{cv}}\)</span>は次式で定義される量である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor34">
<span class="eqno">(10.35)<a class="headerlink" href="#equation-eq-uvsor34" title="この数式へのパーマリンク"></a></span>\[\omega_{\text{cv}} = \frac{1}{\hbar}\left( E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) \right)\]</div>
</div></blockquote>
<p>本プログラムでは、<a class="reference internal" href="#equation-eq-uvsor21">(10.22)</a> 及び <a class="reference internal" href="#equation-eq-uvsor32">(10.33)</a> 式を用いて電子状態を計算する。<a class="reference internal" href="#equation-eq-uvsor33">(10.34)</a> 式の右辺第１項をローカル項、第２項をノンローカル項あるいはppc項と呼ぶ。</p>
<p><strong>計算法</strong></p>
<p>ローカル項は、<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>及び<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>より直接計算できる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor35">
<span class="eqno">(10.36)<a class="headerlink" href="#equation-eq-uvsor35" title="この数式へのパーマリンク"></a></span>\[\frac{1}{i\omega_{\text{cv}}m} &lt; \Psi_{c}(\mathbf{k}_{a})|\mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) &gt; = \frac{1}{i\omega_{\text{cv}}m} &lt; \Psi_{c}(\mathbf{k}_{a})|\frac{\hbar}{i}\nabla|\Psi_{v}(\mathbf{k}_{a})\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor36">
<span class="eqno">(10.37)<a class="headerlink" href="#equation-eq-uvsor36" title="この数式へのパーマリンク"></a></span>\[\Psi_{c}(\mathbf{k}_{a},r) = \frac{1}{\sqrt{V_{u}}}\sum_{\mathbf{G}}^{}\phi_{c,\mathbf{k}_{a} + \mathbf{G}}{\exp\ }(i(\mathbf{k}_{a} + \mathbf{G}) \cdot \mathbf{r})\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor37">
<span class="eqno">(10.38)<a class="headerlink" href="#equation-eq-uvsor37" title="この数式へのパーマリンク"></a></span>\[\Psi_{v}(\mathbf{k}_{a},r) = \frac{1}{\sqrt{V_{u}}}\sum_{\mathbf{G}}^{}\phi_{v,\mathbf{k}_{a} + \mathbf{G}}{\exp\ }(i(\mathbf{k}_{a} + \mathbf{G}) \cdot \mathbf{r})\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(V_{u}\)</span>は結晶ユニットセルの体積、<span class="math notranslate nohighlight">\(\mathbf{G}\)</span>は平面波基底のGベクトル、<span class="math notranslate nohighlight">\(\phi\)</span>は展開係数である。<a class="reference internal" href="#equation-eq-uvsor36">(10.37)</a> 及び <a class="reference internal" href="#equation-eq-uvsor37">(10.38)</a> 式を <a class="reference internal" href="#equation-eq-uvsor33">(10.34)</a> に代入し、平面波の直交条件を用いるとローカル項の計算式を得る（ <a class="reference internal" href="#equation-eq-uvsor38">(10.39)</a> 式）。本プログラムは誘電体の電子バンド構造計算の結果得られる<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>及び<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>よりローカル項を計算する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor38">
<span class="eqno">(10.39)<a class="headerlink" href="#equation-eq-uvsor38" title="この数式へのパーマリンク"></a></span>\[\frac{1}{i\omega_{\text{cv}}m} &lt;\Psi_{c}(\mathbf{k}_{a})|\mathbf{p}|\Psi_{v}(\mathbf{k}_{a}) &gt; = \frac{\hbar}{i\omega_{\text{cv}}m}\sum_{\mathbf{}}^{}\phi_{c,\mathbf{k}_{a} + \mathbf{G}}^{*}\phi_{v,\mathbf{k}_{a} + \mathbf{G}}(\mathbf{k}_{a} + \mathbf{G})\]</div>
</div></blockquote>
<p>ノンローカル項の計算は、交換関係<span class="math notranslate nohighlight">\(\lbrack V_{\text{nl}},\mathbf{r}\rbrack\)</span>を評価することにより行う。擬ポテンシャルのノンローカル部分は <a class="reference internal" href="#equation-eq-uvsor39">(10.40)</a> 式のようにあらわすことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor39">
<span class="eqno">(10.40)<a class="headerlink" href="#equation-eq-uvsor39" title="この数式へのパーマリンク"></a></span>\[V_{\text{nl}} = \sum_{\text{nmI}}^{}|n,I &gt; D_{\text{nm}}^{I} &lt; m,I|\]</div>
<p><span class="math notranslate nohighlight">\(|n,I &gt;\)</span>及び<span class="math notranslate nohighlight">\(&lt; m,I|\)</span>は擬ポテンシャルのノンローカルプロジェクター、<span class="math notranslate nohighlight">\(D\)</span>は係数、<span class="math notranslate nohighlight">\(I\)</span>は原子のインデックスである。ノンローカル項は次式によりあらわされる。<span class="math notranslate nohighlight">\(\Psi_{c}\)</span>及び<span class="math notranslate nohighlight">\(\Psi_{v}\)</span>の波数ベクトル<span class="math notranslate nohighlight">\(\mathbf{k}_{a}\)</span>は省略してある。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor40">
<span class="eqno">(10.41)<a class="headerlink" href="#equation-eq-uvsor40" title="この数式へのパーマリンク"></a></span>\[\frac{1}{\hbar \omega_{cv}} \Braket{\Psi_c | \left[V, \mathbf{r}\right] | \Psi_v} = \frac{1}{\hbar \omega_{cv}} \sum_{nlI} \Braket{\Psi_c | n,I} D_{nm}^I \Braket{l,I | \mathbf{r} | \Psi_v}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor41">
<span class="eqno">(10.42)<a class="headerlink" href="#equation-eq-uvsor41" title="この数式へのパーマリンク"></a></span>\[- \frac{1}{\hbar\omega_{\text{cv}}}\sum_{\text{nmI}}^{} &lt; \Psi{c}|\mathbf{r}|n,I &gt; D_{\text{nl}}^{I} &lt; l,I|\Psi_{v} &gt;\]</div>
<p>本プログラムは、Pickard and
Payneの方法 <a class="reference internal" href="#pickard00" id="id21"><span>[Pickard00]</span></a> ( <a class="reference internal" href="#equation-eq-uvsor42">(10.43)</a> 式）により<span class="math notranslate nohighlight">\(&lt; n,I|\mathbf{r}|\Psi &gt;\)</span>を計算し、ノンローカル項を計算する。<span class="math notranslate nohighlight">\(\omega_{\text{cv}}, &lt; l,I|\Psi &gt;\)</span>は電子バンド構造計算により得られる値を用いる。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor42">
<span class="eqno">(10.43)<a class="headerlink" href="#equation-eq-uvsor42" title="この数式へのパーマリンク"></a></span>\[&lt; n,I\left| \mathbf{r}_{\alpha}\right|\Psi \geq \frac{1}{2i\left| \mathbf{q} \right|}\left\lbrack &lt; n,I\left| e^{i\mathbf{q}_{\alpha} \cdot \mathbf{r}} \right|\Psi &gt; - &lt; n,I\left| e^{- i\mathbf{q}_{\alpha} \cdot \mathbf{r}} \right|\Psi &gt; \right\rbrack\]</div>
<p><span class="math notranslate nohighlight">\(\alpha\)</span>はカーテシアンインデックス<span class="math notranslate nohighlight">\(( = x,y,z)\)</span>であり、<span class="math notranslate nohighlight">\(\mathbf{q}_{\alpha}\)</span>は次式で定義されるベクトルである。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor43">
<span class="eqno">(10.44)<a class="headerlink" href="#equation-eq-uvsor43" title="この数式へのパーマリンク"></a></span>\[\mathbf{q}_{x} = (q,0,0);\mathbf{q}_{y} = (0,q,0);\mathbf{q}_{z} = (0,0,q)\]</div>
<p><span class="math notranslate nohighlight">\(q\)</span>はパラメータであり、微小な数である。</p>
<p id="uvsor-kageshima-and-siraisi-section">** Kageshima and Siraishi 法 **</p>
<p>** 理論 ** <a class="reference internal" href="#read91" id="id22"><span>[Read91]</span></a></p>
<p>KS法における遷移モーメントは <a class="reference internal" href="#equation-eq-uvsor44">(10.45)</a> 式で与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor44">
<span class="eqno">(10.45)<a class="headerlink" href="#equation-eq-uvsor44" title="この数式へのパーマリンク"></a></span>\[\Braket{\varphi_c\left(\mathbf{k}_{\alpha} \right) | \mathbf{r} | \varphi_v \left(\mathbf{k}_{\alpha}\right)} = \frac{1}{i\omega_{cv} m} \Braket{\varphi_c\left(\mathbf{k}_{\alpha}\right) | \mathbf{p} | \varphi_v \left(\mathbf{k}_{\alpha}\right)} + \frac{1}{i\hbar \omega_{cv}} \sum_{nlI} \Braket{\varphi_c | n,I} \mathbf{p}_{nl}^I \Braket{l,I | \varphi_v}\]</div>
</div></blockquote>
<p>右辺の第一項はローカル項である。右辺の第二項がppc項である。<span class="math notranslate nohighlight">\(\mathbf{p}_{\text{nl}}^{I}\)</span>は次式で定義される量である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor45">
<span class="eqno">(10.46)<a class="headerlink" href="#equation-eq-uvsor45" title="この数式へのパーマリンク"></a></span>\[\mathbf{p}_{\text{nl}}^{I} = &lt; \phi_{n}^{I}|\mathbf{p}|\phi_{n}^{I} &gt; - &lt; \psi_{l}^{I}|\mathbf{p}|\psi_{l}^{I} &gt;\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\phi^{I}\)</span>は全電子計算により得られる原子<span class="math notranslate nohighlight">\(I\)</span>の軌道、<span class="math notranslate nohighlight">\(\psi^{I}\)</span>は擬原子<span class="math notranslate nohighlight">\(I\)</span>の軌道、<span class="math notranslate nohighlight">\(\text{nl}\)</span>は軌道インデックスである。</p>
<p><strong>計算法</strong></p>
<p>本プログラムは、擬ポテンシャル計算プログラムCIAOの出力する<span class="math notranslate nohighlight">\(\mathbf{p}_{\text{nl}}^{I}\)</span>を読み込み <a class="reference internal" href="#equation-eq-uvsor44">(10.45)</a> 式のppc項を計算する。<span class="math notranslate nohighlight">\(\omega_{\text{cv}}, &lt; n,I|\varphi &gt;\)</span>は電子バンド計算により得られた値を用いる。</p>
<p><strong>電子系誘電率</strong></p>
<p>電子系誘電率の計算式（ <a class="reference internal" href="#equation-eq-uvsor21">(10.22)</a> 式）は波数ベクトル<span class="math notranslate nohighlight">\(\mathbf{k}_{a}\)</span>に関する和を含む。本プログラムは<span class="math notranslate nohighlight">\(\mathbf{k}_{a}\)</span>に関する和を積分に置き換え、<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>を求める（ <a class="reference internal" href="#equation-eq-uvsor46">(10.47)</a> 式）。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor46">
<span class="eqno">(10.47)<a class="headerlink" href="#equation-eq-uvsor46" title="この数式へのパーマリンク"></a></span>\[\epsilon_{2} = \frac{e^{2}}{\pi^{2}}\sum_{c,v}^{}{\int_{}^{}\left|&lt; \Psi(\mathbf{k}_{a})|\mathbf{u} \cdot \mathbf{r}|\Psi(\mathbf{k}_{a}) &gt; \right|^{2}}\delta(E_{c}(\mathbf{k}_{a}) - E_{v}(\mathbf{k}_{a}) - \hbar\omega)d\mathbf{k}_{a}\]</div>
</div></blockquote>
<p>積分は、Linear Tetrahedron法を用いて行う。Linear Tetrahedronの詳細については <a class="reference internal" href="#lehmann72" id="id23"><span>[Lehmann72]</span></a> を参照されたい。<span class="math notranslate nohighlight">\(\epsilon_{2}\)</span>をクラマース・クロニッヒ変換（ <a class="reference internal" href="#equation-eq-uvsor22">(10.23)</a> 式）することにより<span class="math notranslate nohighlight">\(\epsilon_{1}\)</span>を得る。クラマース・クロニッヒ変換は <a class="reference internal" href="#equation-eq-uvsor22">(10.23)</a> 式を台形公式を用いて数値積分することにより求める。</p>
<p><strong>非線形光学感受率</strong></p>
<p>材料の分極を<span class="math notranslate nohighlight">\(P\)</span>、外部電場を<span class="math notranslate nohighlight">\(F\)</span>とした場合、一般に<span class="math notranslate nohighlight">\(P\)</span>は<span class="math notranslate nohighlight">\(F\)</span>の多項式であらわすことができる( <a class="reference internal" href="#equation-eq-uvsor47">(10.48)</a> 式)。通常の誘電応答は、<span class="math notranslate nohighlight">\(F\)</span>に関する2次以上の高次項を無視し、<span class="math notranslate nohighlight">\(P\)</span>は<span class="math notranslate nohighlight">\(F\)</span>の１次関数であると近似して記述できる。しかし、レーザ光のように電場強度が強い電磁波を材料に照射した場合、高次項の<span class="math notranslate nohighlight">\(P\)</span>に関する寄与が無視できなくなり、高次項に起因する誘電・光学現象を顕著となる。高次項に起因する誘電・光学現象が非線形光学効果(nonlinear optical effect)である <a class="reference internal" href="#shen03" id="id24"><span>[Shen03]</span></a> 。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor47">
<span class="eqno">(10.48)<a class="headerlink" href="#equation-eq-uvsor47" title="この数式へのパーマリンク"></a></span>\[P_{i} = \sum_{j}^{}\chi_{\text{ij}}^{(1)}F_{j} + \sum_{\text{jk}}^{}\chi_{\text{ijk}}^{(2)}F_{j}F_{k} + \sum_{\text{jkl}}^{}\chi_{\text{ijkl}}^{(3)}F_{j}F_{k}F_{l}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(i,j,k,l\)</span>はXYZ座標のインデックス、<span class="math notranslate nohighlight">\(\chi^{(1)}\)</span>は線形感受率テンソル、<span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>及び<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>は、それぞれ3階及び4階の非線形光学テンソルである。<span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>に起因する現象を2次非線形光学効果、<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>に起因する現象を3次非線形光学効果と呼ぶ。材料の<span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>及び<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>は、誘電率同様、電子系及び格子系からの成分からなり、入射光の振動数が材料の格子振動数よりも低い場合には電子系と格子系が、光振動数が格子振動数よりも高い場合には電子系のみが実測値に寄与する。レーザ光の振動数は、格子振動数よりも高いため、非線形光学では電子系の<span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>及び<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>が興味の対象である。</p>
<p>UVSORは、第２高調波発生（Second Harmonic Generation (SHG)）及び第3高周波発生（Third Harmonic Generation(THG)）の感受率を計算する。SHGは、材料に入射されたフォトンが2個結合し、周波数が倍の光が発生する2次非線形光学効果である。その感受率<span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>は複素数であり( <a class="reference internal" href="#equation-eq-uvsor48">(10.49)</a> 式)、電場を摂動ハミルトニアンとする3次の時間依存摂動法を用いて、固体の電子バンド構造より計算できる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor48">
<span class="eqno">(10.49)<a class="headerlink" href="#equation-eq-uvsor48" title="この数式へのパーマリンク"></a></span>\[\chi^{(2)}( - 2\omega;\omega,\omega) = {\chi^{(2)}}^{'}( - 2\omega;\omega,\omega) + i{\chi^{(2)}}^{''}( - 2\omega;\omega,\omega)\]</div>
</div></blockquote>
<p>摂動計算では、価電子の伝導バンドへの仮想励起と伝導帯ホールと価電子バンドへの仮想励起を考える。電子及び正孔の仮想励起を <a class="reference internal" href="#uvsor-fig2"><span class="std std-numref">図 10.2</span></a> に模式的に示す。</p>
<figure class="align-default" id="uvsor-fig2">
<img alt="../_images/uvsor_image2.svg" src="../_images/uvsor_image2.svg" /><figcaption>
<p><span class="caption-number">図 10.2 </span><span class="caption-text">SHG過程における電子と正孔の仮想励起</span><a class="headerlink" href="#uvsor-fig2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><span class="math notranslate nohighlight">\({\chi^{\left( 2 \right)}}^{''}\left( - 2\omega;\omega,\omega \right)\)</span>は電子励起による<span class="math notranslate nohighlight">\({\chi_{\text{VE}}^{(2)}}^{''}( - 2\omega;\omega,\omega)\)</span>と正孔励起による<span class="math notranslate nohighlight">\({\chi_{\text{VH}}^{(2)}}^{''}( - 2\omega;\omega,\omega)\)</span>の和で与えられ( <a class="reference internal" href="#equation-eq-uvsor49">(10.50)</a> 式)、<span class="math notranslate nohighlight">\({\chi_{\text{VE}}^{(2)}}^{''}( - 2\omega;\omega,\omega)\)</span>と<span class="math notranslate nohighlight">\({\chi_{\text{VH}}^{(2)}}^{''}( - 2\omega;\omega,\omega)\)</span>はそれぞれ <a class="reference internal" href="#equation-eq-uvsor51">(10.51)</a> 及び <a class="reference internal" href="#equation-eq-uvsor53">(10.52)</a> 式により計算される <a class="reference internal" href="#ghahmani91" id="id25"><span>[Ghahmani91]</span></a> 。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor49">
<span class="eqno">(10.50)<a class="headerlink" href="#equation-eq-uvsor49" title="この数式へのパーマリンク"></a></span>\[{\chi^{(2)}}^{''}( - 2\omega;\omega,\omega) = {\chi_{\text{VE}}^{(2)}}^{''}( - 2\omega;\omega,\omega) +{\chi_{\text{VH}}^{(2)}}^{''}( - 2\omega;\omega,\omega)\]</div>
<div class="math notranslate nohighlight">
\[{\chi_{\text{VE}}^{\left( 2 \right)}}^{''}\left( - 2\omega;\omega,\omega \right) = - \frac{\pi}{2}\left| \frac{e\hbar}{m} \right|\sum_{i,j,l}^{}{\int_{\text{BZ}}^{}\frac{d\mathbf{k}}{4\pi^{3}}}\left( \frac{\mathfrak{I}\left\lbrack \mathbf{p}_{\text{jl}}^{\text{cc}}\left\{ \mathbf{p}_{\text{lj}}^{\text{cv}}\mathbf{p}_{\text{ij}}^{\text{vc}} \right\} \right\rbrack}{E_{\text{li}}^{3}\left( E_{\text{li}} + E_{\text{ji}} \right)}\delta\left( E_{\text{li}} - \hbar\omega \right) \right.\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor51">
<span class="eqno">(10.51)<a class="headerlink" href="#equation-eq-uvsor51" title="この数式へのパーマリンク"></a></span>\[\left. \  - \frac{\mathfrak{I\lbrack}\mathbf{p}_{\text{ij}}^{\text{vc}}\{\mathbf{p}_{\text{jl}}^{\text{cc}}\mathbf{p}_{\text{li}}^{\text{cv}}\}\rbrack}{E_{\text{li}}^{3}(2E_{\text{li}} - E_{\text{ji}})}\delta(E_{\text{li}} - \hbar\omega) + \frac{16\mathfrak{I\lbrack}\mathbf{p}_{\text{ij}}^{\text{vc}}\{\mathbf{p}_{\text{jl}}^{\text{cc}}\mathbf{p}_{\text{li}}^{\text{cv}}\}\rbrack}{E_{\text{ji}}^{3}(2E_{\text{li}} -E_{\text{ji}})}\delta(E_{\text{ji}} - 2\hbar\omega) \right)\]</div>
<div class="math notranslate nohighlight">
\[{\chi_{\text{VH}}^{\left( 2 \right)}}^{''}\left( - 2\omega;\omega,\omega \right) = \frac{\pi}{2}\left| \frac{e\hbar}{m} \right|\sum_{i,j,l}^{}{\int_{\text{BZ}}^{}\frac{d\mathbf{k}}{4\pi^{3}}}\left( \frac{\mathfrak{I}\left\lbrack \mathbf{p}_{\text{li}}^{\text{vv}}\left\{ \mathbf{p}_{\text{ij}}^{\text{vc}}\mathbf{p}_{\text{jl}}^{\text{cv}} \right\} \right\rbrack}{E_{\text{jl}}^{3}\left( E_{\text{jl}} + E_{\text{ji}} \right)}\delta\left( E_{\text{jl}} - \hbar\omega \right) \right.\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor53">
<span class="eqno">(10.52)<a class="headerlink" href="#equation-eq-uvsor53" title="この数式へのパーマリンク"></a></span>\[\left. \  - \frac{\mathfrak{I\lbrack}\mathbf{p}_{\text{ij}}^{\text{vc}}\{\mathbf{p}_{\text{jl}}^{\text{cv}}\mathbf{p}_{\text{li}}^{\text{vv}}\}\rbrack}{E_{\text{jl}}^{3}(2E_{\text{jl}} - E_{\text{ji}})}\delta(E_{\text{jl}} - \hbar\omega) + \frac{16\mathfrak{I\lbrack}\mathbf{p}_{\text{ij}}^{\text{vc}}\{\mathbf{p}_{\text{jl}}^{\text{cv}}\mathbf{p}_{\text{li}}^{\text{vv}}\}\rbrack}{E_{\text{ji}}^{3}(2E_{\text{jl}} - E_{\text{ji}})}\delta(E_{\text{ji}} - 2\hbar\omega) \right)\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(m\)</span>は電子質量、<span class="math notranslate nohighlight">\(e\)</span>は素電価、<span class="math notranslate nohighlight">\(c,v\)</span>はそれぞれ伝導及び価電子バンドのインデックス、<span class="math notranslate nohighlight">\(\mathbf{p}_{\text{ij}}\)</span>は座標表示の遷移モーメントより計算される運動量表示遷移モーメントの行列成分( <a class="reference internal" href="#equation-eq-uvsor54">(10.53)</a> )式)、<span class="math notranslate nohighlight">\(E_{\text{ab}}\)</span>はバンド間遷移エネルギー<span class="math notranslate nohighlight">\(E_{\mathbf{k}}^{a} - E_{\mathbf{k}}^{b}\)</span>である。<span class="math notranslate nohighlight">\(\mathfrak{I}\)</span>は虚部をとることを意味する。積分は、すべての<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点について被積分関数の和をとることを意味する。誘電関数計算の場合と異なり、伝導バンド間および価電子バンド間の遷移が関与することに注意。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor54">
<span class="eqno">(10.53)<a class="headerlink" href="#equation-eq-uvsor54" title="この数式へのパーマリンク"></a></span>\[\mathbf{p}_{\text{ij}}= &lt; \Psi_{\mathbf{k}}^{i}|\mathbf{p}|\Psi_{\mathbf{k}}^{j} &gt; = \mathrm{Im}(E_{\mathbf{k}}^{c} - E_{\mathbf{k}}^{v}) &lt; \Psi_{\mathbf{k}}^{i}|\mathbf{r}|\Psi_{\mathbf{k}}^{j} &gt;\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\{\mathbf{p}_{\text{ab}}\mathbf{p}_{\text{bc}}\}\)</span>は <a class="reference internal" href="#equation-eq-uvsor55">(10.54)</a> 式により計算されるテンソルである。<span class="math notranslate nohighlight">\(\alpha\)</span>及び<span class="math notranslate nohighlight">\(\beta\)</span>はカーテシアン座標(<span class="math notranslate nohighlight">\(x,y,z\)</span>)のインデックスである。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor55">
<span class="eqno">(10.54)<a class="headerlink" href="#equation-eq-uvsor55" title="この数式へのパーマリンク"></a></span>\[\{\mathbf{p}_{\text{ab}}\mathbf{p}_{\text{bc}}\}_{\text{αβ}} = \frac{1}{2}(\mathbf{p}_{ab,\alpha}\mathbf{p}_{b c,\beta} + \mathbf{p}_{ab,\beta}\mathbf{p}_{bc,\alpha})\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor49">(10.50)</a> - <a class="reference internal" href="#equation-eq-uvsor53">(10.52)</a> 式により得られる<span class="math notranslate nohighlight">\({\chi^{(2)}}^{''}\)</span>をクラマース・クロニッヒ変換( <a class="reference internal" href="#equation-eq-uvsor56">(10.55)</a> 式)し、実部<span class="math notranslate nohighlight">\({\chi^{(2)}}^{'}\)</span>を求める。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor56">
<span class="eqno">(10.55)<a class="headerlink" href="#equation-eq-uvsor56" title="この数式へのパーマリンク"></a></span>\[{\chi^{(2)}}^{'}( - 2\omega;\omega,\omega) = \frac{2}{\pi}P\int_{0}^{\infty}\frac{\Omega{\chi^{(2)}( - 2\Omega;\Omega,\Omega)}^{''}}{\Omega^{2} - \omega^{2}}d\Omega\]</div>
</div></blockquote>
<p>本プログラムでは、各<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点におけるバンド間の遷移モーメントを(54)式により求め、上記の計算法で感受率<span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>を求める。
<a class="reference internal" href="#equation-eq-uvsor51">(10.51)</a> 及び <a class="reference internal" href="#equation-eq-uvsor53">(10.52)</a> の積分は、Gaussian/parabolic smearing法及びlinear tetrahedron法を用いて行う。 Read and Needs法 あるいはKageshima and Shiraishi法を用いて遷移モーメントの補正を行った場合には、全電子計算と同じ結果が得られる。</p>
<p><a class="reference internal" href="#equation-eq-uvsor51">(10.51)</a> 及び <a class="reference internal" href="#equation-eq-uvsor53">(10.52)</a> 式のデルタ関数の係数は分数であり、分母は0となりうる。デルタ関数の共鳴条件が成立し係数の分母が0となる場合、<a class="reference internal" href="#equation-eq-uvsor51">(10.51)</a> 及び <a class="reference internal" href="#equation-eq-uvsor53">(10.52)</a> 式の右辺は発散する。この発散は、2重共鳴(double resonance)として知られる。2重共鳴は、励起状態のダンピングファクターが0であると近似したために起きる現象である。本プログラムでは、係数の分母が一定の値(カットオフ値)よりも小さくなった場合、その項<span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>のへの寄与を無視あるいはダンピングすることにより、2重共鳴の問題を回避している。カットオフ値は、入力で与えるようになっている。</p>
<p>THGは、材料に入射されたフォトンが2個結合し、周波数が3倍の光が発生する3次非線形光学効果である。THG過程は、価電子帯の電子が伝導帯に散乱される過程(電子過程)、伝導帯の正孔が価電子帯に散乱される過程(正孔過程)、及び電子と正孔がそれぞれ同時に伝導帯及び価電子帯に散乱される過程（3順位過程）からなる <a class="reference internal" href="#moss90" id="id26"><span>[Moss90]</span></a> 。本プログラムは、光電場を摂動ハミルトニアンとする4次の時間依存摂動により感受率<span class="math notranslate nohighlight">\(\chi^{(3)}\left( - 3\omega;\omega,\omega,\omega \right)\)</span>を計算する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor57">
<span class="eqno">(10.56)<a class="headerlink" href="#equation-eq-uvsor57" title="この数式へのパーマリンク"></a></span>\[\text{Im}\left\lbrack \chi_{\text{ve}}^{(3)}\left( \omega \right) \right\rbrack_{\text{αβγδ}} = - \frac{\pi}{3}\left( \frac{e\hbar}{m} \right)^{4}\int_{\text{BZ}}^{}\frac{d\mathbf{k}}{4\pi^{3}}\Sigma_{i,j,k,l}\text{Re}\left\{ \mathbf{p}_{\text{ij}}^{\text{vc}}\left( \mathbf{p}_{\text{jk}}^{\text{cc}},\mathbf{p}_{\text{kl}}^{\text{cc}},\mathbf{p}_{\text{li}}^{\text{cv}} \right)_{\text{βγδ}} \right\} f\left( E_{\text{ji}},E_{\text{ki}},E_{\text{ji}},\hbar\omega \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor58">
<span class="eqno">(10.57)<a class="headerlink" href="#equation-eq-uvsor58" title="この数式へのパーマリンク"></a></span>\[\begin{split}\mathrm{Im}\left[ \xi_{\mathrm vh}^{(3)} \left( \omega\right)\right]_{\alpha\beta\gamma\delta} &amp;= - \frac{\pi}{3}\left(\frac{e\hbar}{m}\right)^4 \int_{\rm BZ} \frac{d\mathbf{k}}{4\pi^3} \sum_{i,j,k,l} [ \mathrm{Re} \left\{ \mathbf{p}_{ij}^{vc}\left(\mathbf{p}_{li}^{vv}, \mathbf{p}_{kl}^{vv},\mathbf{p}_{jk}^{cv}\right)_{\beta\gamma\delta} \right\} f\left(E_{ji},E_{jl},E_{jk},\hbar \omega\right) \\ &amp;- \mathrm{Re} \left\{ \mathbf{p}_{ij}^{vc} \left(\mathbf{p}_{jk}^{vv},\mathbf{p}_{li}^{cc},\mathbf{p}_{kl}^{cv}\right)_{\beta\gamma\delta}\right\} f \left(E_{ji},E_{ki},E_{kl},\hbar \omega\right) \\ &amp;- \mathrm{Re} \left\{ \mathbf{p}_{ij}^{vc} \left(\mathbf{p}_{li}^{vv},\mathbf{p}_{jk}^{cc},\mathbf{p}_{kl}^{cv}\right)_{\beta\gamma\delta}\right\} f \left(E_{ji},E_{jl},E_{kl},\hbar \omega\right) ]\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor59">
<span class="eqno">(10.58)<a class="headerlink" href="#equation-eq-uvsor59" title="この数式へのパーマリンク"></a></span>\[\begin{split}\mathrm{Im}\left[ \xi_{\mathrm ts}^{(3)} \left( \omega\right)\right]_{\alpha\beta\gamma\delta} &amp;= - \frac{\pi}{3}\left(\frac{e\hbar}{m}\right)^4 \int_{\rm BZ} \frac{d\mathbf{k}}{4\pi^3} \sum_{i,j,k,l} \mathrm{Re} \left\{ \mathbf{p}_{ij}^{vc}\left(\mathbf{p}_{li}^{vv}, \mathbf{p}_{kl}^{vv},\mathbf{p}_{jk}^{cv}\right)_{\beta\gamma\delta} \right\} f\left(E_{ji},E_{jl},E_{jk},\hbar \omega\right) \\ &amp;\times \left[ \frac{3^6}{E_{ji}^4 \left(3kE_j - 2E_{ji}\right) \left(3E_{li} - E_{jl}\right)} \delta \left( E_1 - 3\hbar \omega\right) + \frac{1}{E_{li}^4 \left(E_{jk} + 3E_{li} \right)} + \frac{E_{ji}+E_{jk}}{\left(E_{ji}-3E_{li}\right)\left(E_{lk}+E_{li}\right)} \right] \\ &amp;\times \delta\left( E_{li} - \hbar \omega \right)\end{split}\]</div>
</div></blockquote>
<p>ここで、</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f\left( E_{1},E_{2},E_{3},\hbar\omega \right) = \frac{3^{6}}{E_{1}^{4}\left( 3E_{2} - 2E_{1} \right)\left( 3E_{3} - E_{1} \right)}\delta\left( E_{1} - 3\hbar\omega \right)\]</div>
<div class="math notranslate nohighlight">
\[+ \frac{2^{7}\left( 2E_{1} - E_{2} \right)}{E_{2}^{4}\left( 2E_{3} - E_{2} \right)\left( 2E_{3} - 3E_{2} \right)\left( 2E_{1} + E_{2} \right)}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor60">
<span class="eqno">(10.59)<a class="headerlink" href="#equation-eq-uvsor60" title="この数式へのパーマリンク"></a></span>\[+ \frac{1}{E_{3}^{4}\left( E_{2} -2E_{3} \right)}\left( \frac{1}{E_{1} - 3E_{3}} + \frac{2E_{2}}{\left( E_{3} + E_{1} \right)\left( E_{2} + 2E_{3} \right)} \right)\delta\left( E_{3} - \hbar\omega \right)\]</div>
</div></blockquote>
<p>である。<span class="math notranslate nohighlight">\(\alpha,\beta,\gamma,\)</span>及び<span class="math notranslate nohighlight">\(\delta\)</span>は、カーテシアン座標(<span class="math notranslate nohighlight">\(x,y,z\)</span>)のインデックスを意味する。<span class="math notranslate nohighlight">\((\ldots)_{\text{βγδ}}\)</span>は、遷移モーメント積のインデックス<span class="math notranslate nohighlight">\(\beta,\gamma,\)</span>及び<span class="math notranslate nohighlight">\(\delta\)</span>を対称化することを意味する。<a class="reference internal" href="#equation-eq-uvsor57">(10.56)</a> , <a class="reference internal" href="#equation-eq-uvsor58">(10.57)</a> , <a class="reference internal" href="#equation-eq-uvsor59">(10.58)</a> 式はそれぞれ、電子過程、正孔過程、及び３順位過程による<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>の虚部を与える。<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>の虚部は、<span class="math notranslate nohighlight">\(\text{Im}\left\lbrack \chi_{\text{ve}}^{(3)} \right\rbrack,\text{Im}\left\lbrack \chi_{\text{vh}}^{(3)} \right\rbrack,\)</span>及び<span class="math notranslate nohighlight">\(\text{Im}\left\lbrack \chi_{\text{ts}}^{(3)} \right\rbrack\)</span>の和で与えられる。<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>の虚部をクラマース・クロニッヒ変換することにより<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>の実部を得る( <a class="reference internal" href="#equation-eq-uvsor61">(10.60)</a> )</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor61">
<span class="eqno">(10.60)<a class="headerlink" href="#equation-eq-uvsor61" title="この数式へのパーマリンク"></a></span>\[\mathrm{Re} \left[ \xi^{(3)} \left(-3\omega;\omega,\omega,\omega\right)\right] = \frac{2}{\pi} P \int_0^{\infty} \frac{\omega}{\omega'^{2}-\omega^{2}} \mathrm{Im} \left[ \xi^{(3)} \left(-3\omega'; \omega',\omega',\omega'\right)\right] d\omega'\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor57">(10.56)</a> - <a class="reference internal" href="#equation-eq-uvsor59">(10.58)</a> 式のブリルアン・ゾーン積分はGaussian/parabolic
smearing法により計算する。２重共鳴条件の処理は、SHG計算の場合同様、共鳴項を無視あるいはダンピングして行う。</p>
<p><strong>有効質量</strong></p>
<p>電子及び正孔の有効質量は、kp摂動法を用いて次式により計算される <a class="reference internal" href="#rashkeev98" id="id27"><span>[Rashkeev98]</span></a> 。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor62">
<span class="eqno">(10.61)<a class="headerlink" href="#equation-eq-uvsor62" title="この数式へのパーマリンク"></a></span>\[\hbar^{2}\left( \frac{1}{m^{*}} \right)_{\alpha,\beta} = \frac{\partial^{2}E_{\mathbf{k}\lambda}}{\partial\mathbf{k}_{\alpha}\partial\mathbf{k}_{\beta}} = \left\lbrack \delta_{\text{αβ}} + \frac{1}{m}\ \sum_{\lambda^{'} \neq \lambda}^{}\frac{(\mathbf{p}_{\lambda\lambda^{'}}^{\mathbf{k}})_{\alpha}(\mathbf{p}_{\lambda^{'}\lambda}^{\mathbf{k}})_{\beta} + (\mathbf{p}_{\lambda\lambda^{'}}^{\mathbf{k}})_{\beta}(\mathbf{p}_{\lambda^{'}\lambda}^{\mathbf{k}})_{\alpha}}{E_{\mathbf{k}\lambda} - E_{\mathbf{k}\lambda^{'}}} \right\rbrack\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\mathbf{k}\)</span>及び<span class="math notranslate nohighlight">\(\lambda\)</span>は有効質量計算を行う<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点及びバンドのインデックス、<span class="math notranslate nohighlight">\(\lambda^{'}\)</span>は他のバンドのインデックス、<span class="math notranslate nohighlight">\(\alpha\)</span>及び<span class="math notranslate nohighlight">\(\beta\)</span>は座標インデックス、<span class="math notranslate nohighlight">\(\mathbf{p}_{\lambda\lambda^{'}}^{\mathbf{k}}\)</span>はバンド<span class="math notranslate nohighlight">\(\lambda\lambda^{'}\)</span>間の遷移モーメント、<span class="math notranslate nohighlight">\(E_{\mathbf{k}\lambda}\)</span>は計算を行う<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点でのバンド<span class="math notranslate nohighlight">\(\lambda\)</span>のエネルギーである。</p>
<p>バンドがエネルギー的に縮退している場合、波動関数がバンド間で混ざり合うため、(62)式により縮退しているバンドの有効質量を計算すると、正しい値が得られない問題がある。この問題は、特に<span class="math notranslate nohighlight">\(\Gamma\)</span>点での正孔の有効質量を計算する場合に顕著となる。本プログラムでは<span class="math notranslate nohighlight">\(\Gamma\)</span>点での有効質量を、縮退が解けている<span class="math notranslate nohighlight">\(\Gamma\)</span>点より僅かシフトした点で計算するようにして、この問題を回避している。シフト量の程度は入力データで指定する。</p>
</section>
<section id="id28">
<h3><span class="section-number">10.2.2. </span>格子系<a class="headerlink" href="#id28" title="この見出しへのパーマリンク"></a></h3>
<p><strong>概要</strong></p>
<p>格子系誘電率計算プログラムBerry-Phononは第一原理計算プログラムPHASEの拡張機能として実装されている。結晶の格子誘電率の計算には有効電荷と結晶の基準振動の振動数が必要である。Berry-Phononでは結晶の分極をベリー位相分極理論に基づき計算し、各原子のボルン有効電荷を求める。また、PHASEで計算されるヘルマン-ファインマン力を数値微分することにより力定数を計算し、これから動力学行列を構築して、その行列の固有値問題を解き、基準振動の振動数と固有ベクトルを求める。ボルン有効電荷と振動モードの固有ベクトルからモード有効電荷が求まる。基準振動の振動数とモード有効電荷から格子誘電率が計算される。この計算方法の詳細を以降の節で解説する。</p>
<figure class="align-default" id="uvsor-fig3">
<img alt="../_images/uvsor_image3.svg" src="../_images/uvsor_image3.svg" /><figcaption>
<p><span class="caption-number">図 10.3 </span><span class="caption-text">Berry-Phonon 構成図</span><a class="headerlink" href="#uvsor-fig3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><strong>格子誘電率</strong></p>
<p>結晶の<span class="math notranslate nohighlight">\(i\)</span>番目の原子の変位ベクトルを<span class="math notranslate nohighlight">\(\mathbf{u}_{i}\)</span>とすれば、原子が平衡位置
からずれた際に発生する分極の変化は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor63">
<span class="eqno">(10.62)<a class="headerlink" href="#equation-eq-uvsor63" title="この数式へのパーマリンク"></a></span>\[\Delta\mathbf{P} = \frac{e}{V}\sum_{i}^{}\mathbf{Z}_{i}^{*}\mathbf{u}_{i}\]</div>
</div></blockquote>
<p>とあらわされる。ここで、eは電気素量であり、Vは結晶の単位胞の体積である。
<span class="math notranslate nohighlight">\(\mathbf{Z}_{i}^{*}\)</span>はボルン有効電荷テンソルとよばれ、結晶単位胞中の各原子
に固有の物理量である。
原子の変位<span class="math notranslate nohighlight">\(\mathbf{u}_{i}\)</span>を結晶の振動モードで分解することができる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor64">
<span class="eqno">(10.63)<a class="headerlink" href="#equation-eq-uvsor64" title="この数式へのパーマリンク"></a></span>\[\sqrt{m_i} \mathbf{u}_{i\alpha} = \sum_{\lambda}{Q_{\lambda} \xi_{\lambda i \alpha}}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(\xi_{\text{λiα}}\)</span>は基準振動の固有ベクトルであり、
<span class="math notranslate nohighlight">\(Q_{\lambda}\)</span>は基準座標である。<span class="math notranslate nohighlight">\(m_{i}\)</span>は<span class="math notranslate nohighlight">\(i\)</span>番目の原子の質量である。
分極の変化を基準座標で表現すれば</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor65">
<span class="eqno">(10.64)<a class="headerlink" href="#equation-eq-uvsor65" title="この数式へのパーマリンク"></a></span>\[\Delta\mathbf{P} = \frac{e}{V}\sum_{\lambda}^{}{\widetilde{\mathbf{Z}}}_{\lambda}Q_{\lambda}\]</div>
</div></blockquote>
<p>となる。ここで、振動モードの有効電荷を</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor66">
<span class="eqno">(10.65)<a class="headerlink" href="#equation-eq-uvsor66" title="この数式へのパーマリンク"></a></span>\[\tilde{Z}_{\lambda \alpha} = \frac{1}{\sqrt{m_i}} \sum_{i \beta} Z_{i\alpha\beta}^{*} \xi_{\lambda i \beta}\]</div>
</div></blockquote>
<p>と定義した。</p>
<p>振動数<span class="math notranslate nohighlight">\(\omega\)</span>の巨視的な電場を<span class="math notranslate nohighlight">\(\mathbf{E}\)</span>とすれば、モード有効電荷がゼロでない
基準振動の基準座標<span class="math notranslate nohighlight">\(Q_{\lambda}\)</span>は電場に比例して振動する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor67">
<span class="eqno">(10.66)<a class="headerlink" href="#equation-eq-uvsor67" title="この数式へのパーマリンク"></a></span>\[Q_{\lambda} = \frac{e{\widetilde{Z}}_{\lambda} \cdot \mathbf{E}}{\omega_{\lambda}^{2} - \omega^{2}}\]</div>
</div></blockquote>
<p>格子誘電関数<span class="math notranslate nohighlight">\(\epsilon^{\text{lat}}(\omega)\)</span>は
<span class="math notranslate nohighlight">\(4\pi\Delta\mathbf{P} = \epsilon^{\text{lat}}(\omega)\mathbf{E}\)</span>で定義されれる。
この定義と <a class="reference internal" href="#equation-eq-uvsor65">(10.64)</a> 式と <a class="reference internal" href="#equation-eq-uvsor67">(10.66)</a> 式から格子誘電関数は</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor68">
<span class="eqno">(10.67)<a class="headerlink" href="#equation-eq-uvsor68" title="この数式へのパーマリンク"></a></span>\[\epsilon_{\alpha}^{\rm lat} \left(\omega\right) = \frac{4\pi^2}{V}\sum_{\lambda} \frac{\tilde{Z}_{\lambda \alpha} \tilde{Z}_{\lambda \beta}}{\omega_{\lambda}^2 - \omega^2}\]</div>
<p>と表現できる。THz領域の誘電関数<span class="math notranslate nohighlight">\(\epsilon_{\text{αβ}}(\omega)\)</span>は格子誘電関数<span class="math notranslate nohighlight">\(\epsilon^{\text{lat}}(\omega)\)</span>に電子誘電率<span class="math notranslate nohighlight">\(\epsilon_{\text{αβ}}^{\infty}\)</span>を加えたものである。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor69">
<span class="eqno">(10.68)<a class="headerlink" href="#equation-eq-uvsor69" title="この数式へのパーマリンク"></a></span>\[\epsilon_{\alpha\beta} = \epsilon_{\alpha\beta}^{\infty} + \frac{4\pi e^2}{V} \sum_{\lambda} \frac{\tilde{Z}_{\lambda\alpha} \tilde{Z}_{\lambda\beta}}{\omega_{\lambda}^2-\omega^2}\]</div>
<p><strong>ベリー位相分極</strong> <a class="reference internal" href="#king-smith93" id="id29"><span>[King-Smith93]</span></a> <a class="reference internal" href="#resta94" id="id30"><span>[Resta94]</span></a> <a class="reference internal" href="#resta92" id="id31"><span>[Resta92]</span></a></p>
<p>ボルン有効電荷を得るにはまず、結晶の分極を求める必要がある。
結晶の分極はイオンからの寄与<span class="math notranslate nohighlight">\(\mathbf{P}_{\text{ion}}\)</span>と価電子からの寄与
<span class="math notranslate nohighlight">\(\mathbf{P}_{\text{el}}\)</span>とからなる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor70">
<span class="eqno">(10.69)<a class="headerlink" href="#equation-eq-uvsor70" title="この数式へのパーマリンク"></a></span>\[\mathbf{P} = \mathbf{P}_{\text{ion}} + \mathbf{P}_{\text{el}}\]</div>
</div></blockquote>
<p>イオンからの寄与は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor71">
<span class="eqno">(10.70)<a class="headerlink" href="#equation-eq-uvsor71" title="この数式へのパーマリンク"></a></span>\[\mathbf{P}_{\text{ion}}　 = \frac{e}{\Omega}\sum_{l}^{}Z_{l}R_{l}\]</div>
</div></blockquote>
<p>である。 結晶の分極の変化は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor72">
<span class="eqno">(10.71)<a class="headerlink" href="#equation-eq-uvsor72" title="この数式へのパーマリンク"></a></span>\[\Delta\mathbf{P} = \mathbf{P}^{(1)} - \mathbf{P}^{(0)}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor73">
<span class="eqno">(10.72)<a class="headerlink" href="#equation-eq-uvsor73" title="この数式へのパーマリンク"></a></span>\[P_{\alpha}^{(\lambda)} = \frac{\text{if}q_{e}}{8\pi^{3}}\sum_{n = 1}^{M}{\int_{\text{BZ}}^{}d}\mathbf{k} &lt; u_{\mathbf{k}n}^{(\lambda)}|\partial/\partial k_{\alpha}|u_{\mathbf{k}n}^{(\lambda)} &gt;\]</div>
</div></blockquote>
<p>とあらわせる。
ここで、<span class="math notranslate nohighlight">\(\mathbf{k}_{\bot}\)</span>は<span class="math notranslate nohighlight">\(\mathbf{G}_{\parallel}\)</span>に垂直な面上のベクトルである。<span class="math notranslate nohighlight">\(\mathbf{k}_{\bot}\)</span>を通り、<span class="math notranslate nohighlight">\(G_{\parallel}\)</span>に平行な長さ<span class="math notranslate nohighlight">\(|\mathbf{G}_{\parallel}|\)</span>線分をJ分割する点列<span class="math notranslate nohighlight">\(\mathbf{k}_{j} = \mathbf{k}_{\bot} + j\mathbf{G}_{\parallel}/J\ (j = 0,\ldots,J - 1)\)</span>を考える。このとき、
変数<span class="math notranslate nohighlight">\(\phi_{J}^{(\lambda)}(\mathbf{k}_{\bot})\)</span>を以下のように定義する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor74">
<span class="eqno">(10.73)<a class="headerlink" href="#equation-eq-uvsor74" title="この数式へのパーマリンク"></a></span>\[\phi_{J}^{(\lambda)}(\mathbf{k}_{\bot}) = \text{Im}\left\{ \ln\Pi_{j = 0}^{J - 1}S^{(\lambda)}(\mathbf{k}_{j},\mathbf{k}_{j + 1}) \right\}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor75">
<span class="eqno">(10.74)<a class="headerlink" href="#equation-eq-uvsor75" title="この数式へのパーマリンク"></a></span>\[S^{(\lambda)}(\mathbf{k}_{j},\mathbf{k}_{j + 1}) = {\det\ }( &lt; u_{\mathbf{k}_{j}m}^{(\lambda)}|u_{\mathbf{k}_{j + 1}n}^{(\lambda)} &gt; )\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(u_{\mathbf{k}_{J}n} = e^{- i\mathbf{G}_{\parallel} \cdot \mathbf{r}}u_{\mathbf{k}_{0}n}\)</span>である。これは<span class="math notranslate nohighlight">\(J \rightarrow \infty\)</span>のとき<span class="math notranslate nohighlight">\(\mathbf{k}_{\bot}\)</span>を通る線分のベリー位相となる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor76">
<span class="eqno">(10.75)<a class="headerlink" href="#equation-eq-uvsor76" title="この数式へのパーマリンク"></a></span>\[\phi^{(\lambda)}(\mathbf{k}_{\bot}) = \lim_{J \rightarrow \infty}\phi_{J}^{(\lambda)}(\mathbf{k}_{\bot})\  = - i\sum_{n = 1}^{M}{\int_{0}^{|\mathbf{G}_{\parallel}|}d}\mathbf{k}_{\parallel} &lt; u_{\mathbf{k}n}^{(\lambda)}|\frac{\partial}{\partial\mathbf{k}_{\parallel}}|u_{\mathbf{k}n}^{(\lambda)} &gt;\]</div>
</div></blockquote>
<p>各k点で独立に波動関数を計算したときにはベリー位相以外の任意の位相ずれが許される。<a class="reference internal" href="#equation-eq-uvsor76">(10.75)</a> 式ではなく <a class="reference internal" href="#equation-eq-uvsor74">(10.73)</a> 式をもちいることにより、その位相ずれを打ち消すことができる。これより、分極の成分<span class="math notranslate nohighlight">\(P_{\parallel}^{(\lambda)}\)</span>は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor77">
<span class="eqno">(10.76)<a class="headerlink" href="#equation-eq-uvsor77" title="この数式へのパーマリンク"></a></span>\[P_{\parallel}^{(\lambda)} = - \frac{fq_{e}}{8\pi^{3}}\int_{A}^{}d\mathbf{k}_{\bot}\phi^{(\lambda)}(\mathbf{k}_{\bot})\]</div>
</div></blockquote>
<p>とあらわせる。<span class="math notranslate nohighlight">\(\mathbf{b}_{i}\)</span>方向に沿って求められたベリー位相を<span class="math notranslate nohighlight">\(\phi_{i}^{(\lambda)}\)</span>とすれば分極は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor78">
<span class="eqno">(10.77)<a class="headerlink" href="#equation-eq-uvsor78" title="この数式へのパーマリンク"></a></span>\[\mathbf{P}^{(\lambda)} = - \frac{fq_{e}}{\Omega}\sum_{i}^{}\frac{a_{\mathbf{i}}}{2\pi}\phi_{i}^{(\lambda)}\]</div>
</div></blockquote>
<p>とあらわせる。</p>
<p>ウルトラソフト擬ポテンシャルを用いた場合は電荷欠損補正を行う必要がある。
<a class="reference internal" href="#equation-eq-uvsor75">(10.74)</a> 式に現れる積<span class="math notranslate nohighlight">\(&lt; u_{\mathbf{k}_{j}m}^{(\lambda)}|u_{\mathbf{k}_{j + 1}n}^{(\lambda)} &gt;\)</span>は<span class="math notranslate nohighlight">\(\psi_{\mathbf{k}n}^{(\lambda)}(\mathbf{r}) = e^{i\mathbf{k} \cdot \mathbf{r}}u_{\mathbf{k}n}^{(\lambda)}(\mathbf{r})\)</span>を用いて、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor79">
<span class="eqno">(10.78)<a class="headerlink" href="#equation-eq-uvsor79" title="この数式へのパーマリンク"></a></span>\[M_{\text{mn}}(\mathbf{k}_{j}) = &lt; \psi_{\mathbf{k}_{j}m}^{(\lambda)}|e^{- i\Delta\mathbf{k} \cdot \mathbf{r}}|\psi_{\mathbf{k}_{j} + \Delta\mathbf{k},n}^{(\lambda)} &gt;\]</div>
</div></blockquote>
<p>と表せる。ここで、<span class="math notranslate nohighlight">\(\Delta\mathbf{k} = \mathbf{G}_{\parallel}/J\)</span>である。
ウルトラソフト擬ポテンシャルを用いた場合には電荷欠損を補うために <a class="reference internal" href="#equation-eq-uvsor79">(10.78)</a> 式の積の間に電荷密度演算子</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor80">
<span class="eqno">(10.79)<a class="headerlink" href="#equation-eq-uvsor80" title="この数式へのパーマリンク"></a></span>\[K\left( \mathbf{r} \right) = |\mathbf{r} &gt; &lt; \mathbf{r}|+ \sum_{l}^{}{\sum_{\text{ij}}^{}Q_{\text{ij}}^{l}}\left( \mathbf{r} \right)|\beta_{i}^{l} &gt; &lt; \beta_{j}^{l}|\]</div>
</div></blockquote>
<p>を挿入しなければならない。
ここで、<span class="math notranslate nohighlight">\(l = \{ R,\tau\}\)</span>は原子位置を表すラベルである。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor81">
<span class="eqno">(10.80)<a class="headerlink" href="#equation-eq-uvsor81" title="この数式へのパーマリンク"></a></span>\[M_{\text{mn}}(\mathbf{k}_{j}) = \int_{}^{}d^{3}r &lt; \psi_{\mathbf{k}_{j}m}^{(\lambda)}|K\left( \mathbf{r} \right)e^{- i\Delta\mathbf{k} \cdot \mathbf{r}}|\psi_{\mathbf{k}_{j} + \Delta\mathbf{k},n}^{(\lambda)} &gt;\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor81">(10.80)</a> 式から求まる <a class="reference internal" href="#equation-eq-uvsor80">(10.79)</a> 式に対する補正項を<span class="math notranslate nohighlight">\(M_{\text{mn}}^{\text{US}}(\mathbf{k})\)</span>とする。</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[M_{\text{mn}}^{\text{US}}(\mathbf{k}) = \sum_{l}^{}{\sum_{\text{ij}}^{}{\int_{}^{}d^{3}}}rQ_{\text{ij}}^{l}\left( \mathbf{r}\right)e^{- i\Delta\mathbf{k} \cdot \mathbf{r}} &lt; \psi_{\mathbf{k}m}^{(\lambda)}|\beta_{i}^{l} &gt; &lt; \beta_{j}^{l}|\psi_{\mathbf{k} + \Delta\mathbf{k},n}^{(\lambda)} &gt;\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor82">
<span class="eqno">(10.81)<a class="headerlink" href="#equation-eq-uvsor82" title="この数式へのパーマリンク"></a></span>\[= \sum_{\tau}^{}{\sum_{\text{ij}}^{}{\int_{}^{}d^{3}}}rq_{\text{ij}}^{\tau}\left( \mathbf{r} \right)e^{- i\Delta\mathbf{k} \cdot \mathbf{r}}F_{i}^{\tau*}(m,\mathbf{k})F_{j}^{\tau}(n,\mathbf{k} + \Delta\mathbf{k})\]</div>
</div></blockquote>
<p>最後の式は波動関数を平面波展開した場合(<span class="math notranslate nohighlight">\(\psi_{\mathbf{k}n}^{(\lambda)}(\mathbf{r}) = \frac{1}{\Omega}\sum_{\mathbf{G}}^{}c_{\mathbf{k}n,\mathbf{G}}^{(\lambda)}e^{i(\mathbf{k} + \mathbf{G}) \cdot \mathbf{r}}\)</span>)の表現であり、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor83">
<span class="eqno">(10.82)<a class="headerlink" href="#equation-eq-uvsor83" title="この数式へのパーマリンク"></a></span>\[Q_{\text{ij}}^{l}(\mathbf{r}) = q_{\text{ij}}^{\tau}\left( \mathbf{r} - \mathbf{\tau} - R \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor84">
<span class="eqno">(10.83)<a class="headerlink" href="#equation-eq-uvsor84" title="この数式へのパーマリンク"></a></span>\[\beta_{i}^{l}(\mathbf{r}) = \beta_{i}^{\tau}\left( \mathbf{r} - \mathbf{\tau} - R \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor85">
<span class="eqno">(10.84)<a class="headerlink" href="#equation-eq-uvsor85" title="この数式へのパーマリンク"></a></span>\[F_{i}^{\tau}(n,\mathbf{k}) = \frac{1}{\sqrt{\Omega}}\sum_{\mathbf{G}}^{}{\int_{}^{}d^{3}}r\beta_{i}^{\tau}(\mathbf{r})e^{i(\mathbf{k} + \mathbf{G}) \cdot \mathbf{r}}e^{i\mathbf{G} \cdot \mathbf{\tau}}c_{\mathbf{k}n,\mathbf{G}}^{(\lambda)}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor86">
<span class="eqno">(10.85)<a class="headerlink" href="#equation-eq-uvsor86" title="この数式へのパーマリンク"></a></span>\[&lt; \beta_{i}^{l}|\psi_{\mathbf{k}n}^{(\lambda)} &gt; = e^{- i\mathbf{k} \cdot(\mathbf{R} + \mathbf{\tau})}F_{i}^{\tau}(n,\mathbf{k})\]</div>
</div></blockquote>
<p>といった関係式を用いて格子和が取り除かれている。<span class="math notranslate nohighlight">\(\psi_{\mathbf{k} + \mathbf{G},n}^{(\lambda)} = \psi_{\mathbf{k}n}^{(\lambda)}\)</span>なので、<span class="math notranslate nohighlight">\(&lt; \beta_{i}^{l}|\psi_{\mathbf{k}n}^{(\lambda)} &gt; = &lt; \beta_{i}^{l}|\psi_{\mathbf{k} + \mathbf{G},n}^{(\lambda)} &gt;\)</span>が成り立つ。<a class="reference internal" href="#equation-eq-uvsor86">(10.85)</a> 式を適用すれば、<span class="math notranslate nohighlight">\(F_{i}^{\tau}(n,\mathbf{k} + \mathbf{G})\)</span>と<span class="math notranslate nohighlight">\(F_{i}^{\tau}(n,\mathbf{k})\)</span>の間の関係が導ける。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor87">
<span class="eqno">(10.86)<a class="headerlink" href="#equation-eq-uvsor87" title="この数式へのパーマリンク"></a></span>\[F_{i}^{\tau}(n,\mathbf{k} + \mathbf{G}) = e^{- i\mathbf{G} \cdot \mathbf{\tau}}F_{i}^{\tau}(n,\mathbf{k})\]</div>
</div></blockquote>
<p>したがって、<span class="math notranslate nohighlight">\(F_{i}^{\tau}(n,\mathbf{k}_{J})\)</span>は<span class="math notranslate nohighlight">\(F_{i}^{\tau}(n,\mathbf{k}_{0})\)</span>に位相因子<span class="math notranslate nohighlight">\(e^{- i\mathbf{G}_{\parallel} \cdot \mathbf{\tau}}\)</span>をかけたものに等しい。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor88">
<span class="eqno">(10.87)<a class="headerlink" href="#equation-eq-uvsor88" title="この数式へのパーマリンク"></a></span>\[F_{i}^{\tau}(n,\mathbf{k}_{J}) = e^{- i\mathbf{G}_{\parallel} \cdot \mathbf{\tau}}F_{i}^{\tau}(n,\mathbf{k}_{0})\]</div>
</div></blockquote>
<p><strong>ボルン有効電荷</strong></p>
<p>結晶中のある原子のボルン有効電荷テンソル<span class="math notranslate nohighlight">\(\mathbf{Z}^{*}\)</span>はその原子の変位<span class="math notranslate nohighlight">\(\mathbf{u}\)</span>よって生じた分極の変化<span class="math notranslate nohighlight">\(\Delta\mathbf{P}\)</span>とその変位との比例係数として定義される。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor89">
<span class="eqno">(10.88)<a class="headerlink" href="#equation-eq-uvsor89" title="この数式へのパーマリンク"></a></span>\[\Delta\mathbf{P}　 = - \frac{q_{e}}{\Omega}Z^{\mathbf{*}}\mathbf{u}\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor70">(10.69)</a> , <a class="reference internal" href="#equation-eq-uvsor71">(10.70)</a> , <a class="reference internal" href="#equation-eq-uvsor78">(10.77)</a> を用いると、ボルン有効電荷は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor90">
<span class="eqno">(10.89)<a class="headerlink" href="#equation-eq-uvsor90" title="この数式へのパーマリンク"></a></span>\[\begin{split}Z_{\alpha\beta}^{*} &amp;= - \frac{\Omega}{q_e} \frac{\partial P_{\alpha}}{\partial u_{\beta}} \\ &amp;= Z_{\rm ion} \delta_{\alpha\beta} + \sum_i \frac{f}{2\pi} a_{i\alpha} \cdot \frac{\partial \phi_i\left(u_\beta \hat{\beta}\right)}{\partial u_\beta}\end{split}\]</div>
</div></blockquote>
<p>と表現できる。ここで、<span class="math notranslate nohighlight">\(\mathbf{a}_{i}\)</span>は基本並進ベクトルであり、<span class="math notranslate nohighlight">\(\phi_{i}(\mathbf{u})\)</span>は逆格子ベクトル<span class="math notranslate nohighlight">\(\mathbf{b}_{i}\)</span>の方向に線積分を行った場合の原子変位<span class="math notranslate nohighlight">\(\mathbf{u}\)</span>によるベリー位相である。ベリー位相の原子変位による微分は<span class="math notranslate nohighlight">\(\frac{\partial\phi_{i}(u_{\beta}\widehat{\beta})}{\partial u_{\beta}}\)</span>は差分近似で求める。原子変位<span class="math notranslate nohighlight">\(\Delta u_{\beta}\)</span>によるベリー位相の変化を<span class="math notranslate nohighlight">\(\Delta\phi_{i}\)</span>とするとき、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor91">
<span class="eqno">(10.90)<a class="headerlink" href="#equation-eq-uvsor91" title="この数式へのパーマリンク"></a></span>\[\frac{\partial\phi_{i}(u_{\beta}\widehat{\beta})}{\partial u_{\beta}} = \frac{\Delta\phi_{i}}{\Delta u_{\beta}}\]</div>
</div></blockquote>
<p>のように求める。</p>
<p>結晶の中の原子は空間群の対称操作を行なうと等価な位置に移る。原子を動かさない対称操作の組から生成される点群がその原子の位置対称性をあらわす。有効電荷テンソルは位置対称性にしたがいゼロでない成分が決まる。位置対称性の対称操作を<span class="math notranslate nohighlight">\(R_{s}\)</span>とすれば、ボルン有効電荷<span class="math notranslate nohighlight">\(\mathbf{Z}^{*}\)</span>は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor92">
<span class="eqno">(10.91)<a class="headerlink" href="#equation-eq-uvsor92" title="この数式へのパーマリンク"></a></span>\[\mathbf{Z}^{*} =　\frac{1}{N}\sum_{s}^{}R_{s}\mathbf{Z}^{*}R_{s}^{- 1}\]</div>
</div></blockquote>
<p>を満たさなければならない。ここで、<span class="math notranslate nohighlight">\(N\)</span>は対称操作の数である。</p>
<p>等価原子のボルン有効電荷テンソルは等価原子に移す対称操作<span class="math notranslate nohighlight">\(\{ R|\mathbf{T}\}\)</span>を作用させて求めることができる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor93">
<span class="eqno">(10.92)<a class="headerlink" href="#equation-eq-uvsor93" title="この数式へのパーマリンク"></a></span>\[\mathbf{Z}_{j}^{*} = R\mathbf{Z}_{i}^{*}R^{- 1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor94">
<span class="eqno">(10.93)<a class="headerlink" href="#equation-eq-uvsor94" title="この数式へのパーマリンク"></a></span>\[\mathbf{r}_{j} = R\mathbf{r}_{i} + \mathbf{T}\]</div>
</div></blockquote>
<p>ボルン有効電荷テンソルには零総和則があり、単位胞内の原子のボルン有効電荷<span class="math notranslate nohighlight">\(\mathbf{Z}_{i}^{*}\)</span>の和をとるとゼロにならなければならない。 <a class="reference internal" href="#pick70" id="id32"><span>[Pick70]</span></a></p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor95">
<span class="eqno">(10.94)<a class="headerlink" href="#equation-eq-uvsor95" title="この数式へのパーマリンク"></a></span>\[\sum_{i}^{}\mathbf{Z}_{i}^{*} = 0\]</div>
</div></blockquote>
<p><strong>k</strong>点数や平面波数に関する収束が不十分であると、ボルン有効電荷の零総和則が満たされなくなる。ボルン有効電荷の平均値</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor96">
<span class="eqno">(10.95)<a class="headerlink" href="#equation-eq-uvsor96" title="この数式へのパーマリンク"></a></span>\[{\bar{\mathbf{Z}}}^{*} = \frac{1}{N_{a}}\sum_{i = 1}^{N_{a}}\mathbf{Z}_{i}^{*}\]</div>
</div></blockquote>
<p>を求め、ボルン有効電荷<span class="math notranslate nohighlight">\(\mathbf{Z}_{i}^{*}\)</span>からボルン有効電荷の平均値<span class="math notranslate nohighlight">\({\bar{\mathbf{Z}}}^{*}\)</span>を差し引くことで補正されたボルン有効電荷<span class="math notranslate nohighlight">\(\mathbf{Z}_{i}^{*,new}\)</span>を求めることができる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor97">
<span class="eqno">(10.96)<a class="headerlink" href="#equation-eq-uvsor97" title="この数式へのパーマリンク"></a></span>\[\mathbf{Z}_{i}^{*,new} = \mathbf{Z}_{i}^{*} - {\bar{\mathbf{Z}}}^{*}\]</div>
</div></blockquote>
<p><strong>格子振動解析</strong></p>
<p>格子振動解析の理論説明は <a class="reference internal" href="../ion_dynamics/ion_dynamics.html#section-phonon"><span class="std std-numref">9.1 章</span></a> の振動解析の説明を参照されたい。</p>
<p><strong>圧電応答</strong></p>
<p>物質が歪むことにより、応力が発生する。歪みがわずかであれば、フックの法則が成り立ち、次式のように弾性定数<span class="math notranslate nohighlight">\(c_{\text{ijkl}}\)</span>を用いて応力<span class="math notranslate nohighlight">\(\sigma_{\text{ij}}\)</span>と歪み
<span class="math notranslate nohighlight">\(\epsilon_{\text{kl}}\)</span>が結びつけられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor98">
<span class="eqno">(10.97)<a class="headerlink" href="#equation-eq-uvsor98" title="この数式へのパーマリンク"></a></span>\[\sigma_{\text{ij}} = \sum_{\text{kl}}^{}c_{\text{ijkl}}\epsilon_{\text{kl}}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(i,j,k,l\)</span>はデカルト座標のインデックス<span class="math notranslate nohighlight">\(x,y,z\)</span>または<span class="math notranslate nohighlight">\(1,2,3\)</span>である。
誘電率が<span class="math notranslate nohighlight">\(\varepsilon_{\text{ij}}\)</span>の物質では電場<span class="math notranslate nohighlight">\(E_{j}\)</span>と分極<span class="math notranslate nohighlight">\(P_{i}\)</span>の間に次の関係が成り立つ。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor99">
<span class="eqno">(10.98)<a class="headerlink" href="#equation-eq-uvsor99" title="この数式へのパーマリンク"></a></span>\[P_{i} = \sum_{j}^{}\frac{\varepsilon_{\text{ij}} - \delta_{\text{ij}}}{4\pi}E_{j}\]</div>
</div></blockquote>
<p>歪み<span class="math notranslate nohighlight">\(\epsilon_{\text{kl}}\)</span>と電場<span class="math notranslate nohighlight">\(E_{j}\)</span>が混在したした場合は、式 <a class="reference internal" href="#equation-eq-uvsor98">(10.97)</a> には電場による項が加わり、式 <a class="reference internal" href="#equation-eq-uvsor99">(10.98)</a> には歪みによる項が加わる。 圧電定数<span class="math notranslate nohighlight">\(e_{i,kl}\)</span>はひずみによる分極の変化率として定義される。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor100">
<span class="eqno">(10.99)<a class="headerlink" href="#equation-eq-uvsor100" title="この数式へのパーマリンク"></a></span>\[e_{i,kl} = \left( \frac{\partial P_{i}}{\partial\epsilon_{\text{kl}}} \right)\]</div>
</div></blockquote>
<p>これより、 <a class="reference internal" href="#equation-eq-uvsor99">(10.98)</a> 式は次のように修正される。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor101">
<span class="eqno">(10.100)<a class="headerlink" href="#equation-eq-uvsor101" title="この数式へのパーマリンク"></a></span>\[P_{i} = \sum_{\text{kl}}^{}e_{i,kl}\epsilon_{\text{kl}} + \sum_{j}^{}\frac{\varepsilon_{\text{ij}} - \delta_{\text{ij}}}{4\pi}E_{j}\]</div>
</div></blockquote>
<p>歪み<span class="math notranslate nohighlight">\(\epsilon_{\text{kl}}\)</span>と応力<span class="math notranslate nohighlight">\(\sigma_{\text{kl}}\)</span>のインデックス<span class="math notranslate nohighlight">\(\text{kl}\)</span>は短縮した表現1,2,3,4,5,6で記述されることがある。その対応を下記に示す。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\text{kl} &amp; 11 &amp; 22 &amp; 33 &amp; 23 &amp; 31 &amp; 12 \\
短縮表現 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 \\
\end{matrix}\end{split}\]</div>
<p>以降の説明でも、適宜この表現を用いる。</p>
<p>次に電場による応力変化の表式を熱力学的考察により導く。分極の微小変化<span class="math notranslate nohighlight">\(dP_{i}\)</span>によるエネルギー変化は<span class="math notranslate nohighlight">\(\sum_{i}^{}E_{i}dP_{i}\)</span>である。歪みの微小変化<span class="math notranslate nohighlight">\(d\epsilon_{\text{kl}}\)</span>によるエネルギー変化は<span class="math notranslate nohighlight">\(\sum_{\text{kl}}^{}\sigma_{\text{kl}}d\epsilon_{\text{kl}}\)</span>である。これらの和が自由エネルギー<span class="math notranslate nohighlight">\(F(T,\epsilon,P)\)</span>の変化である。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor102">
<span class="eqno">(10.101)<a class="headerlink" href="#equation-eq-uvsor102" title="この数式へのパーマリンク"></a></span>\[dF = \sum_{i}^{}E_{i}dP_{i} + \sum_{\text{kl}}^{}\sigma_{\text{kl}}d\epsilon_{\text{kl}}\]</div>
</div></blockquote>
<p>これに分極と電場との相互作用エネルギー<span class="math notranslate nohighlight">\(W = - \sum_{i}^{}P_{i}E_{i}\)</span>の変化<span class="math notranslate nohighlight">\(\text{dW}\)</span>を加えてルジャンドル変換を行い、外場を含む自由エネルギー<span class="math notranslate nohighlight">\(F^{*}(T,\epsilon,E)\)</span>の変化が求まる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor103">
<span class="eqno">(10.102)<a class="headerlink" href="#equation-eq-uvsor103" title="この数式へのパーマリンク"></a></span>\[dF^{*} = dF + dW\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor104">
<span class="eqno">(10.103)<a class="headerlink" href="#equation-eq-uvsor104" title="この数式へのパーマリンク"></a></span>\[= - \sum_{i}^{}P_{i}dE_{i} + \sum_{\text{kl}}^{}\sigma_{\text{kl}}d\epsilon_{\text{kl}}\]</div>
</div></blockquote>
<p>これより、</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor105">
<span class="eqno">(10.104)<a class="headerlink" href="#equation-eq-uvsor105" title="この数式へのパーマリンク"></a></span>\[\left( \frac{\partial F}{\partial E_{i}} \right) = - P_{i}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor106">
<span class="eqno">(10.105)<a class="headerlink" href="#equation-eq-uvsor106" title="この数式へのパーマリンク"></a></span>\[\left( \frac{\partial F}{\partial\epsilon_{\text{kl}}} \right) = \sigma_{\text{kl}}\]</div>
</div></blockquote>
<p>であるから、次の関係が導かれる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor107">
<span class="eqno">(10.106)<a class="headerlink" href="#equation-eq-uvsor107" title="この数式へのパーマリンク"></a></span>\[\left( \frac{\partial\sigma_{\text{kl}}}{\partial E_{i}} \right) = - \left( \frac{\partial P_{i}}{\partial\sigma_{\text{kl}}} \right) = - e_{i,kl}\]</div>
</div></blockquote>
<p>これより、 <a class="reference internal" href="#equation-eq-uvsor98">(10.97)</a> 式は次のように修正される。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor108">
<span class="eqno">(10.107)<a class="headerlink" href="#equation-eq-uvsor108" title="この数式へのパーマリンク"></a></span>\[\sigma_{\text{ij}} = \sum_{\text{kl}}^{}c_{\text{ijkl}}\epsilon_{\text{kl}} - \sum_{k}^{}e_{k,ij}E_{k}\]</div>
</div></blockquote>
<p><a class="reference internal" href="#equation-eq-uvsor101">(10.100)</a> 式から電束密度は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor109">
<span class="eqno">(10.108)<a class="headerlink" href="#equation-eq-uvsor109" title="この数式へのパーマリンク"></a></span>\[D_{i} = 4\pi\sum_{\text{kl}}^{}e_{i,kl}\epsilon_{\text{kl}} + \sum_{j}^{}\varepsilon_{\text{ij}}E_{j}\]</div>
</div></blockquote>
<p>となる。この式と <a class="reference internal" href="#equation-eq-uvsor108">(10.107)</a> 式をあわせて圧電基本式という。</p>
<p><strong>圧電応答のベリー位相理論</strong> <a class="reference internal" href="#vanderbilt00" id="id33"><span>[Vanderbilt00]</span></a></p>
<p><a class="reference internal" href="#equation-eq-uvsor101">(10.100)</a> 式によって定義される圧電定数はインプロパー圧電定数<span class="math notranslate nohighlight">\(e_{i,kl}\)</span>と呼ばれる。これとは違いプロパー圧電定数<span class="math notranslate nohighlight">\({\widetilde{e}}_{i,kl}\)</span>は、歪み速度<span class="math notranslate nohighlight">\({\widetilde{\epsilon}}_{\text{kl}} = \frac{d\epsilon_{\text{kl}}}{\text{dt}}\)</span>による電流密度<span class="math notranslate nohighlight">\(J_{i}\)</span>の変化率として与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor110">
<span class="eqno">(10.109)<a class="headerlink" href="#equation-eq-uvsor110" title="この数式へのパーマリンク"></a></span>\[{\widetilde{e}}_{i,kl} = \frac{\partial J_{i}}{\partial{\widetilde{\epsilon}}_{\text{kl}}}\]</div>
</div></blockquote>
<p>インプロパー圧電定数<span class="math notranslate nohighlight">\(e_{i,kl}\)</span>とプロパー圧電定数<span class="math notranslate nohighlight">\({\widetilde{e}}_{i,kl}\)</span>の間には次の関係が成り立つ。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor111">
<span class="eqno">(10.110)<a class="headerlink" href="#equation-eq-uvsor111" title="この数式へのパーマリンク"></a></span>\[{\widetilde{e}}_{i,kl} = e_{i,kl} + \delta_{\text{kl}}P_{i} - \delta_{\text{ik}}P_{l}\]</div>
</div></blockquote>
<p>ベリー位相分極理論によれば、電子からの結晶分極への寄与を波動関数をもとに計算することが可能である。ここでは、次式で与えられるように、ベリー位相を定義する。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor112">
<span class="eqno">(10.111)<a class="headerlink" href="#equation-eq-uvsor112" title="この数式へのパーマリンク"></a></span>\[\phi_{\alpha}^{\text{el}} = \frac{8\pi^{3}}{V}\sum_{n}^{}{\int_{\text{BZ}}^{}d^{3}}k &lt; u_{n\mathbf{k}}| - i\mathbf{b}_{\alpha} \cdot \nabla_{\mathbf{k}}|u_{n\mathbf{k}} &gt;\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(\alpha\)</span>は逆格子ベクトル<span class="math notranslate nohighlight">\(\mathbf{b}_{\alpha}\)</span>のインデックス1,2,3を表わす。
<span class="math notranslate nohighlight">\(u_{n\mathbf{k}}\)</span>は波動関数の周期的部分であり、nはバンドインデックスであり、<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>は波数ベクトルである。<span class="math notranslate nohighlight">\(V\)</span>は結晶の体積であり、積分記号の添え字BZはブリュアンゾーン内で積分することを表す。
このとき、ベリー位相分極<span class="math notranslate nohighlight">\(\mathbf{P}_{\text{el}}\)</span>は次式の様にあたえらる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor113">
<span class="eqno">(10.112)<a class="headerlink" href="#equation-eq-uvsor113" title="この数式へのパーマリンク"></a></span>\[\mathbf{P}_{\text{el}} = - \frac{1}{2\pi}\frac{e}{V}\sum_{\alpha}^{}\phi_{\alpha}^{\text{el}}\mathbf{a}_{\alpha}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(\mathbf{a}_{\alpha}\)</span>は基本並進ベクトルである。結晶分極のイオンからの寄与は次式のように与えられる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor114">
<span class="eqno">(10.113)<a class="headerlink" href="#equation-eq-uvsor114" title="この数式へのパーマリンク"></a></span>\[\mathbf{P}_{\text{ion}} = - \frac{e}{V}\sum_{\alpha}^{}Z_{l}R_{l}\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(Z_{l}\)</span>はイオンの電荷であり、<span class="math notranslate nohighlight">\(R_{l}\)</span>はイオンの位置ベクトルである。ここで、位相<span class="math notranslate nohighlight">\(\phi_{\alpha}^{\text{ion}} = - \sum_{l}^{}\mathbf{b}_{\alpha} \cdot \mathbf{R}_{l}\)</span>を定義する。これとベリー位相<span class="math notranslate nohighlight">\(\phi_{\alpha}^{\text{el}}\)</span>を加え合わせた位相を<span class="math notranslate nohighlight">\(\phi_{\alpha}\)</span>とする。これを用いて、結晶分極<span class="math notranslate nohighlight">\(\mathbf{P}\)</span>は次のように書き表せる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor115">
<span class="eqno">(10.114)<a class="headerlink" href="#equation-eq-uvsor115" title="この数式へのパーマリンク"></a></span>\[\mathbf{P} = - \frac{1}{2\pi}\frac{e}{V}\sum_{\alpha}^{}\phi_{\alpha}\mathbf{a}_{\alpha}\]</div>
</div></blockquote>
<p>この結晶分極<span class="math notranslate nohighlight">\(\mathbf{P}\)</span>を歪みで微分したものはインプロパー圧電定数を与えることを示せる。ベリー位相分極は<span class="math notranslate nohighlight">\(\frac{e}{V}\mathbf{a}_{\alpha}\)</span>の整数倍の不定性を持ち、そのためインプロパー圧電定数は一意に定まらない。しかし、プロパー圧電定数は一意に定まることが示せる。プロパー圧電定数の表式( <a class="reference internal" href="#equation-eq-uvsor116">(10.115)</a> 式)は <a class="reference internal" href="#equation-eq-uvsor115">(10.114)</a> 式を <a class="reference internal" href="#equation-eq-uvsor111">(10.110)</a> 式に代入して求まる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor116">
<span class="eqno">(10.115)<a class="headerlink" href="#equation-eq-uvsor116" title="この数式へのパーマリンク"></a></span>\[{\widetilde{e}}_{i,kl} = - \frac{1}{2\pi}\frac{e}{V}\sum_{\alpha}^{}\frac{\partial\phi_{\alpha}}{\partial\epsilon_{\text{kl}}}a_{\alpha,i}\]</div>
</div></blockquote>
<p><strong>圧電定数の計算方法</strong></p>
<p>結晶の内部座標<span class="math notranslate nohighlight">\(u_{j}\)</span>を固定して圧電定数を <a class="reference internal" href="#equation-eq-uvsor116">(10.115)</a> 式に従い計算したとき、その圧電定数をクランプドイオン近似プロパー圧電定数と呼ぶ。このとき位相<span class="math notranslate nohighlight">\(\phi_{\alpha}\)</span>はベリー位相としてよい。クランプドイオン近似プロパー圧電定数は次式の様に表せる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor117">
<span class="eqno">(10.116)<a class="headerlink" href="#equation-eq-uvsor117" title="この数式へのパーマリンク"></a></span>\[{\widetilde{e}}_{i,kl}^{(0)} = \left. \ \frac{\partial P_{i}}{\partial\epsilon_{\text{kl}}} \right|_{u_{j} = u_{j}^{(0)}}\]</div>
</div></blockquote>
<p>ここで、<span class="math notranslate nohighlight">\(u_{j}^{(0)}\)</span>は歪みの無いとき内部座標を表す。結晶が歪んだときに内部座標が変化する効果を取り込むには、内部歪みパラメータ<span class="math notranslate nohighlight">\(\frac{\partial u_{j}}{\partial\epsilon_{\text{kl}}}\)</span>とボルン有効電荷<span class="math notranslate nohighlight">\(Z_{l}^{*} = \frac{V}{e}\frac{\partial\mathbf{P}}{\partial\mathbf{R}_{l}}\)</span>に比例する量<span class="math notranslate nohighlight">\(\frac{\partial P_{i}}{\partial u_{j}}\)</span>を計算し、その積をクランプドイオン近似プロパー圧電定数に加えればよい。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor118">
<span class="eqno">(10.117)<a class="headerlink" href="#equation-eq-uvsor118" title="この数式へのパーマリンク"></a></span>\[{\widetilde{e}}_{i,kl} = {\widetilde{e}}_{i,kl}^{(0)} + \sum_{j}^{}\frac{\partial P_{i}}{\partial u_{j}}\frac{\partial u_{j}}{\partial\epsilon_{\text{kl}}}\]</div>
</div></blockquote>
<p>内部ひずみパラメータは力定数<span class="math notranslate nohighlight">\(\Phi_{m\alpha,j} = \frac{\partial F_{\text{mα}}}{\partial u_{j}}\)</span>とひずみ-力結合定数<span class="math notranslate nohighlight">\(C_{m\alpha,kl} = \frac{\partial F_{\text{mα}}}{\partial\epsilon_{\text{kl}}}\)</span>を用いて表せる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor119">
<span class="eqno">(10.118)<a class="headerlink" href="#equation-eq-uvsor119" title="この数式へのパーマリンク"></a></span>\[\frac{\partial u_j}{\partial \epsilon_{kl}} = \sum_{m\alpha} \frac{\partial u_j}{\partial F_{m\alpha}} \frac{\partial F_{m\alpha}}{\partial \epsilon{kl}}\]</div>
</div></blockquote>
<p>力定数は振動数と固有ベクトルを用いて表現できるので、<a class="reference internal" href="#equation-eq-uvsor118">(10.117)</a> 式の右辺第二項は次のように表すことができる。</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor120">
<span class="eqno">(10.119)<a class="headerlink" href="#equation-eq-uvsor120" title="この数式へのパーマリンク"></a></span>\[\frac{e}{V}\sum_{\lambda}^{}\frac{{\widetilde{Z}}_{\text{λi}}{\widetilde{C}}_{\lambda,kl}}{\omega_{\lambda}^{2}}\]</div>
</div></blockquote>
<p>ここで、振動モードのひずみ-力結合定数を</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-uvsor121">
<span class="eqno">(10.120)<a class="headerlink" href="#equation-eq-uvsor121" title="この数式へのパーマリンク"></a></span>\[\tilde{C}_{\lambda, kl} = \frac{1}{\sqrt{m_i}} \sum_{i\beta} C_{i\beta,kl} \xi_{\lambda i \beta}\]</div>
</div></blockquote>
<p>と定義した。</p>
</section>
</section>
<section id="uvsor-epsilon">
<h2><span class="section-number">10.3. </span>UVSOR-Epsilon<a class="headerlink" href="#uvsor-epsilon" title="この見出しへのパーマリンク"></a></h2>
<section id="id34">
<h3><span class="section-number">10.3.1. </span>ファイルの設定<a class="headerlink" href="#id34" title="この見出しへのパーマリンク"></a></h3>
<p>Epsilonは、PHASE/EKCALと同様に、ファイル設定をfile_names.dataで行う。以下にEpsilonのfile_names.dataの例を示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_INP</span>    <span class="o">=</span> <span class="s1">&#39;./nfinput.data&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../PP/atom_14_Si_lda_nc_bhs.gncpp2&#39;</span>
<span class="n">F_ENERG</span>  <span class="o">=</span> <span class="s1">&#39;./nfenerg.data&#39;</span>
<span class="n">F_ZAJ</span>    <span class="o">=</span> <span class="s1">&#39;./zaj.data&#39;</span>
<span class="n">F_CHGT</span>   <span class="o">=</span> <span class="s1">&#39;../scf/nfchgt.data&#39;</span>
<span class="n">F_CNTN</span>   <span class="o">=</span> <span class="s1">&#39;./continue.data&#39;</span>
<span class="n">F_EPSOUT</span>    <span class="o">=</span> <span class="s1">&#39;./eps.data1&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>file_names.dataの設定法はPHASE/EKCALの場合と同じであるが、以下の点に注意する。</p>
<ol class="arabic simple">
<li><p>入力ファイルをF_INPに指定する。Epsilonの入力ファイルはEKCALの入力ファイルに誘電率計算用のepsilonタグを追加したものである。</p></li>
<li><p>PHASE計算により得られた電子密度ファイルをF_CHGTに指定する。</p></li>
<li><p>誘電関数の計算結果を出力するファイルをF_EPSOUTに指定する。</p></li>
</ol>
</section>
<section id="id35">
<h3><span class="section-number">10.3.2. </span>入力データの設定<a class="headerlink" href="#id35" title="この見出しへのパーマリンク"></a></h3>
<p>入力ファイル（F_INP）ファイルの設定は、EKCALの入力設定にEpsilon用の設定を追加して行う。Epsilonの入力設定項目について説明する。</p>
<p><strong>Controlブロック</strong></p>
<p>controlブロックにおいて、condition =
2あるいはcondition=fixed_chargeとする。局所ポテンシャルが軌道ポテンシャルであるTM型擬ポテンシャルを用いる場合、use_additional_projector
= onとする必要がある。Controlブロックの設定例を以下に示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Control{
    condition=fixed_charge
    cpumax = 1 day              ! {sec|min|hour|day}
    max_iteration = 60000
    use_additional_projector=on ! {on|off}
}
</pre></div>
</div>
<p>この例ではuse_additional_projector=onとしている。ポテンシャルの種類が不明なときにはuse_additional_projectorをonにする。</p>
<p><strong>accuracyブロック</strong></p>
<p>accuracyブロックで設定が必要な項目は、num_bands（バンド数）、ksampling（k点セットの指定）及びek_convergence（バンド計算の収束条件）である。これらの項目の詳細は2章などに記述がある。</p>
<p>一般論としては、バンド数をできるだけ多く、k点数をできるだけ多くすることが望ましいが、現実的には、１電子あたりの振動子強度の総和 が0.7を越えるように、バンド数及びｋ点セットを設定すればよい。振動子強度の総和については、後述する。</p>
<p>ek_convergenceでは、delta_eigenvalue及びsuccessionの設定を行う。delta_eigenvalue及びsuccessionの推奨値は以下の通り。</p>
<table class="docutils align-default" id="id71">
<caption><span class="caption-number">表 10.1 </span><span class="caption-text">ek_convergence設定の推奨値</span><a class="headerlink" href="#id71" title="このテーブルへのパーマリンク"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>材料系</p></th>
<th class="head"><p>delta_eigenvalue(Rydberg)</p></th>
<th class="head"><p>succession</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>絶縁体</p></td>
<td><p>1.e-4</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>半導体・金属</p></td>
<td><p>1.e-6</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<p><strong>epsilonブロック</strong></p>
<p>epsilonブロックにおいて、誘電関数の計算方法を指定する。以下にepsilonタグの例及びその設定方法を示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>epsilon {
   sw_epsilon = on ! {on|off}
   crystal_type = single ! {single|poly}
   fermi_energy{
     read_efermi = off ! {on|off}
     efermi = 0.000
   }
   photon{
     polar {ux=1.00, uy=0.00, uz=0.00}
     Poynting {px=0.00, py=0.00, pz=0.00}
     energy {low=0.000, high=2.000, step=0.002}
   }
   transition_moment{
     type = ks ! {l|rn|ks|mks}
     delq =0.001
     symmetry =on ! {on|off}
     band_i=1
     band_f=5
   }
   mass {
     sw_mass = on ! {on|off}
     direction{nx = 0.0, ny = 0.0, nz = 0.0}
     point = band_edge ! {band_edge|input}
     shift = 1.0d-4
     ik = 1
     ib = 5
   }
   BZ_integration {
     method = t !  {parabolic(p)|gaussian(g)|tetrahedron(t)}
     spin = both ! {both|major|minor}
   }
   band_gap_correction{
     scissor_operator=0.00d0
   }
   drude_term{
     drude= off ! {on|off|drude_only}
     effective_mass = 1.0d0
     damping_factor =
     conductivity =
     plasma_frequency =
   }
   nonlinear_optics {
     process = off ! {off|shg|thg}
     excitation = all
     band = all
     term = all
     double_resonance{
       method = damping
       cut_off = 10.0d-3 hartree
     }
   }
   ipriepsilon=1
}
</pre></div>
</div>
<p><strong>sw_epsilon</strong></p>
<div class="line-block">
<div class="line">機能：誘電関数の計算スイッチである。</div>
<div class="line">オプション = on ：計算を行う</div>
<div class="line">　　　　　 = off：計算を行わない</div>
<div class="line">効果offとした場合、EKCALとして機能する（バンド構造の計算のみ行う）。</div>
</div>
<p><strong>crystal_type</strong></p>
<div class="line-block">
<div class="line">機能：結晶タイプの指定</div>
<div class="line">　オプション　= single： 単結晶</div>
<div class="line">　　　　　　  = poly ： 多結晶</div>
<div class="line">polyを指定した場合、誘電率の異方性は平均化されているとみなし、単結晶の平均誘電率
<span class="math notranslate nohighlight">\(\epsilon = (\epsilon_{\text{xx}} + \epsilon_{\text{yy}} + \epsilon_{\text{zz}})/3\)</span>を計算する。</div>
</div>
<p><strong>fermi_energy</strong></p>
<div class="line-block">
<div class="line">機能：フェルミレベルを指定する</div>
<div class="line">　パラメータ　read_fermi</div>
<div class="line">　　　　　　　オプション  = on ：フェルミレベルを指定する</div>
<div class="line">　　　　　　　　　　　　  = off：フェルミレベルを指定しない（計算する）</div>
<div class="line">　　　　　　　efermi =   　　　：フェルミレベルの値を指定する（read_fermi = on 時）</div>
<div class="line">　　　　　　　　　　　　　　     (Hartree単位で指定)</div>
<div class="line-block">
<div class="line">e.g.  efermi = 0.124 （0.124 Hatree）</div>
</div>
<div class="line">　効果：read_fermi = onとすることにより、計算時間を短縮できる</div>
<div class="line">　注意：半導体および絶縁体の場合にのみ有効。</div>
</div>
<p><strong>photon</strong></p>
<div class="line-block">
<div class="line">機能：電磁波状態（偏光状態およびエネルギーレンジ）の指定</div>
<div class="line">　      polar：直線偏光の分極ベクトルを指定する。</div>
<div class="line">　　　　パラメータ　ux =：偏光ベクトルのx成分（任意単位）</div>
<div class="line">　　　　　　　　　　uy =：偏光ベクトルのy成分（任意単位）</div>
<div class="line">　　　　　　　　　　uz =：偏光ベクトルのz成分（任意単位）</div>
<div class="line">　　　            　e.g. polar{ux = 1.0, uy = 0.0, uz = 0.0}は、x軸方向に直線偏光した電</div>
<div class="line-block">
<div class="line">磁波を指定する。</div>
</div>
<div class="line">　　　　Poynting: 非偏光のポインティングベクトルを指定する。</div>
<div class="line">　　　　パラメータ　px =：ポインティングベクトルのx成分（任意単位）</div>
<div class="line">　　　　　　　　　　py =：ポインティングベクトルのy成分（任意単位）</div>
<div class="line">　　　　　　　　　　pz =：ポインティングベクトルのz成分（任意単位）</div>
<div class="line-block">
<div class="line">　　             e.g. Poynting {px = 1.0, py = 0.0, pz = 0.0}は、x軸方向に進行する</div>
<div class="line-block">
<div class="line">非偏光電磁波を指定する。</div>
</div>
</div>
<div class="line">　energy: 電磁波のエネルギーを指定する。</div>
<div class="line-block">
<div class="line">パラメータ  high ：エネルギー上限値   (Hartree単位、デフォルト値 2.0)）</div>
<div class="line">　　　　　  step ：エネルギーステップ (Hartree単位、デフォルト値　0.002)</div>
</div>
<div class="line">　効果：指定された電磁波に対する誘電関数および光学スペクトル（屈折率、吸収係数、</div>
<div class="line-block">
<div class="line-block">
<div class="line">反射率）が計算される。</div>
</div>
<div class="line">注意：i) 分極ベクトルのいずれかの成分が零でない場合、直線偏光が指定される。</div>
<div class="line">　　 ii) ポインティングベクトルのいずれかの成分が零でない場合、非偏光が指定される</div>
<div class="line">　　iii) 分極ベクトルとポインティングベクトルを同時に指定することはできない。</div>
<div class="line">　　 iv) 分極ベクトルおよびポインティングベクトルの全ての成分が零である場合、</div>
<div class="line">　　     誘電テンソル成分（ xx,  yy,  zz,  xy,  xz,  yz）が出力される。光学スペクトルは出</div>
<div class="line-block">
<div class="line">力されない。</div>
</div>
</div>
</div>
<p><strong>transition_moment</strong></p>
<div class="line-block">
<div class="line">機能：遷移モーメント計算オプションの指定</div>
<div class="line">　パラメータ type : 遷移モーメント補正方法の指定</div>
<div class="line">　　　　　　 オプション=   l  ：local型遷移モーメント（補正なし）（デフォルト）</div>
<div class="line">　　　　　　　　　　   =  rn ：Read and Needs型遷移モーメント補正 <a class="reference internal" href="#starace72" id="id36"><span>[Starace72]</span></a> , <a class="reference internal" href="#read91" id="id37"><span>[Read91]</span></a></div>
<div class="line">　　　　　　　　　　　　　　（ノルム保存型擬ポテンシャル対応）</div>
<div class="line">　　　　　　　　　　　 =  ks ：Kageshima-Shiraishi(KS)型遷移モーメント補正 <a class="reference internal" href="#kageshima97" id="id38"><span>[Kageshima97]</span></a></div>
<div class="line">　　　　　　　　　　　　　　（ノルム保存及びウルトラソフト擬ポテンシャル対応）</div>
<div class="line">　　　　　 　delq  =   ：Read and Needs(RN)型遷移モーメント補正のパラメータ <a class="reference internal" href="#read91" id="id39"><span>[Read91]</span></a></div>
<div class="line">　　　　　　　　　　　　　　（デフォルト値0.001）</div>
<div class="line">　　　　　　 symmetry ：遷移モーメントの対称化オプションの指定</div>
<div class="line">　　　　　　 オプション = on ：対称化を行う</div>
<div class="line">　　　　　　　　　　　　= off ：対称化を行わない</div>
<div class="line">　　　　　　 band_i  =  ：価電子バンドの指定</div>
<div class="line">　　　　　　 band_f  =  ：伝導バンドの指定</div>
<div class="line">　効果：a)遷移モーメントの補正方法を適切に指定することにより、全電子計算と同じ誘</div>
<div class="line-block">
<div class="line">電関数を得ることができる。</div>
</div>
<div class="line">　　　　b) band_i = a及びband_f = bとした場合、 a -&gt; bのバンド遷移に起因する誘電</div>
<div class="line-block">
<div class="line">関数が計算され、誘電関数のバンド分割を行うことができる。</div>
</div>
<div class="line">　注意　i) KS型遷移モーメント補正を行う場合、KS補正因子を含む擬ポテンシャルファ</div>
<div class="line-block">
<div class="line-block">
<div class="line">イル（gncpp2形式）を用いる必要がある。補正因子を含むファイルは、CIAO</div>
<div class="line">のダイポールオプション（sw_with_dipole）を用いて作成できる。詳細は、CIAO</div>
<div class="line">のマニュアル参照のこと。</div>
</div>
<div class="line">　　　ii) 局所ポテンシャルが軌道ポテンシャルであるTM型擬ポテンシャルを用いて</div>
<div class="line-block">
<div class="line">KS型遷移モーメント補正を行う場合、additional_projectorを使用をする必要</div>
<div class="line">がある。</div>
</div>
</div>
<div class="line">　　　iii) RN型補正は、ノルム保存型擬ポテンシャルに対してのみ有効である。補正項</div>
<div class="line">　　　     はPickard and Payneの方法 <a class="reference internal" href="#pickard00" id="id40"><span>[Pickard00]</span></a> により計算している。delq値は補正項計算に</div>
<div class="line">　　　     必要な差分パラメータである。</div>
<div class="line">　　　 iv) 結晶対称性を考慮した計算では、symmetry=onとすることがのぞましい。</div>
<div class="line">　　　　v) 誘電関数のバンド分割を行わない場合、band_i及びband_fは省略する。</div>
</div>
<p><strong>mass</strong></p>
<div class="line-block">
<div class="line">機能：電子あるいは正孔有効質量の計算</div>
<div class="line">　パラメータ　sw_mass：計算スイッチ</div>
<div class="line">　　　　　　　オプション = on：計算を行う</div>
<div class="line">　　　　　　　　　　　　 = off： 計算を行わない</div>
<div class="line">　　　　　　　direction：有効質量の方位を指定する</div>
<div class="line">　　　　　　　パラメータ　nx、ny、nz：方位（デフォルト値　0.0）</div>
<div class="line">　　　　　　　point：有効質量を計算するバンド、ｋ点の指定</div>
<div class="line">　　　　　　　オプション = band_edge ：価電子及び伝導電子端で計算を行う</div>
<div class="line">　　　　　　　　　　　　 = input：直接指定する</div>
<div class="line">　　　　　　　shift：正孔質量計算時の 点シフト量（デフォルト値0.0）</div>
<div class="line">　　　　　　　ik：k点インデックス（direction=input指定時）</div>
<div class="line">　　　　　　　ib：バンドインデックス（direction=input指定時）</div>
<div class="line">　効果：電子あるいは正孔の有効質量が計算される。</div>
<div class="line">　注意：i) 電子と正孔は別々のジョブで計算する。</div>
<div class="line">　　　 ii) 電子質量計算時には、direction{nx=0.0, ny=0.0, nz=0.0}とする。</div>
<div class="line">　　  iii) 正孔質量計算時には、directionで方位を指定する。</div>
<div class="line">　　　　　例）(100)方向の正孔質量を計算する場合、direction{nx=1.0, ny=0.0, nz=0.0}とする。</div>
<div class="line">　　　 iv) 正孔質量計算時には、shifit=/0.0d0とする。推奨値は10.0d-3～10.0d-4。</div>
<div class="line-block">
<div class="line">v) point=input指定時には、ik及びibの指定が必要。</div>
</div>
<div class="line">　　　 vi) read_fermi=offが自動設定される(4.2.6参照)。</div>
<div class="line">　　　vii) shift /= 0.0d0とした場合、誘電関数および非線形光学感受率に計算誤差が生じる。</div>
</div>
<p><strong>BZ_integration</strong></p>
<div class="line-block">
<div class="line">機能：遷移モーメント積をブリルアンゾーン内部で積分する方法を指定する。</div>
<div class="line">パラメータ method ：積分方法の指定</div>
<div class="line">　　　　　オプション  ＝tetrahedron（省略形t）：リニアテトラへドロン法 <a class="reference internal" href="#lehmann72" id="id41"><span>[Lehmann72]</span></a> を用いる</div>
<div class="line">　　　　　　　　　　　＝parabolic（省略形p） ：parabolic smearing法を用いる</div>
<div class="line">　　　　　　　　　　　　　　　　　　　　　　  （デフォルト）</div>
<div class="line">　　　　　　　　　　　＝gaussian（省略形g） ：gaussian smearing法を用いる。</div>
<div class="line">　　　　　width　　 ：gaussian/parabolic smearing法におけるsmearing幅の指定</div>
<div class="line">　　　　　　　　　　（Hartree 単位；デフォルト値＝0.01837451 Hartree(=0.50 eV)）</div>
<div class="line-block">
<div class="line">spin      ：電子スピンの指定（magnetic_state=ferro/afの場合のみ有効</div>
<div class="line">オプション  ＝both ：major及びminor スピン状態の電子遷移について</div>
</div>
<div class="line">　　　　　　　　　　　　　　　  積分する（デフォルト）</div>
<div class="line">　　　　　　　　　　　＝major：majorスピン状態の電子遷移について積分する</div>
<div class="line">　　　　　　　　　　　＝minor：minorスピン状態の電子遷移について積分する</div>
<div class="line">　効果：積分方法を指定して誘電関数を計算できる。spinオプションを指定した場合、</div>
<div class="line">　　　　誘電関数のスピン分割が可能。</div>
<div class="line">　注意：i) リニアテトラへドロン法はk点がメッシュ法により指定された場合にのみ有効。</div>
<div class="line">　　　 ii) 金属の計算を行う場合、リニアテトラへドロン法の使用が望ましい。</div>
<div class="line-block">
<div class="line">iii) width パラメータを指定しない場合、デフォルト値(0.01837451Hartre)が適用</div>
<div class="line-block">
<div class="line">される。</div>
</div>
</div>
</div>
<p><strong>band_gap_correction</strong></p>
<div class="line-block">
<div class="line">機能：scissors operator法によりバンドギャップの補正を行う</div>
<div class="line">　パラメータ：scissors_operator = ：scissors operatorの値を指定する（Hartree単位）</div>
<div class="line">　　　　　　　　　　　　　　　　　（デフォルト値＝0.0 Hartree）</div>
<div class="line">　作用：DFT法の欠点であるバンドギャップの過小評価を補正できる。</div>
<div class="line">　注意：半導体あるいは絶縁体の場合にのみ有効</div>
</div>
<p><strong>drude_term</strong></p>
<div class="line-block">
<div class="line">機能：ドルーデ項計算のパラメータを指定する</div>
<div class="line">　パラメータ：drude：ドルーデ項計算方法の指定</div>
<div class="line">　　　　　　　オプション　=  on：ドルーデ項+バンド間遷移に起因する誘電関数を計</div>
<div class="line-block">
<div class="line">算する。</div>
</div>
<div class="line">　　　　　　　　　　　　　=  off：バンド間遷移にのみ起因する誘電関数を計算する。</div>
<div class="line">　　　　　　　　　　　　　        （デフォルト）</div>
<div class="line">　　　　　　　　　　　　　= drude_only：ドルーデ項にのみ起因する誘電関数を計算</div>
<div class="line">　　　　　　　　　　　　　　 する。</div>
<div class="line">　　　　　　　effective＿mass   = ：有効質量の指定（電子質量単位）</div>
<div class="line">　　　　　　　damping_factor    = ：ドルーデdamping factorの指定（Hartree単位）</div>
<div class="line">　　　　　　　　　　　　　　　　　　（デフォルト値＝0.0036749 Hartree (=0.1eV)）</div>
<div class="line">　　　　　　　conductivity      = ：電気伝導度の指定（m/Ω）</div>
<div class="line">　　　　　　　plasma_frequency　= ：プラズマ振動数の指定（Hartree単位）</div>
<div class="line">効果：金属のドルーデ項を考慮した誘電関数計算を行う</div>
<div class="line">注意：i) 金属の場合にのみ有効である</div>
<div class="line">　　 ii) damping_factor、conductivity、及びplasma_frequencyはいずれかひとつを</div>
<div class="line">　　　　 指定できる。</div>
<div class="line-block">
<div class="line">　 iii) damping_factorパラメータを指定しない場合、デフォルト値(0.0036749</div>
<div class="line-block">
<div class="line">Hartree)が適用される。</div>
</div>
</div>
</div>
<p><strong>nonlinear_optics</strong></p>
<div class="line-block">
<div class="line">機能：非線形光学感受率の計算</div>
<div class="line">　パラメータ　process：非線形光学過程の指定</div>
<div class="line">　　　　　　　オプション = off： 感受率の計算を行わない(デフォルト)</div>
<div class="line">　　　　　　　　　　　　 = shg：第2高調波発生の感受率計算を行う</div>
<div class="line">　　　　　　　　　　　　 = thg：第3高調波発生の感受率計算を行う</div>
<div class="line">　　　　　　　excitation：仮想励起プロセスの指定</div>
<div class="line-block">
<div class="line">オプション = all：全ての励起プロセスの感受率を計算する(デフォルト)</div>
</div>
<div class="line">　　　　　　　　　　　　 = electron：電子励起プロセスの感受率を計算する</div>
<div class="line">　　　　　　　　　　　　 = hole：正孔励起プロセスの感受率を計算する</div>
<div class="line">　　　　　　　　　　　　 =three_state：3順位励起プロセスの感受率を計算する</div>
<div class="line">　　　　　　　band：バンド遷移の指定</div>
<div class="line">　　　　　　　オプション = all：全バンド遷移の感受率を計算する(デフォルト)</div>
<div class="line">　　　　　　　　　　　　 = inter：バンド間遷移の感受率を計算する</div>
<div class="line">　　　　　　　　　　　　 = intra：バンド内遷移の感受率を計算する</div>
<div class="line">　　　　　　　term：共鳴項の指定</div>
<div class="line">　　　　　　　オプション = all：全共鳴項を考慮(デフォルト)</div>
<div class="line">　　　　　　　　　　　　 = omega：基本波に対する共鳴項を考慮する</div>
<div class="line">　　　　　　　　　　　　 = 2omega：第2高調波に対する共鳴項を考慮する</div>
<div class="line">　　　　　　　　　　　　 = 3omega：第3高調波に対する共鳴項を考慮する</div>
<div class="line">　　　　　　　double_resonance：2重共鳴の扱いに関する指定</div>
<div class="line">　　　　　　　パラメータ　method：2重共鳴項の取り扱い方法を指定する</div>
<div class="line">　　　　　　　　　　　　　オプション = omit：共鳴項を無視する(デフォルト)</div>
<div class="line-block">
<div class="line">= damping：共鳴項をダンピングする</div>
</div>
<div class="line">　　　　　　　　　　　　　cut_off：2重共鳴判定カットオフ(method = omit指定時)</div>
<div class="line">　　　　　　　　　　　　　　　　　ダンピングファクター(method = damping指定時)</div>
<div class="line">　　　　　　　　　　　　　　　　　デフォルト値：10.0d-3 hatree</div>
<div class="line">　効果：非線形光学感受率が計算される。</div>
<div class="line">　注意：i)　ブリルアン・ゾーン積分法は、Bz_integration (2.10参照)で指定する。THG</div>
<div class="line">　　　　　計算では、linear tetrahedron法は使用できない。</div>
<div class="line-block">
<div class="line-block">
<div class="line">ii) read_efermi = offが自動設定される（4.2.6参照）</div>
</div>
<div class="line">iii) 感受率の定量的な計算には、scissors operatorの指定(7.2.11)が必要</div>
<div class="line-block">
<div class="line">iv) 仮想励起及びバンド内遷移の意味は、文献21を参照</div>
</div>
</div>
</div>
<p><strong>ipriepsilon</strong></p>
<div class="line-block">
<div class="line">機能：プリントオプションの指定</div>
<div class="line">　　　　オプション　＝0：簡略レベル</div>
<div class="line">　　　　　　　　　　＝1：標準レベル（デフォルト）</div>
<div class="line">　　　　　　　　　　＝2：詳細レベル</div>
<div class="line">　　　　　　　　　　＝3：デバックレベル</div>
<div class="line">　効果：出力レベルを制御する。</div>
<div class="line">　注意：デバックレベルは出力データ量が非常に大きくなるので注意。</div>
</div>
</section>
<section id="id42">
<h3><span class="section-number">10.3.3. </span>計算の実行<a class="headerlink" href="#id42" title="この見出しへのパーマリンク"></a></h3>
<p><strong>電荷密度の計算</strong></p>
<p>Epsilon計算はEKCALと同様固定電荷の計算を行うので、電子密度ファイルが必要である。電子密度ファイルは、PHASEによる電子密度の計算を行うと出力されるので、まずはPHASEによる通常の計算を実行する。</p>
<p>Epsilon計算を行うためには、電子密度ファイルを指定する必要である。この指定は、file_names.dataにおいてF_CHGT識別子を利用して行う。たとえば、電子密度ファイルが一階層上のディレクトリーにおいて行われていた場合file_names.dataは次のように記述すればよい。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_POT(1) = …
F_CHGT = ‘../nfchgt.data’
/
</pre></div>
</div>
<p><strong>誘電関数の計算</strong></p>
<p>以下のコマンドを実行することにより、Epsilonが実行される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span>  <span class="o">-</span><span class="n">np</span>  <span class="mi">1</span>  <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">epsmain</span> <span class="o">&gt;&amp;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>並列計算を行う場合には、以下のコマンドを実行する。プロセッサーの数をnprocで指定する。並列計算を行うにはあらかじめMPIをインストールしておくことが必要である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span>  <span class="n">nproc</span>  <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">epsmain</span> <span class="o">&gt;&amp;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p><strong>有効質量の計算</strong></p>
<p>Epsilon計算を行うディレクトリに電子密度ファイルをコピーし、同ディレクトリ中にあるfile_names.dataにおいてF_CNGTに指定する。入力ファイルnfinput.dataにおけるepsilonタグにおいて、有効質量計算に必要な入力を行う。</p>
<p>入力例１：価電子帯端での電子有効質量テンソルの計算</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mass{
     sw_mass = on     ! {on|off}
     direction {nx = 0.0, ny = 0.0, nz = 0.0}
     point = band_edge ! {band_edge|input}
     shift = 1.0d-4
}
</pre></div>
</div>
<p>入力例２：伝導帯端での正孔有効質量([100]方向)の計算</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mass{
     sw_mass = on     ! {on|off}
     direction {nx = 1.0, ny = 0.0, nz = 0.0}
     point = band_edge ! {band_edge|input}
     shift = 1.0d-4
}
</pre></div>
</div>
<p>以下のコマンドを実行することにより、Epsilonが実行される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">1</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">epsmain</span> <span class="o">&gt;&amp;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p><strong>非線形光学感受率の計算</strong></p>
<p>Epsilon計算を行うディレクトリに電子密度ファイルをコピーし、同ディレクトリ中にあるfile_names.dataにおいてF_CNGTに指定する。入力ファイルnfinput.dataにおけるnonlinear_opticsにおいて、必要な入力を行う。</p>
<p>以下のコマンドを実行することにより、Epsilonが実行される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">1</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">epsmain</span> <span class="o">&gt;&amp;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
</section>
<section id="id43">
<h3><span class="section-number">10.3.4. </span>計算結果の解析<a class="headerlink" href="#id43" title="この見出しへのパーマリンク"></a></h3>
<p>計算結果の解析は、(1)遷移モーメントの計算状況、(2)電子状態、(3)振動子強度の総和則を確認して行う。これらの項目の確認は、誘電関数の計算結果が妥当であるかどうか確認する上で重要である。</p>
<p><strong>遷移モーメントの計算状況</strong></p>
<p>標準出力がoutput000である場合、以下のコマンドを実行することにより、遷移モーメントの計算状況を確認できる。全てのk点において遷移モーメントが計算されているかどうか確認することが必要である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% grep  transition output000

!* transition moment correction = Kageshima and Shiraishi method (1)
!* transition moment square matrix is symmetrized (2)
! PP transition moment correction data : it =   1  number of data read from PP file =  18
!* ----- transition moment of    1 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    2 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    3 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    4 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    5 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    6 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    7 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    8 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of    9 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   10 -th k-point is calculated by UVSOR-Epsilon  ----- (3)
!* ----- transition moment of   11 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   12 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   13 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   14 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   15 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   16 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   17 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   18 -th k-point is calculated by UVSOR-Epsilon  -----
!* ----- transition moment of   19 -th k-point is calculated by UVSOR-Epsilon  -----
!* transition moment of all k-points is calculated (4)
!* ----- weighted transiti
on moment square of each k-point in irreducible Brillouin zone -----
 integration of all possible band transitions (5)
!* tetrahe
dron integration of transition moment square over Brillouin zone (6)
</pre></div>
</div>
<div class="line-block">
<div class="line">各項目の意味は以下の通りである。</div>
<div class="line">(1) Kageshima-Shiraishi(KS)型遷移モーメント補正を用いている</div>
<div class="line">(2) 遷移モーメントは結晶の対称性を反映している（transition_moment/symmetry = onである）</div>
<div class="line">(3) 各ｋ点での電子遷移モーメント計算状況</div>
<div class="line">(4) 全てのk点が収束している</div>
<div class="line">(5) 可能なすべての電子遷移を積分して誘電関数を計算する</div>
<div class="line">(6) 積分はリニアテトラへドロン法を用いている</div>
</div>
<p><strong>電子状態</strong></p>
<p>各k点での遷移モーメントが計算された後、電子状態に関する状況が出力される</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">band</span> <span class="nb">type</span> <span class="ow">and</span> <span class="n">occupation</span> <span class="o">----------</span>
<span class="n">ispin</span>    <span class="n">band</span>      <span class="nb">type</span>       <span class="n">occupation</span>
   <span class="mi">1</span>       <span class="mi">1</span>        <span class="n">filled</span>      <span class="mf">1.00000</span>
   <span class="mi">1</span>       <span class="mi">2</span>        <span class="n">filled</span>      <span class="mf">1.00000</span>
   <span class="mi">1</span>       <span class="mi">3</span>        <span class="n">filled</span>      <span class="mf">1.00000</span>
   <span class="mi">1</span>       <span class="mi">4</span>        <span class="n">filled</span>      <span class="mf">1.00000</span>
   <span class="mi">1</span>       <span class="mi">5</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>       <span class="mi">6</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>       <span class="mi">7</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>       <span class="mi">8</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>       <span class="mi">9</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>　　　　<span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="mi">1</span>      <span class="mi">10</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">11</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">12</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">13</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">14</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">15</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">16</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">17</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
   <span class="mi">1</span>      <span class="mi">18</span>      <span class="n">unfilled</span>      <span class="mf">0.00000</span>
<span class="o">----------</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">band</span> <span class="n">numbers</span> <span class="k">for</span> <span class="n">each</span> <span class="n">spin</span> <span class="o">----------</span>
                  <span class="n">filled</span>    <span class="n">half</span><span class="o">-</span><span class="n">filled</span>  <span class="n">unfilled</span>  <span class="n">number</span> <span class="n">of</span> <span class="n">electrons</span>
<span class="n">ispin</span> <span class="o">=</span>  <span class="mi">1</span>           <span class="mi">4</span>           <span class="mi">0</span>          <span class="mi">14</span>          <span class="mf">4.00000</span>　<span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">electron</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">system</span> <span class="o">=</span>    <span class="mf">4.00000</span>
<span class="n">The</span> <span class="n">system</span> <span class="ow">is</span> <span class="n">insulating</span> <span class="ow">or</span> <span class="n">semiconducting</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">(7)各バンドのタイプ(filled：被占バンド；half-filled：金属バンド；unfilled：空バンド)及び電子占有数</div>
<div class="line">(8)各タイプのバンド数及び全電子数</div>
<div class="line">(9)対象系は、絶縁体あるいは半導体</div>
</div>
<p id="uvsor-oscilator-strength-section">** 振動子強度の総和則 ** <a class="reference internal" href="#id70" id="id44"><span>[物理学辞典]</span></a></p>
<p>Thomas-Reiche-Kuhn’s sum
ruleは、任意の体系において、全ての可能な励起に付随する振動子強度を足し合わせると、その値は１電子あたり１となることを主張する。実際のバンド計算では、有限のバンド数を用いて計算を行っているので、このsum
ruleが厳密に満たされることはない。しかし、sum
ruleは計算がどの程度現実の状況を反映しているかを表す指標となる。Epsilonは振動子強度の総和を計算する機能を有し、その値を出力する。</p>
<p>標準出力ファイルがoutput000である場合、以下のコマンドを実行すると、振動子強度の総和値が画面に出力される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% grep   oscillator output000

!* sum of weighted oscillator strength of k-points in irreducible Brillouin zone =    0.91165
!* oscillator strength per electron =    0.91165
</pre></div>
</div>
<p>これはSi（num_bands=18;
k点セット＝メッシュ法（4x4x4））の場合の計算値である。振動子強度の総和の値は約0.9であり、sum-ruleが比較的良く満たされていることがわかる。
num-bandsの値を増やすことにより振動子強度の総和は１に近づくが、経験的には、総和が0.7を越えていれば誘電関数は、ほぼ収束している場合が多い。</p>
<p><strong>誘電関数の計算結果</strong></p>
<p>計算により得られた計算結果は、file_names.dataにおいてEPS_OUTPUTに指定したファイルに出力される。以下の結果は、バルクSi誘電関数の計算例である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>             <span class="n">Dielectric</span> <span class="n">Function</span>                                    <span class="n">Optical</span> <span class="n">Properties</span>
       <span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="p">(</span><span class="mi">2</span><span class="p">)</span>           <span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="p">(</span><span class="mi">4</span><span class="p">)</span>            <span class="p">(</span><span class="mi">5</span><span class="p">)</span>            <span class="p">(</span><span class="mi">6</span><span class="p">)</span>            <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">Photon</span> <span class="n">Energy</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span>   <span class="n">Real</span> <span class="n">Part</span>   <span class="n">Imaginary</span> <span class="n">Part</span>   　    <span class="n">n</span>              <span class="n">k</span>      <span class="nb">abs</span><span class="p">(</span><span class="ow">in</span> <span class="mi">10</span><span class="o">**</span><span class="mi">8</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>      <span class="n">R</span>
     <span class="mf">0.00000</span>       <span class="mf">13.90891</span>       <span class="mf">0.00000</span>          <span class="mf">3.72946</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33307</span>
     <span class="mf">0.05442</span>       <span class="mf">13.91137</span>       <span class="mf">0.00000</span>          <span class="mf">3.72979</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33310</span>
     <span class="mf">0.10885</span>       <span class="mf">13.91876</span>       <span class="mf">0.00000</span>          <span class="mf">3.73079</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33320</span>
     <span class="mf">0.16327</span>       <span class="mf">13.93110</span>       <span class="mf">0.00000</span>          <span class="mf">3.73244</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33337</span>
     <span class="mf">0.21769</span>       <span class="mf">13.94843</span>       <span class="mf">0.00000</span>          <span class="mf">3.73476</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33361</span>
     <span class="mf">0.27211</span>       <span class="mf">13.97078</span>       <span class="mf">0.00000</span>          <span class="mf">3.73775</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33392</span>
                                                   <span class="p">(</span><span class="n">以下略</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">各カラムの意味は以下の通り。</div>
<div class="line">(1)電磁波のエネルギー (2)誘電関数(実部) (3)誘電関数(虚部)</div>
<div class="line">(4)屈折率(実部) (5)屈折率(虚部)　(6)吸収係数　(7)反射スペクトル</div>
</div>
<p>電磁波の分極ベクトル及びポインティングベクトルの成分を全て０として、誘電テンソルを出力した場合には、以下の出力が得られる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    　<span class="n">Dielectric</span> <span class="n">Tensor</span> <span class="n">Component</span><span class="p">(</span><span class="n">Imaginary</span> <span class="n">part</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">parenthesis</span><span class="p">)</span>
<span class="n">Photon</span> <span class="n">Energy</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span>     <span class="n">xx</span>             <span class="n">yy</span>             <span class="n">zz</span>             <span class="n">xy</span>             <span class="n">xz</span>             <span class="n">yz</span>
     <span class="mf">0.00000</span>        <span class="mf">13.90838</span>       <span class="mf">13.90838</span>       <span class="mf">13.90838</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>
                 <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>
     <span class="mf">0.05442</span>        <span class="mf">13.91084</span>       <span class="mf">13.91084</span>       <span class="mf">13.91084</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>
                 <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>
     <span class="mf">0.10885</span>        <span class="mf">13.91824</span>       <span class="mf">13.91824</span>       <span class="mf">13.91824</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>
                 <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>
     <span class="mf">0.16327</span>        <span class="mf">13.93058</span>        <span class="mf">13.93058</span>       <span class="mf">13.93058</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>
                 <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>
     <span class="mf">0.21769</span>        <span class="mf">13.94790</span>        <span class="mf">13.94790</span>       <span class="mf">13.94790</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>
                 <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>   <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>    <span class="p">(</span>   <span class="mf">0.00000</span><span class="p">)</span>
</pre></div>
</div>
<p>それぞれのカラムは、テンソル成分の誘電関数の実部及び虚部をあらわす。虚部は括弧内に示されている。</p>
<p><strong>有効質量の計算結果</strong></p>
<p>有効質量の計算結果は、標準出力ファイルに出力される。電子と正孔の有効質量は別々に計算することに注意する。</p>
<p>以下は、バルクSiの伝導帯端での電子有効質量テンソルを計算した例の出力である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>---------- effective mass calculation ----------
 !* effective mass at valence band top: ik =    1
 !* degeneracy =   3
 !* warning : effective mass should be wrong because of the degeneracy.
 !* set direction indices and  k-point shift parameter in tag_mass.
 !* ib =    2
 !* ispin =    1
  aa =   -0.10765    bb =   -0.36038    cc =   -0.88554
             a                  b                  c
          0.70986           -0.07279            0.70057
          0.53349           -0.59385           -0.60227
         -0.45987           -0.80128            0.38272
 !* ib =    3
 !* ispin =    1
  aa =   -0.09841    bb =   -0.47571    cc =   -1.07597　　　　　　　　　　(1)
             a                  b                  c
         -0.55182            0.63785            0.53725
          0.52096            0.76670           -0.37519
         -0.65123            0.07285           -0.75538
 !* ib =    4
 !* ispin =    1
  aa =   -0.10696    bb =   -0.29293    cc =   -2.32353
             a                  b                  c
          0.23175            0.97159           -0.04797
         -0.71433            0.13650           -0.68637
         -0.66032            0.19333            0.72567
 !* effective mass at conduction band bottom: ik =    4
 !* degeneracy =   1
 !* ib =    5
 !* ispin =    1
  aa =    0.93658    bb =    0.18362    cc =    0.18362
             a                  b                  c
   1.00000            0.00000            0.00000                 (2)
          0.00000            1.00000           -0.00235
          0.00000            0.00235            1.00000
</pre></div>
</div>
<ol class="arabic simple">
<li><p>価電子帯端（<span class="math notranslate nohighlight">\(\Gamma\)</span>点）での正孔有効質量テンソル。<span class="math notranslate nohighlight">\(\Gamma\)</span>点ではバンドが縮退しているため、計算値には問題がある（←の警告参照）</p></li>
<li><p>電子の有効質量テンソルの主値（aa, bb, cc）とそれらの主軸(a, b,
c)の方位。主軸方位はxyz座標表示</p></li>
</ol>
<p>以下は、正孔有効質量（(100)方向）計算を行った例の出力である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>---------- effective mass calculation ----------
 !* effective mass at valence band top: ik =    1
 !* degeneracy =   3
 !* ib =    2
 !* ispin =    1
  mass along (   1.00000   0.00000   0.00000) direction =   -0.17130
 !* ib =    3
 !* ispin =    1
  mass along (   1.00000   0.00000   0.00000) direction =   -0.27190　　(3)
 !* ib =    4
 !* ispin =    1
  mass along (   1.00000   0.00000   0.00000) direction =   -0.27190
 !* effective mass at conduction band bottom: ik =    4
 !* degeneracy =   1
 !* ib =    5
 !* ispin =    1
  mass along (   1.00000   0.00000   0.00000) direction =    0.93658    (4)
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>(100)方向の正孔有効質量</p></li>
<li><p>(100)方向の電子有効質量</p></li>
</ol>
<p><strong>SHG 非線形光学感受率の計算結果</strong></p>
<p>計算結果は、標準出力ファイル及びfile_names.dataにおいて、F_NLOに指定したファイルに出力される。標準出力には、静的な非線形感受率テンソル<span class="math notranslate nohighlight">\(\chi^{(2)}(0)\)</span>が出力される。出力形式は以下の通り。
以下は、Wurzite 型AlN の計算結果例である。この例では、scissors operator
を使用してバンドギャップが実測と同じになるように、ギャップを補正している。
また、ブリルアンゾーン積分にparabolic smearing法を用いている。このため、
誘電関数の結果は、バンドギャップを補正しなかった場合あるいはブリルアンゾーン
積分にlinear tetrahedron法を用いた場合の結果と異なる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Static</span> <span class="n">SHG</span> <span class="n">Susceptibility</span> <span class="n">Tensor</span> <span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mi">8</span> <span class="n">esu</span><span class="p">)</span>
 <span class="n">SHG</span> <span class="n">prrocess</span> <span class="o">=</span> <span class="nb">all</span> <span class="nb">type</span> <span class="n">excitation</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">SHG</span> <span class="n">term</span> <span class="o">=</span> <span class="nb">all</span> <span class="n">terms</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">xxx</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">xxy</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">xxz</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">0.04514</span>
 <span class="n">xyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">xyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">xzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">yxx</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">yxy</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">yxz</span> <span class="o">=</span>    <span class="mf">0.00000</span>    <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
 <span class="n">yyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">yyz</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">0.04514</span>  <span class="n">yzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">zxx</span> <span class="o">=</span>    <span class="mf">0.08732</span>  <span class="n">zxy</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">zxz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">zyy</span> <span class="o">=</span>    <span class="mf">0.08732</span>  <span class="n">zyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>  <span class="n">zzz</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">0.92412</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>全てのSHG過程（電子及び正孔励起）を考慮</p></li>
<li><p>全ての共鳴条件（基本波及び倍波に対する共鳴）を考慮</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^{(2)}(0)\)</span>テンソル（xxx等は<span class="math notranslate nohighlight">\(\chi_{\text{xxx}}^{(2)}\)</span>を意味する）</p></li>
</ol>
<p>F_NLOに指定したファイルには、波長依存の<span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>テンソル各成分の実部、虚部及び絶対値がカラム状に出力される。以下は以下は、Wurzite型AlNの計算結果例である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  SHG susceptibility Tensor (10d-8 esu)
xxx(1)  (2)             (3)             (4)             (5)
Photon Energy(eV)   real part   imaginary part       abs
     0.00000         0.00000        0.00000        0.00000
     0.05442         0.00000        0.00000        0.00000
     0.10885         0.00000        0.00000        0.00000
                         （中略）
zzz
Photon Energy(eV)   real part   imaginary part       abs
     0.00000        -0.92412        0.00000        0.92412
     0.05442        -0.92432        0.00000        0.92432
     0.10885        -0.92494        0.00000        0.92494
     0.16327        -0.92597        0.00000        0.92597
     0.21769        -0.92741        0.00000        0.92741
     0.27211        -0.92926        0.00000        0.92926
</pre></div>
</div>
<ol class="arabic simple">
<li><p>テンソルのインデックス</p></li>
<li><p>基本波のエネルギー</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>の実部</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^{(2)}( - 2\omega;\omega,\omega)\)</span>の虚部</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^{(2)}\)</span>の絶対値</p></li>
</ol>
<p><strong>THG 非線形光学感受率の計算結果</strong></p>
<p>計算結果は、SHG計算の場合同様、file_names.dataにおいてF_NLOに指定したファイルに出力される。出力形式は以下の通り。以下は、バルクSiのTHG感受率を計算結果例である。scissor
operatorを用いてバンドギャップの補正を行い、ブリルアン・ゾーン積分にparabolic
smearing法を用いている</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Static</span> <span class="n">THG</span> <span class="n">Susceptibility</span> <span class="n">Tensor</span> <span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mi">12</span> <span class="n">esu</span><span class="p">)</span>
 <span class="n">THG</span> <span class="n">prrocess</span> <span class="o">=</span> <span class="nb">all</span> <span class="nb">type</span> <span class="n">excitation</span>　<span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">excitation</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">intraband</span>  <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">THG</span> <span class="n">term</span> <span class="o">=</span> <span class="nb">all</span> <span class="n">terms</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
 <span class="n">xxxx</span> <span class="o">=</span>   <span class="mf">59.19956</span>   <span class="n">xxxy</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">xxxz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">xxyy</span> <span class="o">=</span>   <span class="mf">24.15228</span>   <span class="n">xxyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">xxzz</span> <span class="o">=</span>   <span class="mf">24.15228</span>
 <span class="n">xyyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">xyyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">xyzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">xzzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">yxxx</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">yxxy</span> <span class="o">=</span>   <span class="mf">24.15228</span>
 <span class="n">yxxz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">yxyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">yxyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>     <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
 <span class="n">yxzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">yyyy</span> <span class="o">=</span>   <span class="mf">59.19956</span>   <span class="n">yyyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">yyzz</span> <span class="o">=</span>   <span class="mf">24.15228</span>   <span class="n">yzzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">zxxx</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">zxxy</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">zxxz</span> <span class="o">=</span>   <span class="mf">24.15228</span>   <span class="n">zxyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">zxyz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">zxzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">zyyy</span> <span class="o">=</span>    <span class="mf">0.00000</span>
 <span class="n">zyyz</span> <span class="o">=</span>   <span class="mf">24.15228</span>   <span class="n">zyzz</span> <span class="o">=</span>    <span class="mf">0.00000</span>   <span class="n">zzzz</span> <span class="o">=</span>   <span class="mf">59.19956</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>すべての仮想励起過程（電子、正孔、3順位）を考慮</p></li>
<li><p>すべてのバンド遷移（バンド間＋バンド内遷移）を考慮</p></li>
<li><p>すべての共鳴条件（基本波及び倍波に対する共鳴）を考慮</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^{(3)}(0)のテンソル\)</span>（<span class="math notranslate nohighlight">\(\text{xxxx}\)</span>などは<span class="math notranslate nohighlight">\(\chi_{\text{xxxx}}^{(3)}\)</span>を意味する）</p></li>
</ol>
<p>F_NLOに指定したファイルには、波長依存の<span class="math notranslate nohighlight">\(\chi^{(3)}\left( - 3\omega;\omega,\omega,\omega \right)\)</span>テンソル各成分の実部、虚部及び絶対値がカラム状に出力される。以下は、Siの<span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>計算結果である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">THG</span> <span class="n">susceptibility</span> <span class="n">Tensor</span> <span class="p">(</span><span class="mi">10</span><span class="n">d</span><span class="o">-</span><span class="mi">12</span> <span class="n">esu</span><span class="p">)</span>
<span class="n">Xxxx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">)</span>              <span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="p">(</span><span class="mi">4</span><span class="p">)</span>             <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Photon</span> <span class="n">Energy</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span>   <span class="n">real</span> <span class="n">part</span>   <span class="n">imaginary</span> <span class="n">part</span>       <span class="nb">abs</span>
     <span class="mf">0.00000</span>        <span class="mf">59.19956</span>        <span class="mf">0.00000</span>       <span class="mf">59.19956</span>
     <span class="mf">0.05442</span>        <span class="mf">59.33822</span>        <span class="mf">0.00000</span>       <span class="mf">59.33822</span>
     <span class="mf">0.10885</span>        <span class="mf">59.75834</span>        <span class="mf">0.00000</span>       <span class="mf">59.75834</span>
     <span class="mf">0.16327</span>        <span class="mf">60.47272</span>        <span class="mf">0.00000</span>       <span class="mf">60.47272</span>
     <span class="mf">0.21769</span>        <span class="mf">61.50384</span>        <span class="mf">0.00000</span>       <span class="mf">61.50384</span>
</pre></div>
</div>
<p>(1) テンソルのインデックス (2) 基本波のエネルギー (3)
<span class="math notranslate nohighlight">\(\chi^{(3)}\left( - 3\omega;\omega,\omega,\omega \right)\)</span>実部
(4)
<span class="math notranslate nohighlight">\(\chi^{(3)}\left( - 3\omega;\omega,\omega,\omega \right)\)</span>虚部
(5) <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span>の絶対値</p>
</section>
<section id="si2">
<h3><span class="section-number">10.3.5. </span>計算例：Si2-電子誘電関数計算<a class="headerlink" href="#si2" title="この見出しへのパーマリンク"></a></h3>
<p><strong>電子密度の計算</strong></p>
<p>インストールが完了したら、テスト計算を兼ねて、シリコン結晶の誘電関数及び光学スペクトルを計算してみましょう。入力は <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/electron/Si</span></code> にあります。 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/electron/Si</span></code> の下位には、scf、
eps及びPPという名称のディレクトリがあります。scfはphaseによる電荷密度計算用のディレクトリ、epsはUVSOR-Epsilonによる誘電率計算用のディレクトリ、PPはSi原子の擬ポテンシャルファイルを格納するディレクトリです。</p>
<div class="line-block">
<div class="line">最初に、Si結晶の電子密度をPHASEで計算します。scfに移動してください。scfには以下のファイルが含まれています。</div>
<div class="line">　file_names.data</div>
<div class="line-block">
<div class="line">nfinput.data</div>
</div>
<div class="line">file_names.dataはPHASEの入出力ファイルを指定するファイルです。この入力例では、電荷密度を./nfchgt.dataに出力する設定になっています。</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP    = &#39;./nfinput.data&#39;
F_POT(1) = &#39;../PP/atom_14_Si_lda_nc_bhs.gncpp2&#39;
F_CHGT   = &#39;./nfchgt.data&#39; 　←　電荷密度ファイルの設
/
</pre></div>
</div>
<p>nfinput.dataはPHASEによりSi結晶の電荷密度を計算するためのファイルです。計算条件は以下のように設定されています。</p>
<p>交換相関ポテンシャル：LDAPW91</p>
<p>バンド数：8</p>
<p>k点セット：メッシュ法(4x4x4)</p>
<p>SCF収束条件：scf_convergence = 10<sup>-12</sup> Hartree; succession = 3</p>
<p>使用する擬ポテンシャルは、PPに格納されているatom_14_Si_lda_nc_bhs.gncpp2です。
擬ポテンシャルの形式は以下の通りです。</p>
<p>交換相関ポテンシャル：LDAPW91</p>
<p>局所ポテンシャル：BHS形式</p>
<p>以下のコマンドを入力してPHASEの計算を行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span>  <span class="o">-</span><span class="n">np</span>  <span class="mi">1</span>  <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phase</span> <span class="o">&gt;&amp;</span> <span class="n">log</span>
</pre></div>
</div>
<p id="id45"><strong>誘電関数の計算</strong></p>
<div class="line-block">
<div class="line">電子密度の計算が終了したら、誘電関数の計算を行います。epsディレクトリに移動してください。このディレクトリには以下のファイルが格納されています。</div>
<div class="line">　file_names.data</div>
<div class="line-block">
<div class="line">nfinput.data</div>
</div>
<div class="line">file_names.dataはUVSORの入出力ファイル設定を行うファイル、nfinput.dataはUVSORの入力ファイルです。file_names.dataは以下のように設定されています。</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP    = &#39;./nfinput.data&#39;                     ←(1)入力データファイルの設定
F_POT(1) = &#39;../PP/atom_14_Si_lda_nc_bhs.gncpp2&#39; ←(2)擬ポテンシャルファイルの設定
F_CHGT   = &#39;../scf/nfchgt.data&#39;                 ←(3)電子密度ファイルの設定
F_EPSOUT = &#39;./eps.data&#39;                         ←(4)誘電関数出力ファイルの設定
/
</pre></div>
</div>
<div class="line-block">
<div class="line">(1)入力ファイルはPHASE/EKCALと同じ形式です。入力ファイル例は次節で説明します。</div>
<div class="line">(2)擬ポテンシャルファイルは、電子密度計算の用いたものと同じです。</div>
<div class="line">(3)scfディレクトリでPHASEを実行して得られた電子密度ファイルを指定します。</div>
<div class="line">(4)誘電関数用の出力ファイルです。名称は任意です。</div>
</div>
<p>入力ファイルの設定</p>
<p>nfinput.dataは、以下内容となっています。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Control{
        condition = 2  (1) !      {0|1|2|3}|{initial|continuation|fixed_charge|fixed_charge_continuation}
        cpumax = 1 day  ! {sec|min|hour|day}
        max_iteration =  6000
        use_additional_projector = off
        nfstopcheck = 1
}
accuracy{
        cke_wavefunctions =  25.0       rydberg  ! cke_wf
        cke_chargedensity = 100.0       rydberg  ! cke_cd
        num_bands = 18 (2)
        ksampling{
                method = mesh ! {mesh|file|directin|gamma|monk}
                mesh{  nx= 4,  ny =  4, nz =  4   }
        }
        smearing{
                method = tetrahedral   ! {parabolic|tetrahedral}
                width  = 0.001 hartree
        }
        xctype = ldapw91  ! ldapw91
        scf_convergence{
                delta_total_energy = 1.e-12  hartree
                succession   = 3   !default value = 3
        }
        force_convergence{
                max_force = 0.1e-3
        }
        ek_convergence{
                num_extra_bands = 0
                num_max_iteration = 300
                sw_eval_eig_diff = on (3)
                delta_eigenvalue = 1.e-6 rydberg (4)
                succession   = 3　(5)
        }
        initial_wavefunctions = matrix_diagon  !{random_numbers|matrix_diagion}
            matrix_diagon{
               cke_wf =  20.00  rydberg  ! cke_wf
            }
        initial_charge_density = file !{Gauss|Very_broad|pseudopotentialfile}
}
        （中略）
epsilon {
        sw_epsilon = on　a
        crystal_type = single ! {single|poly}  b
        fermi_energy{
               read_efermi = off  c
               efermi = 0.0000
        }
        photon{
               polar    {ux=1.00, uy=0.00, uz=0.00 } d
               Poynting {px=0.00, py=0.00, pz=0.00}
               energy   {low=0.000, high=2.000, step=0.002}  e
        }
        transition_moment{
         type = ks ! {l|rn|ks}  f　　　　　　　　　　　　　　　　(6)
                delq = 0.001
                symmetry = on  g
        }
        BZ_integration {
            method = t !{parabolic(p)|gaussian(g)|tetrahedron(t)}  h
        }
        band_gap_correction{
                scissor_operator=0.0d0  i
        }
        drude_term {
                drude = off  j
        }
        ipriepsilon = 1  k
}
(以下略)
</pre></div>
</div>
<ol class="arabic simple">
<li><p>controlタグにおいてcondition=2とします。</p></li>
</ol>
<p>(2)
num_bandsを設定します。num_bandsは通常のSCF計算の場合よりも大きな値として、１電子あたりの振動子強度が0.7以上になるようにします。詳細は次節で説明します。</p>
<ol class="arabic simple" start="3">
<li><p>sw_eval_eig_diff=onとします。</p></li>
</ol>
<p>(4) delta_eigenvalue 値を設定します。delta_eigenvalue
の推奨値は、半導体・金属の場合は10<span class="math notranslate nohighlight">\({}^{- 6}\)</span>
Rydberg程度、絶縁体の場合10<span class="math notranslate nohighlight">\({}^{- 4}\)</span> Rydberg程度です。</p>
<ol class="arabic simple" start="5">
<li><p>succession=3とします。</p></li>
</ol>
<p>(6)
epsilonタグを設定。epsilonタグで誘電関数の計算方法を指定します。この入力例におけるepsilonタグのa,
b, c, d, e, f, g, h, i, kの意味は以下の通りです。</p>
<p>a 誘電関数の計算を行う</p>
<p>sw_epsilon=offとすると誘電関数の計算を行わないので注意してください。</p>
<p>b 単結晶として計算する</p>
<p>c フェルミレベルを計算する。</p>
<p>d 入射電磁波は直線偏光しており、偏光ベクトルは(1.0, 0.0, 0.0)(x軸)の方向を向いている。</p>
<p>e 入射電磁波のエネルギーレンジは0～2.0 Hartreeであり、エネルギーステップは0.002 Hartreeである。</p>
<p>f
遷移モーメント補正を行い、全電子計算と同じ結果が得られようにする。補正法はKageshima-Shiraishi(KS)法を用いる。</p>
<p>g リニアテトラヘドロン法を用いて誘電率の虚部を求める</p>
<p>h scissors operator 値を0とする(バンドギャップの補正を行わない)。</p>
<p>i 標準出力とする。</p>
<p>(注意)Read and Needs(RN)法は、ノルム保存型擬ポテンシャルの場合にのみ有効です。KS法はノルム保存及びウルトラソフト擬ポテンシャルに有効ですが、CIAOにより作成されたKS補正因子(Dipole 補正因子)を含む擬ポテンシャルファイルを使用することが必要です。詳細は、UVSOR-Epsilon及びCIAOのマニュアルを参照ください。なお、この計算に用いる擬ポテンシャルは補正因子を含んでいます。</p>
<p id="uvsor-sieps-1"><strong>誘電関数の計算1</strong></p>
<p>epsディレクトリで以下のコマンドを実行してみてください。UVSOR-Epsilonが実行されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">1</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">epsmain</span> <span class="o">&gt;&amp;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>計算が終わったら、電子状態の収束を確認します。収束の確認は、以下のコマンドで行うことができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">grep</span> <span class="n">converged</span> <span class="n">output000</span>
</pre></div>
</div>
<p>このコマンドを実行して、!* all k-points are convergedと画面に表示されれば、電子状態は収束しています。</p>
<p>eps.dataを見てみましょう。以下のような出力が得られているはずです。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>             <span class="n">Dielectric</span> <span class="n">Function</span>                                    <span class="n">Optical</span> <span class="n">Properties</span>
       <span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="p">(</span><span class="mi">2</span><span class="p">)</span>           <span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="p">(</span><span class="mi">4</span><span class="p">)</span>            <span class="p">(</span><span class="mi">5</span><span class="p">)</span>            <span class="p">(</span><span class="mi">6</span><span class="p">)</span>            <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">Photon</span> <span class="n">Energy</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span>   <span class="n">Real</span> <span class="n">Part</span>   <span class="n">Imaginary</span> <span class="n">Part</span>   　    <span class="n">n</span>              <span class="n">k</span>      <span class="nb">abs</span><span class="p">(</span><span class="ow">in</span> <span class="mi">10</span><span class="o">**</span><span class="mi">8</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>      <span class="n">R</span>
     <span class="mf">0.00000</span>       <span class="mf">13.90891</span>       <span class="mf">0.00000</span>          <span class="mf">3.72946</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33307</span>
     <span class="mf">0.05442</span>       <span class="mf">13.91137</span>       <span class="mf">0.00000</span>          <span class="mf">3.72979</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33310</span>
     <span class="mf">0.10885</span>       <span class="mf">13.91876</span>       <span class="mf">0.00000</span>          <span class="mf">3.73079</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33320</span>
     <span class="mf">0.16327</span>       <span class="mf">13.93110</span>       <span class="mf">0.00000</span>          <span class="mf">3.73244</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33337</span>
     <span class="mf">0.21769</span>       <span class="mf">13.94843</span>       <span class="mf">0.00000</span>          <span class="mf">3.73476</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33361</span>
     <span class="mf">0.27211</span>       <span class="mf">13.97078</span>       <span class="mf">0.00000</span>          <span class="mf">3.73775</span>        <span class="mf">0.00000</span>        <span class="mf">0.00000</span>        <span class="mf">0.33392</span>
                                                   <span class="p">(</span><span class="n">以下略</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">各カラムの意味は以下の通りです。</div>
<div class="line">(1)電磁波のエネルギー (2)誘電関数(実部)  (3)誘電関数(虚部)</div>
<div class="line">(4)屈折率(実部)  (5)屈折率(虚部)　(6)吸収係数　(7)反射率</div>
<div class="line">電磁波のエネルギー＝0における誘電率が静的誘電率です。計算により得られた静的誘電率は13.90で、実測(11.7)よりも大きな値となります。これは、LDA法がSiのバンドギャップを過少評価することに起因しています。</div>
</div>
<p><strong>バンド数の設定法</strong></p>
<p>計算の信頼性は、計算に用いるバンド数に大きく依存します。信頼性を確認するには、１電子あたりの振動子強度の総和をしらべます。振動子強度の総和は、以下のコマンドを使用します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">grep</span>  <span class="n">oscillator</span>  <span class="n">output000</span>
</pre></div>
</div>
<p>このコマンドを実行すると</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!* oscillator strength per electron =    0.91165
</pre></div>
</div>
<p>という表示が画面に現われます。</p>
<p>この表示は、この計算における１電子あたりの振動子強度の総和が約0.91であることを示しています。振動子強度の総和則(トーマス・ライヒ・クーンの総和則)は、1電子あたりの振動子強度の総和が1になることを主張します。バンド数(num_bandsパラメータ)を増やすにつれ、oscillator
strength per
electronの値は１に近づいていきますが、実際の計算では、この値が0.7を越えるようにnum_bandsを設定すれば、誘電関数はほぼ収束していることが経験的にわかっています。この例では、１電子あたりの振動子強度の総和が0.7以上となっており、バンド数は十分であることがわかります。</p>
<p><strong>誘電関数の計算2</strong></p>
<p>次に、Read and
Needs(RN)方式で、遷移モーメント補正を行い、Siの誘電率を計算してみましょう。epsilonタグのfの部分を
type = rnとして、同様に計算を行ってみます。計算を行うとeps.dataが上書きされるので、コピーをとっておきます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cp</span> <span class="n">eps</span><span class="o">.</span><span class="n">data</span>  <span class="n">eps</span><span class="o">.</span><span class="n">data</span><span class="o">-</span><span class="n">ks</span>
</pre></div>
</div>
<p>同様に計算を行うと、以下のような結果がeps.dataに出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>             Dielectric Function                                    Optical Properties
Photon Energy(eV)   Real Part   Imaginary Part          n              k      abs(in 10**8 m-1)      R
     0.00000       13.97263       0.00000          3.73800        0.00000        0.00000        0.33395
     0.05442       13.97510       0.00000          3.73833        0.00000        0.00000        0.33398
     0.10885       13.98253       0.00000          3.73932        0.00000        0.00000        0.33408
     0.16327       13.99492       0.00000          3.74098        0.00000        0.00000        0.33425
     0.21769       14.01231       0.00000          3.74330        0.00000        0.00000        0.33449
     0.27211       14.03476       0.00000          3.74630        0.00000        0.00000        0.33480
                                                  （以下略）
</pre></div>
</div>
<p>静的誘電率は13.97で、KS法による計算値に極めて近い値となっています。先に得られたKS補正による誘電関数と、ここで得られた誘電関数を比較してプロットすると、以下のようになります。なお <a class="reference internal" href="#uvsor-fig4"><span class="std std-numref">図 10.4</span></a> は、比較のため、光学測定により実測された誘電関数も示してあります。</p>
<figure class="align-default" id="uvsor-fig4">
<img alt="../_images/uvsor_image4.svg" src="../_images/uvsor_image4.svg" /><figcaption>
<p><span class="caption-number">図 10.4 </span><span class="caption-text">Si結晶の誘電関数：(a)実部; (b)虚部。KS補正及びRN補正をして計算した誘電関数を示す。実測の誘電関数 (CRC Handbook of Chemistry 79-th Ed,CRC Press, New York 1998)を比較のため示す。</span><a class="headerlink" href="#uvsor-fig4" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="uvsor-berry-phonon">
<h2><span class="section-number">10.4. </span>UVSOR-Berry-Phonon<a class="headerlink" href="#uvsor-berry-phonon" title="この見出しへのパーマリンク"></a></h2>
<section id="id46">
<h3><span class="section-number">10.4.1. </span>入出力の説明<a class="headerlink" href="#id46" title="この見出しへのパーマリンク"></a></h3>
<p><strong>入力出力ファイル</strong></p>
<p>PHASEと同様に入力および出力ファイルはfile_names.dataに記述して指定する。
たとえば、以下のように記述する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_INP</span>    <span class="o">=</span> <span class="s1">&#39;./nfinput.data&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;./potential.1&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;./potential.2&#39;</span>
<span class="n">F_CHGT</span>   <span class="o">=</span> <span class="s1">&#39;./nfchgt.data&#39;</span>
<span class="n">F_BERRY</span>  <span class="o">=</span> <span class="s1">&#39;./berry.data&#39;</span>
<span class="n">F_EFFCHG</span> <span class="o">=</span> <span class="s1">&#39;./effchg.data&#39;</span>
<span class="n">F_FORCE</span>  <span class="o">=</span> <span class="s1">&#39;./force.data&#39;</span>
<span class="n">F_MODE</span>   <span class="o">=</span> <span class="s1">&#39;./mode.data&#39;</span>
<span class="n">F_EPSILON</span><span class="o">=</span> <span class="s1">&#39;./epsilon.data&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>F_INPはPHASEの入力ファイルであり、ベリー位相計算や振動解析計算の入力も
このファイルに記述する。標準のPHASEには無いファイルについてのみ説明をする。
F_BERRYはベリー位相計算の出力である。F_EFFCHGは通常は使用されないが、
有効電荷を入力するファイルである。F_FORCEは振動解析に必要とされるファイル
が出力されるファイルである。F_MODEは振動解析の結果およびモード有効電荷と誘電率が出力されるファイルである。F_EPSILONは誘電関数が出力されるファイルである。</p>
<p>各入力および出力ファイルの説明を <a class="reference internal" href="#uvsor-fnames-table1"><span class="std std-numref">表 10.2</span></a> にまとめた。</p>
<table class="longtable docutils align-default" id="uvsor-fnames-table1">
<caption><span class="caption-number">表 10.2 </span><span class="caption-text">ファイルポインタの説明</span><a class="headerlink" href="#uvsor-fnames-table1" title="このテーブルへのパーマリンク"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>ファイルポインタ名</p></th>
<th class="head"><p>既定値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>F_INP</p></td>
<td><p>nfinp.data</p></td>
<td><p>入力ファイル。</p>
<p>結晶構造、計算精度、計算の制
御などの情報が記述されている。</p>
</td>
</tr>
<tr class="row-odd"><td><p>F_BERRY</p></td>
<td><p>berry.data</p></td>
<td><p>ベリー位相
の計算値が出力されるファイル。</p></td>
</tr>
<tr class="row-even"><td><p>F_EFFCHG</p></td>
<td><p>effchg.data</p></td>
<td><p>有効電荷を記述するファイル。</p></td>
</tr>
<tr class="row-odd"><td><p>F_FORCE</p></td>
<td><p>force.data</p></td>
<td><p>振動解析に必要とされる力
のデータが記述されるファイル。</p></td>
</tr>
<tr class="row-even"><td><p>F_MODE</p></td>
<td><p>mode.data</p></td>
<td><p>振動
解析の結果およびモード有効電荷
と誘電率が出力されるファイル。</p></td>
</tr>
<tr class="row-odd"><td><p>F_EPSILON</p></td>
<td><p>epsilon.data</p></td>
<td><p>誘電関数が出力されるファイル。</p></td>
</tr>
<tr class="row-even"><td><p>F_STRFRC</p></td>
<td><p>strfrc.data</p></td>
<td><p>入力ファイル。内部座標を固
定して結晶を歪ませた時に原子に
作用する力を記述するファイル。</p></td>
</tr>
</tbody>
</table>
<p><strong>入力ファイル&quot;F_INP&quot;</strong></p>
<p>&quot;F_INP&quot;で指定されるファイルには、結晶構造、計算精度、計算の制御などを記述する。格子誘電率計算は、Berry_phaseブロックとPhononブロックで主に制御される。Berry_phaseブロックは固有状態を計算するプログラムEKCALでのみ有効で、ベリー位相計算の制御を行う。PhononブロックはPHASEでのみ有効で、格子振動解析の制御を行う。</p>
<p>Berry_phaseブロックの形式は次のようになっている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Berry_phase</span><span class="p">{</span>
  <span class="n">sw_berry_phase</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
  <span class="n">g_index</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">G_INDEX</span><span class="o">&gt;</span>
  <span class="n">mesh</span><span class="p">{</span> <span class="n">n1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_J</span><span class="o">&gt;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>BerryPhase計算に関係する変数の説明</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>変数名またはタグ名</p></th>
<th class="head"><p>既定値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sw_berry_phase</p></td>
<td><p>OFF</p></td>
<td><p>ベリ
ー位相計算を行うかどうかのスイッチ。</p></td>
</tr>
<tr class="row-odd"><td><p>g_index</p></td>
<td><p>1</p></td>
<td><p>逆格子ベクトル<span class="math notranslate nohighlight">\(\mathbf{g}_{i}(i=1,2,3)\)</span>の指数<span class="math notranslate nohighlight">\(i\)</span>。</p></td>
</tr>
<tr class="row-even"><td><p>mesh</p></td>
<td></td>
<td><p><strong>k</strong>空
間のメッシュを指定するブロックタグ。</p></td>
</tr>
<tr class="row-odd"><td><p>n1,n2</p></td>
<td><p>4</p></td>
<td><p>選択
した逆格子ベクトル <span class="math notranslate nohighlight">\(\mathbf{g}_i\)</span>
に垂直な面内のMonkhorst-Pack
メッシュの指数<span class="math notranslate nohighlight">\(n1 \times n2\)</span></p></td>
</tr>
<tr class="row-even"><td><p>J</p></td>
<td><p>20</p></td>
<td><p>選択した逆格子ベクトル<span class="math notranslate nohighlight">\(\mathbf{g}_i\)</span>
の分割数<span class="math notranslate nohighlight">\(J\)</span>。</p></td>
</tr>
</tbody>
</table>
<p>ベリー位相計算を行うために原子を変位させる必要があり、そのための機能がBerry-Phononには備わっている。それは、次のようにdisplacementブロックを原子座標を指定するatom_list内に記述することでできる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atom_list</span><span class="p">{</span>
  <span class="n">coordinate_system</span> <span class="o">=</span> <span class="n">cartesian</span>
  <span class="n">atoms</span><span class="p">{</span>
   <span class="c1">#tag  rx        ry        rz         element</span>
         <span class="mf">0.000</span>     <span class="mf">0.000</span>     <span class="mf">0.000</span>      <span class="n">Al</span>
         <span class="mf">2.6561175</span> <span class="mf">2.6561175</span> <span class="mf">2.6561175</span>  <span class="n">As</span>
  <span class="p">}</span>
  <span class="n">displacement</span><span class="p">{</span>
    <span class="n">sw_displace_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
    <span class="n">displaced_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ATOM_ID</span><span class="o">&gt;</span>
    <span class="n">ux</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Ux</span><span class="o">&gt;</span>
    <span class="n">uy</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uy</span><span class="o">&gt;</span>
    <span class="n">uz</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uz</span><span class="o">&gt;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>原子を変位させる変数の説明</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>変数名またはタグ名</p></th>
<th class="head"><p>既定値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sw_displace_atom</p></td>
<td><p>OFF</p></td>
<td><p>原子を変位されるかどうかのスイッチ。</p></td>
</tr>
<tr class="row-odd"><td><p>displaced_atom</p></td>
<td><p>0</p></td>
<td><p>変位させる原子の番号。</p></td>
</tr>
<tr class="row-even"><td><p>ux</p></td>
<td><p>0.0</p></td>
<td><p>x方向の原子変
位量または、格子ベクトル
<span class="math notranslate nohighlight">\(\mathbf{a}\)</span> に
沿った内部座標の変化量。</p></td>
</tr>
<tr class="row-odd"><td><p>uy</p></td>
<td><p>0.0</p></td>
<td><p>y方向の原子変
位量または、格子ベクトル
<span class="math notranslate nohighlight">\(\mathbf{b}\)</span> に
沿った内部座標の変化量。</p></td>
</tr>
<tr class="row-even"><td><p>uz</p></td>
<td><p>0.0</p></td>
<td><p>z方向の原子変
位量または、格子ベクトル
<span class="math notranslate nohighlight">\(\mathbf{c}\)</span> に
沿った内部座標の変化量。</p></td>
</tr>
</tbody>
</table>
<p>本プログラムには有効電荷を計算するための機能が備わっている。それを行うには
Postprocessingブロック内にPolarizationブロックを加えて制御する。入力形式は
次のようになっている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Postprocessing</span><span class="p">{</span>
   <span class="n">Polarization</span><span class="p">{</span>
   　<span class="n">sw_bp_property</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
     <span class="nb">property</span> <span class="o">=</span> <span class="n">effective_charge</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>分極に関係する物理量計算に関係する変数の説明</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>変数名またはタグ名</p></th>
<th class="head"><p>既定値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Polarization</p></td>
<td></td>
<td><p>結晶の分極に関
する物性値の計算を制御するブロック。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_bp_property</p></td>
<td><p>OFF</p></td>
<td><p>Berry位相分極に関
係した物性値を計算するためのスイッチ</p></td>
</tr>
<tr class="row-even"><td><p>property</p></td>
<td><p>0</p></td>
<td><p>polarizationを指定するとberry.dataを
読み込みBerry位相分極を計算する。</p>
<p>effective_chargeを指定するとberry.data
を読み込みボルン有効電荷を計算する。</p>
</td>
</tr>
</tbody>
</table>
<p>Phononブロックの形式は次のようになっている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phonon</span><span class="p">{</span>
   <span class="n">sw_phonon</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">sw_calc_force</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">displacement</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span>
   <span class="n">sw_vibrational_modes</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">point_group</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Point_Group</span><span class="o">&gt;</span>
   <span class="n">sw_lo_to_splitting</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">electronic_dielectric_constant</span><span class="p">{</span>
     <span class="n">exx</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">eyy</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ezz</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
     <span class="n">exy</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">eyz</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ezx</span> <span class="o">=</span> <span class="mf">0.0</span>
   <span class="p">}</span>
   <span class="n">k_vector</span><span class="p">{</span> <span class="n">kx</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ky</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">kz</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="p">}</span>
   <span class="n">sw_lattice_dielectric_tensor</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">sw_dielectric_function</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ON_OFF</span><span class="o">&gt;</span>
   <span class="n">energy_range</span><span class="p">{</span>
     <span class="n">min_energy</span> <span class="o">=</span> <span class="mf">0.0</span>
     <span class="n">max_energy</span> <span class="o">=</span> <span class="mf">0.01</span>
     <span class="n">division_number</span> <span class="o">=</span> <span class="mi">100</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>各変数またはタグの説明を表6と7にあげる。</p>
<p>振動解析に関係する変数の説明</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>変数名またはタグ名</p></th>
<th class="head"><p>既定値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sw_phonon</p></td>
<td><p>OFF</p></td>
<td><p>格子
振動解析設定ブロックを有効
にするかどうかのスイッチ。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_calc_force</p></td>
<td><p>OFF</p></td>
<td><p>振動解析のための力計算
を行うかどうかのスイッチ。</p>
<p>ONのときには
、格子振動解析のための力計
算を行う。(計算した力はforc
e.dataに出力される。）OFFの
ときには、sw_vibrational_m
odes=ONならファイル&quot;F_FORCE
&quot;から力のデータを読み込む。</p>
</td>
</tr>
<tr class="row-even"><td><p>displacement</p></td>
<td><p>0.1</p></td>
<td><p>原子変位パラメーター。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_vibrational_modes</p></td>
<td><p>OFF</p></td>
<td><p>格子振動解析
を行うかどうかのスイッチ。
ONのときには
、格子振動解析が行われ、mod
es.dataに結果が出力される。
OFFのときには、
格子振動解析は行われない。</p></td>
</tr>
<tr class="row-even"><td><p>point_group</p></td>
<td><p>C1</p></td>
<td><p>シェンフ
リース記号での点群の名称。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_lo_to_splitting</p></td>
<td><p>OFF</p></td>
<td><p>LO-TO分裂を考
慮するかどうかのスイッチ。</p></td>
</tr>
<tr class="row-even"><td><p>electronic_dielectric_constant</p></td>
<td></td>
<td><p>電子誘電率を
指定するブロックのタグ名。</p></td>
</tr>
<tr class="row-odd"><td><p>exx</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{xx}\)</span>成分。</p></td>
</tr>
<tr class="row-even"><td><p>eyy</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{yy}\)</span>成分。</p></td>
</tr>
<tr class="row-odd"><td><p>ezz</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{zz}\)</span>成分。</p></td>
</tr>
<tr class="row-even"><td><p>exy</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{xy}\)</span>成分。</p></td>
</tr>
<tr class="row-odd"><td><p>eyz</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{yz}\)</span>成分。</p></td>
</tr>
<tr class="row-even"><td><p>ezx</p></td>
<td><p>0.0</p></td>
<td><p>電子誘電率の
<span class="math notranslate nohighlight">\(\text{zx}\)</span>成分。</p></td>
</tr>
<tr class="row-odd"><td><p>k_vector</p></td>
<td></td>
<td><p>格
子振動の波数ベクトルの方向
を指定するブロックのタグ。</p></td>
</tr>
<tr class="row-even"><td><p>kx</p></td>
<td><p>0.0</p></td>
<td><p>格子
振動の波数ベクトルのx成分。</p></td>
</tr>
<tr class="row-odd"><td><p>ky</p></td>
<td><p>0.0</p></td>
<td><p>格子
振動の波数ベクトルのy成分。</p></td>
</tr>
<tr class="row-even"><td><p>kz</p></td>
<td><p>1.0</p></td>
<td><p>格子
振動の波数ベクトルのz成分。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_lattice_dielectric_tensor</p></td>
<td><p>OFF</p></td>
<td><p>格子誘電率を計
算するかどうかのスイッチ。</p></td>
</tr>
<tr class="row-even"><td><p>sw_dielectric_function</p></td>
<td><p>OFF</p></td>
<td><p>誘電関
数をファイル&quot;F_EPSILON&quot;に出
力するかどうかのスイッチ。</p></td>
</tr>
<tr class="row-odd"><td><p>energy_range</p></td>
<td></td>
<td><p>誘電関数のエネエルギー範囲
を指定するブロックのタグ。</p></td>
</tr>
<tr class="row-even"><td><p>min_energy</p></td>
<td><p>0.0</p></td>
<td><p>エネルギー範囲の最小値。</p></td>
</tr>
<tr class="row-odd"><td><p>max_energy</p></td>
<td><p>0.01</p></td>
<td><p>エネルギー範囲の最大値。</p></td>
</tr>
<tr class="row-even"><td><p>division_number</p></td>
<td><p>100</p></td>
<td><p>エネルギー範囲の分割数。</p></td>
</tr>
</tbody>
</table>
<p>変数point_groupで指定可能なシェンフリース記号を以下にあげる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Oh</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">Td</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">D4h</span><span class="p">,</span> <span class="n">D4</span><span class="p">,</span> <span class="n">D2d</span><span class="p">,</span> <span class="n">C4v</span><span class="p">,</span> <span class="n">C4h</span><span class="p">,</span> <span class="n">S4</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">D2h</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">C2v</span><span class="p">,</span> <span class="n">D6h</span><span class="p">,</span> <span class="n">D6</span><span class="p">,</span>
<span class="n">D3h</span><span class="p">,</span> <span class="n">C6v</span><span class="p">,</span> <span class="n">C6h</span><span class="p">,</span> <span class="n">C3h</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">D3d</span><span class="p">,</span> <span class="n">D3</span><span class="p">,</span> <span class="n">C3v</span><span class="p">,</span> <span class="n">S6</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C2h</span><span class="p">,</span> <span class="n">Cs</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">C1</span>
</pre></div>
</div>
<p><strong>入力および出力ファイル&quot;F_BERRY&quot;</strong></p>
<p>原子displaced_atomを<span class="math notranslate nohighlight">\((u_{x},u_{y},u_{z})\)</span>変位させて計算した場合に、
ベリー位相データが次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">nkprep</span><span class="p">,</span><span class="w"> </span><span class="n">ig</span><span class="p">,</span><span class="w"> </span><span class="n">displaced_atom</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkprep</span>
<span class="w">   </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">cphi</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">phi</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">wgh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>配列displacementの1,2,3番目の要素が<span class="math notranslate nohighlight">\(u_{x}\)</span>,<span class="math notranslate nohighlight">\(u_{y}\)</span>,<span class="math notranslate nohighlight">\(u_{z}\)</span>に対応する。
phiは逆格子ベクトル<span class="math notranslate nohighlight">\(g_{i}\)</span>に平行な線に沿ったベリー位相の配列
であり、cphiはそのphiの元となる 行列式の積の値の配列である。
nkprepは線積分の刻みJであり、igは逆格子ベクトル<span class="math notranslate nohighlight">\(g_{i}\)</span>の指数であり、
wghはk点の重みである。</p>
<p>ベリー位相の入力形式は出力ファイルを結合したものであるが、ファイルの
先頭にはそのベリー位相データの数を記述しなければならない。
ただし、出力ファイルを結合する順序は問わない。</p>
<p><strong>入力ファイル&quot;F_EFFCHG&quot;</strong></p>
<p>ボルン有効電荷をベリー位相から計算せずに読み込むことができる。
対称性から要求されるサイトのボルン有効電荷のみを記述すればよい。
次の形式で入力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">num_zeff</span>
<span class="k">do </span><span class="n">ia</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_zeff</span>
<span class="w">   </span><span class="n">zeff</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">ia</span><span class="p">)</span>
<span class="w">   </span><span class="n">zeff</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">ia</span><span class="p">)</span>
<span class="w">   </span><span class="n">zeff</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">ia</span><span class="p">)</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>num_zeffはボルン有効電荷の数であり、iaが原子の番号であり、
zeffがボルン有効電荷の配列である。</p>
<p><strong>入力および出力ファイル&quot;F_FORCE&quot;</strong></p>
<p>&quot;F_FORCE&quot;には力の定数を計算するための力のデータが記述される。
その力データは次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">num_force_data</span>
<span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_force_data</span>
<span class="w">   </span><span class="n">displaced_atom</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="w">   </span><span class="k">do </span><span class="n">ia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">natm</span>
<span class="w">      </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">force_data</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="w">   </span><span class="k">end do</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>num_force_dataは力を計算する配置の数であり、displaced_atomは変位した原子
の番号であり、配列displacementが原子の変位ベクトル<span class="math notranslate nohighlight">\((u_{x},u_{y},u_{z})\)</span>である。</p>
<p><strong>出力ファイル&quot;F_MODE&quot;</strong></p>
<p>&quot;F_MODE&quot;には振動解析の結果が記述される。
まず最初に基本並進ベクトル<span class="math notranslate nohighlight">\(\mathbf{a}_{i} = (a_{\text{ix}},a_{\text{iy}},a_{\text{iz}})\)</span>が次の形式で
記述される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">primitive</span> <span class="n">lattice</span> <span class="n">vectors</span> <span class="o">---</span>
  <span class="n">a_1x</span> <span class="n">a_1y</span> <span class="n">a_1z</span>
  <span class="n">a_2x</span> <span class="n">a_2y</span> <span class="n">a_2z</span>
  <span class="n">a_3x</span> <span class="n">a_3y</span> <span class="n">a_3z</span>
</pre></div>
</div>
<p>次に原子の数natmと各原子の座標<span class="math notranslate nohighlight">\((x_{i},y_{i},z_{i})\)</span>と質量<span class="math notranslate nohighlight">\(m_{i}\)</span>とラベルname(i)が次の形式記述される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">---</span><span class="w"> </span><span class="n">Equilibrium</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="nb">and </span><span class="n">mass</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">atom</span><span class="o">---</span>
<span class="n">Natom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">natm</span>
<span class="w"> </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">natm</span>
<span class="w">    </span><span class="n">i</span><span class="w">  </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">  </span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">m</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w"> </span><span class="k">end do</span>
</pre></div>
</div>
<p>次に振動解析の結果が次の形式で記述される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">---</span><span class="w"> </span><span class="n">Vibrational</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="o">---</span>
<span class="n">Nmode</span><span class="o">=</span><span class="w"> </span><span class="n">nmode</span><span class="w">   </span><span class="n">Natom</span><span class="o">=</span><span class="w"> </span><span class="n">natm</span>
<span class="k">do </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nmode</span>
<span class="w">  </span><span class="n">n</span><span class="o">=</span><span class="w">   </span><span class="n">m</span><span class="w">  </span><span class="n">representation</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="n">acvtive</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="n">hbarW</span><span class="o">=</span><span class="w"> </span><span class="n">omega_ha</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">om</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omega_ev</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nu</span><span class="o">=</span><span class="w"> </span><span class="n">omega_nu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">natm</span>
<span class="w">     </span><span class="n">i</span><span class="w">  </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">  </span><span class="k">end do</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>representationは既約表現の配列である。active(m)はラマン活性なモードあれば
Rになり、赤外活性なモードであればIRとなる。両活性であれば、IR&amp;Rとなる。
サイレントモードの場合には何も表示されない。
vecは固有ベクトルの配列で、omega_haはHartree単位での振動数であり、
omega_evは電子ボルト単位での振動数であり、omega_nuは波数である。</p>
<p>格子誘電率を計算した場合には、モード有効電荷が付加されて、次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">---</span><span class="w"> </span><span class="n">Vibrational</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="o">---</span>
<span class="n">Nmode</span><span class="o">=</span><span class="w"> </span><span class="n">nmode</span><span class="w">   </span><span class="n">Natom</span><span class="o">=</span><span class="w"> </span><span class="n">natm</span>
<span class="k">do </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nmode</span>
<span class="w">  </span><span class="n">n</span><span class="o">=</span><span class="w">   </span><span class="n">m</span><span class="w">  </span><span class="kt">character</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="n">active</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="n">hbarW</span><span class="o">=</span><span class="w"> </span><span class="n">omega_ha</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">om</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omega_ev</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nu</span><span class="o">=</span><span class="w"> </span><span class="n">omega_nu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">   </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">natm</span>
<span class="w">     </span><span class="n">i</span><span class="w">  </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">vec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">   </span><span class="k">end do</span>
<span class="k">   </span><span class="n">Mode</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charge</span><span class="w"> </span><span class="nb">and </span><span class="n">its</span><span class="w"> </span><span class="n">average</span><span class="p">:</span>
<span class="w">   </span><span class="n">Z</span><span class="o">=</span><span class="w">  </span><span class="n">z</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">   </span><span class="n">z</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="n">z</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="n">Ave</span><span class="p">.</span><span class="o">=</span><span class="w">  </span><span class="n">zave</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>そして、最後に誘電率が次の形式で出力される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">Lattice</span> <span class="ow">and</span> <span class="n">static</span> <span class="n">dielectric</span> <span class="n">tensors</span> <span class="o">---</span>
<span class="p">[</span>   <span class="n">elat_xx</span>   <span class="n">elat_xy</span>   <span class="n">elat_xz</span> <span class="p">]</span>  <span class="p">[</span>   <span class="n">e0_xx</span>   <span class="n">e0_xy</span>   <span class="n">e0_xz</span> <span class="p">]</span>
<span class="p">[</span>   <span class="n">elat_yx</span>   <span class="n">elat_yy</span>   <span class="n">elat_yz</span> <span class="p">]</span>  <span class="p">[</span>   <span class="n">e0_yx</span>   <span class="n">e0_yy</span>   <span class="n">e0_yz</span> <span class="p">]</span>
<span class="p">[</span>   <span class="n">elat_zx</span>   <span class="n">elat_zy</span>   <span class="n">elat_zz</span> <span class="p">]</span>  <span class="p">[</span>   <span class="n">e0_zx</span>   <span class="n">e0_zy</span>   <span class="n">e0_zz</span> <span class="p">]</span>
</pre></div>
</div>
<p>elatが格子誘電率であり、e0が静的誘電率である。</p>
<p><strong>出力ファイル&quot;F_EPSILON&quot;</strong></p>
<p>&quot;F_EPSILON&quot;には誘電関数の値がつぎの形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">Energy</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="w"> </span><span class="n">E1xx</span><span class="w"> </span><span class="n">E1yy</span><span class="w"> </span><span class="n">E1zz</span><span class="w"> </span><span class="n">E1yz</span><span class="w"> </span><span class="n">E1zx</span><span class="w"> </span><span class="n">E1xy</span><span class="w"> </span><span class="n">E2xx</span><span class="w"> </span><span class="n">E2yy</span><span class="w"> </span><span class="n">E2zz</span><span class="w"> </span><span class="n">E2yz</span><span class="w"> </span><span class="n">E2zx</span><span class="w"> </span><span class="n">E2xy</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">division_number</span>
<span class="w">   </span><span class="n">energy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e1xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">e2xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>energyはeV単位のエネルギーの値である。e1xx,e1yy,e1zz,e1yz,e1zx,e1xyはそれぞれ誘電関数の実部のxx,yy,zz,yz,zx,xy成分である。e2xx,e2yy,e2zz,e2yz,e2zx,e2xyはそれぞれ誘電関数の虚部のxx,yy,zz,yz,zx,xy成分である。</p>
<p><strong>ボルン有効電荷の出力</strong></p>
<p>ボルン有効電荷はoutput000に出力される。まず最初に、&quot;F_BERRY&quot;から読み込んだベリー位相から計算したボルン有効電荷が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Calculated</span><span class="w"> </span><span class="n">electronic</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="o">---</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_atom_inputed</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zel_xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_xz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zel</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="n">zel_yx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zel_zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_zy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">    </span><span class="n">zel_zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>num_atom_inputedは有効電荷が計算された原子の数である。
zel_xx(i),zel_xy(i)などは原子iのボルン有効電荷の電子からの寄与
のxx,xy,...成分である。</p>
<p>電子からの寄与にイオンの価数を加えた結果が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Calculated</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="o">---</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_atom_inputed</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span><span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_yx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>zeff_xx(i),zeff_xy(i)などは原子iのボルン有効電荷の
のxx,xy,...成分である。</p>
<p>サイトの対称性を考慮して、対称化されたボルン有効電荷が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Symmetrized</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="o">---</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_atom_inputed</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zsym_xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_xz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zsym</span><span class="p">(</span><span class="w">  </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="n">zsym_yx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zsym_zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_zy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zsym_zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>zsym_xx(i),zsym_xy(i)などは原子iの対称化されたボルン有効電荷の
のxx,xy,...成分である。</p>
<p>先の対称化されたボルン有効電荷から等価原子のボルン有効電荷を計算した
結果が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">all </span><span class="n">atoms</span><span class="w"> </span><span class="o">---</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">natm</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span><span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_yx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>zeff_xx(i),zeff_xy(i)などは原子iのボルン対称化された
有効電荷のxx,xy,...成分である。</p>
<p>ボルン有効電荷の成分の平均値が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Averaged</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="o">---</span>
<span class="w">       </span><span class="p">[</span><span class="w">   </span><span class="n">zave_xx</span><span class="w">   </span><span class="n">zave_xy</span><span class="w">   </span><span class="n">zave_xz</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zave</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">   </span><span class="n">zave_yx</span><span class="w">   </span><span class="n">zave_yy</span><span class="w">   </span><span class="n">zave_yz</span><span class="w"> </span><span class="p">]</span>
<span class="w">       </span><span class="p">[</span><span class="w">   </span><span class="n">zave_zx</span><span class="w">   </span><span class="n">zave_zy</span><span class="w">   </span><span class="n">zave_zz</span><span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<p>zave_xx,zave_xy,...などはボルン有効電荷のxx,xy,...成分の平均値である。</p>
<p>最後に、補正されたボルン有効電荷が次の形式で出力される。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">Corrected</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">charges</span><span class="w"> </span><span class="o">---</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">natm</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_xx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_xz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span><span class="w">  </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_yx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_yz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="w">    </span><span class="n">zeff_zx</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">zeff_zz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>zeff_xx(i),zeff_xy(i)などは原子iの補正されたボルン有効電荷の
のxx,xy,...成分である。</p>
<p><strong>入力ファイル&quot;F_STRFRC&quot;</strong></p>
<p>入力ファイル&quot;F_STRFRC&quot;には次の形式で内部座標を固定して結晶を歪ませた時に原子に作用する力を記述する。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">num_force_data</span>
<span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_force_data</span>
<span class="w">   </span><span class="nb">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">strain</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">   </span><span class="k">do </span><span class="n">ia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">natm</span>
<span class="w">      </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">force_data</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="w">   </span><span class="k">end do</span>
<span class="k">end do</span>
</pre></div>
</div>
</section>
<section id="quartz">
<h3><span class="section-number">10.4.2. </span>計算例：水晶(α-quartz)の格子誘電率計算<a class="headerlink" href="#quartz" title="この見出しへのパーマリンク"></a></h3>
<p><strong>計算手順</strong></p>
<p>水晶の格子誘電率の計算を例として、格子誘電率の計算の仕方を説明する。
まず、格子誘電率計算の準備の手順を示す。</p>
<ol class="arabic simple">
<li><p>計算したい格子定数において、構造最適化を行う。</p></li>
<li><p>nfdynm.dataの最後に書かれている最適構造でのPHASEの入力を作成する。</p></li>
<li><p>ベリー位相計算を行うディレクトリberryと振動解析を行うディレクトリphononを作成する。</p></li>
<li><p>ディレクトリberryには、Perlスクリプトprep_zeff.plが参照する、入力のテンプレートをディレクトリtemplate_berryとtemplate_scfに置く。入力テンプレートは2.で作成した入力を編集して作成する。</p></li>
<li><p>2.で作成した入力を編集して、振動解析、有効電荷計算と格子誘電率計算に必要な記述がある入力を作成し、ディレクトリphononに置く。</p></li>
<li><p>ディレクトリberryで、prep_zeff.plを実行して、自動実行のためのPerlスクリプトexec_zeff.plと実際に使用する入力を作成し、exec_zeff.plを実行して有効電荷計算に必要なベリー位相を計算する。なお、prep_zeff.plはbinディレクトリーにある。</p></li>
<li><p>ディレクトリphononで振動解析を行い、最後にベリー位相を読み込んで格子誘電率を計算する。</p></li>
<li><p>1.の構造最適化の仕方については、本マニュアル2章や3章などを見よ。2.では原子の座標をデカルト座標で入力するので、coordinate_systemをcartesianに設定する。以降の節で、3から7について、順に説明する。</p></li>
</ol>
<p><strong>ベリー位相計算</strong></p>
<p>ベリー位相の計算はekcalを用いて行うので、ekcalに入力する自己無頓着な電子密度が必要であるので、その計算の入力テンプレートを示す。
水晶はシリコン原子と酸素原子からなるので、自己無頓着場計算のfile_names.dataには、シリコンのポテンシャルpotentail.Siと酸素のポテンシャルpotential.Oの指定がある。これらのポテンシャルは二階層上に置かれていなければならない。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_INP</span>    <span class="o">=</span> <span class="s1">&#39;./nfinput.data&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../../potential.Si&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../../potential.O&#39;</span>
<span class="n">F_CHGT</span>   <span class="o">=</span> <span class="s1">&#39;./nfchgt.data&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>ベリー位相の計算では、各原子を平衡位置からX,Y,Z方向にわずかに変位させたときの電子密度が必要である。その入力&quot;F_INP&quot;のテンプレートを以下に示す。Accuracy{}ブロック中のforce_convergence{}ブロックに含まれるmax_force=0.1e+3は、原子を平衡位置から微小量ずらしたときに発生する力がある程度大きくてもそのまま原子を止めておくための予防的な設定である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Control{
  condition = 0 ! {0|1|2|3}|{initial|continuation|fixed_charge|fixed_charge_continuation}
  cpumax = 24 hour    ! {sec|min|hour|day}
  max_iteration = 60000
}
accuracy{
  cke_wavefunctions =  36.00  rydberg  ! cke_wf
  cke_chargedensity = 300.00  rydberg  ! cke_cd
  num_bands = 32
  ksampling{
    method = monk ! {monk|mesh|file|directin|gamma}
    mesh{ nx=2, ny=2, nz=2}
  }
  smearing{
    method = parabolic ! {parabolic|tetrahedral}
    width  = 0.002 hartree
  }
  xctype = ldapw91
  scf_convergence{
    delta_total_energy = 1.e-10 hartree
    succession   = 3   !default value = 3
  }
  force_convergence{
    max_force = 0.1e+3
  }
  initial_wavefunctions = matrix_diagon !{random_numbers|matrix_diagion}
  matrix_diagon{
    cutoff_wf =  10.0 rydberg  ! cke_wf
  }
}
structure{
  unit_cell_type=Bravais
  unit_cell{
    !#units bohr degree
    a = 9.2, b= 9.2, c= 10.12, alpha=90.0, beta=90.0, gamma=120.0
  }
  symmetry{
    tspace{
      system = h
      generators {
       !#tag rotation tx  ty  tz
             E        0   0   0
      }
    }
    sw_inversion = 0
  }
  magnetic_state = para  !{para|af|ferro}
  atom_list{
    coordinate_system = cartesian ! {cartesian|internal}
    atoms{
     !#default mobile=no
!#tag   rx             ry             rz            element
       -2.136349214   -3.700265381    3.373333567   Si
        4.272698428    0.000000000    0.000000000   Si
       -2.136349214    3.700265381    6.746667135   Si
        2.511045782    2.203258231    1.129569348   O
        0.652554710   -3.276258553    4.502902914   O
       -3.163600490    1.073000321    7.876236482   O
        2.511045781   -2.203258231   -1.129569348   O
        0.652554708    3.276258553    5.617097788   O
       -3.163600489   -1.073000321    2.243764219   O
    }
    displacement{
      sw_displace_atom = on
      displaced_atom = &lt;ATOM_ID&gt;
      ux =  &lt;Ux&gt;
      uy =  &lt;Uy&gt;
      uz =  &lt;Uz&gt;
    }
  }
  element_list{ #units atomic_mass
    !#tag element  atomicnumber  zeta  dev     mass
          Si        14              0.00  3.5  28.0855
          O          8              0.00  2.0  15.9994
  }
}
wavefunction_solver{
  solvers{
  !#tag   sol    till_n  dts  dte  itr  var  prec cmix submat
          MSD    5    0.2  0.2    1  *    on   2    off
          lm+MSD   20    0.2  1.0  100  tanh on   2    on
          rmm2p   -1    1.0  1.0    *    *  on   1    on
  }
  line_minimization{
    dt_lower_critical = 0.1
    dt_upper_critical = 3.0
  }
  rmm{
    imGSrmm  = 1
    rr_Critical_Value = 1.e-15
    edelta_change_to_rmm = 1.0e-6 hartree
  }
}
charge_mixing{
  mixing_methods{
  !# tag no   method   rmxs   rmxe   itr  var    prec istr  nbmix  update
        1   simple   0.50   0.90  400   tanh    on
        2  broyden2  0.30   0.30  100   *       on     3    5     RENEW
  }
}
</pre></div>
</div>
<p>Berry位相計算のときには、generatorsには単位元のみを指定する。
atomsブロックの後にあるdiplacementブロックで原子変位の指定をする。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displacement</span><span class="p">{</span>
  <span class="n">sw_displace_atom</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">displaced_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ATOM_ID</span><span class="o">&gt;</span>
  <span class="n">ux</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Ux</span><span class="o">&gt;</span>
  <span class="n">uy</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uy</span><span class="o">&gt;</span>
  <span class="n">uz</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uz</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>sw_displace_atomがONに設定されていると、displaced_atomで指定した原子が(ux,uy,uz)方向に変位する。これらの変数には<span class="math notranslate nohighlight">\(&lt;\)</span>ATOM_ID<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Ux<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Uy<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Uz<span class="math notranslate nohighlight">\(&gt;\)</span>を指定しておく。これらは、prep_zeff.plによって置きかえられ、実際に使用する入力が作成される。以上で示したfile_names.dataと&quot;F_INP&quot;をディレクトリtemplate_scfに置く。</p>
<p>ベリー位相計算のfile_names.dataのテンプレートを以下に示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_INP</span>    <span class="o">=</span> <span class="s1">&#39;./nfinput.data&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../../potential.Si&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../../pontetail.O&#39;</span>
<span class="n">F_CHGT</span>   <span class="o">=</span> <span class="s1">&#39;../&lt;SCF_DIR&gt;/nfchgt.data&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>自己無頓着場計算のfile_names.dataとの違いは、’F_CHGT’の指定です。同じ原子配置の自己無頓着場計算のディレクトリから電子密度を読み込むようにする。prep_zeff.plが<span class="math notranslate nohighlight">\(&lt;\)</span>SCF_DIR<span class="math notranslate nohighlight">\(&gt;\)</span>を適切なディレクトリ名に置き換え、実際に使用するfile_names.dataを作成する。</p>
<p>ベリー位相計算の入力&quot;F_INP&quot;の例を以下に示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Control{
  condition = 2 ! {0|1|2|3}|{initial|continuation|fixed_charge|fixed_charge_continuation}
  cpumax = 24 hour    ! {sec|min|hour|day}
  max_iteration = 400001
}
accuracy{
  cke_wavefunctions =  36.00  rydberg  ! cke_wf
  cke_chargedensity = 300.00  rydberg  ! cke_cd
  num_bands = 24
  ksampling{
  }
  smearing{
    method = parabolic ! {parabolic|tetrahedral}
    width  = 0.002 hartree
  }
  xctype = ldapw91
  ek_convergence{
    sw_eval_eig_diff = on
    succession = 3
    num_max_iteration = 200
    delta_eigenvalue = 1.0e-8
    num_extra_bands = 0
  }
  initial_wavefunctions = matrix_diagon !{random_numbers|matrix_diagion}
  matrix_diagon{
    cutoff_wf =  10.0 rydberg  ! cke_wf
  }
}
structure{
  unit_cell_type=Bravais
  unit_cell{
  !#units bohr degree
    a = 9.2, b= 9.2, c= 10.12, alpha=90.0, beta=90.0, gamma=120.0
  }
  symmetry{
    tspace{
      system = h
      generators {
      !#tag rotation tx  ty  tz
            C3+  0   0   2/3
            C212 0   0   0/1
      }
    }
    sw_inversion = 0
  }
  magnetic_state = para  !{para
  atom_list{
  coordinate_system = cartesian
    atoms{
    !#default mobile=no
!#tag   rx             ry             rz            element
       -2.136349214   -3.700265381    3.373333567   Si
        4.272698428    0.000000000    0.000000000   Si
       -2.136349214    3.700265381    6.746667135   Si
        2.511045782    2.203258231    1.129569348   O
        0.652554710   -3.276258553    4.502902914   O
       -3.163600490    1.073000321    7.876236482   O
        2.511045781   -2.203258231   -1.129569348   O
        0.652554708    3.276258553    5.617097788   O
       -3.163600489   -1.073000321    2.243764219   O
    }
    displacement{
      sw_displace_atom = on
      displaced_atom = &lt;ATOM_ID&gt;
      ux =  &lt;Ux&gt;
      uy =  &lt;Uy&gt;
      uz =  &lt;Uz&gt;
    }
  }
  element_list{ #units atomic_mass
   !#tag element  atomicnumber  zeta  dev     mass
         Si        14              0.00  3.5  28.0855
         O          8              0.00  2.0  15.9994
  }
}
wavefunction_solver{
  solvers {
  !#tag   sol till_n  dts  dte itr prec submat
          MSD     10  1.0  1.0 1   on   on
          lm+MSD    20  1.0  1.0 1   on   on
          rmm2p     -1  1.0  1.0 1   on   on
  }
  line_minimization{
    dt_lower_critical = 0.1
    dt_upper_critical = 3.0
  }
  rmm{
    imGSrmm  = 1
    rr_Critical_Value = 1.e-15
    edelta_change_to_rmm = 1.0e-4 hartree
  }
}
Berry_phase{
  sw_berry_phase = on
  g_index = &lt;G_INDEX&gt;
  mesh{ n1 = &lt;MESH_N1&gt;, n2 = &lt;MESH_N2&gt;, J = &lt;MESH_J&gt; }
}
</pre></div>
</div>
<p>Berry位相計算のときには、generatorsには単位元のみを指定する。
displacementブロックは自己無頓着場計算の入力テンプレートと同じように記述する。Berry位相計算を行うには、Berry_phaseブロックで、sw_berry_phaseをONに設定して、g_indexとmeshブロックのn1,n2,Jを設定する。g_index,n1,n2,Jには、<span class="math notranslate nohighlight">\(&lt;\)</span>G_INDEX<span class="math notranslate nohighlight">\(&gt;\)</span>、<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_N1<span class="math notranslate nohighlight">\(&gt;\)</span>、<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_N2<span class="math notranslate nohighlight">\(&gt;\)</span>、<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_J<span class="math notranslate nohighlight">\(&gt;\)</span>を指定しておきます。prep_zeff.plがこれらを適切な値に置き換え、実際に使用する入力が作成される。以上で作成した、file_names.dataと&quot;F_INP&quot;をディレクトリtemplate_berryにおく。</p>
<p>有効電荷を求めるためのベリー位相を計算する入力は、計算入力自動生成Perlスクリプトprep_zeff.plによって生成される。prep_zeff.plを引数を付けずに実行すると、以下のように、実行するときに付加する引数のリストが表示される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prep_zeff</span><span class="o">.</span><span class="n">pl</span> <span class="n">DISPLACEMENT</span> <span class="n">ATOM_LIST</span> <span class="n">MESH1</span> <span class="n">MESH2</span> <span class="n">MESH3</span>
</pre></div>
</div>
<p>DISPLACEMENTには原子変位量をBohr単位で指定する。ここでは、0.05とする。ATOM_LISTにはダブルクオーテーションで、有効電荷を計算したい原子の番号のリストを指定する。等価な原子の有効電荷は対称性で結び付けられるので、二番目のシリコン原子と4番目の酸素原子の有効電荷を計算すればいい。この場合は、ATOM_LISTを&quot;2 4&quot;とする。MESH1,MESAH2,MESH3には、k空間メッシュのパラメーターn1,n2,Jを’n1
n2 J’の並びで入力する。ここでは、&quot;2 2 10&quot;とする。ここで説明した引数の値で、prep_zeff.plを実行する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $PATH_TO_PHASE0/bin/prep_zeff.pl &quot;0.05&quot; &quot;2 4&quot; &quot;2 2 10&quot; &quot;2 2 10&quot; &quot;2 2 10&quot;
</pre></div>
</div>
<p>ベリー位相計算を逐次あるいは並列に実行するPerlスクリプトexec_zeff.plとベリー位相計算に必要な入力ファイルが生成される。その入力ファイルはディレクトリberry_a<span class="math notranslate nohighlight">\(i\)</span>_u<span class="math notranslate nohighlight">\(\alpha\)</span>_g<span class="math notranslate nohighlight">\(\beta\)</span>
(berry_a0_g<span class="math notranslate nohighlight">\(\beta\)</span>)やscf_a<span class="math notranslate nohighlight">\(i\)</span>_u<span class="math notranslate nohighlight">\(\alpha\)</span>
(scf_a0)に作成される。ただし、<span class="math notranslate nohighlight">\(\alpha,\beta = 1,2,3\)</span>である。<span class="math notranslate nohighlight">\(i\)</span>は原子の番号を表し、<span class="math notranslate nohighlight">\(\alpha\)</span>は原子変位の方向を表し(<span class="math notranslate nohighlight">\(1 \rightarrow x,2 \rightarrow y,3 \rightarrow z\)</span>)、<span class="math notranslate nohighlight">\(\beta\)</span>は逆格子ベクトルのインデックスを表す。ベリー位相計算はディレクトリberry_a<span class="math notranslate nohighlight">\(i\)</span>_u<span class="math notranslate nohighlight">\(\alpha\)</span>_g<span class="math notranslate nohighlight">\(\beta\)</span>
(berry_a0_g<span class="math notranslate nohighlight">\(\beta\)</span>)でekcalを実行することで行われる。このekcalの実行に必要な電子密度はディレクトリscf_a<span class="math notranslate nohighlight">\(i\)</span>_u<span class="math notranslate nohighlight">\(\alpha\)</span>
(scf_a0)でphaseを実行することで得られる。
ベリー位相計算の手続きをフローチャートにすると、<a class="reference internal" href="#uvsor-fig5"><span class="std std-numref">図 10.5</span></a> のようになる。</p>
<figure class="align-default" id="uvsor-fig5">
<img alt="../_images/uvsor_image5.svg" src="../_images/uvsor_image5.svg" /><figcaption>
<p><span class="caption-number">図 10.5 </span><span class="caption-text">Berry位相計算のフローチャート</span><a class="headerlink" href="#uvsor-fig5" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>Perlスクリプトexec_zeff.plはこの手続きを自動で行ってくれる。exec_zeff.plを引数を付けずに実行すると、以下のように実行するときに付加する引数のリストが表示される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./exec_zeff.pl PHASE EKCAL PARALLEL {-vpp|-primepower|-sr} |
</pre></div>
</div>
<p>’PHASE’にPHASEのバイナリPATH_TO_PHASE0/bin/phaseを指定し、’EKCAL’にEKCALのバイナリPATH_TO_PHASE0/bin/ekcalを指定する。berryディレクトリの下のディレクトリでphaseとekcalが実行されることを考慮して、実行環境に合うように設定する。’PARALLEL’には同時実行するプログラム(PHASEまたはEKCAL)の数を指定する。exec_zeff.plを以下のように実行し、ベリー位相計算がすべて終了するとberryディレクトリにberry.dataが生成される。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./exec_zeff.pl PATH_TO_PHASE0/bin/phase PATH_TO_PHASE0/bin/ekcal 1
</pre></div>
</div>
<p>MPIプログラム実行時にオプション-machinefileで利用可能なホストをを指定する場合には、machinefileを作成し、作業ディレクトリに置く。</p>
<p>VPP,PRIMEPOWER,SR8000,SR11000といた大型計算機ではMPIプログラムの実行方法が特殊であるので、MPIプログラムの実行方法を変更するオプション-archがある。計算機と-archオプションの値の対応を表8に示す。このオプションは</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">exec_zeff</span><span class="o">.</span><span class="n">pl</span>
 <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phase</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ekcal</span> <span class="mi">1</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">primpower</span>
</pre></div>
</div>
<p>のように最後に付加して用いる。</p>
<p>exec_zeff.plのオプション</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>計算機</p></th>
<th class="head"><p>archの値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VPP5000</p></td>
<td><p>vpp</p></td>
</tr>
<tr class="row-odd"><td><p>PRIMEPOWER HPC500</p></td>
<td><p>primepower</p></td>
</tr>
<tr class="row-even"><td><p>SR11000</p></td>
<td><p>sr</p></td>
</tr>
</tbody>
</table>
<p>バッチ処理システムによっては、使用するCPUリソースを制御することがある。exe_zeff.plは最初とは異なる並列度でmpirunを実行することがある。このときにCPUリソースを制御されると正常に計算できない。このような場合に対応するために、-loadlevelerというオプションがある。
たとえば、SR11000で4並列で実行するならば、以下のようにする。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">exec_zeff</span><span class="o">.</span><span class="n">pl</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phase</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ekcal</span> <span class="mi">4</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">sr</span> <span class="o">-</span><span class="n">loadleveler</span>
</pre></div>
</div>
<p>使用するCPUリソースが変更になった時点でexec_zeff.plは終了する。
exec_zeff.plのコメントに従い、使用するCPUリソースを減らして、
-loadlevelerオプションを外し、ジョブを投入する。</p>
<p>計算が途中で終了したときには、再度exec_zeff.plを実行することにより、継続計算ができる。</p>
<p>Perlが使えない環境では、図3に図示した順序で計算を実行する。その後、各berryディレクトリの
berry.dataを結合したファイルを作成する。このファイルの先頭行に結合したファイルの個数を
書き、berry.dataという名前で保存する。</p>
<p><strong>ベリー位相計算の出力</strong></p>
<p>ベリー位相計算の出力&quot;F_BERRY&quot;はたとえば以下のようになる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>     <span class="mi">1</span>     <span class="mi">2</span>      <span class="mf">0.0</span>                      <span class="mf">0.0</span>                       <span class="mf">0.50000000000000</span><span class="n">D</span><span class="o">-</span><span class="mi">01</span>
<span class="mi">1</span>      <span class="mf">0.63456226917922</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>     <span class="o">-</span><span class="mf">0.20888574273791</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>     <span class="o">-</span><span class="mf">0.32917965405901</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>      <span class="mf">0.25000000000000</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>
<span class="mi">2</span>      <span class="mf">0.63432394408679</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>     <span class="o">-</span><span class="mf">0.20934910658866</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>     <span class="o">-</span><span class="mf">0.33003380756268</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>      <span class="mf">0.25000000000000</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>
<span class="mi">3</span>      <span class="mf">0.63289711025371</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>     <span class="o">-</span><span class="mf">0.19971191896918</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>     <span class="o">-</span><span class="mf">0.31555090531068</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>      <span class="mf">0.25000000000000</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>
<span class="mi">4</span>      <span class="mf">0.63151794421351</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>     <span class="o">-</span><span class="mf">0.20390845515460</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>     <span class="o">-</span><span class="mf">0.32288511895501</span><span class="n">D</span><span class="o">-</span><span class="mi">02</span>      <span class="mf">0.25000000000000</span><span class="n">D</span><span class="o">+</span><span class="mi">00</span>
</pre></div>
</div>
<p>これは二番目のSiが平衡位置から<span class="math notranslate nohighlight">\(x\)</span>方向に0.05
a.u.変位した時のベリー位相のデータである。
berry.dataは出力された&quot;F_BERRY&quot;を結合したファイルで、ファイルの先頭には結合したファイルの数である21が記述されている。</p>
<p id="id47"><strong>格子振動解析</strong></p>
<p>phononディレクトリの上にシリコン原子のポテンシャルpotential.Siと酸素原子のポテンシャルpotential.Oがあるので、格子振動解析を行う時のfile_names.dataは以下のようになる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_INP</span>    <span class="o">=</span> <span class="s1">&#39;./nfinput.data&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../potential.Si&#39;</span>
<span class="n">F_POT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;../potential.O&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>格子振動解析を行う時の入力&quot;F_INP&quot;をつぎに示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Control{
  condition = 0 ! {0|1|2|3}|{initial|continuation|fixed_charge|fixed_charge_continuation}
  cpumax = 24 hour    ! {sec|min|hour|day}
  max_iteration = 60000
}
accuracy{
  cke_wavefunctions =  36.00  rydberg  ! cke_wf
  cke_chargedensity = 300.00  rydberg  ! cke_cd
  num_bands = 32
  ksampling{
    method = monk ! {monk|mesh|file|directin|gamma}
    mesh{ nx=2, ny=2, nz=2}
  }
  smearing{
    method = parabolic ! {parabolic|tetrahedral}
    width  = 0.002 hartree
  }
  xctype = ldapw91
  scf_convergence{
    delta_total_energy = 1.e-10 hartree
    succession   = 3   !default value = 3
  }
  initial_wavefunctions = matrix_diagon !{random_numbers|matrix_diagion}
  matrix_diagon{
    cutoff_wf =  10.0 rydberg  ! cke_wf
  }
}
structure{
  unit_cell_type=Bravais
  unit_cell{
    !#units bohr degree
    a = 9.2, b= 9.2, c= 10.12, alpha=90.0, beta=90.0, gamma=120.0
  }
  symmetry{
    tspace{
      system = h
      generators {
        !#tag rotation tx  ty  tz
              C3+      0   0   2/3
              C212     0   0   0/1
      }
    }
    sw_inversion = 0
  }
  magnetic_state = para  !{para|af|ferro}
  atom_list{
    coordinate_system = cartesian ! {cartesian|internal}
    atoms{
      !#default mobile=no
!#tag   rx             ry             rz            element
       -2.136349214   -3.700265381    3.373333567   Si
        4.272698428    0.000000000    0.000000000   Si
       -2.136349214    3.700265381    6.746667135   Si
        2.511045782    2.203258231    1.129569348   O
        0.652554710   -3.276258553    4.502902914   O
       -3.163600490    1.073000321    7.876236482   O
        2.511045781   -2.203258231   -1.129569348   O
        0.652554708    3.276258553    5.617097788   O
       -3.163600489   -1.073000321    2.243764219   O
    }
    displacement{
      sw_displace_atom = off
      displaced_atom = 0
      ux =  0
      uy =  0
      uz =  0
    }
  }
  element_list{ #units atomic_mass
      #tag element  atomicnumber  zeta  dev  mass
           Si       14            0.00  3.5  28.0855
           O         8            0.00  2.0  15.9994
  }
}
wavefunction_solver{
  solvers{
    !#tag   sol    till_n  dts  dte  itr  var  prec cmix submat
            MSD       5    0.2  0.2    1  *    on   2    off
            lm+MSD   20    0.2  1.0  100  tanh on   2    on
            rmm2p    -1    1.0  1.0    *    *  on   1    on
  }
  line_minimization{
    dt_lower_critical = 0.1
    dt_upper_critical = 3.0
  }
  rmm{
    imGSrmm  = 1
    rr_Critical_Value = 1.e-15
    edelta_change_to_rmm = 1.0e-6 hartree
  }
}
charge_mixing{
  mixing_methods
  !#tag no   method   rmxs   rmxe   itr  var    prec istr  nbmix  update
        1   simple   0.50   0.90  400   tanh    on
        2  broyden2  0.30   0.30  100   *       on     3    5     RENEW
  }
  charge_preconditioning{
    amix =  0.90
    bmix = -1.00
  }
}
Phonon{
  sw_phonon = on
  sw_calc_force = on
  force_calc{
    start = 1, end = 0
  }
  displacement = 0.05
  norder = 1
  sw_polynomial_fit = on
  sw_vibrational_modes = on
  point_group = D3
  electronic_dielectric_constant{
    exx = 2.56011,  eyy = 2.56011,  ezz = 2.57411
    exy = 0.0,      eyz = 0.0,      ezx = 0.0
  }
  k_vector{ kx = 0.0, ky = 0.0, kz = 0.0 }
  sw_lattice_dielectric_tensor = off
}
Postprocessing{
  Polarization{
    sw_bp_property = off
    property = effective_charge
  }
}
</pre></div>
</div>
<p>diplacementブロックがあるときは、sw_diplace_atomがoffになっていることを確認する。振動解析を行うので、elementリストに質量(mass)指定が正しく行われていることを確認する。ここで、示した入力では、「#units
atomic_mass」をelement_listの先頭に記述し、原子質量単位で質量を入力している。Phononブロックに記述される振動解析に関わる入力の詳細は、5.2.1に記載されている。sw_phononとsw_calc_forceをONに指定し、原子変位(diplacement)を0.05に指定する。水晶の結晶点群はD<sub>3</sub>なので、point_groupにD3を設定する。
静的誘電率は格子誘電率と電子誘電率の和なので、electronic_dielectric_constantブロックで、水晶の電子誘電率の計算値<span class="math notranslate nohighlight">\(\epsilon_{\text{xx}} = \epsilon_{\text{yy}} = 2.56011,\ \epsilon_{\text{zz}} = 2.57411\)</span>を指定している。まず、振動解析のみを行うので、sw_lattice_dielectric_tensorをoffに設定する。この入力で振動解析を行った後に、sw_calc_forceをoffに、sw_lattice_dielectric_tensorとsw_bp_propertyをonに設定する。振動解析を行ったディレクトリでもう一度PHASEを実行して、格子誘電率を計算する。こうして得られたPHASEの出力の見方を次節で説明する。</p>
<p id="id48"><strong>ボルン有効電荷の出力</strong></p>
<p>output001に出力される有効電荷計算の結果を以下に示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Calculated</span> <span class="n">electronic</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.00158</span>    <span class="mf">0.00284</span>   <span class="o">-</span><span class="mf">0.00266</span> <span class="p">]</span>
<span class="n">Zel</span> <span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.00001</span>   <span class="o">-</span><span class="mf">0.35464</span>   <span class="o">-</span><span class="mf">0.32379</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.28121</span>   <span class="o">-</span><span class="mf">0.56029</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">7.31546</span>    <span class="mf">0.50495</span>    <span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zel</span> <span class="p">(</span>  <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">8.00477</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">7.72450</span> <span class="p">]</span>
</pre></div>
</div>
<p>タイトル”Calculated electronic effective
charges”の後には、ベリー位相から計算した電子からの有効電荷への寄与が3x3の行列として出力されている。’Zel’の後の括弧の中の数字は、原子の番号である。ボルン有効電荷を計算する原子を2番目と4番目の原子に指定した通りになっている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Calculated</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
            <span class="p">[</span>    <span class="mf">2.99842</span>    <span class="mf">0.00284</span>   <span class="o">-</span><span class="mf">0.00266</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.00001</span>    <span class="mf">3.64536</span>   <span class="o">-</span><span class="mf">0.32379</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.28121</span>    <span class="mf">3.43971</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31546</span>    <span class="mf">0.50495</span>    <span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00477</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
</pre></div>
</div>
<p>タイトル”Calculated effective
charges”の後には、イオンの電荷を加え、ボルン有効電荷が出力されている。Zeffの後の括弧の中の数字はZelと同じ意味である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Symmetrized</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
            <span class="p">[</span>    <span class="mf">2.99842</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zsym</span><span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">3.64536</span>   <span class="o">-</span><span class="mf">0.32379</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.28121</span>    <span class="mf">3.43971</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31546</span>    <span class="mf">0.50495</span>    <span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zsym</span><span class="p">(</span>  <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00477</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
</pre></div>
</div>
<p>タイトル”Symmetrized effective
charges”の後には、原子サイトの対称性を満たすようにしたボルン有効電荷が出力されている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Effective</span> <span class="n">charges</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">atoms</span> <span class="o">---</span>
            <span class="p">[</span>    <span class="mf">3.48362</span>   <span class="o">-</span><span class="mf">0.28013</span>   <span class="o">-</span><span class="mf">0.28041</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.28013</span>    <span class="mf">3.16016</span>    <span class="mf">0.16190</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.24354</span>   <span class="o">-</span><span class="mf">0.14061</span>    <span class="mf">3.43971</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">2.99842</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">3.64536</span>   <span class="o">-</span><span class="mf">0.32379</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.28121</span>    <span class="mf">3.43971</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">3.48362</span>    <span class="mf">0.28013</span>    <span class="mf">0.28041</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.28013</span>    <span class="mf">3.16016</span>    <span class="mf">0.16190</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.24354</span>   <span class="o">-</span><span class="mf">0.14061</span>    <span class="mf">3.43971</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31546</span>    <span class="mf">0.50495</span>    <span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00477</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">2.24657</span>    <span class="mf">0.08613</span>   <span class="o">-</span><span class="mf">0.76609</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.03263</span>   <span class="o">-</span><span class="mf">1.07365</span>    <span class="mf">0.07490</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.76225</span>    <span class="mf">0.14887</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.41830</span>   <span class="o">-</span><span class="mf">0.51083</span>    <span class="mf">0.44791</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.56433</span>   <span class="o">-</span><span class="mf">1.90192</span>    <span class="mf">0.62600</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.51005</span>    <span class="mf">0.58569</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31546</span>   <span class="o">-</span><span class="mf">0.50495</span>   <span class="o">-</span><span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00477</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">2.24657</span>   <span class="o">-</span><span class="mf">0.08613</span>    <span class="mf">0.76609</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.03263</span>   <span class="o">-</span><span class="mf">1.07365</span>    <span class="mf">0.07490</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.76225</span>    <span class="mf">0.14887</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.41830</span>    <span class="mf">0.51083</span>   <span class="o">-</span><span class="mf">0.44791</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.56433</span>   <span class="o">-</span><span class="mf">1.90192</span>    <span class="mf">0.62600</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.51005</span>    <span class="mf">0.58569</span>   <span class="o">-</span><span class="mf">1.72450</span> <span class="p">]</span>
</pre></div>
</div>
<p>タイトル”Effective charges of all
atoms”の後には、計算しなかった等価原子のボルン有効電荷が結晶の対称性を用いて構成され、すべての原子のボルン有効電荷が出力されている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Averaged</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
       <span class="p">[</span>    <span class="mf">0.00055</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zave</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.00055</span>    <span class="mf">0.00000</span> <span class="p">]</span>
       <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">0.00310</span> <span class="p">]</span>
</pre></div>
</div>
<p>タイトル”Averaged effective
charges”の後には、ボルン有効電荷の平均値が出力されている。結晶を構成する原子のボルン有効電荷を足し合わせると、ゼロにならなければならない。ボルン有効電荷の平均値を各原子のボルン有効電荷から引くことによりその性質を満たすように修正することができる。修正されたボルン有効電荷はタイトル”Corrected
effective charges”以下に出力されている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Corrected</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
            <span class="p">[</span>    <span class="mf">3.48307</span>   <span class="o">-</span><span class="mf">0.28013</span>   <span class="o">-</span><span class="mf">0.28041</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.28013</span>    <span class="mf">3.15960</span>    <span class="mf">0.16190</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.24354</span>   <span class="o">-</span><span class="mf">0.14061</span>    <span class="mf">3.44281</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">2.99787</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">3.64480</span>   <span class="o">-</span><span class="mf">0.32379</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.28121</span>    <span class="mf">3.44281</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">3.48307</span>    <span class="mf">0.28013</span>    <span class="mf">0.28041</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.28013</span>    <span class="mf">3.15960</span>    <span class="mf">0.16190</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.24354</span>   <span class="o">-</span><span class="mf">0.14061</span>    <span class="mf">3.44281</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31602</span>    <span class="mf">0.50495</span>    <span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00532</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">2.24713</span>    <span class="mf">0.08613</span>   <span class="o">-</span><span class="mf">0.76609</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.03263</span>   <span class="o">-</span><span class="mf">1.07421</span>    <span class="mf">0.07490</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.76225</span>    <span class="mf">0.14887</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.41886</span>   <span class="o">-</span><span class="mf">0.51083</span>    <span class="mf">0.44791</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.56433</span>   <span class="o">-</span><span class="mf">1.90248</span>    <span class="mf">0.62600</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.51005</span>    <span class="mf">0.58569</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.31602</span>   <span class="o">-</span><span class="mf">0.50495</span>   <span class="o">-</span><span class="mf">0.31818</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.45145</span>   <span class="o">-</span><span class="mf">2.00532</span>   <span class="o">-</span><span class="mf">0.70090</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.25220</span>   <span class="o">-</span><span class="mf">0.73456</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">2.24713</span>   <span class="o">-</span><span class="mf">0.08613</span>    <span class="mf">0.76609</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>   <span class="o">-</span><span class="mf">0.03263</span>   <span class="o">-</span><span class="mf">1.07421</span>    <span class="mf">0.07490</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.76225</span>    <span class="mf">0.14887</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">1.41886</span>    <span class="mf">0.51083</span>   <span class="o">-</span><span class="mf">0.44791</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.56433</span>   <span class="o">-</span><span class="mf">1.90248</span>    <span class="mf">0.62600</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">0.51005</span>    <span class="mf">0.58569</span>   <span class="o">-</span><span class="mf">1.72141</span> <span class="p">]</span>
</pre></div>
</div>
<p><strong>格子振動解析と誘電率の出力</strong></p>
<p>出力ファイル&quot;F_MODE&quot;を次に示す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">primitive</span> <span class="n">lattice</span> <span class="n">vectors</span> <span class="o">---</span>
  <span class="mf">9.2000000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>
 <span class="o">-</span><span class="mf">4.6000000000</span>   <span class="mf">7.9674337148</span>   <span class="mf">0.0000000000</span>
  <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>  <span class="mf">10.1200000000</span>
<span class="o">---</span> <span class="n">Equilibrium</span> <span class="n">position</span> <span class="ow">and</span> <span class="n">mass</span> <span class="n">of</span> <span class="n">each</span> <span class="n">atom</span><span class="o">---</span>
<span class="n">Natom</span><span class="o">=</span>    <span class="mi">9</span>
   <span class="mi">1</span>  <span class="o">-</span><span class="mf">2.1363492140</span>  <span class="o">-</span><span class="mf">3.7002653810</span>   <span class="mf">3.3733335670</span>    <span class="mf">51196.42133</span> <span class="n">Si</span>
   <span class="mi">2</span>   <span class="mf">4.2726984280</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>    <span class="mf">51196.42133</span> <span class="n">Si</span>
   <span class="mi">3</span>  <span class="o">-</span><span class="mf">2.1363492140</span>   <span class="mf">3.7002653810</span>   <span class="mf">6.7466671350</span>    <span class="mf">51196.42133</span> <span class="n">Si</span>
   <span class="mi">4</span>   <span class="mf">2.5110457820</span>   <span class="mf">2.2032582310</span>   <span class="mf">1.1295693480</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
   <span class="mi">5</span>   <span class="mf">0.6525547100</span>  <span class="o">-</span><span class="mf">3.2762585530</span>   <span class="mf">4.5029029140</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
   <span class="mi">6</span>  <span class="o">-</span><span class="mf">3.1636004900</span>   <span class="mf">1.0730003210</span>   <span class="mf">7.8762364820</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
   <span class="mi">7</span>   <span class="mf">2.5110457810</span>  <span class="o">-</span><span class="mf">2.2032582310</span>  <span class="o">-</span><span class="mf">1.1295693480</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
   <span class="mi">8</span>   <span class="mf">0.6525547080</span>   <span class="mf">3.2762585530</span>   <span class="mf">5.6170977880</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
   <span class="mi">9</span>  <span class="o">-</span><span class="mf">3.1636004890</span>  <span class="o">-</span><span class="mf">1.0730003210</span>   <span class="mf">2.2437642190</span>    <span class="mf">29164.94360</span> <span class="n">O</span>
<span class="o">---</span> <span class="n">Vibrational</span> <span class="n">modes</span> <span class="o">---</span>
<span class="n">Nmode</span><span class="o">=</span>   <span class="mi">27</span> <span class="n">Natom</span><span class="o">=</span>    <span class="mi">9</span>
<span class="n">n</span><span class="o">=</span>     <span class="mi">1</span> <span class="n">E</span>   <span class="n">IR</span><span class="o">&amp;</span><span class="n">R</span>     <span class="n">hbarW</span> <span class="o">=</span>  <span class="mf">0.00000000E+00</span> <span class="n">Ha</span> <span class="o">=</span>  <span class="mf">0.00000000E+00</span> <span class="n">eV</span><span class="p">;</span> <span class="n">nu</span><span class="o">=</span>  <span class="mf">0.00000000E+00</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span>
<span class="o">...</span>
<span class="n">n</span><span class="o">=</span>     <span class="mi">4</span> <span class="n">E</span>   <span class="n">IR</span><span class="o">&amp;</span><span class="n">R</span>     <span class="n">hbarW</span> <span class="o">=</span>  <span class="mf">0.58285132E-03</span> <span class="n">Ha</span> <span class="o">=</span>  <span class="mf">0.15860191E-01</span> <span class="n">eV</span><span class="p">;</span> <span class="n">nu</span><span class="o">=</span>  <span class="mf">0.12792108E+03</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span>
    <span class="mi">1</span>  <span class="o">-</span><span class="mf">0.1076861591</span> <span class="o">-</span><span class="mf">0.0492955392</span> <span class="o">-</span><span class="mf">0.0289969411</span>
    <span class="mi">2</span>  <span class="o">-</span><span class="mf">0.0000000001</span>  <span class="mf">0.1372246738</span>  <span class="mf">0.0579965405</span>
    <span class="mi">3</span>   <span class="mf">0.1076861592</span> <span class="o">-</span><span class="mf">0.0492955391</span> <span class="o">-</span><span class="mf">0.0289969411</span>
    <span class="mi">4</span>  <span class="o">-</span><span class="mf">0.0710674524</span>  <span class="mf">0.2294802586</span> <span class="o">-</span><span class="mf">0.2767253313</span>
    <span class="mi">5</span>  <span class="o">-</span><span class="mf">0.0266667306</span> <span class="o">-</span><span class="mf">0.2719065772</span> <span class="o">-</span><span class="mf">0.0591536507</span>
    <span class="mi">6</span>   <span class="mf">0.3853480075</span>  <span class="mf">0.0172331774</span>  <span class="mf">0.3358772210</span>
    <span class="mi">7</span>   <span class="mf">0.0710674522</span>  <span class="mf">0.2294802589</span> <span class="o">-</span><span class="mf">0.2767253316</span>
    <span class="mi">8</span>   <span class="mf">0.0266667309</span> <span class="o">-</span><span class="mf">0.2719065770</span> <span class="o">-</span><span class="mf">0.0591536503</span>
    <span class="mi">9</span>  <span class="o">-</span><span class="mf">0.3853480076</span>  <span class="mf">0.0172331772</span>  <span class="mf">0.3358772209</span>
  <span class="n">Mode</span> <span class="n">effective</span> <span class="n">charge</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">norm</span><span class="p">:</span>

 <span class="n">Z</span><span class="o">=</span>  <span class="mf">0.0000000000</span>   <span class="mf">0.0159080661</span>   <span class="mf">0.0000020096</span> <span class="n">Norm</span><span class="o">=</span>  <span class="mf">0.0159080663</span>
<span class="n">n</span><span class="o">=</span>     <span class="mi">5</span> <span class="n">E</span>   <span class="n">IR</span><span class="o">&amp;</span><span class="n">R</span>     <span class="n">hbarW</span> <span class="o">=</span>  <span class="mf">0.58285208E-03</span> <span class="n">Ha</span> <span class="o">=</span>  <span class="mf">0.15860211E-01</span> <span class="n">eV</span><span class="p">;</span> <span class="n">nu</span><span class="o">=</span>  <span class="mf">0.12792125E+03</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span>
    <span class="mi">1</span>   <span class="mf">0.0750340743</span> <span class="o">-</span><span class="mf">0.1076820548</span>  <span class="mf">0.0502260531</span>
    <span class="mi">2</span>  <span class="o">-</span><span class="mf">0.1114922066</span> <span class="o">-</span><span class="mf">0.0000000001</span>  <span class="mf">0.0000000000</span>
    <span class="mi">3</span>   <span class="mf">0.0750340742</span>  <span class="mf">0.1076820548</span> <span class="o">-</span><span class="mf">0.0502260531</span>
    <span class="mi">4</span>  <span class="o">-</span><span class="mf">0.2462863619</span> <span class="o">-</span><span class="mf">0.2627994415</span>  <span class="mf">0.2280661351</span>
    <span class="mi">5</span>   <span class="mf">0.2551052896</span> <span class="o">-</span><span class="mf">0.2184164183</span> <span class="o">-</span><span class="mf">0.3536922309</span>
    <span class="mi">6</span>  <span class="o">-</span><span class="mf">0.0340512209</span>  <span class="mf">0.1936020463</span>  <span class="mf">0.1256104976</span>
    <span class="mi">7</span>  <span class="o">-</span><span class="mf">0.2462863620</span>  <span class="mf">0.2627994412</span> <span class="o">-</span><span class="mf">0.2280661348</span>
    <span class="mi">8</span>   <span class="mf">0.2551052896</span>  <span class="mf">0.2184164186</span>  <span class="mf">0.3536922309</span>
    <span class="mi">9</span>  <span class="o">-</span><span class="mf">0.0340512205</span> <span class="o">-</span><span class="mf">0.1936020463</span> <span class="o">-</span><span class="mf">0.1256104979</span>
  <span class="n">Mode</span> <span class="n">effective</span> <span class="n">charge</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">norm</span><span class="p">:</span>

 <span class="n">Z</span><span class="o">=</span>  <span class="mf">0.0159051835</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span> <span class="n">Norm</span><span class="o">=</span>  <span class="mf">0.0159051835</span>
<span class="o">...</span>
<span class="o">---</span> <span class="n">Lattice</span> <span class="ow">and</span> <span class="n">static</span> <span class="n">dielectric</span> <span class="n">tensors</span> <span class="o">---</span>
<span class="p">[</span>     <span class="mf">2.1944</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">4.7545</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">2.1944</span>     <span class="mf">0.0000</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">4.7545</span>     <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>     <span class="mf">2.3874</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>     <span class="mf">4.9616</span> <span class="p">]</span>
</pre></div>
</div>
<p>各モードの振動数と固有ベクトルの次にモード有効電荷が出力されている。’Z=’の次に並んでいる三つの値がモード有効電荷のデカルト座標での三成分である。’Norm=’の次の値はこのベクトルの大きさである。最後の三行に格子誘電率が出力されている。右側の3x3の行列が格子誘電率である。左側にはその格子誘電率に電子誘電率を加えた行列が出力されている。これから、格子誘電率は<span class="math notranslate nohighlight">\(\epsilon_{\text{xx}}^{\text{lat}} = \epsilon_{\text{yy}}^{\text{lat}} = 2.2,\ \epsilon_{\text{zz}}^{\text{lat}} = 2.4\)</span>と計算されたことが分かる。そして、静的誘電率が<span class="math notranslate nohighlight">\(\epsilon_{\text{xx}}^{0} = \epsilon_{\text{yy}}^{0} = 4.8,\ \epsilon_{\text{zz}}^{0} = 5.0\)</span>となることが分かる。</p>
</section>
<section id="aln">
<h3><span class="section-number">10.4.3. </span>計算例：AlNの圧電定数の計算<a class="headerlink" href="#aln" title="この見出しへのパーマリンク"></a></h3>
<p id="id49"><strong>計算手順</strong></p>
<p>AlNの圧電定数の計算を例として、圧電定数の計算の仕方を説明する。
まず、圧電定数計算の準備の手順を示す。</p>
<ol class="arabic simple">
<li><p>理論的な平衡格子定数を決定する。</p></li>
<li><p>平衡格子定数において、構造最適化を行う。</p></li>
<li><p>nfdynm.dataの最後に書かれている最適構造でのPHASEの入力を作成する。</p></li>
<li><p>ベリー位相計算を行うディレクトリberryを作成する。</p></li>
<li><p>ディレクトリberryには、Perlスクリプトprep_zeff.plが参照する、入力のテンプレートをディレクトリtemplate_berryとtemplate_scfに置く。入力テンプレートは3.で作成した入力を編集して作成する。</p></li>
<li><p>振動解析を行うディレクトリphononを作成する。</p></li>
<li><p>3.で作成した入力を編集して、振動解析、有効電荷計算と圧電応答解析に必要な記述がある入力を作成し、ディレクトリphononに置く。</p></li>
<li><p>圧電応答解析を行うディレクトリpiezoを作成し、その下にディレクトリclampedとinternalを作成する。</p></li>
<li><p>ディレクトリclampedには、Perlスクリプトprep_piezo.plが参照する、入力のテンプレートをディレクトリtemplate_berryとtemplate_scfに置く。入力テンプレートは3.で作成した入力を編集して作成する。</p></li>
<li><p>ディレクトリinternalには、Perlスクリプトprep_strfrc.plが参照する、入力のテンプレートをtemplate_scfに置く。入力テンプレートは3.で作成した入力を編集して作成する。</p></li>
<li><p>ディレクトリberryで、prep_zeff.plを実行して、自動実行のためのPerlスクリプトexec_zeff.plと実際に使用する入力を作成し、exec_zeff.plを実行して有効電荷計算に必要なベリー位相を計算する。なお、prep_zeff.plはPATH_TO_PHASE0/binにある。</p></li>
<li><p>ディレクトリphononで振動解析のための力計算を行う。</p></li>
<li><p>ディレクトリpiezo/clampedで、prep_piezo.plを実行して、自動実行のためのPerlスクリプトexec_piezo.plと実際に使用する入力を作成し、exec_piezo.plを実行してイオン固定圧電定数の計算に必要なベリー位相を計算する。なお、prep_piezo.plはPATH_TO_PHASE0/binにある。</p></li>
<li><p>ディレクトリpiezo/internalで、prep_strfrc.plを実行して、自動実行のためのPerlスクリプトexec_strfrc.plと実際に使用する入力を作成し、exec_strfrc.plを実行してひずみ-力結合定数の計算に必要な原子に作用する力を計算する。なお、prep_strfrc.plはPATH_TO_PHASE0/binにある。</p></li>
<li><p>ディレクトリphononで振動解析を行い、最後にベリー位相とひずみ-力結合定数を読み込んで圧電定数を計算する。</p></li>
</ol>
<p>1.格子定数決定と2.構造最適化の仕方については、2章や3章を見よ。3.では原子の座標をデカルト座標で入力するので、coordinate_systemをcartesianに設定する。以降の節で、4から15について、順に説明する。</p>
<p id="id50"><strong>ベリー位相計算</strong></p>
<p>入力の作り方と計算方法は格子誘電率計算の場合と同一です。
入力例がディレクトリ <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/AlN/berry</span></code> にあります。
AlNの場合、prep_zeff.plは次のように実行すれば、正しい結果が得られる入力が作成できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prep_zeff</span><span class="o">.</span><span class="n">pl</span> <span class="mf">0.1</span> <span class="s1">&#39;1 3&#39;</span> <span class="s1">&#39;6 6 15&#39;</span> <span class="s1">&#39;6 6 15&#39;</span> <span class="s1">&#39;6 6 15&#39;</span>
</pre></div>
</div>
<p>原子変位を0.1 a.u.とし、１番目と３番目の原子のボルン有効電荷を実際に計算するように指定しています。n1xn2xJはすべての方向で6x6x15としています。あとは、作成されたexec_zeff.plを次のように実行してください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exec_zeff</span><span class="o">.</span><span class="n">pl</span> <span class="n">phase</span> <span class="n">ekcal</span> <span class="mi">1</span>
</pre></div>
</div>
<p>最後の1は１MPI並列で計算することを指定しています。この入力では最大7MPI並列まで指定できます。</p>
<p id="id51"><strong>格子振動解析</strong></p>
<p>入力の作り方と計算方法は格子誘電率計算の場合と同一です。入力例がディレクトリ <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/AlN/phonon</span></code> にあります。この計算が完了した段階で格子誘電率を計算することができます。</p>
<figure class="align-default" id="uvsor-fig6">
<img alt="../_images/uvsor_image6.svg" src="../_images/uvsor_image6.svg" /><figcaption>
<p><span class="caption-number">図 10.6 </span><span class="caption-text">Wurtzite構造のAlN</span><a class="headerlink" href="#uvsor-fig6" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><strong>圧電定数のイオン固定項の計算</strong></p>
<p>ディレクトリberryに作成した入力テンプレートに類似したものをディレクトリpiezo/clampedに作成します。 原子の座標は内部座標で入力します。<a class="reference internal" href="#uvsor-fig6"><span class="std std-numref">図 10.6</span></a> に示す構造のAlNの場合、次のようになります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>atom_list{
     coordinate_system = internal ! {cartesian|internal}
     atoms{
     !#tag   rx            ry            rz            element mobile
       0.3333333333  0.6666666666  0.0000000000  Al      off
       0.6666666666  0.3333333333  0.5000000000  Al      off
       0.3333333333  0.6666666666  0.3820000000  N       on
       0.6666666666  0.3333333333  0.8820000000  N       on
}
</pre></div>
</div>
<p>ボルン有効電荷の計算ではないので、原子を変位させる入力は必要ありません。圧電定数を計算する場合は、結晶を歪ませるための以下に示す入力が必要になります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">strain</span><span class="p">{</span>
  <span class="n">sw_strained_cell</span> <span class="o">=</span> <span class="n">ON</span>
  <span class="n">e11</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E11</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">e22</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E22</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">e33</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E33</span><span class="o">&gt;</span>
  <span class="n">e23</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E23</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">e32</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E32</span><span class="o">&gt;</span>
  <span class="n">e31</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E31</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">e13</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E13</span><span class="o">&gt;</span>
  <span class="n">e12</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E12</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">e21</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E21</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(&lt;\)</span>E11<span class="math notranslate nohighlight">\(&gt;\)</span>などはprep_piezo.plによって置き換えられて、実際に使用される入力が作成されます。ベリー位相計算の入力はボルン有効電荷の計算の場合と同じです。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Berry_phase</span><span class="p">{</span>
  <span class="n">sw_berry_phase</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">g_index</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">G_INDEX</span><span class="o">&gt;</span>
  <span class="n">mesh</span><span class="p">{</span> <span class="n">n1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_J</span><span class="o">&gt;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>prep_piezo.plが読み込む入力テンプレートが作成したら、prep_piezo.plを実行します。
引数を付けずにprep_piezo.plを実行すると、引数の情報が得られます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">prep_piezo</span><span class="o">.</span><span class="n">pl</span> <span class="n">STRAIN</span> <span class="n">INDEX_LIST</span> <span class="n">MESH1</span> <span class="n">MESH2</span> <span class="n">MESH3</span>
</pre></div>
</div>
<p>STRAINはひずみの大きさで、INDEX_LISTは零でないひずみ成分の縮約表示の指数のリストです。MESH1などはprep_zeff.plと同じです。
AlNの場合、次のようにすれば圧電定数の零でないすべての成分<span class="math notranslate nohighlight">\(e_{31},e_{33},e_{15}\)</span>を計算できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">prep_piezo</span><span class="o">.</span><span class="n">pl</span> <span class="mf">0.01</span> <span class="s1">&#39;1 3 5&#39;</span> <span class="s1">&#39;6 6 15&#39;</span> <span class="s1">&#39;6 6 15&#39;</span> <span class="s1">&#39;6 6 15&#39;</span>
</pre></div>
</div>
<p>ひずみの大きさを0.01として、零でないひずみ成分を<span class="math notranslate nohighlight">\(\epsilon_{1},\epsilon_{3},\epsilon_{5}\)</span>としています。
生成されたexec_piezo.plを次のように実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">exec_piezo</span><span class="o">.</span><span class="n">pl</span> <span class="n">phase</span> <span class="n">ekcal</span> <span class="mi">1</span>
</pre></div>
</div>
<p>最後の1は１MPI並列で計算することを指定しています。この入力では最大4MPI並列まで指定できます。</p>
<p>計算が完了するとberry.dataがpiezo/clampledディレクトリに作成されます。それをscf_e0ディレクトリにコピーして、入力nfinput.dataに</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Postprocessing</span><span class="p">{</span>
   <span class="n">polarization</span><span class="p">{</span>
      <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">ON</span>
      <span class="nb">property</span> <span class="o">=</span> <span class="n">piezoelectric_const</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>を書き加えます。conditionを以下のように書き変えて、継続計算を行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Control</span><span class="p">{</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">continuation</span>
<span class="p">}</span>
</pre></div>
</div>
<p>出力output001に次のような圧電定数のイオン固定項の値が出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===</span> <span class="n">Piezoelectric</span> <span class="n">constant</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">===</span>
   <span class="mi">1</span>      <span class="o">-</span><span class="mf">0.0000488692</span>       <span class="mf">0.0000008508</span>       <span class="mf">0.2508631403</span>
   <span class="mi">2</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
   <span class="mi">3</span>       <span class="mf">0.0000015381</span>       <span class="mf">0.0000020659</span>      <span class="o">-</span><span class="mf">0.3977128777</span>
   <span class="mi">4</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
   <span class="mi">5</span>       <span class="mf">0.3321219558</span>       <span class="mf">0.0000004282</span>       <span class="mf">0.0030073377</span>
   <span class="mi">6</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
</pre></div>
</div>
<p>列は左からx,y,z方向に対応してます。この結果は圧電定数のイオン固定項の値が
<span class="math notranslate nohighlight">\(e_{31}^{(0)} = 0.251C/m^{2}\)</span>,
<span class="math notranslate nohighlight">\(e_{33}^{(0)} = - 0.398C/m^{2}\)</span>,
<span class="math notranslate nohighlight">\(e_{15}^{(0)} = 0.332C/m^{2}\)</span>
であることを示しています。零であるべきところが零になっていませんが、それは数値計算誤差によるものです。</p>
<p><strong>圧電定数の内部ひずみ項の計算</strong></p>
<p>prep_strfrc.plが読み込む入力テンプレートtemplate_scfはディレクトclampedに作成したものをコピーして作成してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% cd piezo/internal
% cp -R ../clamped/template_scf .
</pre></div>
</div>
<p>prep_strfrc.plを引数を付けずに実行すると、引数の情報が得られます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% prep_strfrc.pl STRAIN INDEX_LIST
</pre></div>
</div>
<p>引数の意味はprep_piezo.plの引数と同じです。AlNの場合、次のように実行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% prep_strfrc.pl 0.02 &#39;1 3 5&#39;
</pre></div>
</div>
<p>ひずみ-力結合定数を差分で計算するときに、大きさの同じ正と負のひずみで、結晶を変形させます。
そのひずみの大きさを0.02にしています。
生成されたexec_strfrc.plを次のように実行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>exec_strfrc.pl phase 1
</pre></div>
</div>
<p>最後の1は１MPI並列で計算することを指定しています。この入力では最大6MPI並列まで指定できます。</p>
<p>計算が完了すると、ディレクトリpiezo/internalにstrfrc.dataが作成されます。これをディレクトリphononにコピーします。
ディレクトリphononに移り、入力nfinput.dataを次のように書き換えます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phonon</span><span class="p">{</span>
   <span class="n">sw_phonon</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">sw_calc_force</span> <span class="o">=</span> <span class="n">off</span>
   <span class="n">displacement</span> <span class="o">=</span> <span class="mf">0.05</span>
   <span class="n">sw_vibrational_modes</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">sw_internal_strain_piezoelectric_tensor</span> <span class="o">=</span> <span class="n">on</span>
<span class="p">}</span>
<span class="n">Postprocessing</span><span class="p">{</span>
        <span class="n">Polarization</span><span class="p">{</span>
           <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">on</span>
           <span class="nb">property</span> <span class="o">=</span> <span class="n">effective_charge</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>sw_calc_forceをoffとし、sw_internal_strain_piezoelectric_tensorをonとし、sw_bp_propertyをonとします。
phaseを実行して得られる出力output001に次のような圧電定数の内部ひずみ項の値が出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===</span> <span class="n">Internal</span><span class="o">-</span><span class="n">strain</span> <span class="n">piezoelectric</span> <span class="n">tensor</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">===</span>
   <span class="mi">1</span>       <span class="mf">0.0000000000</span>      <span class="o">-</span><span class="mf">0.0001106316</span>      <span class="o">-</span><span class="mf">0.9017585866</span>
   <span class="mi">2</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
   <span class="mi">3</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">2.0047352963</span>
   <span class="mi">4</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
   <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.6775051139</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000006994</span>
   <span class="mi">6</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>       <span class="mf">0.0000000000</span>
</pre></div>
</div>
<p>列は左からx,y,z方向に対応してます。この結果は圧電定数の内部ひずみ項の値<span class="math notranslate nohighlight">\(e_{\text{ij}}^{(1)}\)</span>が
<span class="math notranslate nohighlight">\(e_{31}^{(1)} = - 0.902C/m^{2}\)</span>,
<span class="math notranslate nohighlight">\(e_{33}^{(1)} = 2.005C/m^{2}\)</span>,
<span class="math notranslate nohighlight">\(e_{15}^{(1)} = - 0.678C/m^{2}\)</span>
であることを示しています。零であるべきところが零になっていませんが、それは数値計算誤差によるものです。</p>
<p>AlNの圧電定数の計算結果を表9にまとめて示します。計算結果は実験と一致しています。</p>
<p>AlNの圧電定数(<span class="math notranslate nohighlight">\(\mathbf{C/}\mathbf{m}^{\mathbf{2}}\)</span>)</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>成分</p></th>
<th class="head"><p>イオン固定項</p></th>
<th class="head"><p>内部ひずみ項</p></th>
<th class="head"><p>合計</p></th>
<th class="head"><p>実験値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e_{31}\)</span></p></td>
<td><p>0.251</p></td>
<td><p>-0.902</p></td>
<td><p>-0.651</p></td>
<td><p>-0.58</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(e_{33}\)</span></p></td>
<td><p>-0.398</p></td>
<td><p>2.005</p></td>
<td><p>1.607</p></td>
<td><p>1.55</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e_{15}\)</span></p></td>
<td><p>0.332</p></td>
<td><p>-0.678</p></td>
<td><p>-0.345</p></td>
<td><p>-0.48</p></td>
</tr>
</tbody>
</table>
</section>
<section id="gaas">
<h3><span class="section-number">10.4.4. </span>計算例：GaAs-格子誘電率計算<a class="headerlink" href="#gaas" title="この見出しへのパーマリンク"></a></h3>
<p id="id52"><strong>ベリー位相計算</strong></p>
<p>ベリー位相計算はekcalを用いて行います。</p>
<p>まず、GaAs結晶のボルン有効電荷計算を求めるのに必要とされるベリー位相の計算を行うために、 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/GaAs/berry</span></code> というディレクトリに移ります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">dielectric</span><span class="o">/</span><span class="n">lattice</span><span class="o">/</span><span class="n">GaAs</span><span class="o">/</span><span class="n">berry</span>
</pre></div>
</div>
<p>ここには、ベリー位相計算の入力テンプレートが収められているtemplate_berryとベリー位相計算の入力として与える電子密度を計算するSCF計算の入力テンプレートがtemplate_scfに収められています。これらのファイルは実際に使用する入力を作成するPerlスクリプトprep_zeff.plが参照します。まず、template_scfにあるnfinput.dataには通常のSCF計算の入力と違い、原子をX,Y,Z方向に変位させるための、記述があります。それは、atomsブロックの次に書かれています。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displacement</span><span class="p">{</span>
   <span class="n">sw_displace_atom</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">displaced_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ATOM_ID</span><span class="o">&gt;</span>
   <span class="n">ux</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Ux</span><span class="o">&gt;</span>
   <span class="n">uy</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uy</span><span class="o">&gt;</span>
   <span class="n">uz</span> <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Uz</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>displaced_atomには変位させる原子を指定し、原子の変位ベクトルがデカルト座標のベクトル(ux,uy,uz)と表すものとして、ux,uy,uzに入力します。（ただし、coordinate_systemはcartesianになっているものとします。）displaced_atom,ux,uy,uzには<span class="math notranslate nohighlight">\(&lt;\)</span>ATOM_ID<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Ux<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Uy<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>Uz<span class="math notranslate nohighlight">\(&gt;\)</span>が指定されていますが、これらはcalc_zeff.shが実際に使用する入力を作るときに置き換えますので、必ずこのように入力してください。</p>
<p>template_berryに収められているnfinput.dataを見ると、ベリー位相計算を行うときに必要となるタグが見つかります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Berry_phase</span><span class="p">{</span>
  <span class="n">sw_berry_phase</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">g_index</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">G_INDEX</span><span class="o">&gt;</span>
  <span class="n">mesh</span><span class="p">{</span> <span class="n">n1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_J</span><span class="o">&gt;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>g_indexには逆格子ベクトルのインデックス(1、2、または3)を指定します。ブロックmeshでは、k空間のメッシュをn1,n2,Jで指定します。n1,n2はscf計算の時と同程度にします。Jはそれよりも3倍から5倍大きくとります。g_index,n1,n2,Jには<span class="math notranslate nohighlight">\(&lt;\)</span>G_INDEX<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_N1<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_N2<span class="math notranslate nohighlight">\(&gt;\)</span>,<span class="math notranslate nohighlight">\(&lt;\)</span>MESH_J<span class="math notranslate nohighlight">\(&gt;\)</span>が指定されていますが、これらはprep_zeff.plが実際に使用する入力を作るときに置き換えますので、必ずこのように入力してください。</p>
<p>ディレクトリにPATH_TO_PHASE0/binあるprep_zeff.plを以下のように実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ PATH_TO_PHASE0/bin/prep_zeff.pl 0.05 &#39;1 2&#39; &#39;4 4 20&#39; &#39;4 4 20&#39; &#39;4 4 20&#39;
</pre></div>
</div>
<p>一番目の引数が原子変位量であり、二番目の引数がボルン有効電荷を計算する原子の番号のリストです。最後の三つの引数では、’n1 n2 J’の様にメッシュパラメータ(n1,n2,J)を指定します。最初のメッシュパラメーターは一番目の逆格子ベクトルに対して適用されます。つぎは二番目、その次は三番目というように対応付けられています。上記の様に実行すると、原子変位量は0.05 bohrになり、1番目の原子(Ga)と２番目の原子(As)のボルン有効電荷を計算します。どの逆格子ベクトルに対しても(4,4,20)メッシュパラメーターが適用されます。このPerlスクリプトはtemplate_scfとtemplate_berryを参照して、実際に使用する入力を生成します。実際に使用する入力はscf_a0,...,berry_a0_g1,...といったディレクトリに置かれます。これらのディレクトリでphaseまたはekcalを実行しなければなりませんが、それを行うPerlスクリプトexec_zeff.plが生成されていますので、それを以下のようにして実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./exec_zeff.pl &quot; PATH_TO_PHASE0/bin/phase&quot;  &quot; PATH_TO_PHASE0/bin/ekcal&quot; &quot;1&quot;
</pre></div>
</div>
<p>このスクリプトの実行が終了すると、berry.dataというファイルが生成されます。これには、ボルン有効電荷を計算するためのベリー位相のデータが収められています。これをphononディレクトリにコピーします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cp berry.data ../phonon
</pre></div>
</div>
<p><strong>振動解析および格子誘電率計算</strong></p>
<p>次に、振動解析を行うディレクトリphononに移ります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd ../phonon
</pre></div>
</div>
<p>このディレクトリのPHASEの入力nfinput.dataには振動解析を制御するPhononブロックがあります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phonon</span><span class="p">{</span>
   <span class="n">sw_phonon</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">sw_calc_force</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">displacement</span> <span class="o">=</span> <span class="mf">0.1</span>
   <span class="n">sw_vibrational_modes</span> <span class="o">=</span> <span class="n">on</span>
   <span class="n">point_group</span> <span class="o">=</span> <span class="n">Td</span>
   <span class="n">sw_lattice_dielectric_tensor</span> <span class="o">=</span> <span class="n">off</span>
<span class="p">}</span>
</pre></div>
</div>
<p>GaAsの構造の点群は<span class="math notranslate nohighlight">\(T_{d}\)</span>であるので、point_groupにそれを指定しています。sw_calc_forceとsw_vibrational_modesがともにONになっているので、振動解析のための力計算を行い、それがすべて完了したあとに、振動解析が行われます。</p>
<p>SCF計算行ったときと同じ様にして、PHASEを実行してください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">1</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phase</span>
</pre></div>
</div>
<p>この計算が終わるとforce.dataが出力されます。</p>
<p>先の入力でsw_calc_forceをOFFにし、sw_lattice_dielectric_tensorをONにして、格子誘電率を計算します。
berry.dataを読み込み有効電荷を計算するために、下記の様にsw_effective_chargeをONにしなければいけません。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Postprocessing</span><span class="p">{</span>
  <span class="n">Polarization</span><span class="p">{</span>
    <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">on</span>
    <span class="nb">property</span> <span class="o">=</span> <span class="n">effective_charge</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>先ほどと同様にPHASEを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">1</span> <span class="n">PATH_TO_PHASE0</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phase</span>
</pre></div>
</div>
<p>この計算が終わると、出力ファイルmode.dataに振動解析の結果、モード有効電荷、格子誘電率が出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span>     <span class="mi">6</span> <span class="n">T2</span>  <span class="n">IR</span><span class="o">&amp;</span><span class="n">R</span>
    <span class="n">hbarW</span> <span class="o">=</span>  <span class="mf">0.12314123E-02</span> <span class="n">Ha</span> <span class="o">=</span>  <span class="mf">0.33508432E-01</span> <span class="n">eV</span><span class="p">;</span> <span class="n">nu</span><span class="o">=</span>  <span class="mf">0.27026376E+03</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span>
    <span class="mi">1</span>   <span class="mf">0.7197015024</span>  <span class="mf">0.0000000000</span>  <span class="mf">0.0000000000</span>
    <span class="mi">2</span>  <span class="o">-</span><span class="mf">0.6942836217</span>  <span class="mf">0.0000000000</span>  <span class="mf">0.0000000000</span>
  <span class="n">Mode</span> <span class="n">effective</span> <span class="n">charge</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">norm</span><span class="p">:</span>
 <span class="n">Z</span><span class="o">=</span>  <span class="mf">0.3438767680</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span> <span class="n">Norm</span><span class="o">=</span>  <span class="mf">0.3438767680</span>
<span class="o">---</span> <span class="n">Lattice</span> <span class="ow">and</span> <span class="n">static</span> <span class="n">dielectric</span> <span class="n">tensors</span> <span class="o">---</span>
<span class="p">[</span>     <span class="mf">1.8176</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">1.8176</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">1.8176</span>     <span class="mf">0.0000</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">1.8176</span>     <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>     <span class="mf">1.8176</span> <span class="p">]</span>  <span class="p">[</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>     <span class="mf">1.8176</span> <span class="p">]</span>
</pre></div>
</div>
<p>振動解析だけを行ったときとは違い、各モードの振動数と固有ベクトルの次にモード有効電荷が出力されています。’Z=’の次に並んでいる三つの値がモード有効電荷のデカルト座標での三成分です。’Norm=’の次の値はこのベクトルの大きさです。最後の三行に格子誘電率が出力されています。左側の3x3の行列が格子誘電率です。右側にはその格子誘電率に電子誘電率を加えた行列が出力されます。この計算では、電子誘電率を入力しなかったので、電子誘電率の値はゼロになっています。格子誘電率は1.8と計算されています。</p>
<p>ボルン有効電荷はoutput001に出力されています。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">---</span> <span class="n">Corrected</span> <span class="n">effective</span> <span class="n">charges</span> <span class="o">---</span>
            <span class="p">[</span>    <span class="mf">2.06653</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">2.06653</span>    <span class="mf">0.00000</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span>    <span class="mf">2.06653</span> <span class="p">]</span>
            <span class="p">[</span>   <span class="o">-</span><span class="mf">2.06653</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span> <span class="p">]</span>
<span class="n">Zeff</span><span class="p">(</span>  <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">2.06653</span>    <span class="mf">0.00000</span> <span class="p">]</span>
            <span class="p">[</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">2.06653</span> <span class="p">]</span>
</pre></div>
</div>
<p>’Corrected effective
charges’というタイトル以下に書かれている3x3の行列がボルン有効電荷テンソルです。’Zeff’の後の括弧の中の番号は原子の番号です。Ga原子のボルン有効電荷は2.07と計算され、Asのボルン有効電荷は-2.07と計算されています。</p>
</section>
</section>
<section id="id53">
<h2><span class="section-number">10.5. </span>UVSOR-Berry-Phonon（改良版）<a class="headerlink" href="#id53" title="この見出しへのパーマリンク"></a></h2>
<section id="id54">
<span id="id55"></span><h3><span class="section-number">10.5.1. </span>概要<a class="headerlink" href="#id54" title="この見出しへのパーマリンク"></a></h3>
<p>prep_zeff.pl, prep_piezo.plなどのPerlスクリプトを利用して、格子誘電率や圧電定数の計算を行う方法を説明しました。PHASE/0には、これらのPerlスクリプトを統合し、さらに機能を充実させた新しいスクリプト、berry.plが付属しています。ここでは、このberry.plスクリプトの利用方法を説明します。なお、以前のバージョンからあったprep_zeff.pl, prep_piezo.plなどのPerlスクリプトも変わらず利用することも可能です。</p>
</section>
<section id="id56">
<h3><span class="section-number">10.5.2. </span>使用方法<a class="headerlink" href="#id56" title="この見出しへのパーマリンク"></a></h3>
<p>berry.plスクリプトの利用方法を説明します。基本的な使い方（テンプレート入力データの準備の仕方など）は以前のスクリプトと同様ですが、より柔軟な制御が可能となっています。</p>
<p><strong>準備</strong></p>
<p>berry.plによる計算を行う前に、「テンプレート入力ファイル」を格納したディレクトリを、実行したい計算に</p>
<p>応じて作成する必要があります。以下、ケースごとにテンプレート入力ファイルの作成方法を説明します。</p>
<p>ボルン有効電荷に必要なベリー位相の計算を行う場合</p>
<p>ボルン有効電荷を計算するために必要なベリー位相は、格子誘電率および圧電定数の内部ひずみ項の計算に必要です。対称性から等価でないすべての原子をx,y,zの3方向に変位させ、さらに各々のケースで3つの逆格子ベクトルに対応するベリー位相を計算する必要があります。変位をさせないケースも必要なので、原子数×3×3＋3種類のベリー位相を評価する計算を行います。</p>
<ul class="simple">
<li><p>SCF計算のテンプレートディレクトリ</p></li>
</ul>
<p>まず、通常のPHASEのSCF計算用の入力データを用意します。原子座標は、構造最適化が施されているものを指定します。また、上述のように原子を変位させるので、対称性の指定は行わないようにします。この入力データを、任意のディレクトリ（たとえばtemplate_scf）に置きます。file_names.dataファイルも通常通り置きます。この入力パラメーターファイルに、以下を加えます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span><span class="p">{</span>
  <span class="n">atom_list</span><span class="p">{</span>
    <span class="n">sw_displace_atom</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">displaced_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ATOM_ID</span><span class="o">&gt;</span>
    <span class="n">ux</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Ux</span><span class="o">&gt;</span>
    <span class="n">uy</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Uy</span><span class="o">&gt;</span>
    <span class="n">uz</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Uz</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>&lt;ATOM_ID&gt;, &lt;Ux&gt;, &lt;Uy&gt;,
&lt;Uz&gt;はberry.plによって実際に利用する値に置き換えられるプレースホルダーです。大文字、小文字の違いも含め、この通りに記述する必要があります。</p>
<ul class="simple">
<li><p>ベリー位相計算のテンプレートディレクトリ</p></li>
</ul>
<p>つぎに、ベリー位相計算用のテンプレートディレクトリ（たとえばtemplate_berry）を、SCFテンプレートディレクトリーと同じ階層に作成します。このテンプレートディレクトリの下に、ekcal用の入力データを作成します。通常のekcal入力に、以下を加えます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span><span class="p">{</span>
  <span class="n">atom_list</span><span class="p">{</span>
    <span class="n">sw_displace_atom</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">displaced_atom</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ATOM_ID</span><span class="o">&gt;</span>
    <span class="n">ux</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Ux</span><span class="o">&gt;</span>
    <span class="n">uy</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Uy</span><span class="o">&gt;</span>
    <span class="n">uz</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Uz</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="o">...</span>

<span class="n">Berry_phase</span><span class="p">{</span>
    <span class="n">sw_berry_phase</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">g_index</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">G_INDEX</span><span class="o">&gt;</span>
    <span class="n">mesh</span><span class="p">{</span>
      <span class="n">n1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N1</span><span class="o">&gt;</span>
      <span class="n">n2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N2</span><span class="o">&gt;</span>
      <span class="n">J</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_J</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>&lt;ATOM_ID&gt;, &lt;Ux&gt;, &lt;Uy&gt;, &lt;Uz&gt;はSCF計算の場合と同様です。&lt;G_INDEX&gt;, &lt;MESH_N1&gt;, &lt;MESH_N2&gt;, &lt;MESH_J&gt;は計算実行時にベリー位相計算に必要なメッシュパラメーターに置き換わるプレースホルダーです。</p>
<p>大文字、小文字の違いも含め、この通りに記述する必要があります。</p>
<p>また、file_names.dataは以下のように記述する必要があります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = ‘./nfinp.data’
....
F_CHGT = ‘../&lt;SCF_DIR&gt;/nfchgt.data’
/
</pre></div>
</div>
<p>&lt;SCF_DIR&gt;は、計算実行時に対応するSCF計算ディレクトリ名に置き換わるプレースホルダーです。大文字、小文字の違いも含め、この通りに記述する必要があります。</p>
<p>※ 3D版の場合の注意点</p>
<p>ベリー位相計算は、ekcalではなくphaseを用いて行ってください。この際、以下の要領で“<strong>k</strong>点を一点ずつ処理する”モードにしてください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">control</span><span class="p">{</span>
  <span class="n">fixed_charge_option</span><span class="p">{</span>
    <span class="n">kparallel</span> <span class="o">=</span> <span class="n">one_by_one</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>圧電定数のイオン固定項の計算に必要なベリー位相を計算する場合</p>
<p>圧電定数のイオン固定項を計算する場合、ひずみ下でのベリー位相が必要となります。対称性から0にならないひずみ成分を指定し、各ひずみ成分に対して3つの逆格子ベクトルにそったベリー位相を計算します。必要なベリー位相の数は、参照データとしてひずんでいない系のベリー位相も計算するので、“0にならない成分の数×3+3”です。この計算の場合も、ボルン電荷の場合と同様にSCF計算用およびベリー位相計算用のテンプレートディレクトリーを作成します。</p>
<ul class="simple">
<li><p>SCF計算用のテンプレートディレクトリ</p></li>
</ul>
<p>ボルン電荷の場合は原子を変位させた計算を行いますが、圧電定数のイオン固定項の場合は単位胞をひずませた計算を行います。ボルン有効電荷の場合と同じように、SCF計算用の入力パラメーターファイルをテンプレートディレクトリの下に置き、以下のような設定を施します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span><span class="p">{</span>
  <span class="n">strain</span><span class="p">{</span>
    <span class="n">sw_strained_cell</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">e11</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E11</span><span class="o">&gt;</span>
    <span class="n">e22</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E22</span><span class="o">&gt;</span>
    <span class="n">e33</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E33</span><span class="o">&gt;</span>
    <span class="n">e23</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E23</span><span class="o">&gt;</span>
    <span class="n">e32</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E32</span><span class="o">&gt;</span>
    <span class="n">e31</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E31</span><span class="o">&gt;</span>
    <span class="n">e13</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E13</span><span class="o">&gt;</span>
    <span class="n">e12</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E12</span><span class="o">&gt;</span>
    <span class="n">e21</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E21</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>&lt;E11&gt;, ...  は計算実行時に設定したひずみに置き換わるプレースホルダーです。大文字、小文字の違いも含め、この通りに記述する必要があります。</p>
<ul class="simple">
<li><p>ベリー位相計算のテンプレートディレクトリ</p></li>
</ul>
<p>ボルン有効電荷の場合と同じように、ekcal用の入力パラメーターファイルをベリー位相計算用に作成したテンプレートディレクトリの下に置き、以下のように編集します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span><span class="p">{</span>
  <span class="n">strain</span><span class="p">{</span>
    <span class="n">sw_strained_cell</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">e11</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E11</span><span class="o">&gt;</span>
    <span class="n">e22</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E22</span><span class="o">&gt;</span>
    <span class="n">e33</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E33</span><span class="o">&gt;</span>
    <span class="n">e23</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E23</span><span class="o">&gt;</span>
    <span class="n">e32</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E32</span><span class="o">&gt;</span>
    <span class="n">e31</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E31</span><span class="o">&gt;</span>
    <span class="n">e13</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E13</span><span class="o">&gt;</span>
    <span class="n">e12</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E12</span><span class="o">&gt;</span>
    <span class="n">e21</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E21</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">..</span>
<span class="n">Berry_phase</span><span class="p">{</span>
  <span class="n">sw_berry_phase</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">g_index</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">G_INDEX</span><span class="o">&gt;</span>
  <span class="n">mesh</span><span class="p">{</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N1</span><span class="o">&gt;</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_N2</span><span class="o">&gt;</span>
    <span class="n">J</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">MESH_J</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>&lt;E11&gt;,...はSCF計算の場合と同様です。また、&lt;MESH_N1&gt;, &lt;MESH_N2&gt;,
&lt;MESH_J&gt;はボルン電荷の場合と同様、計算実行時にベリー位相計算のメッシュパラメーターに置き換わります。また、ボルン電荷計算の場合と同様file_names.dataは以下のように作成する必要があります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = ‘./nfinp.data’
....
F_CHGT = ‘../&lt;SCF_DIR&gt;/nfchgt.data’
/
</pre></div>
</div>
<p>圧電定数の内部ひずみ項を計算するために必要な、ひずみ下での原子間力を計算する場合</p>
<p>この場合、作成する必要があるのはSCF計算用のテンプレートディレクトリのみです。テンプレートディレクトリを作成し、その下に通常のSCF計算用の入力パラメーターファイルとfile_names.dataファイルを置きます。SCF計算用の入力パラメータファイルには以下の内容を追加します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span><span class="p">{</span>
  <span class="n">strain</span><span class="p">{</span>
    <span class="n">sw_strained_cell</span> <span class="o">=</span> <span class="n">on</span>
    <span class="n">e11</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E11</span><span class="o">&gt;</span>
    <span class="n">e22</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E22</span><span class="o">&gt;</span>
    <span class="n">e33</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E33</span><span class="o">&gt;</span>
    <span class="n">e23</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E23</span><span class="o">&gt;</span>
    <span class="n">e32</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E32</span><span class="o">&gt;</span>
    <span class="n">e31</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E31</span><span class="o">&gt;</span>
    <span class="n">e13</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E13</span><span class="o">&gt;</span>
    <span class="n">e12</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E12</span><span class="o">&gt;</span>
    <span class="n">e21</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">E21</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>コントロールファイルの記述</strong></p>
<p>berry.plの振る舞いは、コントロールファイルを介して指定します。たとえば、以下のような内容になります（#で始まる文はコメント文）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#overall control
property = zeff
cpumax = 1000
#directories under which the template files reside
template_scf = scf
template_berry = berry
#parameters for the berry-phase calculation
atom_list = 1 3
strain_list = 1 3 5
displacement = 0.1
strain = 0.01
mesh1 = 6 6 15
mesh2 = 6 6 15
mesh3 = 6 6 15

#execution control
np = 4
ndir = 2
ne = 1
nk = 2
ne_b = 2

scf_command = mpiexec –np NP phase ne=NE nk=NK
berry_command = mpiexec –np NP ekcal ne=NE_B

#unit cell info, optional
a_vector = 5.01 0.0 0.0
b_vector = 0.0 5.01 0.0
c_vector = 0.0 0.0 5.01
</pre></div>
</div>
<p>この例からわかるように、パラメータ1つにつき1行を利用し、“キーワード=値”という形式でパラメータを指定します。利用できるキーワードとそのデフォルト値は下記の通り。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>キーワード</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>property</p></td>
<td><p>どのような計算を行うかを指定します。zeff, piezo,
strfrcのいずれかです。zeffを指定
するとボルン有効電荷用のベリー位相計算、piezoを選
ぶと圧電定数のイオン固定項の計算に必要なひずみ下で
のベリー位相計算、strfrcを選ぶと圧電定数の内部ひず
み項の計算に必要なひずみ下での原子間力の計算を行う
ことを指定することになります。デフォルト値はzeff。</p></td>
</tr>
<tr class="row-odd"><td><p>cpumax</p></td>
<td><p>計算の最大時間を秒の単位で指定しま
す。ここで指定した時間よりも経過時間が長い場合、計
算はすみやかに終了します。0以下の値を指定すると、
この条件では計算は終了しません。デフォルト値は-1。</p></td>
</tr>
<tr class="row-even"><td><p>stopcheck</p></td>
<td><p>計算停止条件を満たしているかどうかをチェック
する間隔を秒の単位で指定します。デフォルト値は10。</p></td>
</tr>
<tr class="row-odd"><td><p>length_unit</p></td>
<td><p>コントロールフ
ァイル中に利用される長さの単位を指定します。bohr,
angstrom,
nmのいずれかを指定します。デフォルト値はbohr。</p></td>
</tr>
<tr class="row-even"><td><p>template_scf</p></td>
<td><p>SCF計算用のテンプレートディレクトリーのディレ
クトリ名を指定します。デフォルト値はtemplate_scf。</p></td>
</tr>
<tr class="row-odd"><td><p>template_berry</p></td>
<td><p>ベリー位相計算用のテンプレートディレクトリのディレク
トリ名を指定します。デフォルト値はtemplate_berry。</p></td>
</tr>
<tr class="row-even"><td><p>atom_list</p></td>
<td><p>変位させる原子のIDを、空白区切り
で指定します。property=zeffの場合必須の指定です。</p></td>
</tr>
<tr class="row-odd"><td><p>strain_list</p></td>
<td><p>ひずみ成
分を空白区切りで指定します。対応は、次の通りです。</p>
<p>1 <span class="math notranslate nohighlight">\(\rightarrow\)</span> 11 成分</p>
<p>2 -&gt; 22 成分</p>
<p>3 -&gt; 33 成分</p>
<p>4 -&gt; 23 成分</p>
<p>5 -&gt; 13 成分</p>
<p>6 -&gt; 12 成分</p>
<p>property=piezo および strfrcの場合必須の指定です。</p>
</td>
</tr>
<tr class="row-even"><td><p>displacement</p></td>
<td><p>原子の変位量を指定します。property =
zef
fの場合に指定する必要があります。デフォルト値は0.1
bohr。</p></td>
</tr>
<tr class="row-odd"><td><p>strain</p></td>
<td><p>ひずみの量を指定します。property = piezo および
strfrcの
場合に指定する必要があります。デフォルト値は0.01。</p></td>
</tr>
<tr class="row-even"><td><p>mesh1</p></td>
<td><p>1番目の逆格子ベクトルに沿った
ベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezoの場合必須の指定です。</p></td>
</tr>
<tr class="row-odd"><td><p>mesh2</p></td>
<td><p>2番目の逆格子ベクトルに沿った
ベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezo の場合必須の指定です。</p></td>
</tr>
<tr class="row-even"><td><p>mesh3</p></td>
<td><p>3番目の逆格子ベクトルに沿った
ベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezo の場合必須の指定です。</p></td>
</tr>
<tr class="row-odd"><td><p>np</p></td>
<td><p>MPIプロセス数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>ndir</p></td>
<td><p>デ
ィレクトリー並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ne</p></td>
<td><p>バンド並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>nk</p></td>
<td><p><strong>k</strong>点並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ng</p></td>
<td><p>(三次元版のみ
)<strong>G</strong>点並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>ne_b</p></td>
<td><p>ベリー位相計算時に
おけるバンド並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ng_b</p></td>
<td><p>（三次元版のみ）ベリー位相計算時にお
ける<strong>G</strong>並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>scf_command</p></td>
<td><p>SCF計算の実行方法を指定します。たとえば、</p>
<p>scf_command = mpirun –np NP phase ne=NE nk=NK
(2D版)</p>
<p>scf_command = mpirun -np NP phase ne=NE nk=NK
ng=NG (3D版)</p>
<p>などと指定します。NP, NE, NK,
NGは、計算実行時に上述のnp, ne, nk,
ngに
置き換わります。ただし、ディレクトリ並列の数によっ
ては&quot;あまり&quot;が発生することがあり、その場合はne=NE
nk=NK
ng=NGは
省略されて計算が投入されます。デフォルト値はmpirun
phase
ですが、利用して
いる環境に合わせて適切な指定をする必要があります。</p>
</td>
</tr>
<tr class="row-odd"><td><p>berry_command</p></td>
<td><p>ベリー位相計算の実行方法を指定します。たとえば、</p>
<p>berry_command = mpirun –np NP ekcal ne=NE_B (2D版)</p>
<p>berry_command=mpirun -np NP phase ne=NE_B ng=NG_B
(3D版)</p>
<p>などと指定します。NE_Bは上述のne_bに
、NG_Bはng_bに置き換わります。デフォルト値はmpirun
ekcalです、利用して
いる環境に合わせて適切な指定をする必要があります。</p>
</td>
</tr>
<tr class="row-even"><td><p>a_vector</p></td>
<td><p><em>a</em>軸の三成分を空白区切りで指定し
ます。必須ではありませんが、指定しておくとベリー位
相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
<tr class="row-odd"><td><p>b_vector</p></td>
<td><p><em>b</em>軸の三成分を空白区切りで指定し
ます。必須ではありませんが、指定しておくとベリー位
相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
<tr class="row-even"><td><p>c_vector</p></td>
<td><p><em>c</em>軸の三成分を空白区切りで指定し
ます。必須ではありませんが、指定しておくとベリー位
相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
</tbody>
</table>
<p>※ 3D版の場合、ベリー位相計算にはphaseを使うようにしてください。</p>
<p><strong>並列計算について</strong></p>
<p>並列計算の設定について注意すべき点を挙げます。berry.plによる計算は、通常のバンド、<strong>k</strong>点による並列に加え、複数のディレクトリにまたがって並列計算を行う“ディレクトリ並列”によって行われます。したがって、ディレクトリ並列数（パラメーターndir）を2以上にする場合、SCF計算の場合はnp=ne×nkではなくnp=ndir×ne×nkとなるように、ベリー位相計算の場合はnp=ne_bではなくnp=ne_b×ndirとなるように並列数を調整してください。また、SCF計算とベリー位相計算とでバンド並列数が異なるのは、ベリー位相計算は<strong>k</strong>点並列に未対応のためです。</p>
<p><strong>スクリプトの実行</strong></p>
<p>berry.plを引数なしで実行すると、以下のようなメッセージが得られます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span>
<span class="n">Usage</span> <span class="p">:</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span>
</pre></div>
</div>
<p>第一引数にコントロールファイルのファイル名を指定し、さらに必要に応じてオプションを指定して制御する仕組みになっています。</p>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のみ行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% berry.pl control –-mode=analyze
</pre></div>
</div>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のあと、計算用のディレクトリを作成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">gendir</span>
</pre></div>
</div>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のあと、計算用のディレクトリを作成し、さらに計算を実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">exec</span>
</pre></div>
</div>
<p>--mode オプションのデフォルト値はgendir です。</p>
<p><strong>計算のストップ/リスタート</strong></p>
<p>計算は、以下の条件のいずれかが満たされれば終了します。</p>
<ul class="simple">
<li><p>すべての計算が終了した。</p></li>
<li><p>コントロールファイルのcpumaxで指定した時間を経過時間が超えた。</p></li>
<li><p>作業ディレクトリにstopという名前のファイルが作成された。</p></li>
</ul>
<p>一方、リスタートは特に設定を行わずとも実行されます。計算を最初からやり直したい場合は、まず以下のコマンドによって計算用ディレクトリを削除します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="o">--</span><span class="n">clean</span>
</pre></div>
</div>
<p>リスタートは、通常の状態の場合はディレクトリ単位でのリスタートとなります。すなわち、あるディレクトリにおいて途中で停止された計算は、そのディレクトリにおいて最初から行われます。各ディレクトリにおける計算をも継続して行う場合は、テンプレート入力の入力パラメータファイルに以下の設定を記述する必要があります。</p>
<p>SCF計算の場合：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">control</span><span class="p">{</span>
  <span class="n">condition</span> <span class="o">=</span> <span class="n">automatic</span>
<span class="p">}</span>
</pre></div>
</div>
<p>ベリー位相計算の場合：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">control</span><span class="p">{</span>
  <span class="n">condition</span> <span class="o">=</span> <span class="n">fixed_charge_automatic</span>
<span class="p">}</span>
</pre></div>
</div>
<p>このような設定を施しておくことによって、計算が継続可能かどうかをPHASEが判断し、可能な場合は継続計算を実行するようになります。</p>
<p><strong>注意点</strong></p>
<p>ベリー位相計算用のメッシュ</p>
<p>ベリー位相の計算においては、対象としたい逆格子ベクトルに垂直な面の面積分とに沿った線積分が実行されます。面積分のメッシュをn1
n2で、線積分のメッシュをJで指定します。以外の2つの逆格子ベクトルをとするとをに垂直な面に射影したベクトル、、が面積分のメッシュの見積もりの基準となるのでその長さから決めます。線積分のパラメータは、の長さをもとに決定します。コントロールファイルにa_vector,
b_vector,
c_vectorの指定を行っておくと、この長さの計算（bohr<sup>-1</sup>単位）とそこから見積もられる参考のメッシュパラメーターが以下のように標準出力に出力されます（あくまで参照値であり、得られる結果の妥当性を保証するものではありません）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">b_para1</span><span class="o">|</span><span class="p">,</span> <span class="o">|</span><span class="n">b_para2</span><span class="o">|</span> <span class="ow">and</span> <span class="o">|</span><span class="n">b_perp</span><span class="o">|</span> <span class="p">(</span><span class="ow">in</span> <span class="n">bohr</span><span class="o">^-</span><span class="mi">1</span> <span class="n">units</span><span class="p">)</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">1</span> <span class="p">:</span> <span class="mf">0.172224346323159</span><span class="p">,</span> <span class="mf">0.107572987734313</span><span class="p">,</span> <span class="mf">0.198867545420854</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">2</span> <span class="p">:</span> <span class="mf">0.172224346322494</span><span class="p">,</span> <span class="mf">0.107572987734313</span><span class="p">,</span> <span class="mf">0.198867545421622</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">3</span> <span class="p">:</span> <span class="mf">0.198867545420854</span><span class="p">,</span> <span class="mf">0.198867545421622</span><span class="p">,</span> <span class="mf">0.107572987734313</span>
<span class="n">reference</span> <span class="n">value</span> <span class="k">for</span> <span class="n">mesh</span> <span class="n">parameters</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">and</span> <span class="n">J</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">19</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">2</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">19</span>
<span class="k">for</span> <span class="n">reciprocal</span> <span class="n">vector</span> <span class="n">no</span><span class="o">.</span> <span class="mi">3</span> <span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span>
</pre></div>
</div>
<p>ボルン電荷を計算するときに指定する原子</p>
<p>ボルン電荷の計算を行う際に指定する原子は、対称性から等価でない原子のみを指定します（等価な原子を指定しても結果は正しくでますが、不要な計算を実行することになります）。たとえば、SiO<sub>2</sub>の場合SiとOをどれか1つずつ選びます。</p>
<p>並列数の指定</p>
<p>並列の指定は、以下が満たされるように行ってください。</p>
<p>SCF計算の場合：np = ndir × ne × nk</p>
<p>ベリー位相計算の場合：np = ndir × ne_b</p>
<p>ここでndirは並列に扱いたいディレクトリの数、ne,
nkはそれぞれSCF計算のバンド並列および<strong>k</strong>点並列数、ne_bはベリー位相計算時のバンド並列数です。SCF計算とベリー位相計算でバンド並列数が異なるのは、ベリー位相計算は<strong>k</strong>点並列に未対応のためです。この関係が成立しない場合、berry.plはその旨を出力し終了します。</p>
</section>
<section id="id57">
<h3><span class="section-number">10.5.3. </span>計算例題：AlNの格子誘電率、圧電定数<a class="headerlink" href="#id57" title="この見出しへのパーマリンク"></a></h3>
<p>例題として、AlNを取り上げます。格子誘電率、圧電定数のイオン固定項、圧電定数の内部ひずみ項の計算例を紹介します。各計算は、成すべき手続きが多いので、1ステップずつ解説していきます。なお、ここで利用するサンプルデータは <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/AlN</span></code>
以下にあります。以降の説明は、このディレクトリにいるものとして行います。</p>
<p><strong>AlNの格子誘電率</strong></p>
<p id="id58">格子振動解析</p>
<p>まずは、格子振動解析を行います。phononの下に格子振動解析を行うための入力データがおかれています。この計算は、通常のPHASEの計算と同じように実行します。</p>
<p>ベリー位相の計算</p>
<p>ついで、ベリー位相の計算を行います。利用する入力テンプレートディレクトリは、berry以下にあります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="n">berry</span>
<span class="o">%</span> <span class="n">ls</span>
<span class="n">control</span> <span class="n">template_berry</span> <span class="n">template_scf</span>
</pre></div>
</div>
<p>control がberry.plのコントロールファイルです。template_berry,
template_scfはそれぞれベリー位相およびSCF計算用の入力テンプレートディレクトリです。その内容をみると、入力パラメータファイルには&lt;ATOM_ID&gt;,
&lt;Ux&gt;
など、通常のPHASEの計算では利用しない文字列が確認できます。これらの文字列は、berry.pl実行時に適切な値に置き換わる仕組みになっています。</p>
<p>controlファイルは、以下のような内容です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>property=zeff
cpumax=10000
template_scf = template_scf
template_berry = template_berry
atom_list = 1 3
displacement = 0.1
mesh1 = 6 6 15
mesh2 = 6 6 15
mesh3 = 6 6 15
np = 8
ndir = 2
ne = 2
nk = 2
ne_b = 4
scf_command = mpiexec –n NP $HOME|PHASE020XX.YY|/bin/phase ne=NE nk=NK
berry_command = mpiexec –n NP $HOME|PHASE020XX.YY|/bin/ekcal ne=NE_B
</pre></div>
</div>
<p>このうち、変更する必要があるのは実行制御部分です。np, ndir, ne, nk,
ne_bを利用したいMPIプロセス数に合わせて編集します。また、scf_commandにPHASEの実行方法を、berry_commandにekcalの実行方法を指定します。コントロールファイルの実行制御部分を適切に編集したら、以下の要領でberry.plを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">exec</span>
</pre></div>
</div>
<p>この例では、1番目と3番目の原子（AlとN）を変位させてベリー位相の計算を行うので、合計で7のSCF計算と21のベリー位相の計算が行われます。</p>
<p>計算がすべて終了すると、作業ディレクトリにberry.dataというファイルが作成されますが、これを格子振動解析を行ったディレクトリ（この例ではphonon）にコピーします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cp</span> <span class="n">berry</span><span class="o">.</span><span class="n">data</span> <span class="o">../</span><span class="n">phonon</span>
</pre></div>
</div>
<p>格子誘電率の計算</p>
<p>格子振動解析とベリー位相の計算が終了すれば、格子誘電率を計算するための準備はできています。まず、格子振動解析のディレクトリへ移ります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="o">../</span><span class="n">phonon</span>
</pre></div>
</div>
<p>格子振動解析の入力パラメーターファイルに、以下の変更を施します。</p>
<ul class="simple">
<li><p>phononブロックのsw_calc_forceをoffとする。</p></li>
<li><p>sw_lattice_dielectric_tensorをonとする。</p></li>
<li><p>postprocessingブロックの下のpolarizationブロックの下で、sw_bp_propertyをonとし、propertyをeffective_chargeとする。</p></li>
</ul>
<p>以下に、具体的な変更箇所を示しました。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phonon</span><span class="p">{</span>
  <span class="n">sw_phonon</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">sw_vibrational_modes</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">sw_calc_force</span> <span class="o">=</span> <span class="n">off</span>
  <span class="n">sw_lattice_dielectric_tensor</span> <span class="o">=</span> <span class="n">on</span>
<span class="p">}</span>
<span class="n">postprocessing</span><span class="p">{</span>
  <span class="n">polarization</span><span class="p">{</span>
    <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">on</span>
    <span class="nb">property</span> <span class="o">=</span> <span class="n">effective_charge</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>この状態でPHASEを実行します。この計算の負荷は非常に軽いので、通常並列で実行する必要はありません。</p>
<p>計算結果は、outputxxxファイルとmode.dataファイルに記録されます。outputxxxファイルには、ボルン有効電荷の計算結果が記録されます。最終結果は、---
Corrected effective charges
---のあとに記録されます。今の例の場合、以下のようにすれば計算されたボルン有効電荷を抽出することができます（格子誘電率計算のログファイルをoutput001とします）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% grep –A16 ‘Corrected effective’ output001
--- Corrected effective charges ---
           [ 2.50954 0.00000 0.00000 ]
Zeff( 1) = [ 0.00000 2.50954 0.00000 ]
           [ 0.00000 0.00000 2.64146 ]
           [ 2.50954 0.00000 0.00000 ]
Zeff( 2) = [ 0.00000 2.50954 0.00000 ]
           [ 0.00000 0.00000 2.64146 ]
           [ -2.50954 0.00000 0.00000 ]
Zeff( 3) = [ 0.00000 -2.50954 0.00000 ]
           [ 0.00000 0.00000 -2.64146 ]
           [ -2.50954 0.00000 0.00000 ]
Zeff( 4) = [ 0.00000 -2.50954 0.00000 ]
           [ 0.00000 0.00000 -2.64146 ]
</pre></div>
</div>
<p>格子誘電率は、mode.dataファイルの最後に、以下のような形式で記録されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">Lattice</span> <span class="ow">and</span> <span class="n">static</span> <span class="n">dielectric</span> <span class="n">tensors</span> <span class="o">---</span>
<span class="p">[</span> <span class="mf">3.7058</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="p">]</span> <span class="p">[</span> <span class="mf">3.7058</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span> <span class="mf">0.0000</span> <span class="mf">3.7058</span> <span class="mf">0.0000</span> <span class="p">]</span> <span class="p">[</span> <span class="mf">0.0000</span> <span class="mf">3.7058</span> <span class="mf">0.0000</span> <span class="p">]</span>
<span class="p">[</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mf">4.9314</span> <span class="p">]</span> <span class="p">[</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mf">4.9314</span> <span class="p">]</span>
</pre></div>
</div>
<p>結果が2組記録されます。1つめが格子誘電率の計算結果ですが、2つめは電子系誘電率の記述が入力パラメーターファイルにあった場合それを加えた結果が出力されます。記述がない場合、1つめと同じ結果が出力されます。</p>
<p><strong>AlNの圧電定数のイオン固定項</strong></p>
<p id="id59">ベリー位相の計算</p>
<p>圧電定数のイオン固定項を計算するためには、ひずみ下でのベリー位相が必要です。そのような計算を行うための入力テンプレートディレクトリがpiezo/clamped
以下にあります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="n">piezo</span><span class="o">/</span><span class="n">clamped</span>
<span class="o">%</span> <span class="n">ls</span>
<span class="n">control</span> <span class="n">template_berry</span> <span class="n">template_scf</span>
</pre></div>
</div>
<p>controlがberry.pl用のコントロールファイル、template_berryとtemplate_scfがそれぞれベリー位相計算およびSCF計算用の入力テンプレートディレクトリです。その内容をみると、入力パラメータファイルには&lt;E11&gt;,
&lt;E22&gt;
など、通常のPHASEの計算では利用しない文字列が確認できます。これらの文字列は、berry.pl実行時に適切な値に置き換わる仕組みになっています。</p>
<p>controlファイルの内容は格子誘電率の場合とほぼ同じですが、以下に示すようにstrain_listとstrainの設定がなされている点が異なります。また、atom_listとdisplacementは不要なので消してあります（指定があっても問題はありません）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">property</span><span class="o">=</span><span class="n">zeff</span>
<span class="n">cpumax</span><span class="o">=</span><span class="mi">10000</span>
<span class="o">...</span>
<span class="o">...</span>
<span class="n">strain_list</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">5</span>
<span class="n">strain</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">mesh1</span> <span class="o">=</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">15</span>
<span class="n">mesh2</span> <span class="o">=</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">15</span>
<span class="n">mesh3</span> <span class="o">=</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">15</span>
<span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
<p>実行制御部分の変更は、格子誘電率の場合と同じように行います。</p>
<p>コントロールファイルの実行制御部分を適切に編集したら、以下の要領でberry.plを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">exec</span>
</pre></div>
</div>
<p>この例では、1, 3,
5成分のひずみを与えてベリー位相の計算を行うので、ひずみのない場合もいれて合計で4のSCF計算と12のベリー位相の計算が行われます。</p>
<p>計算がすべて終了すると、作業ディレクトリにberry.dataというファイルが作成されますが、これをscf_e0
ディレクトリ　(berry.plによって作成されたディレクトリの1つ)にコピーします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cp</span> <span class="n">berry</span><span class="o">.</span><span class="n">data</span> <span class="n">scf_e0</span><span class="o">/</span>
</pre></div>
</div>
<p id="id60">圧電定数のイオン固定項の計算</p>
<p>圧電定数のイオン固定項は、scf_e0ディレクトリにおいて行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="n">scf_e0</span>
</pre></div>
</div>
<p>このディレクトリにある入力パラメータファイルに、以下の変更を施します。</p>
<ul class="simple">
<li><p>conditionをcontinuationとする。</p></li>
<li><p>postprocessingブロックの下のpolarizationブロックにおいて、変数sw_bp_propertyをonとし、propertyにpiezoelectric_constを指定する。</p></li>
</ul>
<p>以下に、具体的な変更箇所を示します。赤字で示した部分が変更を要する部分です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Control</span><span class="p">{</span>
  <span class="n">condition</span> <span class="o">=</span> <span class="n">continuation</span>
<span class="p">}</span>
<span class="o">...</span>
<span class="o">...</span>
<span class="n">postprocessing</span><span class="p">{</span>
  <span class="n">polarization</span><span class="p">{</span>
    <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">on</span>
    <span class="nb">property</span> <span class="o">=</span> <span class="n">piezoelectric_const</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>この状態でPHASEを実行します。この計算の負荷は非常に軽いので、通常並列で実行する必要はありません。</p>
<p>結果は、outputxxxファイルに、Piezoelectric
constantのあとに原子単位およびC/m<sup>2</sup>単位で記録されます。以下の要領でこの情報を抽出することができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% grep –A6 ‘Piezoelectric’ output001
=== Piezoelectric constant (a.u.) ===
1 -0.0000008823 0.0000000060 0.0043842675
2 0.0000000000 0.0000000000 0.0000000000
3 -0.0000000034 0.0000000049 -0.0069512745
4 0.0000000000 0.0000000000 0.0000000000
5 0.0058046970 -0.0000000097 0.0000525809
6 0.0000000000 0.0000000000 0.0000000000
=== Piezoelectric constant (C/m^2) ===
1 -0.0000504820 0.0000003433 0.2508448251
2 0.0000000000 0.0000000000 0.0000000000
3 -0.0000001971 0.0000002824 -0.3977155187
4 0.0000000000 0.0000000000 0.0000000000
5 0.3321143610 -0.0000005530 0.0030084060
6 0.0000000000 0.0000000000 0.0000000000
</pre></div>
</div>
<p>0になるべき項が0になっていないのは、数値誤差によるものです。</p>
<p><strong>AlNの圧電定数の内部ひずみ項</strong></p>
<p>ひずみ下における原子間力の計算</p>
<p>圧電定数の内部ひずみ項を計算するためには、ひずみ下における原子間力が必要です。この計算を行うための例題がpiezo/internal
以下にあります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="n">piezo</span><span class="o">/</span><span class="n">internal</span>
<span class="o">%</span> <span class="n">ls</span>
<span class="n">control</span> <span class="n">template_scf</span>
</pre></div>
</div>
<p>このケースではベリー位相の計算は不要なので、テンプレート入力ディレクトリはSCF計算用のもののみとなっています。</p>
<p>template_scfの内容は、イオン固定項の同名のディレクトリと全く同じ内容です。ひずみを与える計算を行うため、入力パラメータファイルにプレースホルダーが記述されています。controlファイルの内容もほぼ同じですが、property変数にはstrfrcが指定されています。また、実行制御部分を環境に合わせて書き換える必要がある点もこれまでと同様です。</p>
<p>実行制御部分を書き換えたら、berry.plを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">berry</span><span class="o">.</span><span class="n">pl</span> <span class="n">control</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">exec</span>
</pre></div>
</div>
<p>3つのひずみ成分に対して、正と負のひずみを与えた計算を実行するので、計6つのSCF計算を実行することになります。</p>
<p>計算が終了したら、strfrc.dataというファイルが作成されます。このデータと格子振動解析の結果を利用して内部ひずみ項を計算します。格子振動解析は、講師誘電率計算の際に実行した結果を再度利用するので、この格子振動解析を行ったディレクトリにstrfrc.dataファイルをコピーします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cp</span> <span class="n">strfrc</span><span class="o">.</span><span class="n">data</span> <span class="o">../../</span><span class="n">phonon</span>
</pre></div>
</div>
<p id="id61">圧電定数の内部ひずみ項の計算</p>
<p>圧電定数の内部ひずみ項は、上述のphononディレクトリにおいて行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">cd</span> <span class="o">../.../</span><span class="n">phonon</span>
</pre></div>
</div>
<p>内部ひずみ項の計算にはここで計算したstrfrc.dataのほかに原子を変位させたときのベリー位相も必要であるが、ベリー位相の計算は格子誘電率計算において実行済みなのでこれを再利用します。</p>
<p>phononディレクトリの入力パラメータファイルに、以下の変更を施します（大体の変更は、格子誘電率計算において施したもの）。</p>
<ul class="simple">
<li><p>phononブロックのsw_calc_forceをoffとする。</p></li>
<li><p>sw_internal_strain_piezoelectric_tensorをonとする。</p></li>
<li><p>sw_lattice_dielectric_tensorをoffとする。</p></li>
<li><p>postprocessingブロックの下のpolarizationブロックの下で、sw_bp_propertyをonとし、propertyをeffective_chargeとする。</p></li>
</ul>
<p>以下に、具体的な変更箇所を示します。赤字で示した部分が変更を要する部分です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phonon</span><span class="p">{</span>
  <span class="n">sw_phonon</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">sw_vibrational_modes</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">sw_calc_force</span> <span class="o">=</span> <span class="n">off</span>
  <span class="n">sw_internal_strain_piezoelectric_tensor</span> <span class="o">=</span> <span class="n">on</span>
  <span class="n">sw_lattice_dielectric_tensor</span> <span class="o">=</span> <span class="n">off</span>
<span class="p">}</span>
<span class="n">postprocessing</span><span class="p">{</span>
  <span class="n">polarization</span><span class="p">{</span>
    <span class="n">sw_bp_property</span> <span class="o">=</span> <span class="n">on</span>
    <span class="nb">property</span> <span class="o">=</span> <span class="n">effective_charge</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>この状態でPHASEを実行します。この計算の負荷は非常に軽いので、通常並列で実行する必要はありません。</p>
<p>結果は、outputxxxファイルに、Internal-strain piezoelectric
tensorのあとに原子単位およびC/m<sup>2</sup>単位で記録されます。以下の要領でこの情報を抽出することができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% grep –A6 ‘Internal-strain’ outputxxx
=== Internal-strain piezoelectric tensor (a.u.) ===
1 0.0000000000 0.0000000000 -0.0157392802
2 0.0000000000 0.0000000000 0.0000000000
3 0.0000000000 0.0000000000 0.0348231759
4 0.0000000000 0.0000000000 0.0000000000
5 -0.0118073889 0.0000000000 0.0000000000
6 0.0000000000 0.0000000000 0.0000000000
=== Internal-strain piezoelectric tensor (C/m^2) ===
1 0.0000000000 0.0000000000 -0.9005191764
2 0.0000000000 0.0000000000 0.0000000000
3 0.0000000000 0.0000000000 1.9923997401
4 0.0000000000 0.0000000000 0.0000000000
5 -0.6755569503 0.0000000000 0.0000000000
6 0.0000000000 0.0000000000 0.0000000000
</pre></div>
</div>
<p>最後に、<a class="reference internal" href="#uvsor-aln-berrypl-table1"><span class="std std-numref">表 10.3</span></a> に圧電定数の計算結果をまとめます。</p>
<table class="docutils align-default" id="uvsor-aln-berrypl-table1">
<caption><span class="caption-number">表 10.3 </span><span class="caption-text">AlNの圧電定数；単位はC/m<sup>2</sup></span><a class="headerlink" href="#uvsor-aln-berrypl-table1" title="このテーブルへのパーマリンク"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>成分</p></th>
<th class="head"><p>イオン固定項</p></th>
<th class="head"><p>内部ひずみ項</p></th>
<th class="head"><p>合計</p></th>
<th class="head"><p>実験値</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>e<sub>31</sub></p></td>
<td><p>0.251</p></td>
<td><p>－0.901</p></td>
<td><p>－0.650</p></td>
<td><p>－0.58</p></td>
</tr>
<tr class="row-odd"><td><p>e<sub>33</sub></p></td>
<td><p>－0.398</p></td>
<td><p>1.992</p></td>
<td><p>1.594</p></td>
<td><p>1.55</p></td>
</tr>
<tr class="row-even"><td><p>e<sub>15</sub></p></td>
<td><p>0.332</p></td>
<td><p>－0.676</p></td>
<td><p>－0.344</p></td>
<td><p>-0.48</p></td>
</tr>
</tbody>
</table>
<p><strong>使用上の注意点</strong></p>
<p>ベリー位相計算は<strong>k</strong>点並列には対応していません。したがって、controlファイルのne_b(三次元版の場合ne_b×ne_g)の値はnpと等しくなるように設定してください。</p>
</section>
</section>
<section id="lr-tddft">
<span id="uvsor-lrtddft-section"></span><h2><span class="section-number">10.6. </span>線形応答時間依存密度汎関数法（LR-TDDFT）<a class="headerlink" href="#lr-tddft" title="この見出しへのパーマリンク"></a></h2>
<section id="id62">
<h3><span class="section-number">10.6.1. </span>機能の概要<a class="headerlink" href="#id62" title="この見出しへのパーマリンク"></a></h3>
<p id="id63"><strong>はじめに</strong></p>
<p>独立粒子近似における励起スペクトル計算では、Kohn-Sham
方程式の解として得られた固有エネルギー準位間の遷移の計算を行います。実際に観測される励起スペクトルは、粒子間の相互作用が働くために、遷移エネルギーやピーク強度が、独立粒子近似における予測とは異なる場合があります。ここでは、その相互作用を線形応答の範囲で取り入れたLinear-response Time-dependent density functional theory (LR-TDDFT)について説明します。</p>
<p><strong>固体への適用</strong></p>
<p>独立粒子近似における、外場の変化に対する系の応答関数<span class="math notranslate nohighlight">\(\chi^{0}\)</span>は</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor122">
<span class="eqno">(10.121)<a class="headerlink" href="#equation-eq-uvsor122" title="この数式へのパーマリンク"></a></span>\[\chi_{\mathbf{G}\mathbf{G}^{'}}^{0}\left( q,\omega \right) = 2\int_{\text{BZ}}^{}\frac{d\mathbf{k}}{\left( 2\pi \right)^{3}}\sum_{n,n^{'}}^{}\left( f_{n\mathbf{k} - \mathbf{q}} - f_{n^{'}\mathbf{k}} \right)\frac{\rho_{n^{'}n\mathbf{k}}^{*}\left( \mathbf{q},\mathbf{G} \right)\rho_{n^{'}n\mathbf{k}}\left( \mathbf{q},\mathbf{G}^{'} \right)}{\omega - \left( \varepsilon_{n^{'}\mathbf{k}} - \varepsilon_{n\mathbf{k} - \mathbf{q}} \right) + i\eta}\]</div>
<p>で表されます。ここで、</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor123">
<span class="eqno">(10.122)<a class="headerlink" href="#equation-eq-uvsor123" title="この数式へのパーマリンク"></a></span>\[\rho_{n^{'}n\mathbf{k}}\left( \mathbf{q},\mathbf{G} \right) = \left\langle n^{'}\mathbf{k}\left| e^{i\left( \mathbf{q} + \mathbf{G} \right) \cdot \mathbf{r}} \right|n\mathbf{k} - \mathbf{q} \right\rangle\]</div>
<p>です。一方、粒子間のクーロン及び交換相互作用を取り入れた場合の応答関数<span class="math notranslate nohighlight">\(\chi\)</span>は、<span class="math notranslate nohighlight">\(\chi^{0}\)</span>とDyson方程式</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor124">
<span class="eqno">(10.123)<a class="headerlink" href="#equation-eq-uvsor124" title="この数式へのパーマリンク"></a></span>\[\chi = \chi^{0} + \chi^{0}\left( \nu + f_{\text{xc}} \right)\chi\]</div>
<p>の関係にあります。ここで、<span class="math notranslate nohighlight">\(\nu\)</span>はクーロンカーネルで、</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor125">
<span class="eqno">(10.124)<a class="headerlink" href="#equation-eq-uvsor125" title="この数式へのパーマリンク"></a></span>\[\nu_{\mathbf{G}}\left( \mathbf{q} \right) = \frac{4\pi}{\left| \mathbf{q} + \mathbf{G} \right|^{2}}\]</div>
<p>で表されます。一方、<span class="math notranslate nohighlight">\(f_{\text{xc}}\)</span>は交換相関カーネルですが、具体的な表式は定まっておらずいくつかのモデルが提案されています。以下に採用したモデルを記します。</p>
<ul class="simple">
<li><p>RPA ( Random Phase Approximation )</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-uvsor126">
<span class="eqno">(10.125)<a class="headerlink" href="#equation-eq-uvsor126" title="この数式へのパーマリンク"></a></span>\[f_{\text{xc}} = 0\]</div>
<ul class="simple">
<li><p>LRC( Long range correction )</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-uvsor127">
<span class="eqno">(10.126)<a class="headerlink" href="#equation-eq-uvsor127" title="この数式へのパーマリンク"></a></span>\[f_{\text{xc}} = - \frac{\alpha}{\left| \mathbf{q} + \mathbf{G} \right|^{2}}\]</div>
<p>さて、実験と比較可能な量としては巨視的な誘電関数<span class="math notranslate nohighlight">\(\varepsilon_{M}\)</span>があります。これは、</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor128">
<span class="eqno">(10.127)<a class="headerlink" href="#equation-eq-uvsor128" title="この数式へのパーマリンク"></a></span>\[\varepsilon_{M}\left( \omega \right) = 1 - \nu_{0}{\overline{\chi}}_{\mathbf{G} = \mathbf{G}^{'} = 0}\left( \omega \right)\]</div>
<p>を用いて算出します。なお、<span class="math notranslate nohighlight">\(\overline{\chi}\)</span>は<span class="math notranslate nohighlight">\(\chi\)</span>に似た応答関数で、以下のようにクーロンカーネルの<span class="math notranslate nohighlight">\(\mathbf{G} = 0\)</span>成分を除去した関数です。</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor129">
<span class="eqno">(10.128)<a class="headerlink" href="#equation-eq-uvsor129" title="この数式へのパーマリンク"></a></span>\[\overline{\chi} = \chi_{0} + \chi_{0}\left( \overline{\nu} + f_{\text{xc}} \right)\overline{\chi}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor130">
<span class="eqno">(10.129)<a class="headerlink" href="#equation-eq-uvsor130" title="この数式へのパーマリンク"></a></span>\[\begin{split}\overline{\nu}\left( \mathbf{q} \right) = \left\{
\begin{matrix}
\nu_{\mathbf{G}}\left( \mathbf{q} \right) &amp; \mathbf{G} \neq 0 \\
                                        0 &amp; \mathbf{G} = 0
\end{matrix} \right.\end{split}\]</div>
<p><strong>孤立系への適用</strong></p>
<p>分子など孤立系では、<span class="math notranslate nohighlight">\(f_{\text{xc}}\)</span>として以下のようなモデルを採用しました。</p>
<ul class="simple">
<li><p>ALDA ( Adiabatic Local Density Approximation )</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-uvsor131">
<span class="eqno">(10.130)<a class="headerlink" href="#equation-eq-uvsor131" title="この数式へのパーマリンク"></a></span>\[f_{\text{xc}}\left( \mathbf{r},\mathbf{r}^{'} \right) = \delta\left( r - r^{'} \right)\frac{\partial\nu_{\text{xc}}\left( \rho\left( \mathbf{r} \right) \right)}{\partial\rho}\]</div>
<p>この<span class="math notranslate nohighlight">\(f_{\text{xc}}\)</span>を実空間メッシュ上で評価し、フーリエ変換して得られた<span class="math notranslate nohighlight">\(f_{\text{xc}}\left( \mathbf{G},\mathbf{G}^{'} \right)\)</span>を式 <a class="reference internal" href="#equation-eq-uvsor129">(10.128)</a> に代入すれば、誘電関数等のスペクトルが計算できます。しかし、このフーリエ変換の際に、電荷密度が小さい領域で精度が悪くなることが知られています。そこで、本プログラムでは、以下の様な手法を用いています。
　まず、相互作用のない電子空孔グリーン関数<span class="math notranslate nohighlight">\(L^{0}\)</span>を</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor132">
<span class="eqno">(10.131)<a class="headerlink" href="#equation-eq-uvsor132" title="この数式へのパーマリンク"></a></span>\[\lim_{\mathbf{q} \rightarrow 0}\chi_{\mathbf{\text{GG}}^{'}}^{0}\left( q,\omega \right) = - i\sum_{nn^{'}}^{}{\sum_{\mathbf{k}}^{}{\lim_{\mathbf{q} \rightarrow 0}\left\lbrack \rho_{n^{'}n\mathbf{k}}^{*}\left( \mathbf{q},\mathbf{G} \right)\rho_{n^{'}n\mathbf{k}}\left( \mathbf{q},\mathbf{G}^{'} \right) \right\rbrack}}L_{nn^{'}\mathbf{k}}^{0}(\omega)\]</div>
<p>により定義します。同様に、相互作用を含んだ電子空孔グリーン関数<span class="math notranslate nohighlight">\(\overline{L}\)</span>を</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor133">
<span class="eqno">(10.132)<a class="headerlink" href="#equation-eq-uvsor133" title="この数式へのパーマリンク"></a></span>\[\lim_{\mathbf{q} \rightarrow 0}{\overline{\chi}}_{\mathbf{G}\mathbf{G}^{'}}\left( q,\omega \right) = - i\sum_{nn^{'}}^{}{\sum_{mm^{'}}^{}{\sum_{\mathbf{k},\mathbf{k}^{'}}^{}{\lim_{\mathbf{q} \rightarrow 0}\left\lbrack \rho_{n^{'}n\mathbf{k}}^{*}\left( \mathbf{q},\mathbf{G} \right)\rho_{m^{'}m\mathbf{k}^{'}}\left( \mathbf{q},\mathbf{G}^{'} \right) \right\rbrack}}}{\overline{L}}_{nn^{'}\mathbf{k},mm^{'}\mathbf{k}^{'}}\left( \omega \right)\]</div>
<p>で定義します。<span class="math notranslate nohighlight">\(\overline{L}\)</span>と<span class="math notranslate nohighlight">\(L^{0}\)</span>
の関係は、Bethe-Salpeter 方程式</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor134">
<span class="eqno">(10.133)<a class="headerlink" href="#equation-eq-uvsor134" title="この数式へのパーマリンク"></a></span>\[{\overline{L}}_{nn^{'}\mathbf{k},m^{'}m\mathbf{k}^{'}}\left( \omega \right) = L_{nn^{'}\mathbf{k}}^{0}\left( \omega \right)\left\lbrack \delta_{\text{nm}}\delta_{n^{'}m^{'}}\delta_{\mathbf{\text{kk}}^{'}} + i\sum_{ss^{'}}^{}{\sum_{\mathbf{k}_{1}}^{}\Xi_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}}}{\overline{L}}_{ss^{'}\mathbf{k}_{1},mm^{'}\mathbf{k}^{'}}\left( \omega \right) \right\rbrack\]</div>
<p>で表されます。ここで、</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor135">
<span class="eqno">(10.134)<a class="headerlink" href="#equation-eq-uvsor135" title="この数式へのパーマリンク"></a></span>\[\Xi_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}} = - V_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}} - K_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor136">
<span class="eqno">(10.135)<a class="headerlink" href="#equation-eq-uvsor136" title="この数式へのパーマリンク"></a></span>\[V_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}} = \frac{1}{\Omega N_{\mathbf{k}}}\sum_{\mathbf{G} \neq 0}^{}\rho_{nn^{'}\mathbf{k}}\left( \mathbf{q} = 0,\mathbf{G} \right)\rho_{ss^{'}\mathbf{k}_{1}}^{*}\left( \mathbf{q} = 0,\mathbf{G} \right)\nu\left( \mathbf{G} \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-uvsor137">
<span class="eqno">(10.136)<a class="headerlink" href="#equation-eq-uvsor137" title="この数式へのパーマリンク"></a></span>\[K_{nn^{'}\mathbf{k}ss^{'}\mathbf{k}_{1}} = 2\int_{}^{}\int_{}^{}d\mathbf{r}d\mathbf{r}^{'}\phi_{n\mathbf{k}}^{*}\left( \mathbf{r} \right)\phi_{n^{'}\mathbf{k}}\left( \mathbf{r} \right)f_{\text{xc}}\left( \mathbf{r},\mathbf{r}^{'} \right)\phi_{s^{'}\mathbf{k}^{'}}\left( \mathbf{r}^{'} \right)\phi_{s\mathbf{k}^{'}}^{*}\left( \mathbf{r}^{'} \right)\]</div>
<p>です。なお、<span class="math notranslate nohighlight">\(\Omega\)</span>は系の体積、<span class="math notranslate nohighlight">\(N_{\mathbf{k}}\)</span>は<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点サンプリングの数です。</p>
<p>さて、<span class="math notranslate nohighlight">\(f_{\text{xc}}\)</span>としてALDAを用いることから、実際の計算では式 <a class="reference internal" href="#equation-eq-uvsor137">(10.136)</a> の積分は実空間メッシュ上での1重積分になります。また、<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点として<span class="math notranslate nohighlight">\(\Gamma\)</span>点のみを使用することから、式 <a class="reference internal" href="#equation-eq-uvsor132">(10.131)</a> - <a class="reference internal" href="#equation-eq-uvsor134">(10.133)</a> の<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>点に関する和は不要となります。</p>
<p>さて、孤立系でしばしば計測される光吸収断面積 ( Photo Adsorption Cross
Section, PACS ) は、</p>
<div class="math notranslate nohighlight" id="equation-eq-uvsor138">
<span class="eqno">(10.137)<a class="headerlink" href="#equation-eq-uvsor138" title="この数式へのパーマリンク"></a></span>\[\sigma\left( \omega \right) = \frac{\Omega}{c}\omega\text{Im}\left\lbrack \varepsilon_{M}\left( \omega \right) \right\rbrack\]</div>
<p>表されます。ここで、誘電関数<span class="math notranslate nohighlight">\(\varepsilon_{M}\)</span>は、式 <a class="reference internal" href="#equation-eq-uvsor134">(10.133)</a> により得られた<span class="math notranslate nohighlight">\(\overline{L}\)</span>を式 <a class="reference internal" href="#equation-eq-uvsor128">(10.127)</a> 及び <a class="reference internal" href="#equation-eq-uvsor133">(10.132)</a> に代入することにより得ることが出来ます。</p>
</section>
<section id="id64">
<h3><span class="section-number">10.6.2. </span>入力ファイルの記述<a class="headerlink" href="#id64" title="この見出しへのパーマリンク"></a></h3>
<p>LR-TDDFT法解析プログラムを利用するためには、次の設定が必要です。</p>
<p id="control-1"><strong>controlブロック</strong></p>
<p>まず、phaseを用いて事前にSCF計算を行い、系の電荷密度を求めておきます。LR-TDDFTはその電荷密度をもとに計算を行います。このため、controlブロック内でcondition
= fixed_charge
として下さい。また、UVSORと同様に、局所ポテンシャルが軌道ポテンシャルであるTM
型擬ポテンシャルを用いる場合、 use_additional_projector = on
として下さい。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">control</span><span class="p">{</span>
   <span class="n">condition</span> <span class="o">=</span> <span class="n">fixed_charge</span>
   <span class="n">cpumax</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">day</span>
   <span class="n">max_iteration</span> <span class="o">=</span> <span class="mi">600</span>
   <span class="n">use_additional_projector</span><span class="o">=</span><span class="n">on</span>
<span class="p">}</span>
</pre></div>
</div>
<p id="accuracy-1"><strong>accuracyブロック</strong></p>
<p>accucuracy
ブロック内では、UVSORと同様に、固有値計算のためのパラメータ設定を行います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">{</span>
    <span class="o">...</span>
    <span class="n">ek_convergence</span><span class="p">{</span>
      <span class="n">num_extra_bands</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">num_max_iteration</span> <span class="o">=</span> <span class="mi">2000</span>
      <span class="n">sw_eval_eig_diff</span> <span class="o">=</span> <span class="n">on</span>
      <span class="n">delta_eigenvalue</span> <span class="o">=</span> <span class="mf">1.e-6</span> <span class="n">rydberg</span>
      <span class="n">succession</span>   <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>structureブロック</strong></p>
<p>k点に関する和を、ブリルアンゾーン内の、既約化されていない全てのk点を用いて行うため、E以外の対称性をオフにします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>structure{
  symmetry{
    method = manual
    tspace{
      lattice_system = primitive
      generators{
       !#tag rotation tx  ty  tz
                E     0   0   0
      }
    }
  }
}
</pre></div>
</div>
<p><strong>spectrumブロック</strong></p>
<p>LR-TDDFT
によるスペクトル計算に関するパラメータ設定を行います。以下、ブロック内で使用可能な変数について説明します。[　]内の値はデフォルト値で、無指定の場合に使用されます。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type変数 [OPTICS]</p></th>
<th class="head"><p>OPTICS、PACSが使用可能です。</p>
<p>OPTICSは
誘電関数計算を行い、主として固体
に使用します。PACSは光吸収断面積
で、分子など孤立系に使用します。</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>momentum_transferブロック</p></td>
<td><p>momentum transfer
ベ
クトルに関する記述を行うブロック</p></td>
</tr>
<tr class="row-even"><td><p>deltaq　変数 [1.0E-3]</p></td>
<td><p>momentum transferベクトルq
の大きさを指定し
ます。単位はÅ<span class="math notranslate nohighlight">\({}^{- 1}\)</span>
です。</p></td>
</tr>
<tr class="row-odd"><td><p>nx, ny, nz　変数 [0.0, 0.0, 1.0]</p></td>
<td><p>momentum transferベクトルq
の方向を指定します。</p></td>
</tr>
<tr class="row-even"><td><p>LongWaveApprox　変数 [ON]</p></td>
<td><p>ON、OFFが使用可能。長波長近似 (
q<span class="math notranslate nohighlight">\(\rightarrow\)</span>0 )
を使
用する場合には、ONを指定します。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>tddftブロック</p></td>
<td><p>tddftに関
するパラメータを設定するブロック</p></td>
</tr>
<tr class="row-odd"><td><p>sw_tddft　変数 [OFF]</p></td>
<td><p>ON、OFFが使用可能
。LR-TDDFT機能を使用する場合には
ON を指定します。</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>solver　ブロック</p></td>
<td><p>使
用するソルバーを設定するブロック</p></td>
</tr>
<tr class="row-even"><td><p>equation 変数 [DYSON]</p></td>
<td><p>DYSON、BSが使用可能。
DYSON様方程式を使用する場合には
DYSON を、Bethe-Salpeter
様方程式を使用する場合には BS
を指定します。後者は、分
子など孤立系の場合に使用します。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>XC_Kernel　ブロック</p></td>
<td><p>exchange-correlation kernel
の
タイプ及び関連変数を設定します。</p></td>
</tr>
<tr class="row-odd"><td><p>kernel_type 変数 [RPA]</p></td>
<td><p>RPA、LRC、ALDA-Rが指定可能で
す。RPAは、exchange-correlation
kernel
を考慮しないモデルで
す。LRCは、固体などの周期系で、
長距離相互作用の補正を取り入れた
い場合に使用します。ALDA-Rは、分
子など孤立系の場合に使用します。</p></td>
</tr>
<tr class="row-even"><td><p>LRC_alpha 変数 [1.0]</p></td>
<td><p>kernel
変数に
LRCを使用した場合に設定します。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Coulomb_Kernelブロック</p></td>
<td><p>coulomb
kernelに関する変数を設定します。</p></td>
</tr>
<tr class="row-odd"><td><p>sw_NLF 変数 [OFF]</p></td>
<td><p>ON、OFFが使用可能。Local field
(<span class="math notranslate nohighlight">\(|\mathbf{G}|&gt;0\)</span> )
を無視する近似
を行う場合には、ONを指定します。</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Expansionブロック</p></td>
<td><p>展開に使用するGベ
クトルに関する設定を行うブロック</p></td>
</tr>
<tr class="row-even"><td><p>NumGVec 変数 [100]</p></td>
<td><p>波数ベクトルの数を設定します。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>energyブロック</p></td>
<td><p>スペクトルを計算する
エネルギー範囲を指定するブロック</p></td>
</tr>
<tr class="row-odd"><td><p>low, high,step 変数</p></td>
<td><p>low、highにはエ
ネルギーの最小及び最大値、stepに
はエネルギーの間隔を入力します。</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>BZ_Integration ブロック</p></td>
<td><p>ブリルアンゾーン内
の積分に関する設定を行うブロック</p></td>
</tr>
<tr class="row-even"><td><p>width 変数 [1.0E-4 hartree]</p></td>
<td><p>Lorentzian の幅を指定します。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>band_gap_correction ブロック</p></td>
<td><p>バンドギャッ
プ補正を顕わに指定する場合に設定
します。詳細はUVSORに準じます。</p></td>
</tr>
<tr class="row-odd"><td><p>scissor_operator 変数 [0.0]</p></td>
<td><p>ギャップの増分値を指定します。</p></td>
</tr>
</tbody>
</table>
<p>以下は記入例です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="p">{</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">optics</span>
    <span class="n">momentum_transfer</span><span class="p">{</span>
      <span class="n">deltaq</span> <span class="o">=</span> <span class="mf">1.0E-3</span>
      <span class="n">nx</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="mf">0.9</span>
      <span class="n">LongWaveApprox</span> <span class="o">=</span> <span class="n">ON</span>
    <span class="p">}</span>
    <span class="n">tddft</span><span class="p">{</span>
      <span class="n">sw_tddft</span> <span class="o">=</span> <span class="n">ON</span>
      <span class="n">solver</span><span class="p">{</span>
        <span class="n">equation</span> <span class="o">=</span> <span class="n">DYSON</span>
      <span class="p">}</span>
      <span class="n">XC_Kernel</span><span class="p">{</span>
        <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">LRC</span>
        <span class="n">LRC_alpha</span> <span class="o">=</span> <span class="mf">0.2</span>
      <span class="p">}</span>
      <span class="n">Coulomb_Kernel</span><span class="p">{</span>
        <span class="n">sw_NLF</span> <span class="o">=</span> <span class="n">OFF</span>
      <span class="p">}</span>
      <span class="n">Expansion</span>
        <span class="n">NumGVec</span> <span class="o">=</span> <span class="mi">80</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">energy</span><span class="p">{</span>
      <span class="n">low</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="n">eV</span>
      <span class="n">high</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="n">eV</span>
      <span class="n">step</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="n">eV</span>
    <span class="p">}</span>
    <span class="n">BZ_integration</span><span class="p">{</span>
      <span class="n">width</span> <span class="o">=</span>  <span class="mf">0.15</span> <span class="n">eV</span>
    <span class="p">}</span>
    <span class="n">band_gap_correction</span><span class="p">{</span>
      <span class="n">scissor_operator</span> <span class="o">=</span> <span class="mf">0.6</span><span class="n">d0</span> <span class="n">eV</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id65">
<h3><span class="section-number">10.6.3. </span>計算の実行方法<a class="headerlink" href="#id65" title="この見出しへのパーマリンク"></a></h3>
<p>phaseを用いて事前にSCF計算を行い、系の電荷密度を計算します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">NP</span> <span class="n">phase</span>
</pre></div>
</div>
<p>LR-TDDFTの計算を行うには、以下のコマンドを使用します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">NP</span> <span class="n">tdlrmain</span>
</pre></div>
</div>
<p>ここで、NPはMPIプロセス数です。</p>
</section>
<section id="id66">
<h3><span class="section-number">10.6.4. </span>出力ファイル<a class="headerlink" href="#id66" title="この見出しへのパーマリンク"></a></h3>
<p>スペクトルデータは、spectrum.data
に出力されます。以下のような書式をとります。</p>
<ol class="upperalpha simple">
<li><p>type変数でOPTICSを指定した場合</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#                 Optical spectrum</span>
<span class="c1">#              NonInteracting               Interacting</span>
<span class="c1">#      Energy[eV]        Real        Imaginary         Real        Imaginary</span>
<span class="mf">0.000000</span>       <span class="mf">8.626260</span>       <span class="mf">0.252860</span>       <span class="mf">9.678273</span>       <span class="mf">0.327540</span>
<span class="mf">0.050000</span>       <span class="mf">8.627214</span>       <span class="mf">0.252961</span>       <span class="mf">9.679507</span>       <span class="mf">0.327682</span>

<span class="o">....................................................................</span>
</pre></div>
</div>
<p>第1カラムはエネルギー値です。第2、3カラムは独立粒子近似における誘電関数を出力しています。なお、Real
及び Imaginary
はそれぞれ、実部および虚部に対応します。また、第4、5カラムはCoulomb及び
exchange-correlation kernel を取り入れた誘電関数です。</p>
<ol class="upperalpha simple" start="2">
<li><p>type変数でOPTICSを指定した場合</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#                 Photo Absorption Cross Section</span>
<span class="c1">#      Energy[eV]   NonInteracting   Interacting</span>
       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>
       <span class="mf">0.050000</span>       <span class="mf">0.000034</span>       <span class="mf">0.000012</span>
       <span class="o">...</span>
</pre></div>
</div>
<p>第1カラムはエネルギー値です。第2、3カラムは、それぞれ独立粒子近似及び相互作用を取り入れた光吸収断面積です。</p>
</section>
<section id="id67">
<h3><span class="section-number">10.6.5. </span>例題<a class="headerlink" href="#id67" title="この見出しへのパーマリンク"></a></h3>
<p><strong>Si結晶の誘電スペクトル</strong></p>
<p>Si結晶の誘電スペクトルの計算例題です。計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/tddft/lr_bulkSi</span></code> です。まず、scf
ディレクトリにて電荷密度の計算を行い、次にLRCディレクトリにてスペクトル計算を行います。ここでは、exchange-correlation kernelとして LRCを採用しています。</p>
<figure class="align-default" id="uvsor-fig10">
<img alt="../_images/uvsor_image10.png" src="../_images/uvsor_image10.png" />
<figcaption>
<p><span class="caption-number">図 10.7 </span><span class="caption-text">LRCによるSi結晶誘電スペクトルの変化。青線は独立粒子近似による結果。</span><a class="headerlink" href="#uvsor-fig10" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#uvsor-fig10"><span class="std std-numref">図 10.7</span></a> の青線および赤線は、spectrum.data
の虚部を表示したもので、それぞれ独立粒子近似およびLRCを用いた場合の誘電スペクトルです。長距離相互作用の補正を行うことにより、第1ピークの強度が強くなる様子が分かります。なお、本系では、TDDFTによってもギャップ値の改善は見られません。これは、結晶のように波動関数が広がっている場合には、その間のクーロン相互作用が弱いためです。</p>
<p><strong>C:sub:`6`H:sub:`6`分子の光吸収断面積</strong></p>
<p>C<sub>6</sub>H<sub>6</sub>分子の光吸収断面積計算の計算例題です。計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/tddft/lr_C6H6</span></code> です。まず、scf
ディレクトリにて電荷密度の計算を行い、次に、ALDAディレクトリにて移動してスペクトル計算を行います。exchange-correlation kernelとして ALDAを採用しています。</p>
<figure class="align-default" id="uvsor-fig11">
<img alt="../_images/uvsor_image11.png" src="../_images/uvsor_image11.png" />
<figcaption>
<p><span class="caption-number">図 10.8 </span><span class="caption-text">ALDAによるC<sub>6</sub>H<sub>6</sub>分子の光吸収断面積スペクトルの変化。青線は独立粒子近似による結果。</span><a class="headerlink" href="#uvsor-fig11" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#uvsor-fig11"><span class="std std-numref">図 10.8</span></a> の青線および赤線は、spectrum.dataを表示したもので、それぞれ独立粒子近似およびALDAを用いた場合の誘電スペクトルです。第1ピークのエネルギー位置が高エネルギー側にシフト、すなわちギャップ値が拡大している様子が分かります。</p>
</section>
<section id="id68">
<span id="id69"></span><h3><span class="section-number">10.6.6. </span>使用上の注意点<a class="headerlink" href="#id68" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p>対称性を用いたk点の縮約に対応していません。このため、symmetryブロック中に”E”のみの対称性を指定してください。</p></li>
<li><p>solver でequation =BS
を指定した場合には、非磁性（paramagnetic）な系のみを取り扱うことが出来ます。</p></li>
</ul>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="gunther72" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Gunther72<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id4">1</a>,<a role="doc-backlink" href="#id15">2</a>)</span>
<p>Gunther Harbeke, &quot;Optical Properties of Semiconductors&quot; in Optical Properties of Solids; F. Abeles(Ed.), North-Holland, Amsterdam (1972):Chapter 2.</p>
</div>
<div class="citation" id="starace72" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Starace72<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id19">2</a>,<a role="doc-backlink" href="#id36">3</a>)</span>
<p>A. F. Starace, &quot;Length and Velocity Formulas in Approximate Oscillator-Strength Calculations&quot;, Phys. Rev.　A , pp. 1242-1245 (1972).</p>
</div>
<div class="citation" id="read91" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Read91<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id8">2</a>,<a role="doc-backlink" href="#id17">3</a>,<a role="doc-backlink" href="#id22">4</a>,<a role="doc-backlink" href="#id37">5</a>,<a role="doc-backlink" href="#id39">6</a>)</span>
<p>A. J. Read and Needs, &quot;Calculation of Optical Matrix Elements with Nonlocal Pseudopotentials&quot;, Phys. Rev. B , pp13071-13073 (1991).</p>
</div>
<div class="citation" id="kageshima97" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Kageshima97<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id9">2</a>,<a role="doc-backlink" href="#id18">3</a>,<a role="doc-backlink" href="#id38">4</a>)</span>
<p>H. Kageshima and K. Shiraishi, &quot;Momentum-matrix-element Calculation using Pseudopotentials&quot;, Phys. Rev. B , pp14985-14992 (1997).</p>
</div>
<div class="citation" id="lehmann72" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Lehmann72<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id10">1</a>,<a role="doc-backlink" href="#id23">2</a>,<a role="doc-backlink" href="#id41">3</a>)</span>
<p>G. Lehmann and M. Taut, &quot;On the Numerical Calculation of the Density of States and Related Properties&quot;, phys. stat. sol. (b) , pp469-477 (1972).</p>
</div>
<div class="citation" id="adolf97" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Adolf97<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id16">1</a>,<a role="doc-backlink" href="#id20">2</a>)</span>
<p>B. Adolf, K. Tenelsen, V. I. Gavrilenko, and F. Bechstedt, &quot;Optical Properties and Loss Spectra of SiC polytypes from Ab Initio Calculation&quot;, Phys. Rev. B , pp1422-1429 (1997).</p>
</div>
<div class="citation" id="pickard00" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Pickard00<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id21">1</a>,<a role="doc-backlink" href="#id40">2</a>)</span>
<p>C. J. Pickard and M. C. Payne, &quot;Second-order k・p Perturbation Theory with Vanderbilt Pseudopotentials and Plane Waves&quot;, Phys. Rev. B , pp4383-4388 (2000).</p>
</div>
<div class="citation" id="shen03" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id24">Shen03</a><span class="fn-bracket">]</span></span>
<p>Y. R. Shen, &quot;Principles of Nonlinear Optics (Wiley Classics Library)&quot;, John Wiley and Sons, Inc.Hoboken, NJ, USA(2003).</p>
</div>
<div class="citation" id="ghahmani91" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id25">Ghahmani91</a><span class="fn-bracket">]</span></span>
<p>E. Ghahramani, D. J. Moss, and J. E. Sipe, &quot; Full-band-structure Calculation of Second-harminc Generation in Odd-period Strained (Si)n/(Ge)n Superlattices&quot;, Phys. Rev. B , pp8990-9002 (1991).</p>
</div>
<div class="citation" id="rashkeev98" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id27">Rashkeev98</a><span class="fn-bracket">]</span></span>
<p>S. N. Rashkeev, W. R. L. Lambrecht, and B. Segall &quot;Efficient Ab initio Method for the Calculation of Frequency-dependent Second-order Optical Response in Semiconductors&quot;, Phys. Rev. B , pp3905-3919 (1998).</p>
</div>
<div class="citation" id="king-smith93" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id29">King-Smith93</a><span class="fn-bracket">]</span></span>
<p>R. D. King-Smith and David Vanderbilt, Phys. Rev. B , 1651 (1993).</p>
</div>
<div class="citation" id="resta94" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id30">Resta94</a><span class="fn-bracket">]</span></span>
<p>R. Resta, Rev. Mod. Phys. , 899 (1994).</p>
</div>
<div class="citation" id="resta92" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id31">Resta92</a><span class="fn-bracket">]</span></span>
<p>R. Resta, Ferroelectrics , 51 (1992).</p>
</div>
<div class="citation" id="pick70" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id32">Pick70</a><span class="fn-bracket">]</span></span>
<p>R. M. Pick, M. H. Cohen, and R. M. Martin, Phys. Rev. B , 910 (1970).</p>
</div>
<div class="citation" id="id70" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id44">物理学辞典</a><span class="fn-bracket">]</span></span>
<p>物理学辞典（縮刷版）、物理学辞典編集委員会（培風館、東京1992）, p.988.</p>
</div>
<div class="citation" id="moss90" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id26">Moss90</a><span class="fn-bracket">]</span></span>
<p>D. J. Moss, E. Ghahramani, J. E. Sipe, and H. M. van Driel, “Band-structure Calculation of dispersion and anisotropy in <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> for third-harmonic generation in Si, Ge, and GaAs”, Phys. Rev. B, , pp1542-1560 (1990).</p>
</div>
<div class="citation" id="vanderbilt00" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id33">Vanderbilt00</a><span class="fn-bracket">]</span></span>
<p>D. Vanderbilt, J. Phys. Chem. Solids (2000) 147-151.</p>
</div>
<div class="citation" id="bernardini97" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Bernardini97<span class="fn-bracket">]</span></span>
<p>F. Bernardini et al., Phys. Rev. B 56 (1997) R10024.</p>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ion_dynamics/ion_dynamics.html" class="btn btn-neutral float-left" title="9. 原子ダイナミクス" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../supplement/supplement.html" class="btn btn-neutral float-right" title="11. 補遺" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, PHASEシステム研究会.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>