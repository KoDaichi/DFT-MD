<!DOCTYPE html>
<html class="writer-html5" lang="ja">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. PHASE/0のインストール &mdash; PHASE/0 Manual 2024.01 ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/phase0.css?v=84baaed2" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=df52f328"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/translations.js?v=4dbe4bdc"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="3. PHASE/0の基本的な利用方法" href="../first_step/first_step.html" />
    <link rel="prev" title="1. はじめに" href="../introduction/introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PHASE/0 Manual
              <img src="../_static/image1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">1. はじめに</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. PHASE/0のインストール</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">2.1. 動作環境</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">2.2. 2次元版および3次元版について</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">2.3. インストール方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#distributed-memory-fftw-2022-01">2.4. Distributed-memory FFTWとリンクする方法（バージョン2022.01以降）</a></li>
<li class="toctree-l2"><a class="reference internal" href="#eigenexa-2024-01">2.5. EigenExaとリンクする方法（バージョン2024.01以降）</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../first_step/first_step.html">3. PHASE/0の基本的な利用方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_parameters/input_parameters.html">4. 入力パラメータファイル：nfinp.data（詳細版）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/basics.html">5. 基本機能を利用した計算例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../electronic_structure/electronic_structure.html">6. 電子状態解析：バンド構造と状態密度</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_electronic_structure/advanced_electronic_structure.html">7. 高度な電子状態計算</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/analysis.html">8. 解析機能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ion_dynamics/ion_dynamics.html">9. 原子ダイナミクス</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uvsor/uvsor.html">10. 誘電応答解析機能 UVSOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplement/supplement.html">11. 補遺</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PHASE/0 Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">2. </span>PHASE/0のインストール</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/install/install.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="phase-0">
<span id="install-chapter"></span><h1><span class="section-number">2. </span>PHASE/0のインストール<a class="headerlink" href="#phase-0" title="この見出しへのパーマリンク"></a></h1>
<p>PHASE/0をインストールする方法を説明します。個別の環境についてのインストール方法について <a class="reference external" href="https://github.com/Materials-Science-Software-Consortium/phase0_install">このGitHub</a> のページにも情報があります。</p>
<section id="id1">
<h2><span class="section-number">2.1. </span>動作環境<a class="headerlink" href="#id1" title="この見出しへのパーマリンク"></a></h2>
<p>PHASE/0は、PCから最先端のスーパーコンピュータの様々な計算機環境で動作します。</p>
<p>PHASE/0プログラムはFortran（Fortran90およびFORTRAN77）とCで記述されています。これらのコンパイラが使える計算機システムが必要です。並列計算をする場合にはMPIライブラリがインストールされている必要があります。</p>
<p>必要（利用可能）なソフトウェア、ライブラリ</p>
<ul class="simple">
<li><p>Fortran90コンパイラ、Cコンパイラ（必須）</p></li>
<li><p>MPIライブラリ（並列計算に必須）</p></li>
<li><p>行列演算ライブラリLAPACK, BLAS（オプション）</p></li>
<li><p>FFTライブラリFFTW（オプション）</p></li>
<li><p>Perl（オプション）・・・・PHASEツールで必要</p></li>
<li><p>Gnuplot（オプション）・・・・PHASEツールで必要</p></li>
<li><p>Python（オプション）・・・・PHASEツール，ASEで必要</p></li>
</ul>
<p>PHASEの動作確認を行っている計算機環境を以下に示します。</p>
<p>PHASE/0が動作する主な計算機環境</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>計算機環境</p></th>
<th class="head"><p>コンパイラー</p></th>
<th class="head"><p>利用可能ライブラリ</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linux</p></td>
<td><p>GNU Compiler
Intel Compiler</p></td>
<td><p>LAPACK, BLAS, ScaLAPACK,
MKL, FFTW3</p></td>
</tr>
<tr class="row-odd"><td><p>macOS (Apple Silicon)</p></td>
<td><p>GNU Compiler</p></td>
<td><p>LAPACK, BLAS, ScaLAPACK, FFTW3</p></td>
</tr>
<tr class="row-even"><td><p>NEC SX Series</p></td>
<td><p>Fortran90/SX</p></td>
<td><p>Mathkeisan(LAPACK)
ASL(FFT)</p></td>
</tr>
<tr class="row-odd"><td><p>Fujitsu FX1000, FX700</p></td>
<td><p>Fujitsu Compiler</p></td>
<td></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>MPIライブラリは、OpenMPI, IntelMPI, SGI MPTなどに対応しています。</p></li>
<li><p>MKLのFFTW3ラッパーを介してMKLのFFTを利用することもできます。</p></li>
<li><p>ASLのFFTW3ラッパーを介してASLのFFTを利用することもできます。</p></li>
</ul>
</section>
<section id="id2">
<h2><span class="section-number">2.2. </span>2次元版および3次元版について<a class="headerlink" href="#id2" title="この見出しへのパーマリンク"></a></h2>
<p>PHASE/0は，バンドおよび<strong>k</strong>点の2軸で並列化を施した2次元版と，バンド，<strong>k</strong>点に加え<strong>G</strong>点の並列軸を加えた3次元版があります。低並列時では2次元版の方が高速に動作することが多いですが，高並列時は3次元版に軍配があがります。ただし，一部機能は2次元版でしか利用することはできません。</p>
</section>
<section id="id3">
<h2><span class="section-number">2.3. </span>インストール方法<a class="headerlink" href="#id3" title="この見出しへのパーマリンク"></a></h2>
<p>Linux環境を例にしてインストール方法を説明します。ここでは、Linux環境にIntel Fortran compilerがインストールされていることを想定します。
別のコンパイラを利用する場合はコンパイラの選択のときに、そのコンパイラを選択してください。また、MPIライブラリとして、OpenMPIを使用することを仮定しています。プログラムモデルの選択のときに「Serial」を選択すればMPIライブラリを使用しないでプログラムを作成することもできます。</p>
<p>まず、PHASE/0パッケージ phase0_2024.01.tar.gzをPHASE/0をインストールするディレクトリに展開してください。</p>
<pre class="literal-block">$ tar zxf phase0_2024.01.tar.gz</pre>
<p>ディレクトリ phase0_2024.01 に移り、インストーラーを実行してください(2次元版はinstall.sh, 3次元版はinstall_3d.sh；以下は2次元版の例)</p>
<pre class="literal-block">$ cd phase0_2024.01
$ ./install.sh

 === PHASE installer ===
 Do you want to install PHASE? (yes/no) [yes]</pre>
<p>インストールするかどうか聞いてきますので、何も入力せずにEnterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported platforms

0) GNU Linux (IA32)
1) GNU Linux (EM64T/AMD64)
2) NEC SX Series
x) Exit

Enter number of your platform. [0]
</pre></div>
</div>
<p>対応する環境の一覧が表示されますので、「GNU Linux
(EM64T/AMD64)」に対応する1を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported compilers
0) GNU compiler collection (gfortran)
1) Intel Fortran compiler
x) Exit
Enter number of a desired compiler. [0]
</pre></div>
</div>
<p>対応するコンパイラーの一覧が表示されますので、「Intel Fortran compiler」に対応する1を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported programming-models
0) Serial
1) MPI parallel
x) Exit
Enter number of a desired programming-model. [0]
</pre></div>
</div>
<p>対応するプログラムモデルの一覧が表示されますので、「MPI
parallel」に対応する1を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported MPI libraries
0) Open MPI
1) SGI MPT
2) Intel(R) MPI
x) Exit
Enter number of a desired MPI library. [0]
</pre></div>
</div>
<p>対応するMPIライブラリの一覧が表示されますので、「Open MPI」に対応する0を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported BLAS/LAPACK
0) Netlib BLAS/LAPACK
1) Intel Math Kernel Library (MKL)
x) Exit
Enter number of a desired library. [0]
</pre></div>
</div>
<p>対応するBLAS/LAPACKライブラリの一覧が表示されますので、「Netlib BLAS/LAPACK」に対応する0を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Supported FFT libraries
0) Built-in FFT subroutnes
1) FFTW3 library
x) Exit
Enter number of a desired library. [0]
</pre></div>
</div>
<p>対応するFFTライブラリの一覧が表示されますので、「Built-in FFT subroutnes」に対応する0を入力して、Enterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Do you want to edit the makefile that has been generated? (yes/no/exit) [no]
</pre></div>
</div>
<p>作成されたMakefileを編集するかどうか聞いてきます。Makefileの確認や編集を行う必要がなければ、何も入力せずにEnterキーを押してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Do you want to make PHASE now? (yes/no) [yes]
</pre></div>
</div>
<p>PHASEのコンパイルとインストールを開始するかどうか聞いてきます。何も入力せずにEnterキーを押して、PHASEのコンパイルとインストールを始めてください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PHASE was successfully installed.
Do you want to check the installed programs? (yes/no) [no]
</pre></div>
</div>
<p>PHASEが正常にインストールされたことを告げるメッセージの後、プログラムのテスト計算を実行するかどうか聞いてくるので、必要があればyesを入力し、Enterキーを押してください。テスト計算をしないならば、noを入力してEnterキーを押してください。テスト計算を実行して以下のような出力が得られれば問題ありません。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Do you want to check the installed programs? (yes/no) [no]
yes
Checking total-energy calculation.
 Total energy : -7.897015156331 Hartree/cell
 Reference    : -7.897015156332 Hartree/cell
Checking band-energy calculation.
 Valence band maximum : 0.233846 Hartree
 Reference            : 0.233846 Hartree
</pre></div>
</div>
<p>MPIプログラムの実行に用いるmpirunやmpiexecなどのコマンドを用いて実行します。</p>
<p>$HOME/phase0_2024.01/binを環境変数PATHに追加しておくと、PHASE/0のプログラムのパスを指定せずに実行でき便利です。</p>
<p>Bourne shell(ボーンシェル)系であれば、$HOME/.bashrcなどにPATHを記述します。</p>
<pre class="literal-block">export PATH=$HOME/phase0_2024.01/bin:$PATH</pre>
<p>C shell(シーシェル)系であれば、$HOME/.cshrcにPATHを記述します。</p>
<pre class="literal-block">setenv PATH $HOME/phase0_2024.01/bin:$PATH</pre>
<p>MPIライブラリのbinディレクトリにも必ずパスを通すようにしてください。</p>
<p>Bourne shell(ボーンシェル)系であれば、$HOME/.bashrcなどにPATHを記述します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/openmpi/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>C shell(シーシェル)系であれば、$HOME/.cshrcにPATHを記述します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>setenv<span class="w"> </span>PATH<span class="w"> </span><span class="nv">$HOME</span>/openmpi/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>以下のようにして、PHASEを実行します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">2</span><span class="w"> </span>phase<span class="w"> </span><span class="nv">ne</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">nk</span><span class="o">=</span><span class="m">2</span>
</pre></div>
</div>
<p><strong>gfortranを用いる場合の注意点</strong></p>
<p>Fortranコンパイラーとしてバージョン10以上のgfortranを用いる場合、上述のinstall.shスクリプトを用いた方法は失敗します。<code class="docutils literal notranslate"><span class="pre">src_phase/Makefile</span></code> を編集する必要があります。</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">F90</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mpif90<span class="w"> </span>-m64
</pre></div>
</div>
<p>この行に <code class="docutils literal notranslate"><span class="pre">-fallow-argument-mismatch</span></code> という文字列を追加したのちに <code class="docutils literal notranslate"><span class="pre">make</span></code> コマンドを実行してください。</p>
</section>
<section id="distributed-memory-fftw-2022-01">
<span id="section-install-mpifftw"></span><h2><span class="section-number">2.4. </span>Distributed-memory FFTWとリンクする方法（バージョン2022.01以降）<a class="headerlink" href="#distributed-memory-fftw-2022-01" title="この見出しへのパーマリンク"></a></h2>
<p>3次元版PHASE/0を <a class="reference external" href="https://fftw.org/doc/Distributed_002dmemory-FFTW-with-MPI.html">Distributed-memory FFTWライブラリー</a> とリンクし、MPI並列FFTの処理をこのライブラリーに任せることができます。MPI並列FFTの処理は3次元版のPHASE/0に組み込まれており、3次元FFTの2軸を面とみなし分割する仕組みとなっています。これに対しDistributed-memory FFTWは1軸を分割します。したがってPHASE/0内蔵の並列FFTの方がスケーラビリティが高いのですが、系の形状やカットオフエネルギー、G点並列数によっては1軸分割の方が通信が少なくなる場合があり、そのような場合に利用するとより高速な計算を実現することができます。</p>
<p>リンクする方法は環境などによって異なります。ここでは <a class="reference external" href="https://www.intel.com/content/www/us/en/develop/documentation/onemkl-developer-reference-fortran/top/appendix-c-fftw-interface-to-onemkl/fftw3-interface-to-onemkl/mpi-fftw3-wrappers.html">Intel MKLに付属するdistributed-memory FFTW</a> とリンクする方法を紹介します。</p>
<p>まずはラッパーをコンパイルします。ここではホームディレクトリーの下の <code class="docutils literal notranslate"><span class="pre">mkl</span></code> というディレクトリーにインストールする前提のコマンドを紹介します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-r<span class="w"> </span><span class="nv">$MKLROOT</span>/interfaces/fftw3x_cdft<span class="w"> </span>.
<span class="nb">cd</span><span class="w"> </span>fftw3x_cdft
make<span class="w"> </span>libintel64<span class="w"> </span><span class="nv">MKLROOT</span><span class="o">=</span><span class="nv">$MKLROOT</span><span class="w"> </span><span class="nv">INSTALL_DIR</span><span class="o">=</span><span class="nv">$HOME</span>/mkl
</pre></div>
</div>
<p>Makefileを以下のように編集します。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CPPFLAGS</span> <span class="pre">=</span> <span class="pre">-D_USE_DATE_AND_TIME_</span> <span class="pre">...</span></code> に <code class="docutils literal notranslate"><span class="pre">-DMPI_FFTW</span></code> を追加</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--start-group</span> <span class="pre">...</span> <span class="pre">${MKLHOME}/libmkl_sequential.a</span> <span class="pre">...</span></code> に <code class="docutils literal notranslate"><span class="pre">${HOME}/mkl/libfftw3x_cdft_lp64.a</span> <span class="pre">${MKLHOME}/libmkl_cdft_core.a</span></code> を追加</p></li>
</ul>
<p>環境変数CPATHにfftwのインクルードディレクトリーを追加します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">CPATH</span><span class="o">=</span><span class="nv">$MKLROOT</span>/include/fftw:<span class="nv">$CPATH</span>
</pre></div>
</div>
<p>この状態で <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean;make</span></code> とするとdistributed-memory FFTWを利用することのできるバイナリーを得ることができます。</p>
<p>デフォルトの状態では内蔵の並列FFTを用います。Distributed-memory FFTWを使う場合は以下のような設定を施します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  sw_mpi_fftw = on
}
</pre></div>
</div>
</section>
<section id="eigenexa-2024-01">
<span id="section-install-eigenexa"></span><h2><span class="section-number">2.5. </span>EigenExaとリンクする方法（バージョン2024.01以降）<a class="headerlink" href="#eigenexa-2024-01" title="この見出しへのパーマリンク"></a></h2>
<p>3次元版PHASE/0を <a class="reference external" href="https://www.r-ccs.riken.jp/labs/lpnctrt/projects/eigenexa/">EigenExa</a> とリンクし、分散並列による行列対角化をこのライブラリーに任せることができます。PHASE/0の標準的な分散並列行列対角化ライブラリーはScaLAPACKですが、計算機アーキテクチャーや問題規模、並列数によってはEigenExaの方が高速に動作する場合があります。</p>
<p>リンクする方法は環境によって異なります。ここでは、MPIとしてインテルMPI, コンパイラーとしてインテル Fortranコンパイラー・クラシックを用いた例を紹介します。</p>
<p>まずはEigenExaをコンパイルします。上記のサイトから最新版をダウンロードし、 <code class="docutils literal notranslate"><span class="pre">README.md</span></code> ファイルの指示に従ってコンパイルします。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>tar<span class="w"> </span>-zxvf<span class="w"> </span>EigeExa-2.12.tar.gz
<span class="nb">cd</span><span class="w"> </span>EigenExa-2.12
./bootstrap
./configure
make<span class="w"> </span>install
</pre></div>
</div>
<p>インテルMPIの環境が設定されている場合、自動的にそれが選択されます。</p>
<p>Makefileに以下のような編集を施す必要があります。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CPPFLAGS</span> <span class="pre">=</span> <span class="pre">-D_USE_DATE_AND_TIME_</span> <span class="pre">...</span></code> に <code class="docutils literal notranslate"><span class="pre">-DUSE_EIGENLIB</span> <span class="pre">-DEIGEN_EXA_2_9</span></code> を追加します</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LIBS</span></code> から始まる行にEigenExaのライブラリーを次のように指定します <code class="docutils literal notranslate"><span class="pre">LIBS</span> <span class="pre">=</span> <span class="pre">-L$(HOME)/EigenExa-2.12/lib</span> <span class="pre">-lEigenExa</span> <span class="pre">...</span></code></p></li>
<li><p>OpenMPを有効にするため、コンパイラーオプションに <code class="docutils literal notranslate"><span class="pre">-qopenmp</span></code> を加えます。 <code class="docutils literal notranslate"><span class="pre">F90</span> <span class="pre">=</span> <span class="pre">mpiifort</span> <span class="pre">-qopenmp</span></code> <code class="docutils literal notranslate"><span class="pre">LINK</span> <span class="pre">=</span> <span class="pre">mpiifort</span> <span class="pre">-qopenmp</span></code></p></li>
<li><p>ESMを有効にしている場合、 <code class="docutils literal notranslate"><span class="pre">libesm.a</span></code> の次の行における <code class="docutils literal notranslate"><span class="pre">-D__MPI__</span></code> という文字列を <code class="docutils literal notranslate"><span class="pre">-D__OPENMP</span></code> に差し替えます</p></li>
</ul>
<p>環境変数 <code class="docutils literal notranslate"><span class="pre">CPATH</span></code> にEigenExaのインクルードディレクトリーを追加します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">CPATH</span><span class="o">=</span><span class="nv">$HOME</span>/EigenExa-2.12/include:<span class="nv">$CPATH</span>
</pre></div>
</div>
<p>この状態で <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean;make</span></code> とするとEigenExaを利用することのできる実行可能ファイルを得ることができます。</p>
<p>デフォルトの状態ではScaLAPACKを用います。EigenExaを使う場合は以下のような設定を施します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>wavefunction_solver{
  submat{
    eigen_exa{
      sw_eigen_exa = on
    }
  }
}
</pre></div>
</div>
<p>また、実行する前に環境変数 <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> にEigenExaのライブラリーファイルが配置されているディレクトリーを指定する必要があります。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$HOME</span>/EigenExa-2.12/lib:<span class="nv">$LD_LIBRARY_PATH</span>
</pre></div>
</div>
<p>さらに、環境変数 <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> によってMPI並列数や利用可能なコア数を勘案しながら適切なスレッド並列数を指定します。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">2</span>
</pre></div>
</div>
<p>なお、EigenExaはIntel oneAPI 2024年版以降に同梱されているインテルMPIとコンパイラーではコンパイルできなくなっているようです。2023年版以下のバージョンを用いるようにしてください。また、EigenExaとk点並列を同時に利用することはできません。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../introduction/introduction.html" class="btn btn-neutral float-left" title="1. はじめに" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../first_step/first_step.html" class="btn btn-neutral float-right" title="3. PHASE/0の基本的な利用方法" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, PHASEシステム研究会.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>