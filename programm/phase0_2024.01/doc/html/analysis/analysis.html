<!DOCTYPE html>
<html class="writer-html5" lang="ja">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8. 解析機能 &mdash; PHASE/0 Manual 2024.01 ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/phase0.css?v=84baaed2" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=df52f328"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/translations.js?v=4dbe4bdc"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="9. 原子ダイナミクス" href="../ion_dynamics/ion_dynamics.html" />
    <link rel="prev" title="7. 高度な電子状態計算" href="../advanced_electronic_structure/advanced_electronic_structure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PHASE/0 Manual
              <img src="../_static/image1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">2. PHASE/0のインストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_step/first_step.html">3. PHASE/0の基本的な利用方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_parameters/input_parameters.html">4. 入力パラメータファイル：nfinp.data（詳細版）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/basics.html">5. 基本機能を利用した計算例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../electronic_structure/electronic_structure.html">6. 電子状態解析：バンド構造と状態密度</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_electronic_structure/advanced_electronic_structure.html">7. 高度な電子状態計算</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. 解析機能</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#section-partial-charge">8.1. 部分電荷密度</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stm">8.2. STM像</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">8.2.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">8.2.2. 計算理論</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">8.2.3. コンパイル方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">8.2.4. 入力</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#phase-0">8.2.4.1. PHASE/0の入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">8.2.4.2. STMプログラムの入出力ファイル</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">8.2.5. STMプログラムの実行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">8.2.6. 計算結果</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">8.2.7. 計算例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-bader-charge">8.3. ベーダ―解析向け電荷密度ファイルの出力 (バージョン2019.02以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">8.3.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">8.3.2. ベーダ―解析について</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">8.3.3. 処理内容</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">8.3.4. 入力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">8.3.5. 出力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">8.3.6. 計算例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gan">8.3.6.1. GaNの計算例</a></li>
<li class="toctree-l4"><a class="reference internal" href="#h-sic">8.3.6.2. 4H-SiCの計算例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-stress-tensor">8.4. ストレステンソル</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">8.4.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">8.4.2. 入力パラメータ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">8.4.3. 弾性定数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">8.4.4. ストレステンソルの補正</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-workfunc">8.5. 仕事関数</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id27">8.5.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">8.5.2. 入力パラメータ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">8.5.3. 計算の実行方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">8.5.4. 計算結果の出力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">8.5.5. 計算例：アルミニウムの仕事関数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-localpot-av-section">8.6. 原子周囲局所ポテンシャル出力機能（2021.02以降）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id33">8.6.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">8.6.2. 入力パラメーターファイル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">8.6.3. 出力ファイル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#al-graphene-al">8.6.4. 計算例： Al-Graphene-Al系</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-taiden">8.7. 帯電欠損状態の評価 (バージョン2021.01以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id37">8.7.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">8.7.2. 理論</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fnv">8.7.2.1. FNV法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41">8.7.2.2. 外部解析プログラム</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extended-fnv">8.7.2.3. extended FNV 法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id43">8.7.3. 使い方</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id44">8.7.3.1. 外部解析プログラムの使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id45">8.7.3.2. extended FNV 法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defectq-forme-fig1">8.7.3.3. 生成エネルギー図の作成1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defectq-forme-fig2">8.7.3.4. 生成エネルギー図の作成2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id48">8.7.4. 例題</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id49">8.7.4.1. 概要</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id50">8.7.4.2. 例題のディレクトリー構成および計算のながれ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id51">8.7.4.3. 補正エネルギー比較</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id52">8.7.4.4. 生成エネルギー図の作成 1.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id53">8.7.4.5. 生成エネルギー図の作成 2.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xps">8.8. XPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id56">8.8.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id57">8.8.2. 理論</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id58">8.8.2.1. 相対論的運動エネルギー</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id60">8.8.2.2. 内殻電子のスピン</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id61">8.8.2.3. XPSのピークエネルギーの計算方法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id63">8.8.3. 使い方</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#newxps-usage1">8.8.3.1. 相対論的運動エネルギー</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id65">8.8.3.2. 内殻電子のスピン</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id66">8.8.4. 例題</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#h-sic-c-1s">8.8.4.1. 4H-SiC結晶 (C 1s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#w-aln-n-1s">8.8.4.2. w-AlN 結晶 (N 1s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#w-aln-al-2p3-2">8.8.4.3. w-AlN 結晶 (Al 2p3/2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fcc-pt-pt-4f">8.8.4.4. fcc Pt結晶 (Pt 4f)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#o-2-o-1s">8.8.4.5. O <sub>2</sub> 分子 (O 1s)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#core-level-shift-cls">8.8.5. Core Level Shift (CLS)の解析</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id69">8.8.5.1. 内殻準位シフト</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">8.8.5.2. 内殻光電子放出のスペクトル</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id75">8.8.5.3. 内殻正孔を含む原子の擬ポテンシャル</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id77">8.8.5.4. 計算の実行方法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#si-100">8.8.5.5. 計算例：Si(100)表面</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#elnes-xanes">8.9. ELNES / XANES解析機能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id84">8.9.1. はじめに</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-elnes-xanes-pp">8.9.2. 準備：擬ポテンシャル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id87">8.9.3. 計算の流れ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-scf">8.9.4. 基底状態 (A) のSCF 計算</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id88">8.9.4.1. 入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id89">8.9.4.2. 出力</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#b-scf">8.9.5. 内殻電子励起状態 (B) のSCF 計算</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id90">8.9.5.1. 入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id91">8.9.5.2. 出力</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#b">8.9.6. 内殻電子励起状態 (B) のスペクトル計算</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id92">8.9.6.1. 入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id93">8.9.6.2. 出力</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id94">8.9.7. 計算事例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lif-li-k">8.9.7.1. LiF 結晶の Li 原子K端のスペクトル</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-xanes-quad-section">8.9.8. 四重極子成分 (バージョン2019.02以降)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id96">8.9.8.1. 概要</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id97">8.9.8.2. 計算理論</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id101">8.9.8.3. 入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id102">8.9.8.4. 出力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id103">8.9.8.5. 計算例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id104">8.9.9. 文献</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xes-2024-01">8.10. XES解析機能 (バージョン2024.01以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id105">8.10.1. はじめに</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id106">8.10.2. 準備：擬ポテンシャル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scf">8.10.3. 始状態SCF計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id107">8.10.4. 終状態SCF計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id108">8.10.5. スペクトル計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id109">8.10.6. 計算例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#si-8">8.10.6.1. Si結晶(8原子)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mgo-8">8.10.6.2. MgO結晶 (8原子)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-borncharge">8.11. ボルン有効電荷</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id113">8.11.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id114">8.11.2. ボルン有効電荷の計算の流れ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id115">8.11.3. 入力データ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id116">8.11.3.1. 概要</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id117">8.11.3.2. SCF計算およびベリー位相計算用テンプレート入力データの作成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#berry-pl">8.11.3.3. berry.pl用のコントロールファイルの作成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id118">8.11.3.4. 注意点</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id119">8.11.4. berry.plの実行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-berry-results">8.11.5. 計算結果</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id121">8.11.6. 例題</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id122">8.11.7. berry.plを使わずにボルン有効電荷を計算する方法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id123">8.11.7.1. SCF計算</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id124">8.11.7.2. ベリー位相計算</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id125">8.11.7.3. ボルン有効電荷の計算</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-finite-electric-field">8.12. 有限電場計算機能 (バージョン2019.02以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id127">8.12.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id128">8.12.2. 計算理論</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id130">8.12.3. 入力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id131">8.12.4. 計算ソルバーについて</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id132">8.12.5. 出力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id133">8.12.6. 計算例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id134">8.12.6.1. 計算結果</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id135">8.12.7. 注意点</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id136">8.13. 陽電子寿命解析</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id137">8.13.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id142">8.13.2. 入力パラメータ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id143">8.13.3. 計算結果の出力</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id144">8.13.4. 使用上の注意</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#section-wannier">8.14. ワニエ関数</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id146">8.14.1. 機能の概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#si">8.14.2. 計算例：Siの最大局在ワニエ関数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wannier90">8.14.3. Wannier90を用いたワニエ関数解析</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id147">8.14.3.1. 機能の概要</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id148">8.14.3.2. ワニエ補間</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id149">8.14.3.3. 計算例題</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id150">8.14.4. 使用上の注意</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#boltztrap-2019-01">8.15. BoltzTraPを利用した解析(バージョン2019.01以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id153">8.15.1. 入力ファイル</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id154">8.15.2. PHASE/0の実行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boltztrap">8.15.3. BoltzTraPの実行</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id155">8.15.3.1. バージョン1.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id156">8.15.3.2. バージョン2.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id157">8.15.4. 計算例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#energy-density-analysis-2022-01">8.16. Energy Density Analysis(バージョン2022.01以降)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id158">8.16.1. 概要</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id160">8.16.2. 使い方</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id161">8.16.2.1. 入力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id162">8.16.2.2. 出力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id163">8.16.2.3. 計算例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ion_dynamics/ion_dynamics.html">9. 原子ダイナミクス</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uvsor/uvsor.html">10. 誘電応答解析機能 UVSOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplement/supplement.html">11. 補遺</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PHASE/0 Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">8. </span>解析機能</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/analysis/analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="analysis-chapter">
<span id="id1"></span><h1><span class="section-number">8. </span>解析機能<a class="headerlink" href="#analysis-chapter" title="この見出しへのパーマリンク"></a></h1>
<section id="section-partial-charge">
<span id="id2"></span><h2><span class="section-number">8.1. </span>部分電荷密度<a class="headerlink" href="#section-partial-charge" title="この見出しへのパーマリンク"></a></h2>
<p>部分電荷密度を計算するにはタグPostprocessingの中のタグchargeで指定します。タグchargeの中の変数sw_charge_rspaceとタグpartial_chargeの中の変数sw_partial_chargeをOnにします。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Postprocessing{
  charge{
    sw_charge_rspace = on
    partial_charge {
      sw_partial_charge = on
      Erange_min = -0.45 eV
      Erange_max = 0.45 eV
      Erange_delta = 0.05 eV
      partial_charge_filetype=separate !{individual,separate | integrated}
    }
  }
}
</pre></div>
</div>
<p>変数Erange_minとErange_maxにエネルギー領域の最大値と最小値を入力します。エネルギーは金属の場合フェルミレベルから測り、絶縁体の場合は価電子帯上端のエネルギーから測ります。変数Erange_deltaに入力した値の間隔のエネルギー窓を先のエネルギー領域に作成します。</p>
<p>出力ファイルoutput000には以下の様にエネルギー窓に関する出力があります（”!pc”で始まる行）。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>!pc nEwindows =   20, nvb_windows =   10, ncb_windows =   10 &lt;&lt;m_ESoc_set_nEwindows_pc&gt;&gt;
!pc    iw  if_elec_state                erange(hartree)                        erange(eV)
!pc              (asis)                  (shifted)             (shifted)
!pc     1       1       ( 0.094537  0.096374 ) ( -0.018375 -0.016537 ) ( -0.500000 -0.450000 )
!pc     2       1       ( 0.096374  0.098211 ) ( -0.016537 -0.014700 ) ( -0.450000 -0.400000 )
!pc     3       1       ( 0.098211  0.100049 ) ( -0.014700 -0.012862 ) ( -0.400000 -0.350000 )
!pc     4       1       ( 0.100049  0.101886 ) ( -0.012862 -0.011025 ) ( -0.350000 -0.300000 )
!pc     5       0       ( 0.101886  0.103724 ) ( -0.011025 -0.009187 ) ( -0.300000 -0.250000 )
!pc     6       1       ( 0.103724  0.105561 ) ( -0.009187 -0.007350 ) ( -0.250000 -0.200000 )
!pc     7       1       ( 0.105561  0.107399 ) ( -0.007350 -0.005512 ) ( -0.200000 -0.150000 )
!pc     8       0       ( 0.107399  0.109236 ) ( -0.005512 -0.003675 ) ( -0.150000 -0.100000 )
!pc     9       0       ( 0.109236  0.111074 ) ( -0.003675 -0.001837 ) ( -0.100000 -0.050000 )
!pc    10       1       ( 0.111074  0.112911 ) ( -0.001837  0.000000 ) ( -0.050000  0.000000 )
!pc    11       1       ( 0.112911  0.114749 ) (  0.000000  0.001837 ) (  0.000000  0.050000 )
!pc    12       0       ( 0.114749  0.116586 ) (  0.001837  0.003675 ) (  0.050000  0.100000 )
!pc    13       0       ( 0.116586  0.118424 ) (  0.003675  0.005512 ) (  0.100000  0.150000 )
!pc    14       0       ( 0.118424  0.120261 ) (  0.005512  0.007350 ) (  0.150000  0.200000 )
!pc    15       0       ( 0.120261  0.122099 ) (  0.007350  0.009187 ) (  0.200000  0.250000 )
!pc    16       1       ( 0.122099  0.123936 ) (  0.009187  0.011025 ) (  0.250000  0.300000 )
!pc    17       1       ( 0.123936  0.125773 ) (  0.011025  0.012862 ) (  0.300000  0.350000 )
!pc    18       0       ( 0.125773  0.127611 ) (  0.012862  0.014700 ) (  0.350000  0.400000 )
!pc    19       0       ( 0.127611  0.129448 ) (  0.014700  0.016537 ) (  0.400000  0.450000 )
!pc    20       0       ( 0.129448  0.131286 ) (  0.016537  0.018375 ) (  0.450000  0.500000 )
</pre></div>
</div>
<p>nEwindowsはエネルギー窓の総数です。nvb_windowsとncb_windowsはそれぞれ価電子状態と伝導電子状態を含むエネルギー窓の数です。この設定例では、Erange_min= -0.45 eV、Erange_max = 0.45 eV、Erange_delta = 0.05 eVなので、エネルギー窓の数は18個になるはずですが、実際には低エネルギー側および高エネルギー側にそれぞれErange_delta幅の袖領域を設けて出力するのでエネルギー窓の総数が20個になっていることに、ご注意下さい。iwはエネルギー窓の番号です。if_elec_stateはそのエネルギー窓に電子状態があるかどうかを示しています。この値が0の時は電子状態がなく、1の時には電子状態が存在します。列asisには原子単位でエネルギー窓の範囲が示されています。二つの列shiftedにはエネルギーの基準から測ったときのエネルギー窓の範囲が原子単位とeV単位で示されています。</p>
<p>変数partial_charge_filetypeにindividualまたはseparateを指定すると、各エネルギー窓ごとに計算された電荷密度が番号付けされたファイルに出力されます。
その際の名前の付け方は、スピン分極がない場合であれば、F_CHR = nfchr.cubeに対してnfchr.00xx.cube（xxには上の表のiwの値が入る）というようになります。スピン分極がある場合には、F_CHR = nfchr.cubeに対して、nfchr.up.00xx.cube、nfchr.down.00xx.cubeの二種類のファイルが生成されます。上の表でif_elec_stateが0になっているのは、その範囲に固有値がある状態がないことを示しています。その場合、cubeファイルは生成されません。</p>
<p>integratedを選択すると各電荷密度がひとつのファイルに追記され、各電荷密度データの先頭にはPARTIALCHARGEが記述され、終わりにはENDが記述されます。</p>
<p>BaO/Si(001)界面の部分電荷密度を計算した結果を <a class="reference internal" href="#advanced-bao-image3"><span class="std std-numref">図 8.1</span></a> に示します。</p>
<figure class="align-default" id="advanced-bao-image3">
<img alt="../_images/image11.svg" src="../_images/image11.svg" /><figcaption>
<p><span class="caption-number">図 8.1 </span><span class="caption-text">BaO/Si(001)界面構造の部分電荷密度。(a)BaO/Si(001)界面構造のモデル図。(b)フェルミレベル直下(固有エネルギーが-0.05eVから0.0eVまで)の電子状態の部分電荷密度。(c)フェルミレベル直上(固有エネルギーが0.0eVから0.05eVまで)の電子状態の部分電荷密度。電子密度は<span class="math notranslate nohighlight">\(\mathbf{1} \times \mathbf{10}^{- \mathbf{5}}\)</span>から<span class="math notranslate nohighlight">\(\mathbf{1} \times \mathbf{10}^{- \mathbf{3}}\)</span>までが示されています。青い部分には電子が少なく、赤い分部には電子が多くなっています。</span><a class="headerlink" href="#advanced-bao-image3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>応用例：STM像の解析</p></li>
</ul>
<p>部分電荷密度出力機能を利用すると、STM像を模擬することが可能です。解析したいバイアスポテンシャルに対応したエネルギーウィンドウの部分電荷密度を、表面からある程度離れた平面に投影した像が計算上のSTM像です。以下、サンプルデータ( <code class="code docutils literal notranslate"><span class="pre">samples/stm_by_pcharge</span></code> 以下)を利用して計算方法を具体的に説明します。</p>
<p>サンプルは、Si の(001)面に相当するデータです。通常のPHASE入力に、以下のように部分電荷密度出力の設定を加えています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  charge{
    sw_charge_rspace = on
    filetype = cube
    partial_charge{
      sw_partial_charge = on
      partial_charge_filetype = individual
      Erange_min = 0 eV
      Erange_max = 0 eV
      Erange_delta = 1 eV
    }
  }
}
</pre></div>
</div>
<p>このように設定することによって、フェルミエネルギーからみて-1 eV から0 eVまでのデータと0 eV から1 eVのエネルギーウィンドウの部分電荷密度が出力されます。それぞれ、-1 V（占有状態）および1 V（非占有状態）のバイアスポテンシャルに対応したSTM像が得られます。この入力データを利用して計算を実施すると、nfchr.0001.cube (-1 eV から0 eV の電荷密度データファイル) とnfchr.0002.cube (0 eV から1 eV の電荷密度データファイル) が作成されます。それぞれ、表面から5 Å程度離れた地点でのコンター図を占有状態について <a class="reference internal" href="#advanced-stm-image1"><span class="std std-numref">図 8.2</span></a> (a)に、非占有状態について <a class="reference internal" href="#advanced-stm-image1"><span class="std std-numref">図 8.2</span></a> (b)に示します。</p>
<figure class="align-default" id="advanced-stm-image1">
<img alt="../_images/image12.png" src="../_images/image12.png" />
<figcaption>
<p><span class="caption-number">図 8.2 </span><span class="caption-text">Si (100)面のSTM像、(a) 占有状態の像、(b)非占有状態の像。</span><a class="headerlink" href="#advanced-stm-image1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="stm">
<span id="section-stm"></span><h2><span class="section-number">8.2. </span>STM像<a class="headerlink" href="#stm" title="この見出しへのパーマリンク"></a></h2>
<section id="id3">
<h3><span class="section-number">8.2.1. </span>概要<a class="headerlink" href="#id3" title="この見出しへのパーマリンク"></a></h3>
<p>前節において部分電荷密度出力機能を用いてSTM像を可視化する方法を説明しました。前節の方法は、表面からある程度離れた位置では波動関数の精度が足りず、きれいな像が得られない場合があります。この問題は&quot;STM&quot;というPHASE/0とは異なるプログラムを用いることによって解決することができます。STMプログラムは、波動関数をPHASE/0から得られるポテンシャルをもとに一次元のSchrödinger方程式を用いて解きなおすことによって真空域でも精度の高い波動関数を得ることができるプログラムです。STMプログラムがもたらす波動関数によって得られる部分電荷密度から、表面から離れた地点においてもきれいなSTM像を得ることができるようになります。</p>
</section>
<section id="id4">
<h3><span class="section-number">8.2.2. </span>計算理論<a class="headerlink" href="#id4" title="この見出しへのパーマリンク"></a></h3>
<p>STMプログラムは、対象物の表面から少し離れた位置から真空層の中心までの領域で一次元の Schrödinger 方程式を解きます。具体的には以下のような方程式を解きます <a class="reference internal" href="#kageshima91" id="id5"><span>[Kageshima91]</span></a> , <a class="reference internal" href="#kageshima92" id="id6"><span>[Kageshima92]</span></a></p>
<div class="math notranslate nohighlight">
\[E_{\mu k_{\parallel}} \Psi_{\mu k_{\parallel}} \left( G_{\parallel}, z \right) = \frac{\hbar^2}{2m} \left( k_{\parallel} + G_{\parallel} \right)^2 \Psi_{\mu k_{\parallel}} \left( G_{\parallel}, z \right) - \frac{\hbar^2}{2m} \frac{\partial^2}{\partial z^2} \Psi_{\mu k_{\parallel}} \left( G_{\parallel}, z \right) + \sum_{G^{'}_\parallel} V\left( G_\parallel - G^{'}_\parallel , z \right) \Psi_{\mu k_{\parallel}} \left( G_{\parallel}, z \right)\]</div>
<p>このとき表面から少し離れた位置においてPHASE/0 で得た波動関数と一致するという境界条件と真空層の中心において波動関数が0になるという境界条件を課した上で解きます。有効ポテンシャル <span class="math notranslate nohighlight">\(V\left( r \right)\)</span> はPHASE/0で得られた遮蔽ポテンシャルを用います。ただし、本来の遮蔽ポテンシャルではなく非局所項を取り去ったもの、すなわち局所ポテンシャルのみを使います。</p>
</section>
<section id="id7">
<h3><span class="section-number">8.2.3. </span>コンパイル方法<a class="headerlink" href="#id7" title="この見出しへのパーマリンク"></a></h3>
<p>STMプログラムはPHASE/0とは別プログラムなので利用するたえにはコンパイルする必要があります。そのソースコードは <code class="docutils literal notranslate"><span class="pre">src_stm</span></code> 以下に配置されています。以下の要領でコンパイルしてください。</p>
<pre class="literal-block">$ cd ~/phase0_2024.01/src_stm
$ make COMP=gnu install</pre>
<p><code class="docutils literal notranslate"><span class="pre">COMP</span></code> にコンパイラーを指定します。 <code class="docutils literal notranslate"><span class="pre">gnu</span></code> (GNU Fortranコンパイラー) , <code class="docutils literal notranslate"><span class="pre">ifort</span></code> (classic Intel Fortranコンパイラー), <code class="docutils literal notranslate"><span class="pre">ifx</span></code> (Intel Fortranコンパイラー), <code class="docutils literal notranslate"><span class="pre">AT</span></code> (NEC nfortコンパイラー) <code class="docutils literal notranslate"><span class="pre">fugaku</span></code> (Fujitsu Fortranコンパイラー) を用いることができます。コンパイルに成功したら実行可能バイナリーファイル <code class="docutils literal notranslate"><span class="pre">stm</span></code> が作成されます。 <code class="docutils literal notranslate"><span class="pre">make</span></code> の引数に <code class="docutils literal notranslate"><span class="pre">install</span></code> をつけている場合、このファイルはPHASE/0インストールディレクトリーの下の <code class="docutils literal notranslate"><span class="pre">bin</span></code> ディレクトリーに移されます。</p>
</section>
<section id="id8">
<h3><span class="section-number">8.2.4. </span>入力<a class="headerlink" href="#id8" title="この見出しへのパーマリンク"></a></h3>
<section id="phase-0">
<h4><span class="section-number">8.2.4.1. </span>PHASE/0の入力<a class="headerlink" href="#phase-0" title="この見出しへのパーマリンク"></a></h4>
<p>STMプログラムを用いるためには、STMプログラムが必要とする情報をPHASE/0に出力させる必要があります。 <code class="docutils literal notranslate"><span class="pre">nfinp.data</span></code> ファイルに以下のような記述を行います。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  STM{
    sw_stm = ON
  }
}
</pre></div>
</div>
<p>この設定を施した状態でPHASE/0 を実行することによりSTMプログラムが必要とするファイル群 (continue_bin_stm.data, nfvlc.data など)が生成されます。また、 <code class="docutils literal notranslate"><span class="pre">output000</span></code> ファイルに以下のような出力が得られます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>!!STM: template input
2 1
1 0.1082 0.3247 0.0000 0.2500 0.3750 0.0000 0.5000
2 0.1082 0.1082 0.0000 0.2500 0.1250 0.0000 0.5000
48 60.0000000000
-1.0 0.0
90
45 90
3
0.10 0.30 100
0.01
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">!!STM:</span> <span class="pre">template</span> <span class="pre">input</span></code> 以降の行をコピーペーストすることによってSTMプログラムのテンプレート入力ファイルとして用いることができます。このテンプレートファイルは、デフォルトの設定の場合表面に垂直な方向は <em>c</em> 軸で、波動関数の接続位置は最表面の原子から3 bohr離れた地点になるような値が採用されます。このふるまいを変更するには、 <code class="docutils literal notranslate"><span class="pre">nfinp.data</span></code> ファイルに次の記述を行います。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  stm{
    sw_stm = on
    z_axis = 3
    connect_from = 3 bohr
  }
}
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">postprocessing</span></code> ブロックの下のstmブロックの下の <code class="docutils literal notranslate"><span class="pre">z_axis</span></code> に表面に垂直な軸の数値を(<em>a</em> 軸なら1, <em>b</em> 軸なら2,
<em>c</em> 軸なら3)、 <code class="docutils literal notranslate"><span class="pre">connect_from</span></code> に接続位置の最表面原子からの距離を指定します。 <code class="docutils literal notranslate"><span class="pre">z_axis</span></code> のデフォルト値は3, <code class="docutils literal notranslate"><span class="pre">connect_from</span></code> のデフォルト値は3 bohrです。</p>
</section>
<section id="id9">
<h4><span class="section-number">8.2.4.2. </span>STMプログラムの入出力ファイル<a class="headerlink" href="#id9" title="この見出しへのパーマリンク"></a></h4>
<p>STMプログラムの入出力ファイルには次の表に示す９つのものがあります。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ファイル指示名</p></th>
<th class="head"><p>番号</p></th>
<th class="head"><p>既定ファイル名</p></th>
<th class="head"><p>入出力</p></th>
<th class="head"><p>内容</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>F_INP</p></td>
<td><p>31</p></td>
<td><p>nfstminput.data</p></td>
<td><p>入力</p></td>
<td><p>STM像のエネルギー範囲などの指示</p></td>
</tr>
<tr class="row-odd"><td><p>F_CNTN_BIN</p></td>
<td><p>55</p></td>
<td><p>continue_bin_stm.data</p></td>
<td><p>入力</p></td>
<td><p>固有値,
基底逆格子点の集合などのデータ</p></td>
</tr>
<tr class="row-even"><td><p>F_ZAJ</p></td>
<td><p>44</p></td>
<td><p>zaj.data</p></td>
<td><p>入力</p></td>
<td><p>波動関数の平面波展開係数</p></td>
</tr>
<tr class="row-odd"><td><p>F_VLC</p></td>
<td><p>45</p></td>
<td><p>nfvlc.data</p></td>
<td><p>入力</p></td>
<td><p>ポテンシャルの局所成分</p></td>
</tr>
<tr class="row-even"><td><p>F_CHGU</p></td>
<td><p>60</p></td>
<td><p>nfchgu.cube</p></td>
<td><p>出力</p></td>
<td><p>Schrödinger方程式を解いて得た電子状態密度</p></td>
</tr>
<tr class="row-odd"><td><p>F_CHGD</p></td>
<td><p>61</p></td>
<td><p>nfchgd.cube</p></td>
<td><p>出力</p></td>
<td><p>F_CHGUと同様。但し,down spin 状態</p></td>
</tr>
<tr class="row-even"><td><p>F_CHGU_P</p></td>
<td><p>46</p></td>
<td><p>nfchgu_asis.cube</p></td>
<td><p>出力</p></td>
<td><p>入力波動関数から得た電子状態密度</p></td>
</tr>
<tr class="row-odd"><td><p>F_CHGD_P</p></td>
<td><p>47</p></td>
<td><p>nfchgd_asis.cube</p></td>
<td><p>出力</p></td>
<td><p>F_CHGU_Pと同様。但し,down spin 状態</p></td>
</tr>
<tr class="row-even"><td><p>file_names.data</p></td>
<td><p>5</p></td>
<td><p>stm_file_names.data</p></td>
<td><p>入力</p></td>
<td><p>上の８つのファイルを指定するためのファイル</p></td>
</tr>
</tbody>
</table>
<p>なお、電子状態密度は Gaussian cube
形式で出力されます。</p>
<blockquote>
<div><p><strong>stm_file_names.data</strong></p>
</div></blockquote>
<p>ファイル名を指定するためのファイル。PHASE/0におけるfile_names.dataファイルに相当するファイルです。このファイルが存在しない場合上述のデフォルトファイル名が採用されます。このファイルを利用する場合、以下のように記述します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = &#39;./nfstminput.data&#39;
F_CNTN_BIN = &#39;./continue_bin_stm.data&#39;
F_VLC = &#39;./nfvlc.data&#39;
F_ZAJ = &#39;./zaj.data&#39;
F_CHGU = &#39;./nfchgu_occ.cube&#39;
F_CHGU_P = &#39;./nfchgu_p_occ.cube&#39;
/
</pre></div>
</div>
<p>F_CNTN_BIN, F_ZAJ, F_VLC はPHASE/0の出力データなので、PHASE/0の指定に合わせる必要があります。デフォルト値はPHASE/0と同じです。</p>
<blockquote>
<div><p><strong>F_INP (nfstminput.data)</strong></p>
</div></blockquote>
<p>このファイルはSTMプログラムの入力ファイルです。典型的には以下のようなものになります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>4 1 : kv3, nspin
1 0.0000 -0.1624 -0.3247 0.0000 -0.3750 -0.3750 0.25
2 0.0000 -0.1624 -0.1082 0.0000 -0.3750 -0.1250 0.25
3 0.0000 -0.0541 -0.3247 0.0000 -0.1250 -0.3750 0.25
4 0.0000 -0.0541 -0.1082 0.0000 -0.1250 -0.1250 0.25
110 42.9043654360 ! neg, zl (=lattice c)
-3.00 -2.000 ! e1, e2 : Efermi+e1 - Efermi+e2
90 ! nlpf
53 90 !izi, izf
1 ! colomn number of the z-component
0.10 0.15 100 ! rini, rfin, nfin
0.01 ! erlmt
</pre></div>
</div>
<p>１行目の最初の数字は, k 点の個数です。あとの数字はスピンの違いを考慮するかしないかを示す数で、考慮しない場合が 1 する場合が 2 です。2行目から4行目まではｋ点の座標です。全部で 4 × 1 = 4 組の座標があります。さらに最後のカラムにk点座標の重みを指定します。ここではスピンの違いを考慮していないためこうなりましたが、スピンの違いがある場合の記すべき座標の組の個数は１行目に記したｋ点の個数の倍に等しくなります。座標の番号・直交座標系での座標・基本逆格子ベクトル系での座標で一組の座標指定になります。</p>
<p>6行目の <code class="docutils literal notranslate"><span class="pre">110</span> <span class="pre">42.9043654360</span> <span class="pre">!</span> <span class="pre">neg,</span> <span class="pre">zl</span> <span class="pre">(=lattice</span> <span class="pre">c)</span></code> の最初の数字はエネルギーバンドの数、あとの数字は表面に垂直方向の結晶格子の長さです。長さはボーア単位です。7行目の2つの数字はエネルギー範囲です。フェルミエネルギーレベルを基準にします。8行目の数字は電荷密度FFTにおける格子点の表面垂直方向の数に関係した数です。反転対称がない系ではｃ軸方向の電荷密度 FFT 格子点の数そのもの, 反転対称がある系ではその半分の数を指定します。9行目の２つの数字は真空領域の Schrödinger 方程式を解く範囲の指定です。電荷密度FFTの格子点でその範囲を指定します。10行目の数は表面垂直方向がどの成分に対応しているかを指示します。表面垂直軸が第1格子ベクトルの方向であれば1、第2格子ベクトルの方向であれば2、第3格子ベクトルの方向であれば3を指定します。11行目, 12行目はSchrödinger 方程式を反復法で解くときに指定する必要がある数値で順に新しい解を混ぜる割合の初期値, 最終値, 反復回数, 収束判定誤差値にそれぞれ対応します。</p>
<p>nfstminput.dataファイルはFFTのメッシュ点数など通常気にしなくてよい数値を指定する必要があり、その作成は煩雑で間違えやすいです。そのため、PHASE/0が出力するテンプレートファイルを利用することが推奨されます。テンプレートファイルをもとに、対象としたいエネルギーレンジ(上の例の場合7行目)や、実行してみて収束しなかった場合に収束に関わるパラメーター(上の例の場合11行目と12行目) を編集します。</p>
</section>
</section>
<section id="id10">
<h3><span class="section-number">8.2.5. </span>STMプログラムの実行<a class="headerlink" href="#id10" title="この見出しへのパーマリンク"></a></h3>
<p>PHASE/0を実行したディレクトリーにおいて <code class="docutils literal notranslate"><span class="pre">nfstminput.data</span></code> ファイルと（既定のファイル名を変更したい場合） <code class="docutils literal notranslate"><span class="pre">stm_file_names.data</span></code> ファイルを準備し、実行します。</p>
<pre class="literal-block"> $ ~/phase0_2024.01/bin/stm
 STM program version 2024.01
 &#64;(#)system=linux
 F_INP =
 ./nfstminput.data
 ...
 ...
 0.13860790D-07 0.85993468D-07
(  2 ) rmix = 0.10 ||d WF|| (errsum) = 0.3550D+02 ( 0.4077D+05)
(  3 ) rmix = 0.10 ||d WF|| (errsum) = 0.1716D+02 ( 0.3773D+05)
(  4 ) rmix = 0.10 ||d WF|| (errsum) = 0.1937D+03 ( 0.7686D+05)
(  5 ) rmix = 0.10 ||d WF|| (errsum) = 0.1398D+02 ( 0.3682D+05)
(  6 ) rmix = 0.10 ||d WF|| (errsum) = 0.1692D+02 ( 0.3691D+05)
(  7 ) rmix = 0.10 ||d WF|| (errsum) = 0.4915D+02 ( 0.4018D+05)
(  8 ) rmix = 0.10 ||d WF|| (errsum) = 0.8600D+02 ( 0.4573D+05)
(  9 ) rmix = 0.10 ||d WF|| (errsum) = 0.2747D+02 ( 0.3736D+05)
( 10 ) rmix = 0.10 ||d WF|| (errsum) = 0.1368D+02 ( 0.3679D+05)
( 11 ) rmix = 0.10 ||d WF|| (errsum) = 0.2098D+02 ( 0.3660D+05)
( 12 ) rmix = 0.10 ||d WF|| (errsum) = 0.1242D+02 ( 0.3609D+05)
 ...
 ...
 &lt;&lt; cpu time statistics &gt;&gt;
 1 2dFFT_fine 68.72040(sec.)
 2 rd_WFs_doFFT_and_solve_eq_core 17.95710(sec.)
 3 FFT_fine 0.49030(sec.)
 4 m_pwBS_set_FFT_mapfunctions 0.00090(sec.)
 5 m_pwBS_kinetic_energies 0.00010(sec.)

 closed filenumber = 31
 closed filenumber = 55
 closed filenumber = 60
 closed filenumber = 61
 closed filenumber = 44
 closed filenumber = 45
 closed filenumber = 46
 closed filenumber = 47
 closed filenumber = 48</pre>
<p>ログにはまずは前処理の結果などが報告されます。繰り返し計算の部分の <code class="docutils literal notranslate"><span class="pre">(errsum)=</span></code> に続く数値が収束判定に用いられる数値です。この数値が順調に減少していれば問題なく計算が進行していることになりますが、振動してしまったり、悪い場合はInfinityとなってしまったりしている場合はうまく進行していないので混合パラメーターなどを見直して再度計算を行います。最後にclosed filenumber =から始まる行が続けば計算修了です。</p>
</section>
<section id="id11">
<h3><span class="section-number">8.2.6. </span>計算結果<a class="headerlink" href="#id11" title="この見出しへのパーマリンク"></a></h3>
<p>STMプログラムによって得られる主要な結果は <code class="docutils literal notranslate"><span class="pre">nfchgu.cube</span></code> と <code class="docutils literal notranslate"><span class="pre">nfchgd.cube</span></code> です。前者はアップスピン状態の電荷密度ファイル、後者はダウンスピン状態の電荷密度ファイルですが後者はスピンを考慮していない場合空ファイルとなります。このほか、PHASE/0の結果から読み込んだ波動関数を何も加工せずに部分電荷密度を計算した結果が <code class="docutils literal notranslate"><span class="pre">nfchgu_asis.cube</span></code> と <code class="docutils literal notranslate"><span class="pre">nfchgd_asis.cube</span></code> に記録されます。</p>
<p>cubeファイルから指定のzの値における二次元的な電荷密度データを抽出しファイルに記録するスクリプトが <code class="docutils literal notranslate"><span class="pre">extract_slice.py</span></code> です。 このスクリプトは <code class="docutils literal notranslate"><span class="pre">bin</span></code> ディレクトリーの下にあります。オプション <code class="docutils literal notranslate"><span class="pre">-h</span></code> もしくは <code class="docutils literal notranslate"><span class="pre">--help</span></code> をつけて実行すると簡単なヘルプメッセージが得られます。</p>
<pre class="literal-block">$ ~/phase0_2024.01/bin/extract_slice.py -h
Usage: extract_slice.py [options]

extract slice data from a cube file

Options:
  -h, --help            show this help message and exit
  -c CUBE, --cube=CUBE  the target cube file. defaults to nfchr.cube
  -z ZVAL, --zval=ZVAL  the height from which the slice data shall be
                        extracted.
  -a ZAXIS, --zaxis=ZAXIS
                        specify which direction is considered as the z-axis. 1
                        stands for the a-vector,                       2
                        stands for the b-vector, and 3 stands for the
                        c-vector. defaults to 3
  -i ZINDEX, --zindex=ZINDEX

                        shall be extracted.
  -o OUTPUT, --output=OUTPUT
                        the file to which the extracted results are output</pre>
<p>用いることができるオプションは次の表に記述する通りです。</p>
<table class="docutils align-default" id="id165">
<caption><span class="caption-number">表 8.1 </span><span class="caption-text">extract_slice.pyスクリプトのオプション</span><a class="headerlink" href="#id165" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>-c CUBE, --cube=CUBE</p></td>
<td><p>対象のcubeファイル。デフォルト値はnfchr.cube.</p></td>
</tr>
<tr class="row-even"><td><p>-z ZVAL, --zval=ZVAL</p></td>
<td><p>二次元的な電荷密度データを抽出したいzの値。単位はÅ. デフォルト値はNoneであり、指定がない場合は--zindexによって指定されるいインデックスが用いられる。</p></td>
</tr>
<tr class="row-odd"><td><p>-a ZAXIS, --zaxis=ZAXIS</p></td>
<td><p>表面に垂直とみなす軸。1の場合 <em>a</em> 軸 2の場合 <em>b</em> 軸 3の場合 <em>c</em> 軸に対応する。デフォルト値は3.</p></td>
</tr>
<tr class="row-even"><td><p>-i ZINDEX, --zindex=ZAXIS</p></td>
<td><p>二次元的な電荷密度データを抽出したいzの値をFFTボックスのインデックスで指定する。--zvalによる指定がある場合は無視される。デフォルト値は0.</p></td>
</tr>
<tr class="row-odd"><td><p>-o OUTPUT, --output=OUTPUT</p></td>
<td><p>出力先のファイル。デフォルト値はslice.dat</p></td>
</tr>
</tbody>
</table>
<p>結果は以下のような形式で出力されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x_1 y_1 c_1_1
x_1 y_2 c_1_2
..
x_nx y_ny c_nx_ny

x_2 y_1 c_2_1
..
</pre></div>
</div>
<p>ここで <code class="docutils literal notranslate"><span class="pre">x_i</span></code> は <code class="docutils literal notranslate"><span class="pre">i</span></code> 番目のx座標、 <code class="docutils literal notranslate"><span class="pre">y_j</span></code> は <code class="docutils literal notranslate"><span class="pre">j</span></code> 番目のx座標、 <code class="docutils literal notranslate"><span class="pre">c_i_j</span></code> は対応する電荷密度の値です。長さの単位はÅです。</p>
</section>
<section id="id12">
<h3><span class="section-number">8.2.7. </span>計算例<a class="headerlink" href="#id12" title="この見出しへのパーマリンク"></a></h3>
<p>計算例として、前節でも用いたSiの2x1表面のSTM像の計算を行います。入力ファイルは <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1</span></code> 以下にあります。SCF計算の入力が <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/scf</span></code> 以下に、STMプログラムの入力が <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/occ</span></code> と <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/uocc</span></code> 以下にあります。前者には占有状態の入力ファイル、後者には非占有状態の入力ファイルが配置されています。</p>
<p><code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/scf</span></code> には原点を中心とした反転対称性がある系のPHASE/0の入力ファイルがおかれています。単位胞としては <em>a</em> 軸が14.512 Bohr, <em>b</em> 軸が7.256 Bohr, <em>c</em> 軸が60 Bohrです。60 Bohrのちょうど半分の30 Bohrの位置が二面ある表面双方から最も遠い点に対応します。 <code class="docutils literal notranslate"><span class="pre">Postprocessing</span></code> ブロックにおいて <code class="docutils literal notranslate"><span class="pre">stm</span></code> ブロックの下に <code class="docutils literal notranslate"><span class="pre">sw_stm</span> <span class="pre">=</span> <span class="pre">on</span></code> を設定しているためSTMプログラムを利用するために必要なファイルが出力される状態になっています。</p>
<p><code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/occ</span></code> と <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/uocc</span></code> に配置されているSTMプログラムの入力は、いずれもPHASE/0が出力したテンプレートから作成したものです。エネルギーレンジの部分のみ変更しており、前者はフェルミエネルギーからみて-1.0 eVから 0.0 eV, 後者はフェルミエネルギーからみて0.0 eVから1.0 eVのSTM像が得られる設定となっています。また、SCF計算0の計算結果は一階層上の下の <code class="docutils literal notranslate"><span class="pre">scf</span></code> ディレクトリーに出力されることになるため、 <code class="docutils literal notranslate"><span class="pre">stm_file_names.data</span></code> ファイルはそのことを考慮して以下のような内容になっています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_CNTN_BIN = &#39;../scf/continue_bin_stm.data&#39;
F_ZAJ      = &#39;../scf/zaj.data&#39;
F_VLC      = &#39;../scf/nfvlc.data&#39;
/
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/scf</span></code> においてPHASE/0によるSCF計算を行い、さらに <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/occ</span></code>, <code class="docutils literal notranslate"><span class="pre">stm/Si_2x1/uocc</span></code> においてSTMプログラムを実行すると結果を得ることができます。 <code class="docutils literal notranslate"><span class="pre">nfchgu.cube</span></code> がSTMプログラムによって得られた部分電荷密度ファイル、 <code class="docutils literal notranslate"><span class="pre">nfchgu_asis.cube</span></code> がPHASE/0から引き継いだ波動関数をそのまま用いて得られた部分電荷密度ファイルです。得られたcubeファイルを用いて表面から5 Å および10 Åの位置におけるSTM像を描画した結果が <a class="reference internal" href="#advanced-stm-occ"><span class="std std-numref">図 8.3</span></a> および <a class="reference internal" href="#advanced-stm-uocc"><span class="std std-numref">図 8.4</span></a> です。前者が占有状態、後者が非占有状態の結果に対応します。</p>
<figure class="align-default" id="advanced-stm-occ">
<img alt="../_images/stm_occ.svg" src="../_images/stm_occ.svg" /><figcaption>
<p><span class="caption-number">図 8.3 </span><span class="caption-text">占有状態のSTM像。(a) PHASE/0の波動関数、最表面から5 Åの位置の像 (b) PHASE/0の波動関数、最表面から10 Åの位置の像 (c) STMプログラムによって解きなおした波動関数、最表面から5 Åの位置の像(b) STMプログラムによって解きなおした波動関数、最表面から10 Åの位置の像</span><a class="headerlink" href="#advanced-stm-occ" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="advanced-stm-uocc">
<img alt="../_images/stm_uocc.svg" src="../_images/stm_uocc.svg" /><figcaption>
<p><span class="caption-number">図 8.4 </span><span class="caption-text">非占有状態のSTM像。(a) PHASE/0の波動関数、最表面から5 Åの位置の像 (b) PHASE/0の波動関数、最表面から10 Åの位置の像 (c) STMプログラムによって解きなおした波動関数、最表面から5 Åの位置の像 (b) STMプログラムによって解きなおした波動関数、最表面から10 Åの位置の像</span><a class="headerlink" href="#advanced-stm-uocc" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#advanced-stm-occ"><span class="std std-numref">図 8.3</span></a> より、最表面原子から5 Å離れた位置ではPHASE/0が出力した波動関数でもそれらしい像が得られますが、10 Å離れた位置ではPHASE/0が出力した波動関数の像はノイズが大きく不明瞭なことが分かります。それに対し、STMがプログラムが出力した像は10 Åにおいてもなおもっともらしい像が得られ、また5 Åの場合と比較してどのように変化したかを理解することができます。<a class="reference internal" href="#advanced-stm-uocc"><span class="std std-numref">図 8.4</span></a> より、非占有状態の場合5 Åの段階ですでにPHASE/0が出力した波動関数がもたらす像にはある程度の不明瞭さがあることが分かります。それに対し、STMプログラムがもたらす像は5 Å, 10 Åいずれの距離においてもはっきりとしたきれいな像になっていることが分かります。</p>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="kageshima91" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">Kageshima91</a><span class="fn-bracket">]</span></span>
<p>影 島 博 之 博 士 論 文(1991年 東 京 大 学).</p>
</div>
<div class="citation" id="kageshima92" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">Kageshima92</a><span class="fn-bracket">]</span></span>
<p>H. Kageshima and M. Tsukada , &quot;Theory of scanning tunneling microscopy and spectroscopy on Si(100) reconstructed surfaces&quot; PHYSICAL REVIEW B 46 6928 (1992).</p>
</div>
</div>
</section>
</section>
<section id="section-bader-charge">
<span id="id13"></span><h2><span class="section-number">8.3. </span>ベーダ―解析向け電荷密度ファイルの出力 (バージョン2019.02以降)<a class="headerlink" href="#section-bader-charge" title="この見出しへのパーマリンク"></a></h2>
<section id="id14">
<h3><span class="section-number">8.3.1. </span>概要<a class="headerlink" href="#id14" title="この見出しへのパーマリンク"></a></h3>
<p>PHASE/0における実空間における電荷密度出力機能では、通常価電子部分のみが出力されますが、ベーダ―解析では、内殻電子の寄与も考慮することにより、解析精度を上げることが出来ます。そこで、CUBE形式ファイルの出力の際に、内殻電子の寄与を加える機能が搭載されています。</p>
</section>
<section id="id15">
<h3><span class="section-number">8.3.2. </span>ベーダ―解析について<a class="headerlink" href="#id15" title="この見出しへのパーマリンク"></a></h3>
<p>ベーダ―解析とは、CUBE形式のファイルから各原子に割り当てる電子数を求める解析手法です。PHASE/0にベーダ―解析を行う機能そのものは備わっていませんが、ベーダ―解析はbaderプログラム</p>
<p><a class="reference external" href="http://theory.cm.utexas.edu/henkelman/code/bader/">http://theory.cm.utexas.edu/henkelman/code/bader/</a></p>
<p>をダウンロードし、コンパイルすることによって簡単に行うことができます。詳しくはbaderプログラムのドキュメントなどを参照してください。</p>
</section>
<section id="id16">
<h3><span class="section-number">8.3.3. </span>処理内容<a class="headerlink" href="#id16" title="この見出しへのパーマリンク"></a></h3>
<p>価電子密度及び内殻電子密度を、それぞれ <span class="math notranslate nohighlight">\(\rho_{\rm v}(\mathbf{r})\)</span> 及び <span class="math notranslate nohighlight">\(\rho_{\rm c}(\mathbf{r})\)</span> とします。CUBEファイルに出力する全電子密度は、両者の合計です。さて、<span class="math notranslate nohighlight">\(\rho_{\rm c}(\mathbf{r})\)</span> は、サイトIにある原子種 <span class="math notranslate nohighlight">\(\alpha\)</span> の内殻電子密度 <span class="math notranslate nohighlight">\(\rho_{\rm c}^{\alpha} (\mathbf{r}-\mathbf{R}_I)\)</span> を足し合わせたものである。</p>
<div class="math notranslate nohighlight" id="advanced-bader-eq1">
<span id="equation-advanced-bader-eq1"></span><span class="eqno">(8.1)<a class="headerlink" href="#advanced-bader-eq1" title="この数式へのパーマリンク"></a></span>\[\rho_{\rm c} (\mathbf{r}) = \sum_{I} \rho_{\rm c}^{\alpha} (\mathbf{r} - \mathbf{R}_I)\]</div>
<p>ここで、は球対称であり、擬ポテンシャルファイル中に出力されています。これを読みこみ、以下の処理をします。</p>
<ol class="arabic simple">
<li><p>逆格子空間で処理する場合</p></li>
</ol>
<div class="math notranslate nohighlight" id="advanced-bader-eq2">
<span id="equation-advanced-bader-eq2"></span><span class="eqno">(8.2)<a class="headerlink" href="#advanced-bader-eq2" title="この数式へのパーマリンク"></a></span>\[\rho_{\rm c} (\mathbf{G}) = \sum_{I} \rho_{\rm c}^{\alpha} ( \mathbf{G} ) \exp (-i \mathbf{G} \cdot \mathbf{R}_I )\]</div>
<p>を価電子密度 <span class="math notranslate nohighlight">\(\rho_{\rm v} (\mathbf{G})\)</span> に加えた <span class="math notranslate nohighlight">\(\rho_{\rm tot} (\mathbf{G})\)</span> を計算し、フーリエ変換により <span class="math notranslate nohighlight">\(\rho_{\rm tot} (\mathbf{r})\)</span> を求める。</p>
<ol class="arabic simple" start="2">
<li><p>実空間で処理する場合</p></li>
</ol>
<p>まず、にフーリエ変換を施しを得る。次に、実空間のメッシュ点 jで</p>
<div class="math notranslate nohighlight" id="advanced-bader-eq3">
<span id="equation-advanced-bader-eq3"></span><span class="eqno">(8.3)<a class="headerlink" href="#advanced-bader-eq3" title="この数式へのパーマリンク"></a></span>\[\rho_{\rm c} (\mathbf{r}_j) = \sum_{I} \rho_{\rm c}^{\alpha} ( \mathbf{r}_j - \mathbf{R}_I )\]</div>
<p>を計算し、 <span class="math notranslate nohighlight">\(\rho_{\rm v} (\mathbf{r}_j)\)</span> に加えて <span class="math notranslate nohighlight">\(\rho_{\rm tot} (\mathbf{r}_j)\)</span> を得る。これを全てのメッシュ点に対して行えばよい。なお、内殻電子密度は原子核近傍に局在しているので、メッシュ点
jは、原子位置 <span class="math notranslate nohighlight">\(\mathbf{R}_I\)</span> から適当な距離 rcut以内にあるものを選ぶ。</p>
</section>
<section id="id17">
<h3><span class="section-number">8.3.4. </span>入力<a class="headerlink" href="#id17" title="この見出しへのパーマリンク"></a></h3>
<p>filetype = cube 及びsw_add_corecharge_rspace = on
とすると、(擬ポテンシャルから読み込んだ)
内殻電子密度を加えた全電子密度分布が、CUBE
ファイルとして出力されます。また、eval_corecharge_on_Gspace =on (off)
のとき、逆格子空間 (実空間) で内殻電子密度を価電子密度に加えます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  charge{
    sw_charge_rspace = on
    filetype = cube
    sw_add_corecharge_rspace = on ( デフォルト：off )
    eval_corecharge_on_Gspace = off ( デフォルト：off )
  }
}
</pre></div>
</div>
<p>上述の設定はPAW対応擬ポテンシャルを利用する場合に利用できます。PAW非対応の古い擬ポテンシャルを用いる場合、次のように設定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  charge{
    sw_charge_rspace = on
    filetype = cube
    sw_add_corecharge_rspace = on
    sw_read_corecharge_extra_file = on
  }
}
</pre></div>
</div>
<p>すなわち、パラメーター <code class="docutils literal notranslate"><span class="pre">sw_read_corecharge_extra_file</span></code> を <code class="docutils literal notranslate"><span class="pre">on</span></code> にすることによって別の擬ポテンシャルから内殻の情報を読み込みます。
読み込むファイル名は、 <code class="docutils literal notranslate"><span class="pre">file_names.data</span></code>  内で <code class="docutils literal notranslate"><span class="pre">F_CORE_CHARGE(n)</span></code> で指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
...
F_CORE_CHARGE(1) = &#39;Si_ggapbe_paw_nc_01m.pp&#39;
...
/
</pre></div>
</div>
<p>なお、 <code class="docutils literal notranslate"><span class="pre">F_POT(n)</span></code> で指定した擬ポテンシャルファイルが内殻電子密度を含む場合には、 <code class="docutils literal notranslate"><span class="pre">F_CORE_CHAEGE(n)</span></code> で指定したファイルは無視されます。</p>
</section>
<section id="id18">
<h3><span class="section-number">8.3.5. </span>出力<a class="headerlink" href="#id18" title="この見出しへのパーマリンク"></a></h3>
<p>出力ファイル名は、価電子密度のCUBEファイル名を元に “_ae”
を加えた名称です。例えば、価電子密度CUBEファイル名が “nfchr.data”
の場合、全電子密度CUBEファイルは ”nfchr_ae.data” となります。</p>
</section>
<section id="id19">
<h3><span class="section-number">8.3.6. </span>計算例<a class="headerlink" href="#id19" title="この見出しへのパーマリンク"></a></h3>
<section id="gan">
<h4><span class="section-number">8.3.6.1. </span>GaNの計算例<a class="headerlink" href="#gan" title="この見出しへのパーマリンク"></a></h4>
<p>GaNの例を紹介します。入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/Bader/GaN</span></code> 以下にあります。</p>
<p>格子定数や原子位置はあらかじめ最適化したものを採用しました。</p>
<p>bader プログラムを用いる際、以下の評価法1-3を試しました。結果を
<a class="reference internal" href="#advanced-bader-table1"><span class="std std-numref">表 8.2</span></a> に示す。</p>
<p>評価法1: bader nfchr.data ( 価電子密度を利用、従来法 )</p>
<p>評価法2: bader nfchr_ae.data ( 全電荷密度を利用)</p>
<p>評価法3: bader nchr.data -ref nfchr_ae.data</p>
<p>(切断する位置は全電荷密度で決定、積分は価電子密度を利用)</p>
<table class="longtable docutils align-default" id="advanced-bader-table1">
<caption><span class="caption-number">表 8.2 </span><span class="caption-text">GaNのベーダ―電荷</span><a class="headerlink" href="#advanced-bader-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>Ga</p></td>
<td><p>N</p></td>
<td><p>評価</p></td>
</tr>
<tr class="row-even"><td><p>Elk</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>plot3dのメッシュ：160x160x250</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>1.34,, 1.59</p></td>
<td><p>-1.55</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>PHASE/0</p></td>
<td><p>eval_corecharge_on_Gspace = off</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 270Ry (CD_FFTメッシュ：32x32x108)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>1.51</p></td>
<td><p>-1.51</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>*2</p></td>
<td><p>3.15</p></td>
<td><p>-1.44</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.47</p></td>
<td><p>-1.47</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>cutoff_cd = 2700Ry (CD_FFTメッシュ：108x108x80)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>評価法1</p></td>
<td><p>1.58</p></td>
<td><p>-1.58</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-even"><td><p>*2</p></td>
<td><p>0.78</p></td>
<td><p>-1.51</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>1.51</p></td>
<td><p>-1.51</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 6150Ry (CD_FFTメッシュ：160x160x250)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>1.58</p></td>
<td><p>-1.58</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>*2</p></td>
<td><p>1.58</p></td>
<td><p>-1.52</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.51</p></td>
<td><p>-1.51</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>PHASE/0</p></td>
<td><p>eval_corecharge_on_Gspace = on</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 270Ry (CD_FFTメッシュ：32x32x108)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>1.51</p></td>
<td><p>-1.51</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.35, 1.36</p></td>
<td><p>-1.36, -1.35</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.28</p></td>
<td><p>-1.28</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>cutoff_cd = 2700Ry (CD_FFTメッシュ：108x108x80)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>評価法1</p></td>
<td><p>1.58</p></td>
<td><p>-1.58</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1.22</p></td>
<td><p>-1.22</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>1.22</p></td>
<td><p>-1.22</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 6150Ry (CD_FFTメッシュ：160x160x250)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>1.58</p></td>
<td><p>-1.58</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.21</p></td>
<td><p>-1.21</p></td>
<td><p>NG</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.21</p></td>
<td><p>-1.21</p></td>
<td><p>NG</p></td>
</tr>
</tbody>
</table>
<p>*電荷密度の積分値が全電荷と一致しない点に注意。</p>
<p>eval_corecharge_on_Gspace =
onの場合、全電子密度の積分値がメッシュサイズによらず整数値になるものの、原子近傍に微少な電荷(ごみ)が現れてしまい、bader
がこれを検知するため精度が悪いようです。</p>
<p>一方、eval_corecharge_on_Gspace =
offの場合、かなりcutoff_cdを上げないと、全電子密度の積分値は、全電荷と一致しません。しかし、評価法3を用いることで、それなりの精度でベーダ―電荷が求められることがわかりました。</p>
</section>
<section id="h-sic">
<h4><span class="section-number">8.3.6.2. </span>4H-SiCの計算例<a class="headerlink" href="#h-sic" title="この見出しへのパーマリンク"></a></h4>
<p>4H-SiCの例を紹介します。入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/Bader/4H-SiC</span></code> 以下にあります。</p>
<p>格子定数や原子位置はあらかじめ最適化したものを採用しました。</p>
<p>GaNの場合と同様、bader
プログラムを用いる際、以下の評価法1-3を試しました。結果を <a class="reference internal" href="#advanced-bader-table2"><span class="std std-numref">表 8.3</span></a> に示します。</p>
<p>評価法1: bader nfchr.data ( 価電子密度を利用、従来法 )</p>
<p>評価法2: bader nfchr_ae.data ( 全電荷密度を利用 )</p>
<p>評価法3: bader nchr.data -ref nfchr_ae.data</p>
<p>(切断する位置は全電荷密度で決定、積分は価電子密度を利用)</p>
<table class="longtable docutils align-default" id="advanced-bader-table2">
<caption><span class="caption-number">表 8.3 </span><span class="caption-text">4H-SiCのベーダ―電荷</span><a class="headerlink" href="#advanced-bader-table2" title="このテーブルへのパーマリンク"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Si</p></th>
<th class="head"><p>C</p></th>
<th class="head"><p>評価</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Elk</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>plot3dのメッシュ：150×150×480</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>※</p></td>
<td><p>2.66</p></td>
<td><p>-2.70, -2.69</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>PHASE/0</p></td>
<td><p>eval_corecharge_on_Gspace = off</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 270Ry (CD_FFTメッシュ：32×32×108)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td><p>※2</p></td>
<td><p>-4.27, 2.88</p></td>
<td><p>-2.66, -2.55</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2.56, 2.58</p></td>
<td><p>-2.58, -2.56</p></td>
<td><p>○</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>cutoff_cd = 2700Ry (CD_FFTメッシュ：100×100×320)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td><p>※2</p></td>
<td><p>2.59, 2.67</p></td>
<td><p>-2.68, -2.67</p></td>
<td><p>○</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>2.65, 2.66</p></td>
<td><p>-2.66, -2.65</p></td>
<td><p>○</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 6150Ry (CD_FFTメッシュ：150×150×480)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td><p>※2</p></td>
<td><p>2.66, 2.68</p></td>
<td><p>-2.69, -2.68</p></td>
<td><p>○</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2.66, 2.67</p></td>
<td><p>-2.67, -2.66</p></td>
<td><p>○</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>PHASE/0</p></td>
<td><p>eval_corecharge_on_Gspace = on</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 270Ry (CD_FFTメッシュ：32×32×108)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>0.94, 1.03</p></td>
<td><p>-0.92, -1.03</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>0.89, 1.06</p></td>
<td><p>-0.94, -1.01</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>cutoff_cd = 2700Ry (CD_FFTメッシュ：100×100×320)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1.18, 1.24</p></td>
<td><p>-1.22, -1.19</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>1.18, 1.24</p></td>
<td><p>-1.22, -1.19</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cutoff_cd = 6150Ry (CD_FFTメッシュ：150×150×480)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>評価法1</p></td>
<td><p>4.00</p></td>
<td><p>-4.00</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1.20, 1.24</p></td>
<td><p>1.21, 1.23</p></td>
<td><p>×</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>1.20, 1.24</p></td>
<td><p>1.21, 1.23</p></td>
<td><p>×</p></td>
</tr>
</tbody>
</table>
<p>※電荷密度の積分値が全電荷と一致しない点に注意。</p>
<p>GaNの場合と同様に、eval_corecharge_on_Gspace =
onの場合、全電子密度の積分値がメッシュサイズによらず整数値になるものの、原子近傍に微少な電荷(ごみ)が現れてしまい、bader
がこれを検知するため精度が悪いようです。</p>
<p>一方、eval_corecharge_on_Gspace =
offの場合、かなりcutoff_cdを上げないと、全電子密度の積分値は、全電荷と一致しません。しかし、評価法3を用いることで、それなりの精度でベーダ―電荷が求められています。また、GaNの場合と異なり、価電子密度のみを用いる評価法1は期待される結果を出力しておらず、注意が必要です。</p>
</section>
</section>
</section>
<section id="section-stress-tensor">
<span id="id20"></span><h2><span class="section-number">8.4. </span>ストレステンソル<a class="headerlink" href="#section-stress-tensor" title="この見出しへのパーマリンク"></a></h2>
<section id="id21">
<h3><span class="section-number">8.4.1. </span>機能の概要<a class="headerlink" href="#id21" title="この見出しへのパーマリンク"></a></h3>
<p>PHASEには、ストレステンソルを計算する機能があります。ストレステンソルを計算することにより、安定な格子定数や弾性定数を計算することができます。</p>
</section>
<section id="id22">
<h3><span class="section-number">8.4.2. </span>入力パラメータ<a class="headerlink" href="#id22" title="この見出しへのパーマリンク"></a></h3>
<p>ストレステンソルを計算するには、入力パラメータファイルnfinp.dataにおいて、structure_evolutionブロックの下のstressブロックで、ストレステンソル計算を有効にする指定をします。</p>
<p>Si（立方晶）の入力パラメータファイルの例を以下に示します。計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/elastic/Si/s0</span></code> 以下にあります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Control{
    condition = initial
}
accuracy{
    cutoff_wf =  20  rydberg
    cutoff_cd =  80  rydberg
    num_bands =   8
    ksampling{
        mesh{ nx = 10, ny = 10, nz = 10 }
    }
}
structure{
    unit_cell_type = primitive
    unit_cell{
        #units angstrom
        a_vector =   0.000000 2.723515 2.723515
        b_vector =   2.723515 0.000000 2.723515
        c_vector =   2.723515 2.723515 0.000000
    }
    symmetry{
        method = automatic
    }
    atom_list{
        coordinate_system = internal
        atoms{       #tag    rx      ry      rz   element
            0.125   0.125   0.125        Si
           -0.125  -0.125  -0.125        Si
        }
    }
    element_list{
        #tag   element   atomicnumber
                 Si            14
    }
}
structure_evolution{
    stress{
        sw_stress=on
    }
}
</pre></div>
</div>
<p>SCF 計算と同様に PHASE を実行します。</p>
<pre class="literal-block">% mpirun ~/phase0_2024.01/bin/phase</pre>
<p>計算が終了したら結果を確認します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>grep<span class="w"> </span>-A3<span class="w"> </span><span class="s1">&#39;Total STRESS TENSOR&#39;</span><span class="w"> </span>output000

STRESS<span class="w"> </span>TENSOR
<span class="m">0</span>.0000004032<span class="w"> </span><span class="m">0</span>.0000000000<span class="w"> </span><span class="m">0</span>.0000000000
<span class="m">0</span>.0000000000<span class="w"> </span><span class="m">0</span>.0000004032<span class="w"> </span><span class="m">0</span>.0000000000
<span class="m">0</span>.0000000000<span class="w"> </span><span class="m">0</span>.0000000000<span class="w"> </span><span class="m">0</span>.0000004032
</pre></div>
</div>
<p>ストレステンソルは</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
X_{x} &amp; X_{y} &amp; X_{z} \\
Y_{x} &amp; Y_{y} &amp; Y_{z} \\
Z_{x} &amp; Z_{y} &amp; Z_{z} \\
\end{pmatrix}\end{split}\]</div>
<p>の形式で出力されています。出力されている値の単位は
[Hartree/Bohr<sup>3</sup>] です。
上の結果では入力データとしてわずかに格子定数を小さく取ってあるため、正の <span class="math notranslate nohighlight">\(X_{x},Y_{y},Z_{z}\)</span> が出力されています。</p>
<p>また、釣り合いの位置からの格子変形(<span class="math notranslate nohighlight">\(\equiv e\)</span>)、スティフネス定数(<span class="math notranslate nohighlight">\(\equiv c\)</span>)を用いると次のようなフックの法則が成り立ちます。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left. \ \begin{matrix}
X_{x} = c_{11}e_{\text{xx}} + c_{12}e_{\text{yy}} + c_{12}e_{\text{zz}} \\
Y_{y} = c_{12}e_{\text{xx}} + c_{11}e_{\text{yy}} + c_{12}e_{\text{zz}} \\
Z_{z} = c_{12}e_{\text{xx}} + c_{12}e_{\text{yy}} + c_{11}e_{\text{zz}} \\
X_{y}( = Y_{x}) = c_{44}e_{\text{xy}} \\
Y_{z}( = Z_{y}) = c_{44}e_{\text{yz}} \\
Z_{x}( = X_{z}) = c_{44}e_{\text{zx}} \\
\end{matrix} \right\}\end{split}\]</div>
</section>
<section id="id23">
<h3><span class="section-number">8.4.3. </span>弾性定数<a class="headerlink" href="#id23" title="この見出しへのパーマリンク"></a></h3>
<p>ストレステンソルの計算結果から、弾性定数の計算を行う例を紹介します。弾性定数は、歪みのない結晶と歪みのある結晶のストレステンソルを利用すると、上述のフックの法則より計算することができます。ここでは、Si（立方晶）を例に説明します。この例題の入力ファイルは、 <code class="code docutils literal notranslate"><span class="pre">samples/elastic/Si</span></code> の <code class="code docutils literal notranslate"><span class="pre">s0</span></code> および <code class="code docutils literal notranslate"><span class="pre">sxx</span></code> の下にあります。 <code class="code docutils literal notranslate"><span class="pre">s0</span></code> が歪みのない結晶の入力データ、 <code class="code docutils literal notranslate"><span class="pre">sxx</span></code> がxx方向に歪みを与える場合の入力データです。</p>
<p>弾性定数を計算する場合、ストレステンソルの絶対値がなるべく小さくなる格子定数を利用することが望ましいです。
この例題は、ストレステンソルの各成分の絶対値が小さくなる、以下のような格子定数を採用しています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>unit_cell{
  #units angstrom
  a_vector = 0.000000 2.731958 2.731958
  b_vector = 2.731958 0.000000 2.731958
  c_vector = 2.731958 2.731958 0.000000
}
</pre></div>
</div>
<p>ディレクトリー <code class="code docutils literal notranslate"><span class="pre">samples/elastic/Si/s0</span></code> においてストレステンソルを計算すると以下のような結果が出力されます。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>grep<span class="w"> </span>-A3<span class="w"> </span><span class="s1">&#39;Total STRESS TENSOR&#39;</span><span class="w"> </span>output000

Total<span class="w"> </span>STRESS<span class="w"> </span>TENSOR
<span class="w">      </span><span class="m">0</span>.0000000301<span class="w">        </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000000
<span class="w">      </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000301<span class="w">        </span><span class="m">0</span>.0000000000
<span class="w">      </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000301
</pre></div>
</div>
<p>つぎに、ディレクトリsxxへ移ります。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>../sxx
</pre></div>
</div>
<p>このディレクトリーに置かれている入力ファイルはs0のものとほぼ同じですが、以下の設定によって11方向(xx方向)に0.001という格子歪みを与えた計算を行うことになります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure{
  ...
  ...
  strain{
    sw_strained_cell = on
    e11 = 0.001
  }
}
</pre></div>
</div>
<p>structureブロックの下にstrainブロックを作成し、変数sw_strained_cellをonとすると格子歪みを与えて計算を行うことができます。さらに変数e11, e12, e13, e22, e23, e33で非ゼロとする歪み成分を指定します。このディレクトリで計算を行うと、以下のようなストレステンソルが得られます。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>grep<span class="w"> </span>-A3<span class="w"> </span><span class="s1">&#39;Total STRESS TENSOR&#39;</span><span class="w"> </span>output000

Total<span class="w"> </span>STRESS<span class="w"> </span>TENSOR
<span class="w">     </span>-0.0000051660<span class="w">        </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000000
<span class="w">      </span><span class="m">0</span>.0000000000<span class="w">       </span>-0.0000018789<span class="w">        </span><span class="m">0</span>.0000000000
<span class="w">      </span><span class="m">0</span>.0000000000<span class="w">        </span><span class="m">0</span>.0000000000<span class="w">       </span>-0.0000018789
</pre></div>
</div>
<p>この例題の弾性定数の計算には、ストレステンソルの対角成分を用います。この計算例題では、回転や剪断ひずみを与えていませんので、非対角項は0になっています。</p>
<p>得られたストレステンソルから、 スティフネス定数<span class="math notranslate nohighlight">\(c_{11}\)</span>,
<span class="math notranslate nohighlight">\(c_{12}\)</span>を次式から計算します。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left. \ \begin{matrix}
X_{x} = c_{11}e_{\text{xx}} + c_{12}e_{\text{yy}} + c_{12}e_{\text{zz}} \\
Y_{y} = c_{12}e_{\text{xx}} + c_{11}e_{\text{yy}} + c_{12}e_{\text{zz}} \\
Z_{z} = c_{12}e_{\text{xx}} + c_{12}e_{\text{yy}} + c_{11}e_{\text{zz}} \\
X_{y}( = Y_{x}) = c_{44}e_{\text{xy}} \\
Y_{z}( = Z_{y}) = c_{44}e_{\text{yz}} \\
Z_{x}( = X_{z}) = c_{44}e_{\text{zx}} \\
\end{matrix} \right\}\end{split}\]</div>
<p>今のケースでは<span class="math notranslate nohighlight">\(e_{\text{xx}}\)</span>以外は0なので、歪みのない系とある系の<span class="math notranslate nohighlight">\(X_{x},\ Y_{y}\)</span>の差を歪み量
(0.001)で除すれば<span class="math notranslate nohighlight">\(c_{11}\)</span>と<span class="math notranslate nohighlight">\(c_{12}\)</span>を計算することができます。結果は <span class="math notranslate nohighlight">\(c_{11} = 5.196 \times 10^{-3} \ \mathrm{Hartree/Bohr}^3 = 153 \ \mathrm{GPa}, c_{12}=1.909 \times 10^{-3} \ \mathrm{Hartree/Bohr}^3 = 56.1 \ \mathrm{GPa}\)</span> となります。</p>
<p>一方、弾性定数(ヤング率(<span class="math notranslate nohighlight">\(\equiv Y\)</span>)・ポアソン比(<span class="math notranslate nohighlight">\(\equiv P\)</span>)・体積弾性率(<span class="math notranslate nohighlight">\(\equiv B\)</span>))はスティフネス定数を用いて次のような式で書き表されます。
剛性率は <span class="math notranslate nohighlight">\(Y/(2 + 2P)\)</span> と書けます。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left. \ \begin{matrix}
Y = \frac{c_{11}^{2} + c_{11}c_{12} - 2c_{12}^{2}}{c_{11} + c_{12}} \\
P = \left| \frac{c_{12}}{c_{11} + c_{12}} \right| \\
B = \frac{c_{11} + 2c_{12}}{3} \\
\end{matrix} \right\}\end{split}\]</div>
<p>これにスティフネス定数<span class="math notranslate nohighlight">\(c_{11}\)</span>, <span class="math notranslate nohighlight">\(c_{12}\)</span>を代入すれば Siの弾性定数は <span class="math notranslate nohighlight">\(Y = 123 \ \mathrm{GPa}, P=0.268, B=88.4 \ \mathrm{GPa}\)</span> と求まります。</p>
<p>より精度の高い弾性定数の計算を行ないたい場合、 cutoff_wf, cutoff_cdを大きめにとり、電子状態を充分に収束させる必要があり、計算時間のかかる計算になります。</p>
</section>
<section id="id24">
<h3><span class="section-number">8.4.4. </span>ストレステンソルの補正<a class="headerlink" href="#id24" title="この見出しへのパーマリンク"></a></h3>
<p>PHASE/0によるストレステンソルの計算は、精度が低い場合があります。原因は、“格子がひずむことによる平面波数の変化の効果”がとりいれられていないからです。この効果を取り入れることによって、ある程度補正を行うことが可能です。</p>
<ul class="simple">
<li><p>方法１．</p></li>
</ul>
<p>運動エネルギーの計算におけるGベクトルの高周波成分をスメアすることによって、“平面波数一定”の状況を“カットオフエネルギー一定”の状況に近づけることができます。 <a class="reference internal" href="#bernasconi95" id="id25"><span>[Bernasconi95]</span></a> では、運動エネルギーの高周波成分を以下のように置き換えることが提案されています。</p>
<div class="math notranslate nohighlight">
\[G^2 \rightarrow G^2 + A \left[ 1 +  \mathrm{erf}\left(\frac{\frac{1}{2}G^2-E_0}{\sigma}\right) \right]\]</div>
<p>PHASE/0では、上式を利用したストレステンソルの計算を行うことができます。以下のような設定を入力パラメーターファイルに記述します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure_evolution{
  lattice{ sw_optimize_lattice = on }
  stress{
    sw_smear_KE = on
    a = 15 rydberg
    sigma = 0.1 rydberg
    e0 = 35 rydberg
  }
}
</pre></div>
</div>
<p>structure_evolutionの下にstressブロックを作成し、設定を行います。sw_smear_KE=onとするとこの機能が有効になります。a, sigma, e0には対応するパラメーターを指定します。</p>
<p>デフォルト値はa=0.375, ecut, sigma = 0.1 Rydberg, e0=ecut-1 Rydbergです。</p>
<ul class="simple">
<li><p>方法２．（バージョン2019.01以降）</p></li>
</ul>
<p>複数のカットオフエネルギーによる計算から誤差を見積もることができます。ターゲットカットオフエネルギーを <span class="math notranslate nohighlight">\(E_{\mathrm c}\)</span> 、変化量を <span class="math notranslate nohighlight">\(\Delta E_{\mathrm c}\)</span> 全エネルギーの変化量を <span class="math notranslate nohighlight">\(\Delta E_{\mathrm t}\)</span> とすると、ストレスの誤差 <span class="math notranslate nohighlight">\(\sigma_{\mathrm e}\)</span> は以下のように見積もることができます。</p>
<div class="math notranslate nohighlight">
\[\sigma_{\mathrm e} = - \left( \frac{2 E_{\mathrm c}}{3V} \right) \times \left( \frac{\Delta E_{\mathrm t}}{\Delta E_{\mathrm c}} \right)\]</div>
<p>この補正をPHASE/0に計算させるには、以下のようにstressブロックにおいてsw_stress_correctionをonとします。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure_evolution{
  stress{
    sw_stress = on
    sw_stress_correction = on
  }
}
</pre></div>
</div>
<p>ストレステンソルの補正は、カットオフエネルギーを変化させてストレステンソルを求めることによって計算します。どの程度カットオフエネルギーを変化させるかはdelta_ecutによって指定します。カットオフエネルギーをecut-delta_ecutとしたケースとecut+delta_ecutとしたケースのストレステンソル計算が行われ、その後補正が計算されます。なお、補正の計算前に計算が終了した場合継続できないので注意が必要です。補正値は以下のようにoutput000ファイルに記録されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>!** Pulay stress : -0.000194696412156
</pre></div>
</div>
<p>補正が計算されたあと、入力パラメーターファイルに格子最適化の設定が行われている場合補正を組み込んだ状態で格子最適化計算が始まります。そうでない場合、以下の要領で補正の値を入力ファイルに書き込み、格子最適化などを行う設定にしたうえで再度計算を実行してください（補正が必要なのは対角要素のみ、また誤差が－0.0001auだったとして）。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure_evolution{
  lattice{
    sw_optimize_lattice = on
    external_stress{
      s11 = -0.0001
      s22 = -0.0001
      s33 = -0.0001
    }
  }
}
</pre></div>
</div>
<p>※ バージョン 2019.01未満の場合補正は手動で計算する必要があります</p>
<ul class="simple">
<li><p>検証</p></li>
</ul>
<p>これらの補正を利用し、TiO<sub>2</sub>の格子定数を計算した結果を以下の表にまとめました。方法１．のパラメーターはデフォルト値、方法２．のは±5 Rydbergとしました。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><em>a</em> (bohr)</p></th>
<th class="head"><p><em>c</em> (bohr)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>カットオフ36 Rydberg,  EV曲線</p></td>
<td><p>8.8017</p></td>
<td><p>5.6355</p></td>
</tr>
<tr class="row-odd"><td><p>カットオフ36 Rydberg, 補正なし</p></td>
<td><p>8.6825</p></td>
<td><p>5.5862</p></td>
</tr>
<tr class="row-even"><td><p>カットオフ36 Rydberg, 方法 1.</p></td>
<td><p>8.7593</p></td>
<td><p>5.6072</p></td>
</tr>
<tr class="row-odd"><td><p>カットオフ36 Rydberg, 方法 2.</p></td>
<td><p>8.8052</p></td>
<td><p>5.6200</p></td>
</tr>
<tr class="row-even"><td><p>カットオフ80 Rydberg, 補正なし</p></td>
<td><p>8.7918</p></td>
<td><p>5.6158</p></td>
</tr>
</tbody>
</table>
<p>方法１．２．とも改善しています。特に、方法２．を使うとEV曲線からもとめた格子定数とほぼ同じ格子定数が得られています。</p>
<div role="list" class="citation-list">
<div class="citation" id="bernasconi95" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id25">Bernasconi95</a><span class="fn-bracket">]</span></span>
<p>M. Bernasconi, G.L.Chiarotti, P.Focher,S.Scandolo,E.Tosatti,M.Parrinello Journal of Physics and Chemistry of Solids, <strong>56</strong> 501-505 (1995).</p>
</div>
</div>
</section>
</section>
<section id="section-workfunc">
<span id="id26"></span><h2><span class="section-number">8.5. </span>仕事関数<a class="headerlink" href="#section-workfunc" title="この見出しへのパーマリンク"></a></h2>
<section id="id27">
<h3><span class="section-number">8.5.1. </span>機能の概要<a class="headerlink" href="#id27" title="この見出しへのパーマリンク"></a></h3>
<p>PHASEを利用して、仕事関数を評価することが可能です。ここでは、仕事関数を計算する方法を説明します。</p>
<p>第一原理計算の枠組み内における仕事関数とは、真空準位とフェルミエネルギーとの差です。真空準位は、表面のSCF計算を実施し、表面から十分に離れた箇所での局所ポテンシャルを利用して算出することができます。</p>
</section>
<section id="id28">
<h3><span class="section-number">8.5.2. </span>入力パラメータ<a class="headerlink" href="#id28" title="この見出しへのパーマリンク"></a></h3>
<p>仕事関数を計算するためには、表面のモデルを準備する必要があります。対象としたい系の、対象としたい面</p>
<p>方位をもつ表面モデルを用意します。さらに、入力データのpostprocessingブロックにworkfunc ブロックを作成し、設定を行います。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  workfunc{
    sw_workfunc = on
    sw_add_xc_to_vloc = off
  }
}
</pre></div>
</div>
<p>各変数は以下の意味をもちます。</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p>sw_workfunc</p></td>
<td><p>仕事関数の計算に必要なデータを出
力するためのスイッチです。</p>
<p>出力させたい場合にonとします。</p>
</td>
</tr>
<tr class="row-even"><td><p>sw_add_xc_to_vloc</p></td>
<td><p>局所ポテンシャルを出力する際に、交換相関相互作用を含めるかどうかを指定します。交換相関相互作用は表面から十分離れた場所において0
になると考えられるので、局所ポテンシャルに含めなくても正しい仕事関数が得られることが期待できます。デフォルト値はonですが、offにしておくことによってより少ない真空層で収束した仕事関数を得ることが可能です。</p></td>
</tr>
</tbody>
</table>
<p>このような設定を行ったら、通常通りPHASE
を実行します。計算が収束した後に、必要な局所ポテンシャル</p>
<p>データなどが出力されます。すでに収束した計算に対する継続計算として実行することも可能です。</p>
</section>
<section id="id29">
<h3><span class="section-number">8.5.3. </span>計算の実行方法<a class="headerlink" href="#id29" title="この見出しへのパーマリンク"></a></h3>
<p>計算が終了した段階では、局所ポテンシャルのデータが逆空間のデータとして保存されます。仕事関数を得るた</p>
<p>めには、逆空間のデータを実空間へ逆フーリエ変換し、表面内で平均を計算しその結果を出力する必要がありま</p>
<p>す。このような処理を行うプログラムがworkfuncです。このプログラムのソースコードはsrc_workfuncディレクトリーにあります。コンパイルするためには、Fortran90コンパイラーが必要です。workfuncをコンパイルするには、たとえば以下のようなコマンドを実行します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>src_workfunc
%<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">F90</span><span class="o">=</span>ifort
%<span class="w"> </span>make
</pre></div>
</div>
<p>環境変数F90にFortran90コンパイラーを指定します。環境変数F90のデフォルト値はgfortranです。</p>
<p>以下のように利用します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>workfunc<span class="w"> </span>-z<span class="w"> </span>ZAXIS
</pre></div>
</div>
<p>ZAXIS に、表面に垂直とみなす軸&quot; を指定します。<em>a</em>軸の場合1,
<em>b</em>軸の場合2, <em>c</em>軸の場合は3 を指定します。</p>
<p>指定しない場合のデフォルト値は3 です。</p>
</section>
<section id="id30">
<h3><span class="section-number">8.5.4. </span>計算結果の出力<a class="headerlink" href="#id30" title="この見出しへのパーマリンク"></a></h3>
<p>workfunc の処理が終了すると、nfvlcr.cube とnfvlcr_av.data の2
種類のファイルが生成されます。nfvlcr.cube
ファイルは、実空間の局所ポテンシャルデータを持つGaussian Cube
形式のデータファイルです。nfvlcr_av.data
には表面に垂直な距離と面内で平均した局所ポテンシャルのデータが記録されています。以下のようなデータ形式となっています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Fermi energy (eV) -0.37838
# distance along the z-axis(Angstrom) averaged local potential (eV)
0.104167 -0.218799E+01
0.208333 -0.250195E+01
0.312500 -0.331223E+01
0.416667 -0.427665E+01
0.520833 -0.495695E+01
0.625000 -0.496651E+01
0.729167 -0.425552E+01
.....
.....
.....
</pre></div>
</div>
<p>ファイルの1 行目にフェルミエネルギーがeV 単位で記録されています。3
行目以降が実際のデータです。1 列目にÅ単位で表面に垂直な距離が、2
列目に対応する局所ポテンシャルの面内平均eV
単位で記録されます。局所ポテンシャルは、表面からある程度離れた地点においてはほぼ一定値となります。この時の値とフェルミエネルギーとの差が仕事関数に相当します。</p>
<p>nfvlcr_av.dataファイルから局所ポテンシャルがフラットになる領域を推定し、フェルミエネルギーとの 差を計算することによって仕事関数をもとめるPerl スクリプトがworkfunc.pl です。以下のように利用します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>workfunc.pl<span class="w"> </span>nfvlcr_av.data<span class="w"> </span>OPTIONS
</pre></div>
</div>
<p>実行すると、計算された仕事関数の値が標準出力に出力されます。また、workfunc.eps という、局所ポテンシャルと表面に垂直な距離の関係をグラフ化したEPS ファイルも作成されます。</p>
</section>
<section id="id31">
<h3><span class="section-number">8.5.5. </span>計算例：アルミニウムの仕事関数<a class="headerlink" href="#id31" title="この見出しへのパーマリンク"></a></h3>
<p>アルミニウムの仕事関数の計算例を紹介します。サンプルデータは、 <code class="code docutils literal notranslate"><span class="pre">samples/surface/workfunc/Al</span></code> です。</p>
<p>利用する系は、Al (111) 7 層の表面モデルです。表面に垂直な軸は<em>c</em> 軸とします。<em>c</em> 軸の長さは、50 Å としました。アルミニウム(111) 面はほとんど再構成しないので、構造最適化は施しませんでした。原点を中心に、反転対称性が存在するようにモデルを作成しました。また、交換相関相互作用は局所ポテンシャルに含めない設定で計算を行いました。アルミニウムの表面モデルを <a class="reference internal" href="#advanced-wf-almodel"><span class="std std-numref">図 8.5</span></a> に示します。</p>
<figure class="align-default" id="advanced-wf-almodel">
<img alt="../_images/image34.png" src="../_images/image34.png" />
<figcaption>
<p><span class="caption-number">図 8.5 </span><span class="caption-text">Al(111)面7層モデル</span><a class="headerlink" href="#advanced-wf-almodel" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>PHASE によるSCF 計算が終了したのちにworkfunc プログラムによってnfvlcr_av.data ファイルを作成し、さらにworkfunc.pl スクリプトを利用して得られた局所ポテンシャルと表面に垂直な距離の関係を <a class="reference internal" href="#advanced-wf-alpot"><span class="std std-numref">図 8.6</span></a> に示します。仕事関数は、4.05 eV と計算されました。この値は実測値である4.08 eVと近い結果となっています。</p>
<figure class="align-default" id="advanced-wf-alpot">
<img alt="../_images/image35.png" src="../_images/image35.png" />
<figcaption>
<p><span class="caption-number">図 8.6 </span><span class="caption-text">表面に垂直な距離と局所ポテンシャルの関係</span><a class="headerlink" href="#advanced-wf-alpot" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="advanced-localpot-av-section">
<span id="id32"></span><h2><span class="section-number">8.6. </span>原子周囲局所ポテンシャル出力機能（2021.02以降）<a class="headerlink" href="#advanced-localpot-av-section" title="この見出しへのパーマリンク"></a></h2>
<section id="id33">
<h3><span class="section-number">8.6.1. </span>機能の概要<a class="headerlink" href="#id33" title="この見出しへのパーマリンク"></a></h3>
<p>本機能を用いることによって原子周囲の局所ポテンシャルの平均値を評価することが可能です。</p>
<p>局所ポテンシャルを <span class="math notranslate nohighlight">\(V\left(r\right)\)</span>, 原子A中心の球対称な重み関数をfとすると、原子Aの周囲の局所ポテンシャル平均値は、</p>
<div class="math notranslate nohighlight" id="equation-advanced-lpot-eq1">
<span class="eqno">(8.4)<a class="headerlink" href="#equation-advanced-lpot-eq1" title="この数式へのパーマリンク"></a></span>\[V_A = \int dr V \left( r \right) f \left( \left| r-R_A \right| \right)\]</div>
<p>であらわされます。関数fとしては、積分半径 <span class="math notranslate nohighlight">\(r_c\)</span> 内でのみ有限の値を持つ関数</p>
<div class="math notranslate nohighlight" id="equation-advanced-lpot-eq2">
<span class="eqno">(8.5)<a class="headerlink" href="#equation-advanced-lpot-eq2" title="この数式へのパーマリンク"></a></span>\[\begin{split}f\left(r\right) =
 \begin{cases}
   \frac{1}{\Omega} &amp; r \leq r_c \\
   0 &amp; r&gt;r_c
 \end{cases}\end{split}\]</div>
<p>が考えられます。ここで<span class="math notranslate nohighlight">\(\Omega=\frac{4\pi r_c^3}{3}\)</span> です。さて、PHASE/0では、局所ポテンシャルは</p>
<div class="math notranslate nohighlight" id="equation-advanced-lpot-eq3">
<span class="eqno">(8.6)<a class="headerlink" href="#equation-advanced-lpot-eq3" title="この数式へのパーマリンク"></a></span>\[V\left(r\right) = \sum_{G} e^{i G \cdot r}\]</div>
<p>のように表現されるので <a class="reference internal" href="#equation-advanced-lpot-eq2">(8.5)</a> <a class="reference internal" href="#equation-advanced-lpot-eq3">(8.6)</a> を <a class="reference internal" href="#equation-advanced-lpot-eq1">(8.4)</a> に代入するとつぎのような表式が得られます。</p>
<div class="math notranslate nohighlight" id="equation-advanced-lpot-eq4">
<span class="eqno">(8.7)<a class="headerlink" href="#equation-advanced-lpot-eq4" title="この数式へのパーマリンク"></a></span>\[\begin{split}V_A = \sum_G V\left(G\right) e^{i G \cdot r} w, \\
 w = \frac{4\pi}{G^3} \frac{1}{\Omega} \left(G r_c\right)^3 j_1 \left(G r_c \right), \\
 j_1 \left(x\right) = \frac{\sin{x}}{x^2} - \frac{\cos{x}}{x} .\end{split}\]</div>
<p><a class="reference internal" href="#equation-advanced-lpot-eq4">(8.7)</a> 式を用いて原子周囲の局所ポテンシャルの平均値を求めることができます。</p>
</section>
<section id="id34">
<h3><span class="section-number">8.6.2. </span>入力パラメーターファイル<a class="headerlink" href="#id34" title="この見出しへのパーマリンク"></a></h3>
<p>局所ポテンシャル平均値を計算するには、以下のような入力を作成します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  potential_average{
     sw_calc_pot_avg = on          ! { on |off },  default : off
     sw_add_xc_pot = on            ! { on | off }, default : off
     cutoff_radius = 2.0 bohr        !  default : 2.0
  }
}
</pre></div>
</div>
<p>sw_calc_pot_avg = on を指定すると、原子近傍の局所ポテンシャルの平均値を計算します。sw_add_xc_pot = on の場合、局所ポテンシャルに交換・相関ポテンシャルを含めるようにします。原子を中心とした空間積分の積分半径は、cutoff_radius で指定します。</p>
</section>
<section id="id35">
<h3><span class="section-number">8.6.3. </span>出力ファイル<a class="headerlink" href="#id35" title="この見出しへのパーマリンク"></a></h3>
<p>局所ポテンシャル平均値は、potential_on_atoms.dataに出力されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Potential on atoms
#   id     pot (eV)
    1     -19.343121
    2     -19.539243
 (後略)
</pre></div>
</div>
<p>第1列及び第2列は、それぞれ原子のインデックス、局所ポテンシャルの平均値 (単位：eV)に対応します。</p>
</section>
<section id="al-graphene-al">
<h3><span class="section-number">8.6.4. </span>計算例： Al-Graphene-Al系<a class="headerlink" href="#al-graphene-al" title="この見出しへのパーマリンク"></a></h3>
<p>Al-Graphene-Al系を用いた計算例を紹介します。入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/local_pot_av/Al-Graphene-Al</span></code> 以下にあります。
Al-Graphene-Al系の原子配置は、 <a class="reference internal" href="#local-pot-av-config"><span class="std std-numref">図 8.7</span></a> に示す通りです。</p>
<figure class="align-default" id="local-pot-av-config">
<img alt="../_images/local_pot_av_config.png" src="../_images/local_pot_av_config.png" />
<figcaption>
<p><span class="caption-number">図 8.7 </span><span class="caption-text">Al-Graphene-Al系の原子配置。茶及び水色の球は、それぞれ C及びAl原子に対応する。C原子のインデックスは、左端から順につけるものとする。</span><a class="headerlink" href="#local-pot-av-config" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>その他の計算条件は以下のとおりです。</p>
<table class="docutils align-default" id="local-pot-av-table1">
<caption><span class="caption-number">表 8.4 </span><span class="caption-text">Al-Graphene-Al 系の計算に用いた条件</span><a class="headerlink" href="#local-pot-av-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>計算条件</p></td>
<td><p>値</p></td>
</tr>
<tr class="row-even"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-odd"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-even"><td><p>k点サンプリング</p></td>
<td><p>monk (1x36x1, <span class="math notranslate nohighlight">\(\Gamma\)</span> -centered)</p></td>
</tr>
<tr class="row-odd"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-even"><td><p>SCF収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
</tbody>
</table>
<p>計算結果を以下に示します。青線及び赤線は、それぞれ積分半径1.0及び2.0 の結果に対応します。また、四角 (丸) は、交換相関ポテンシャルを含まない (含む) 計算に対応します。プロファイルは、積分半径や交換相関ポテンシャルの有無に、あまり依存しないことが分かります。</p>
<figure class="align-default" id="local-pot-av-result">
<img alt="../_images/local_pot_av_result.png" src="../_images/local_pot_av_result.png" />
<figcaption>
<p><span class="caption-number">図 8.8 </span><span class="caption-text">Al-Graphene-Al 系の局所ポテンシャル平均値のプロファイル。左端のC原子のポテンシャルがエネルギーの原点です。</span><a class="headerlink" href="#local-pot-av-result" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="section-taiden">
<span id="id36"></span><h2><span class="section-number">8.7. </span>帯電欠損状態の評価 (バージョン2021.01以降)<a class="headerlink" href="#section-taiden" title="この見出しへのパーマリンク"></a></h2>
<section id="id37">
<h3><span class="section-number">8.7.1. </span>概要<a class="headerlink" href="#id37" title="この見出しへのパーマリンク"></a></h3>
<p>PHASE/0 では、電荷非中性状態を計算する際、周期的境界条件によるエネルギー発散を抑えるために一様な背景電荷を考慮して処理しています。この処理により、全エネルギーは周期的境界条件による背景電荷間の相互作用を含んだ値となります。このため、例えば、帯電した原子欠損などを含む半導体の生成エネルギーは、実際の値とは異なるものとなります。これを補正する手法として、近年、FNV 法 <a class="reference internal" href="#freysoldt09" id="id38"><span>[Freysoldt09]</span></a> が注目されており、対応するプログラム( <a class="reference external" href="https://sxrepo.mpie.de/">sxdefectalign</a> , <a class="reference external" href="http://www.physics.iisc.ac.in/~mjain/software/coffee/">CoFFEE</a> など) がいくつか公開されています。PHASE/0 2021年版以降、これらのプログラムに対するインターフェースが配備され、CUBE ファイル形式で出力することができるようになりました。また、これらのプログラムを利用せずに補正量を評価する仕組みも実装されています。さらに、異なる荷電状態間の生成エネルギーを比較した図を描画するためのPythonスクリプトが付属します。</p>
</section>
<section id="id39">
<h3><span class="section-number">8.7.2. </span>理論<a class="headerlink" href="#id39" title="この見出しへのパーマリンク"></a></h3>
<p>電荷qをもつ欠陥 (D) の生成エネルギーは</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq1">
<span class="eqno">(8.8)<a class="headerlink" href="#equation-eq-defectq1" title="この数式へのパーマリンク"></a></span>\[E_{\rm form}^{\rm D, q} \left( E_{\rm F} \right) = E_{\rm DFT}^{\rm D, q} - E_{\rm DFT}^{\rm bulk} - \sum_{i} n_{i} \mu_{i} + q \left( E_{\rm VBM} + E_{\rm F} \right) + E_{\rm corr}^{q}\]</div>
<p>で書けます。 <span class="math notranslate nohighlight">\(E_{\rm DFT}^{\rm D, q}\)</span> および <span class="math notranslate nohighlight">\(E_{\rm DFT}^{\rm bulk}\)</span> はDFT計算における全エネルギー値で、前者は帯電欠陥、後者は非帯電・無欠陥の完全結晶 (Pristine) に対応します。 <span class="math notranslate nohighlight">\(n_i\)</span> は完全結晶からの元素iの原子数の増減、 <span class="math notranslate nohighlight">\(\mu_i\)</span> はその化学ポテンシャルです。 <span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> は完全結晶の価電子帯上端のエネルギー、 <span class="math notranslate nohighlight">\(E_{\rm corr}^q\)</span> は帯電量に依存する補正項です。</p>
<section id="fnv">
<h4><span class="section-number">8.7.2.1. </span>FNV法<a class="headerlink" href="#fnv" title="この見出しへのパーマリンク"></a></h4>
<p>FNV法では、 <span class="math notranslate nohighlight">\(E_{\rm corr}^{q}\)</span> を2つの寄与に分けて考えます <a class="reference internal" href="#freysoldt09" id="id40"><span>[Freysoldt09]</span></a> 。</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq2">
<span class="eqno">(8.9)<a class="headerlink" href="#equation-eq-defectq2" title="この数式へのパーマリンク"></a></span>\[E_{\rm corr}^{q} = E_{\rm PC}^q - q \Delta V_{\rm far}\]</div>
<p>第1項は、孤立した点電荷qの静電エネルギーと、一様な背景電荷を加えて周期的境界条件を課した際の静電エネルギーの差です。</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq3">
<span class="eqno">(8.10)<a class="headerlink" href="#equation-eq-defectq3" title="この数式へのパーマリンク"></a></span>\[E_{\rm PC}^{q} = E_{\rm isolated}^q - E_{\rm periodic}\]</div>
<p>この値は、スーパーセルのサイズ・誘電率から、DFT計算とは無関係に決定されます。一方、第2項は、potential alignment 補正項で、静電ポテンシャルの差</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq4">
<span class="eqno">(8.11)<a class="headerlink" href="#equation-eq-defectq4" title="この数式へのパーマリンク"></a></span>\[\Delta V \left( \mathbf{r} \right) = V_{\rm DFT}^{\rm D, q} \left( \mathbf{r} \right)  - V_{\rm DFT}^{\rm bulk} \left( \mathbf{r} \right) - V_{\rm PC}^q \left( \mathbf{r} \right)\]</div>
<p>を、欠陥から十分に離れた位置で評価した値です。ここで、 <span class="math notranslate nohighlight">\(V_{\rm PC}^q\)</span> は、静電エネルギー に対応する静電ポテンシャルです。</p>
</section>
<section id="id41">
<h4><span class="section-number">8.7.2.2. </span>外部解析プログラム<a class="headerlink" href="#id41" title="この見出しへのパーマリンク"></a></h4>
<p>sxdefectalign、CoFFEEなどの解析プログラムは、以下の入力を要求します。</p>
<ul class="simple">
<li><p>結果の位置情報</p></li>
<li><p>誘電率の値</p></li>
<li><p><span class="math notranslate nohighlight">\(V_{\rm DFT}^{D,q} \left( \mathbf{r} \right)\)</span> や <span class="math notranslate nohighlight">\(V_{\rm DFT}^{\rm bulk}\)</span> の空間分布。たとえばCUBE形式。</p></li>
</ul>
<p>出力されるのは以下の情報です。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\rm PC}^q\)</span> の値</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta V \left( \mathbf{r} \right)\)</span> の値。各格子ベクトル方向に対するプロット。他の格子ベクトル方向については面平均をする。欠陥からの距離に対して、原子位置近傍で平均した値を出力することもある。</p></li>
</ul>
<p>既知の問題として、以下が挙げられます。</p>
<ul class="simple">
<li><p>sxdefectalign では、欠陥からの距離に対するプロットが正常に出力されないことがある。</p></li>
<li><p>CoFFEE では、各格子ベクトル方向に対するプロットも、ユーザーが python スクリプトを、都度書く必要がある。また、欠陥からの距離に対するプロットは得られない。</p></li>
<li><p>CoFFEE では、 <span class="math notranslate nohighlight">\(E_{\rm PC}^q\)</span> の値は、セルサイズを変えて複数計算し、fitting の結果として得る。このため、ユーザーの手間が多い。</p></li>
</ul>
</section>
<section id="extended-fnv">
<h4><span class="section-number">8.7.2.3. </span>extended FNV 法<a class="headerlink" href="#extended-fnv" title="この見出しへのパーマリンク"></a></h4>
<p>Kumagaiら <a class="reference internal" href="#kumagai14" id="id42"><span>[Kumagai14]</span></a> のextended FNV法では、 <span class="math notranslate nohighlight">\(E_{\rm PC}^q\)</span> は</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq5">
<span class="eqno">(8.12)<a class="headerlink" href="#equation-eq-defectq5" title="この数式へのパーマリンク"></a></span>\[E_{\rm PC}^q = - \frac{q}{2} \left[ \sum_{\mathbf{R}_i \neq 0} \frac{q}{\sqrt{|\varepsilon|}} \frac{{\rm erfc} \left( \sqrt{\mathbf{R}_i \mathbf{\varepsilon}^{-1} \mathbf{R}_i} \right)}{\sqrt{\mathbf{R}_i \mathbf{\varepsilon}^{-1} \mathbf{R}_i}} - \frac{\pi q}{\Omega \gamma^2} + \sum_{\mathbf{G}_i \neq 0}  \frac{4\pi q}{\Omega} \frac{\exp \left(-\mathbf{G}_i \varepsilon \mathbf{G}_i / 4\gamma^2\right)}{\mathbf{G}_i \varepsilon \mathbf{G}_i} - \frac{2\gamma q}{\sqrt{\pi |\varepsilon|}} \right]\]</div>
<p>で表されます。ここで、 <span class="math notranslate nohighlight">\(\gamma\)</span> は適当に選んだ収束パラメータです。また、 <span class="math notranslate nohighlight">\(\varepsilon\)</span> は誘電率テンソル、 <span class="math notranslate nohighlight">\(\Omega\)</span> は系の体積です。一方、ポテンシャル <span class="math notranslate nohighlight">\(V_{\rm PC}^q\)</span> は、</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq6">
<span class="eqno">(8.13)<a class="headerlink" href="#equation-eq-defectq6" title="この数式へのパーマリンク"></a></span>\[V_{\rm PC}^q = \sum_{\mathbf{R}_i \neq 0} \frac{q}{\sqrt{|\varepsilon|}} \frac{{\rm erfc} \left( \sqrt{\mathbf{R}_i \mathbf{\varepsilon}^{-1} \mathbf{R}_i} \right)}{\sqrt{\mathbf{R}_i \mathbf{\varepsilon}^{-1} \mathbf{R}_i}} - \frac{\pi q}{\Omega \gamma^2} + \sum_{\mathbf{G}_i \neq 0}  \frac{4\pi q}{\Omega} \frac{\exp \left(-\mathbf{G}_i \varepsilon \mathbf{G}_i / 4\gamma^2\right)}{\mathbf{G}_i \varepsilon \mathbf{G}_i} \exp \left[ i \mathbf{G}_i \left( \mathbf{r}-\mathbf{R}_d\right) \right]\]</div>
<p>で表されます。ここで、 <span class="math notranslate nohighlight">\(\mathbf{R}_d\)</span> は欠陥の位置です。</p>
<p><span class="math notranslate nohighlight">\(V_{\rm far}\)</span> の評価に関しては、以下の手順をとります。まず、各原子サイトにおける <span class="math notranslate nohighlight">\(\Delta V\left( \mathbf{r} \right)\)</span> を計算します。このうち、欠陥からの距離 <span class="math notranslate nohighlight">\(R_{WS}\)</span> より遠方にあるデータを平均し、 <span class="math notranslate nohighlight">\(\Delta V_{\rm far}\)</span> とします。なお、 <span class="math notranslate nohighlight">\(R_{WS}\)</span> は、欠陥間の最短距離の半分とします。
<a class="reference internal" href="#equation-eq-defectq5">(8.12)</a>  , <a class="reference internal" href="#equation-eq-defectq6">(8.13)</a> による計算を用いることによってsxdefectalign, CoFFEEなどを用いずとも(自動的に)  <span class="math notranslate nohighlight">\(E_{\rm corr}^q\)</span> の評価が可能です。</p>
</section>
</section>
<section id="id43">
<h3><span class="section-number">8.7.3. </span>使い方<a class="headerlink" href="#id43" title="この見出しへのパーマリンク"></a></h3>
<section id="id44">
<h4><span class="section-number">8.7.3.1. </span>外部解析プログラムの使用<a class="headerlink" href="#id44" title="この見出しへのパーマリンク"></a></h4>
<p>sxdefectalign や CoFFEE に受け渡す静電ポテンシャルを CUBE 形式で出力するには、入力パラメーターファイルを以下のように設定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postprocessing{
    electrostatic_potential{
       sw_write_electrostatic_pot = on
       unit = Rydberg                     ! { Rydberg | Hartree | eV }
    }
}
</pre></div>
</div>
<p>単位系は unit で指定し、Rydberg、Hartree、eV の選択が可能です。default 値は　eV です。</p>
<p>結果はelectrostatic_pot.cubeファイルに出力されます。ヘッダー部に単位系が表示され、以降、各軸方向の分割数、メッシュの刻み幅、各メッシュ点における値と続きます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Calculated</span> <span class="n">by</span> <span class="n">phase</span>
<span class="n">Local</span><span class="o">+</span><span class="n">Hartree</span> <span class="n">potential</span> <span class="ow">in</span> <span class="n">Rydberg</span>
   <span class="mi">215</span>         <span class="mf">0.0000</span>         <span class="mf">0.0000</span>         <span class="mf">0.0000</span>
   <span class="mi">180</span>    <span class="mf">0.180912</span>    <span class="mf">0.000000</span>    <span class="mf">0.000000</span>
   <span class="mi">180</span>    <span class="mf">0.000000</span>    <span class="mf">0.180912</span>    <span class="mf">0.000000</span>
   <span class="mi">180</span>    <span class="mf">0.000000</span>    <span class="mf">0.000000</span>    <span class="mf">0.180912</span>
    <span class="mi">33</span>  <span class="mf">33.000000</span>     <span class="mf">2.396007</span>     <span class="mf">2.396052</span>     <span class="mf">2.396080</span>
<span class="p">(</span><span class="n">後略</span><span class="p">)</span>
</pre></div>
</div>
<p>帯電欠陥、及び完全結晶の静電ポテンシャルを出力しておくようにします(sxdefectalignを利用する場合には、unitは Rydberg にしておく必要があります。)。以下に、これらのCUBEファイルを用いたsxdefectalign の実行例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sxdefectalign</span> <span class="o">--</span><span class="n">charge</span> <span class="mi">3</span> <span class="o">--</span><span class="n">eps</span> <span class="mf">12.88</span>
<span class="o">--</span><span class="n">vdef</span> <span class="o">../</span><span class="n">electrostatic_pot</span><span class="o">.</span><span class="n">cube</span> <span class="o">--</span><span class="n">vref</span> <span class="o">../</span><span class="n">bulk</span><span class="o">/</span><span class="n">electrostatic_pot</span><span class="o">.</span><span class="n">cube</span>
<span class="o">--</span><span class="n">center</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span> <span class="o">--</span><span class="n">relative</span>
<span class="o">--</span><span class="n">ecut</span> <span class="mi">270</span> <span class="o">--</span><span class="n">qe</span> <span class="o">&gt;</span> <span class="n">Log</span>
</pre></div>
</div>
<p>系の帯電量を q としたとき、charge には -q を渡します。eps には誘電率の値を指定します。vdef及びvrefには、帯電欠陥及びバルクにおける静電ポテンシャルファイルを、それぞれ指定します。center には欠陥位置の内部座標を与えます。ecut には nfinp.data で指定した　cutoff_cd を Ry 単位で渡します。</p>
<p>sxdefectalignのLog ファイルの末尾には、以下のような出力がされます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Defect</span> <span class="n">correction</span> <span class="p">(</span><span class="n">eV</span><span class="p">):</span> <span class="mf">0.828347</span> <span class="p">(</span><span class="n">incl</span><span class="o">.</span> <span class="n">screening</span> <span class="o">&amp;</span> <span class="n">alignment</span><span class="p">)</span>
</pre></div>
</div>
<p>ここで表示されているのは、 値 ( 式 <a class="reference internal" href="#equation-eq-defectq3">(8.10)</a> 参照 )であり、potential alignment の寄与は含まれていません。
Logファイル以外には、 <code class="docutils literal notranslate"><span class="pre">vline-eV-an.dat</span> <span class="pre">(</span> <span class="pre">n=0,</span> <span class="pre">1,</span> <span class="pre">2</span> <span class="pre">)</span></code> 及び <code class="docutils literal notranslate"><span class="pre">vAtoms.dat</span></code> が出力されます。前者は、式 <a class="reference internal" href="#equation-eq-defectq4">(8.11)</a> の各結晶軸方向に対する、ポテンシャルの1次元プロファイルを出力したものです。一方、後者は、各原子の欠陥位置からの距離、及び原子上でのポテンシャルの値を出力したものです。ただし、 <code class="docutils literal notranslate"><span class="pre">vAtoms.dat</span></code> は正常に出力されないことが多々あるようです。</p>
</section>
<section id="id45">
<h4><span class="section-number">8.7.3.2. </span>extended FNV 法<a class="headerlink" href="#id45" title="この見出しへのパーマリンク"></a></h4>
<p>まず帯電なし・欠陥なしの bulk の計算を行います。入力パラメーターファイルは以下のように設定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postprocessing</span><span class="p">{</span>
    <span class="n">electrostatic_potential</span><span class="p">{</span>
       <span class="n">sw_write_electrostatic_pot</span> <span class="o">=</span> <span class="n">on</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>結果はelecpot_bin.data ファイルが出力されます。静電ポテンシャルのG空間での値をバイナリ形式で出力しているため、外部ソフトと連携することはできません。ファイル名は、F_ELECPOT_BINにより変更できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_ELECPOT_BIN</span> <span class="o">=</span> <span class="s1">&#39;./elecpot_bin.data&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>ついで帯電欠陥の計算を行います。入力パラメーターファイルは以下のように設定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postprocessing{
    electrostatic_potential{
       sw_write_electrostatic_pot = on
    }
    charged_defect{
        correction{
            sw_calc_extfnv_correction = on          ! default : off
            dielectric_constant{
               exx = 12.88
               eyy = 12.88
               ezz = 12.88
            }
            position{
               x = 0.0, y = 0.0, z = 0.0
            }
        }
    }
}
</pre></div>
</div>
<p>charged_defect ブロック内の correction ブロックで、sw_calc_extfnv_correction = on を設定します。また、dielectric_constat ブロック内で誘電率テンソルの値、position ブロック内で欠陥の内部座標を指定します。欠損以外の場合には、内部座標ではなく、原子番号( atom_id )による指定も可能です (例：atom_id= 2 )。 さらに、参照する bulk の静電ポテンシャルファイル名をF_ELECPOT_BIN_REF で指定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">fnames</span>
<span class="n">F_ELECPOT_BIN_REF</span> <span class="o">=</span> <span class="s1">&#39;../bulk/elecpot_bin.data&#39;</span>
<span class="n">F_ELECPOT_BIN</span> <span class="o">=</span> <span class="s1">&#39;./elecpot_bin.data&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>結果はdefect_pot_correction.direction_n ( n=1,2,3, )、defect_pot_correction.atomsに出力されます。前者は、式 <a class="reference internal" href="#equation-eq-defectq4">(8.11)</a> の各結晶軸方向に対する、ポテンシャルの1次元プロファイルを出力したものです。一方、後者は、各原子の欠陥位置からの距離、及び原子上でのポテンシャルの値を出力したものです。</p>
<p>以下に、defect_pot_correction.direction_1 の出力例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># dist. (Ang), pot_diff,    Vpc,  pot_diff -Vpc (eV)</span>
   <span class="mf">0.00000</span>  <span class="o">-</span><span class="mf">0.13205</span>  <span class="o">-</span><span class="mf">0.03907</span>  <span class="o">-</span><span class="mf">0.09299</span>
   <span class="mf">0.09573</span>  <span class="o">-</span><span class="mf">0.13743</span>  <span class="o">-</span><span class="mf">0.03902</span>  <span class="o">-</span><span class="mf">0.09841</span>
<span class="p">(</span><span class="n">後略</span><span class="p">)</span>
</pre></div>
</div>
<p>第2列及び第3列は、それぞれ式 <a class="reference internal" href="#equation-eq-defectq4">(8.11)</a> の <span class="math notranslate nohighlight">\(V_{\rm DFT}^{D,q} \left( \mathbf{r} \right) - V_{\rm DFT}^{\rm bulk} \left( \mathbf{r} \right)\)</span> 及び <span class="math notranslate nohighlight">\(V_{\rm PC}^q \left( \mathbf{r} \right)\)</span> に対応します。第4列は <span class="math notranslate nohighlight">\(\Delta V \left( \mathbf{r} \right)\)</span> に対応します。なお、符号については、電子の電荷が負であることを考慮しています。</p>
<p>以下に、defect_pot_correction.atoms の出力例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># no.,   dist. (Ang),     pot_diff,            Vpc,              pot_diff -Vpc (eV)</span>
    <span class="mi">1</span>    <span class="mf">2.1961</span>       <span class="o">-</span><span class="mf">0.0550653932</span>       <span class="o">-</span><span class="mf">0.2936706923</span>        <span class="mf">0.2386052991</span>
    <span class="mi">2</span>    <span class="mf">3.9534</span>       <span class="o">-</span><span class="mf">0.1647261198</span>       <span class="o">-</span><span class="mf">0.1693351641</span>        <span class="mf">0.0046090443</span>
<span class="p">(</span><span class="n">中略</span><span class="p">)</span>

<span class="c1"># Correction energy (eV):        0.7827480523</span>
</pre></div>
</div>
<p>なお、最終行に表示されている “Correction energy” は、生成エネルギー図作成に必要な <span class="math notranslate nohighlight">\(E_{\rm corr}^q\)</span> です。</p>
</section>
<section id="defectq-forme-fig1">
<span id="id46"></span><h4><span class="section-number">8.7.3.3. </span>生成エネルギー図の作成1<a class="headerlink" href="#defectq-forme-fig1" title="この見出しへのパーマリンク"></a></h4>
<p>欠陥ごとの生成エネルギー図の作成方法を説明します。生成エネルギー図作成にはcalc_defect_formation_energy.pyスクリプトを用います。</p>
<p>平衡状態のとき、化学ポテンシャルは</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq7">
<span class="eqno">(8.14)<a class="headerlink" href="#equation-eq-defectq7" title="この数式へのパーマリンク"></a></span>\[\begin{split}\mu_{\rm Ga} + \mu_{\rm As} = \mu_{\rm GaAs}^0, \\
\mu_{\rm Ga} \leq \mu_{\rm Ga}^0 , \\
\mu_{\rm As} \leq \mu_{\rm As}^0\end{split}\]</div>
<p>を満たします。ここで、 <span class="math notranslate nohighlight">\(\mu_{\rm Ga}^0\)</span> 及び <span class="math notranslate nohighlight">\(\mu_{\rm As}^0\)</span> は、それぞれGa及びAs単体の1原子あたりのエネルギーです。また、 <span class="math notranslate nohighlight">\(\mu_{\rm GaAs}^0\)</span> は、GaAs 結晶の2原子あたりのエネルギーです。特に、Ga-rich 極限の場合は、</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq8">
<span class="eqno">(8.15)<a class="headerlink" href="#equation-eq-defectq8" title="この数式へのパーマリンク"></a></span>\[\mu_{\rm Ga} = \mu_{\rm Ga}^0, \mu_{\rm As} = \mu_{\rm GaAs}^0 - \mu_{\rm Ga}^0\]</div>
<p>となり、As-rich 極限では</p>
<div class="math notranslate nohighlight" id="equation-eq-defectq9">
<span class="eqno">(8.16)<a class="headerlink" href="#equation-eq-defectq9" title="この数式へのパーマリンク"></a></span>\[\mu_{\rm Ga} = \mu_{\rm GaAs}^0 - \mu_{\rm As}^0, \mu_{\rm As} = \mu_{\rm As}^0\]</div>
<p>となります。これら化学ポテンシャルの情報は、以下で説明するcalc_defect_formation_energy.pyスクリプトの入力に記述する必要があるものです。</p>
<p>例えば、GaAs のスーパーセルの中にGa欠損を導入した計算を行い、帯電量 q =-3, -2, -1, 0 の計算結果が得られているとします。生成エネルギー図作成のために、以下のようなファイルを作成します。ファイル名に制限はありません。以下の例ではtmp1.in とします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">VBM</span>        <span class="c1">#(eV)</span>
<span class="mf">6.00887</span>

<span class="o">&amp;</span><span class="n">band_gap</span>        <span class="c1">#(eV)</span>
<span class="mf">1.424</span>

<span class="o">&amp;</span><span class="n">Chemical_potentials</span> <span class="c1">#(Ha)</span>
<span class="n">Ga</span>  <span class="o">-</span><span class="mf">138.9838873703</span>      <span class="c1"># mu_GaAs_bulk -mu_As</span>
<span class="n">As</span>   <span class="o">-</span><span class="mf">87.9848825305</span>

<span class="o">&amp;</span><span class="n">Defects</span>        <span class="c1">#elements, number ( negative==vacancy, positive==impurity )</span>
<span class="n">Ga</span>  <span class="o">-</span><span class="mi">1</span>

<span class="o">&amp;</span><span class="n">Host_supercell_energy</span> <span class="c1">#(Ha)</span>
<span class="o">-</span><span class="mf">7263.0006368270</span>

<span class="o">&amp;</span><span class="n">Defective_supercell_energy</span> <span class="c1"># charge_state(q) and energy (Ha)</span>
<span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mf">7123.2688494462</span>
<span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mf">7123.4909799361</span>
<span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mf">7123.7111092854</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">7123.9292947570</span>

<span class="o">&amp;</span><span class="n">Correction</span> <span class="n">energy</span> <span class="c1"># charge_state(q) and energy (eV)</span>
<span class="o">-</span><span class="mi">3</span> <span class="mf">1.1593520601</span>
<span class="o">-</span><span class="mi">2</span> <span class="mf">0.6178614391</span>
<span class="o">-</span><span class="mi">1</span> <span class="mf">0.2315198082</span>
<span class="mi">0</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>以下、用語の説明をします。</p>
<table class="docutils align-default" id="defectq-table1">
<caption><span class="caption-number">表 8.5 </span><span class="caption-text">キーワードの説明</span><a class="headerlink" href="#defectq-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>キーワード</p></td>
<td><p>単位</p></td>
<td><p>意味</p></td>
</tr>
<tr class="row-even"><td><p>&amp;VBM</p></td>
<td><p>eV</p></td>
<td><p><span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>&amp;band_gap</p></td>
<td><p>eV</p></td>
<td><p>バンドギャップ値</p></td>
</tr>
<tr class="row-even"><td><p>&amp;Chemical_potentials</p></td>
<td><p>Hartree</p></td>
<td><p>化学ポテンシャル <span class="math notranslate nohighlight">\(\mu_i\)</span> 。系を構成する全元素について記述する。</p></td>
</tr>
<tr class="row-odd"><td><p>&amp;Defects</p></td>
<td></td>
<td><p>導入した欠陥</p></td>
</tr>
<tr class="row-even"><td><p>&amp;Host_supercell_energy</p></td>
<td><p>Hartree</p></td>
<td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm DFT}^{\rm bulk}\)</span></p>
</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><p>&amp;Defective_supercell_energy</p></td>
<td><p>Hartree</p></td>
<td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm DFT}^{D, q}.\)</span> 計算した全荷電状態についてqが小さい順に記述する。</p>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p>&amp;Correction</p></td>
<td><p>eV</p></td>
<td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm corr}^q.\)</span> 計算した全荷電状態についてqが小さい順に記述する。</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p>以下の要領でcalc_defect_formation_energy.pyスクリプトを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span>  <span class="n">calc_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>  <span class="nb">input</span>
<span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">OUTFILE</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">emin</span> <span class="n">EMIN</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">emax</span> <span class="n">EMAX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">de</span> <span class="n">DE</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">vmin</span> <span class="n">VMIN</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">vmax</span> <span class="n">VMAX</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">image_format</span> <span class="n">IMAGE_FORMAT</span><span class="p">]</span>
</pre></div>
</div>
<p>括弧内は省略可能なオプションで、その意味は以下のとおりです。</p>
<table class="docutils align-default" id="defectq-table2">
<caption><span class="caption-number">表 8.6 </span><span class="caption-text">キーワードの説明</span><a class="headerlink" href="#defectq-table2" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>引数</p></td>
<td><p>意味</p></td>
<td><p>デフォルト値</p></td>
</tr>
<tr class="row-even"><td><p>-o</p></td>
<td><p>出力するファイルの名称</p></td>
<td><p>result</p></td>
</tr>
<tr class="row-odd"><td><p>--emin</p></td>
<td><p>エネルギーEF の最小値</p></td>
<td><p>-1.0</p></td>
</tr>
<tr class="row-even"><td><p>--emax</p></td>
<td><p>エネルギーEF の最大値</p></td>
<td><p>6.0</p></td>
</tr>
<tr class="row-odd"><td><p>--de</p></td>
<td><p>エネルギーEFの刻み幅</p></td>
<td><p>0.01</p></td>
</tr>
<tr class="row-even"><td><p>--vmin</p></td>
<td><p>生成エネルギーの表示範囲の最小値</p></td>
<td><p>-5.0</p></td>
</tr>
<tr class="row-odd"><td><p>--ymax</p></td>
<td><p>生成エネルギーの表示範囲の最大値</p></td>
<td><p>5.0</p></td>
</tr>
<tr class="row-even"><td><p>--image_format</p></td>
<td><p>可視化画像の形式 (png/eps)</p></td>
<td><p>png</p></td>
</tr>
</tbody>
</table>
<p>実行例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">calc_defect_formation_energy</span><span class="o">.</span><span class="n">py</span> <span class="n">tmp1</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="n">result1</span>
</pre></div>
</div>
<p>上述のコマンドを実行した結果、生成されるファイルは result1.qdep、result1.min、result1.gnu、result1.png です。以下に、result1.qdep及びresult1.min の一部を示します。前者には、各帯電状態における生成エネルギーの、フェルミエネルギー依存性が出力されています。後者は、各フェルミエネルギー値における最小の生成エネルギー値が出力され、ファイル末尾に Charge Transition Level が追記されています。</p>
<p>result1.qdepファイルの内容</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Formation energy</span>
<span class="c1"># Ef (eV)    q=-3       q=-2       q=-1       q=0</span>
  <span class="o">-</span><span class="mf">1.00000</span>   <span class="mf">6.48430</span>   <span class="mf">4.90715</span>   <span class="mf">3.53961</span>   <span class="mf">2.37978</span>
<span class="p">(</span><span class="n">後略</span><span class="p">)</span>
</pre></div>
</div>
<p>result1.minファイルの内容</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Formation energy</span>
<span class="c1"># Ef (eV)    min</span>
  <span class="o">-</span><span class="mf">1.00000</span>   <span class="mf">2.37978</span>
<span class="p">(</span><span class="n">中略</span><span class="p">)</span>
   <span class="mf">6.00000</span> <span class="o">-</span><span class="mf">14.51570</span>

<span class="c1"># Charge   Transtion level [eV]</span>
<span class="c1">#-2/-3             0.57715</span>
<span class="c1">#-1/-2             0.36754</span>
<span class="c1"># 0/-1             0.15983</span>
</pre></div>
</div>
<p>result1.gnu は可視化のための gnuplot 用ファイル、result1.png は gnuplot の出力です。</p>
</section>
<section id="defectq-forme-fig2">
<span id="id47"></span><h4><span class="section-number">8.7.3.4. </span>生成エネルギー図の作成2<a class="headerlink" href="#defectq-forme-fig2" title="この見出しへのパーマリンク"></a></h4>
<p>興味ある全ての欠陥構造について、 <a class="reference internal" href="#defectq-forme-fig1"><span class="std std-ref">生成エネルギー図の作成1</span></a> の作業が終了しているものとします。ここでは、これらをまとめた図の作成を行うため、以下のようなファイルを作成します。ファイル名に制限はありません。以下の例ではgather1.in とします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># title   filename ( excluding &quot;.min&quot; )</span>
<span class="c1">#</span>
<span class="o">&amp;</span><span class="n">List</span>
<span class="n">Vac_Ga</span>    <span class="n">Vacancy_Ga</span><span class="o">/</span><span class="n">result1</span>
<span class="n">Vac_As</span>    <span class="n">Vacancy_As</span><span class="o">/</span><span class="n">result1</span>
<span class="n">Ga_As</span>     <span class="n">Ga_for_As</span><span class="o">/</span><span class="n">resultaa</span>
<span class="n">As_Ga</span>     <span class="n">As_for_Ga</span><span class="o">/</span><span class="n">resultaa</span>

<span class="o">&amp;</span><span class="n">band_gap</span>        <span class="c1">#(eV)</span>
<span class="mf">1.424</span>
</pre></div>
</div>
<p>以下、用語の説明をします。</p>
<table class="docutils align-default" id="defectq-table3">
<caption><span class="caption-number">表 8.7 </span><span class="caption-text">キーワードの説明</span><a class="headerlink" href="#defectq-table3" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>ワード</p></td>
<td><p>単位</p></td>
<td><p>意味</p></td>
</tr>
<tr class="row-even"><td><p>&amp;List</p></td>
<td></td>
<td><p>欠陥の名称、及び計算の出力( <a class="reference internal" href="#defectq-forme-fig1"><span class="std std-ref">生成エネルギー図の作成1</span></a> 指定した outfile 名)</p></td>
</tr>
<tr class="row-odd"><td><p>&amp;band_gap</p></td>
<td><p>eV</p></td>
<td><p>バンドギャップ値</p></td>
</tr>
</tbody>
</table>
<p>以下の要領でplot_multiple_defect_formation_energy.pyスクリプトを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span>  <span class="n">plot_multiple_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>  <span class="nb">input</span>
<span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">OUTFILE</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">emin</span> <span class="n">EMIN</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">emax</span> <span class="n">EMAX</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">vmin</span> <span class="n">VMIN</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">vmax</span> <span class="n">VMAX</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">image_format</span> <span class="n">IMAGE_FORMAT</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">keypos_h</span> <span class="n">KEYPOS_H</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">keypos_v</span> <span class="n">KEYPOS_V</span><span class="p">]</span>
</pre></div>
</div>
<p>括弧内は省略可能なオプションで、その意味は以下のとおりです。なお、EMIN、EMAX値は、 <a class="reference internal" href="#defectq-forme-fig1"><span class="std std-ref">生成エネルギー図の作成1</span></a> の指定と揃えた方がよいです。</p>
<table class="docutils align-default" id="defectq-table4">
<caption><span class="caption-number">表 8.8 </span><span class="caption-text">plot_multiple_defect_formation_energy.pyで省略可能なオプション一覧</span><a class="headerlink" href="#defectq-table4" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>引数</p></td>
<td><p>意味</p></td>
<td><p>デフォルト値</p></td>
</tr>
<tr class="row-even"><td><p>-o</p></td>
<td><p>出力するファイルの名称</p></td>
<td><p>result_all</p></td>
</tr>
<tr class="row-odd"><td><p>--emin</p></td>
<td><p>エネルギーEF の最小値</p></td>
<td><p>なし</p></td>
</tr>
<tr class="row-even"><td><p>--emax</p></td>
<td><p>エネルギーEF の最大値</p></td>
<td><p>なし</p></td>
</tr>
<tr class="row-odd"><td><p>--vmin</p></td>
<td><p>生成エネルギーの表示範囲の最小値</p></td>
<td><p>なし</p></td>
</tr>
<tr class="row-even"><td><p>--ymax</p></td>
<td><p>生成エネルギーの表示範囲の最大値</p></td>
<td><p>なし</p></td>
</tr>
<tr class="row-odd"><td><p>--image_format</p></td>
<td><p>可視化画像の形式 (png/eps)</p></td>
<td><p>png</p></td>
</tr>
<tr class="row-even"><td><p>--keypos_h</p></td>
<td><p>凡例の水平位置 (left/center/right)</p></td>
<td><p>right</p></td>
</tr>
<tr class="row-odd"><td><p>--keypos_v</p></td>
<td><p>凡例の垂直位置 (top/center/bottom)</p></td>
<td><p>top</p></td>
</tr>
</tbody>
</table>
<p>以下に実行例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">plot_multiple_defect_formation_energy</span><span class="o">.</span><span class="n">py</span> <span class="n">gather1</span><span class="o">.</span><span class="ow">in</span>
</pre></div>
</div>
<p>実行するとresult_all.gnu 及び result_all.png が生成されます。前者は gnuplot 用ファイルで、後者はこれを可視化したものです。</p>
</section>
</section>
<section id="id48">
<h3><span class="section-number">8.7.4. </span>例題<a class="headerlink" href="#id48" title="この見出しへのパーマリンク"></a></h3>
<section id="id49">
<h4><span class="section-number">8.7.4.1. </span>概要<a class="headerlink" href="#id49" title="この見出しへのパーマリンク"></a></h4>
<p>GaAs 64 原子をホストとして、帯電欠陥の計算を行った例を紹介します。計算条件は以下の通りです。なお、GaAs の格子定数は、基本格子で最適化を行いました。補正エネルギーは、PHASE/0に実装されている extended FNV 法により評価しました。</p>
<table class="docutils align-default" id="defectq-table5">
<caption><span class="caption-number">表 8.9 </span><span class="caption-text">帯電欠陥の評価で使用した計算条件</span><a class="headerlink" href="#defectq-table5" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>Monkhorst-Pack (2×2×2)</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>単位胞の1辺 [Å]</p></td>
<td><p>11.48882</p></td>
</tr>
<tr class="row-even"><td><p>SCF 収束条件</p></td>
<td><p>[Ha/atom]  1.0E-8</p></td>
</tr>
<tr class="row-odd"><td><p>力の収束条件</p></td>
<td><p>[Ha/bohr]    2.0E-4</p></td>
</tr>
<tr class="row-even"><td><p>擬ポテンシャル</p></td>
<td><p>Ga_ggapbe_paw_02.pp, As_ggapbe_paw_02.pp</p></td>
</tr>
<tr class="row-odd"><td><p>(補正項の計算で使用する)</p></td>
<td><p>誘電率   ※12.88</p></td>
</tr>
</tbody>
</table>
<p>※ <a class="reference external" href="https://www.microwaves101.com/encyclopedias/gallium-arsenide">https://www.microwaves101.com/encyclopedias/gallium-arsenide</a></p>
</section>
<section id="id50">
<h4><span class="section-number">8.7.4.2. </span>例題のディレクトリー構成および計算のながれ<a class="headerlink" href="#id50" title="この見出しへのパーマリンク"></a></h4>
<p>本例題は複数の計算を行い、その結果をとりまとめ、スクリプトで処理することによって結果が得られる仕組みになっています。ここではディレクトリーの構成と計算のながれについて説明します。</p>
<p>必要な入力ファイルはサンプルディレクトリーの下の <code class="code docutils literal notranslate"><span class="pre">samples/defectq</span></code> 以下のサブディレクトリーに配置されています。以下のようなディレクトリー構成になっています。</p>
<p><code class="code docutils literal notranslate"><span class="pre">defectq</span></code> 以下には <code class="code docutils literal notranslate"><span class="pre">Preparation</span></code> ディレクトリーと <code class="code docutils literal notranslate"><span class="pre">GaAs_64_lattice_opt</span></code> ディレクトリーが存在します。</p>
<p>Preparationディレクトリー</p>
<blockquote>
<div><p>単体のAs, Ga, GaAsの格子最適化の入力ファイルが納められたディレクトリーです。bulk_As, bulk_Ga, bulk_GaAsディレクトリーがあり、格子最適化の入力ファイルが納められています。結果得られるエネルギーと <a class="reference internal" href="#equation-eq-defectq8">(8.15)</a> <a class="reference internal" href="#equation-eq-defectq9">(8.16)</a> から化学ポテンシャルをもとめ、スクリプト入力ファイルの&amp;Chemical_potentialsに記述します。</p>
</div></blockquote>
<p>GaAs_64_lattice_optディレクトリー</p>
<blockquote>
<div><p>各種生成エネルギー計算の入力ファイルが格納されています。ベースとなる結晶は格子最適化によってもとまった格子定数から作成した64原子系です。GaAs_64_lattice_optディレクトリーは、さらに以下のようなサブディレクトリー群が存在します。</p>
<table class="docutils align-default" id="defectq-dirstructure-table1">
<caption><span class="caption-number">表 8.10 </span><span class="caption-text">GaAs_64_lattice_opt以下のディレクトリー構成</span><a class="headerlink" href="#defectq-dirstructure-table1" title="このテーブルへのパーマリンク"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>ディレクトリー名</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>Pristine</p></td>
<td><p>欠損のない結晶の入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-odd"><td><p>Ga_for_As</p></td>
<td><p>AsをGaで置換した欠陥構造の入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-even"><td><p>As_for_Ga</p></td>
<td><p>GaをAsで置換した欠陥構造の入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-odd"><td><p>As_interstitial_As4</p></td>
<td><p>Asが最近接原子となる位置に入り込んだAs interstitialの入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-even"><td><p>As_interstitial_Ga4</p></td>
<td><p>Gaが最近接原子となる位置に入り込んだAs interstitialの入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-odd"><td><p>Ga_interstitial_As4</p></td>
<td><p>Asが最近接原子となる位置に入り込んだGa interstitialの入力ファイルが納められたディレクトリー。</p></td>
</tr>
<tr class="row-even"><td><p>Ga_interstitial_Ga4</p></td>
<td><p>Gaが最近接原子となる位置に入り込んだGa interstitialの入力ファイルが納められたディレクトリー。</p></td>
</tr>
</tbody>
</table>
<p>それぞれのディレクトリーにはさらにq_ <em>q</em> ディレクトリーが存在します。ここで <em>q</em> は電荷をあらわす数値です。</p>
<ul class="simple">
<li><p>Pristineの場合はq_0とq_0.2ディレクトリーが存在します。 <span class="math notranslate nohighlight">\(E_{\rm VBM} = \frac{E\left( N \right) - E\left( N-\Delta N \right)}{\Delta N}\)</span> (今の場合 <span class="math notranslate nohighlight">\(\Delta N = 0.2\)</span> )という関係から <span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> をもとめ、スクリプト入力の&amp;VBMに記述します。またq_0のエネルギーをスクリプト入力の&amp;Host_supercell_energyに記述します。</p></li>
<li><p>ほかの欠損に対応するディレクトリーでは、エネルギーの計算結果をスクリプト入力の&amp;Defective_supercell_energyに記述します。また、q_0以外の計算ではextended FNV法による補正エネルギー <span class="math notranslate nohighlight">\(E_{\rm corr}^q\)</span> の計算がなされます。結果はdefect_pot_correction.atomsファイルの末尾に記録されるので、その計算値をスクリプト入力の&amp;Correction に記述します (q=0の項には0を記述します)。</p></li>
</ul>
<p>各欠損ディレクトリーにおいて calc_defect_formation_energy.py スクリプトの入力を作成し、実行することによって各欠損の生成エネルギー図を作成することができます。またすべての欠陥のデータを集約し <a class="reference internal" href="#defectq-forme-fig2"><span class="std std-ref">生成エネルギー図の作成2</span></a> の手続きをふむことによってすべての欠陥の結果をまとめた生成エネルギー図を作成することができます。</p>
</div></blockquote>
</section>
<section id="id51">
<h4><span class="section-number">8.7.4.3. </span>補正エネルギー比較<a class="headerlink" href="#id51" title="この見出しへのパーマリンク"></a></h4>
<p>以下に、Ga欠損 (q=-3) における補正エネルギーについて、sxdefectalign とPHASE/0実装のextentend FNV 法による評価の比較を示します。両者がおおよそ一致していることが分かります。</p>
<table class="docutils align-default" id="defectq-table6">
<caption><span class="caption-number">表 8.11 </span><span class="caption-text">Ga欠損 (q=-3) における補正エネルギーの内訳 (単位：eV)</span><a class="headerlink" href="#defectq-table6" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>sxdefectalign</p></td>
<td><p>PHASE/0</p></td>
</tr>
<tr class="row-even"><td><p>Epc</p></td>
<td><p>1.24251</p></td>
<td><p>1.24272</p></td>
</tr>
<tr class="row-odd"><td><p>dV</p></td>
<td><p>-0.00731</p></td>
<td><p>-0.02779</p></td>
</tr>
<tr class="row-even"><td><p>Ecorr</p></td>
<td><p>1.22058</p></td>
<td><p>1.15935</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id52">
<h4><span class="section-number">8.7.4.4. </span>生成エネルギー図の作成 1.<a class="headerlink" href="#id52" title="この見出しへのパーマリンク"></a></h4>
<p>以下では、Ga欠損に対して、2つの極限における入力を作成し可視化します。以降、Ga-rich 極限及びAs-rich極限の入力を示します。</p>
<p>calc_defect_formation_energy.py 用の入力 ( Ga-rich 極限におけるGa欠損;  <code class="docutils literal notranslate"><span class="pre">samples/defectq/GaAs_64_lattice_opt/Vacancy_Ga/cond_Ga_rich.in</span></code> )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">VBM</span>        <span class="c1">#(eV)</span>
<span class="mf">6.00887</span>

<span class="o">&amp;</span><span class="n">band_gap</span>        <span class="c1">#(eV)</span>
<span class="mf">1.424</span>

<span class="o">&amp;</span><span class="n">Chemical_potentials</span> <span class="c1">#(Ha)</span>
<span class="n">Ga</span> <span class="o">-</span><span class="mf">138.9586691142</span>        <span class="c1">#mu_Ga</span>
<span class="n">As</span>  <span class="o">-</span><span class="mf">88.0101007866</span>        <span class="c1">#mu_GaAs -mu_Ga</span>

<span class="o">&amp;</span><span class="n">Defects</span>        <span class="c1">#elements, number ( negative==vacancy, positive==impurity )</span>
<span class="n">Ga</span>  <span class="o">-</span><span class="mi">1</span>

<span class="o">&amp;</span><span class="n">Host_supercell_energy</span> <span class="c1">#(Ha)</span>
<span class="o">-</span><span class="mf">7263.0006368270</span>

<span class="o">&amp;</span><span class="n">Defective_supercell_energy</span> <span class="c1"># charge_state(q) and energy (Ha)</span>
<span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mf">7123.2688494462</span>
<span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mf">7123.4909799361</span>
<span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mf">7123.7111092854</span>
<span class="mi">0</span>  <span class="o">-</span><span class="mf">7123.9292947570</span>

<span class="o">&amp;</span><span class="n">Correction</span> <span class="n">energy</span> <span class="c1"># charge_state(q) and energy (eV)</span>
<span class="o">-</span><span class="mi">3</span> <span class="mf">1.1593520601</span>
<span class="o">-</span><span class="mi">2</span> <span class="mf">0.6178614391</span>
<span class="o">-</span><span class="mi">1</span> <span class="mf">0.2315198082</span>
<span class="mi">0</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>calc_defect_formation_energy.py 用の入力 ( As-rich 極限におけるGa欠損;  <code class="docutils literal notranslate"><span class="pre">samples/defectq/GaAs_64_lattice_opt/Vacancy_Ga/cond_As_rich.in</span></code> )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">VBM</span>        <span class="c1">#(eV)</span>
<span class="mf">6.00887</span>

<span class="o">&amp;</span><span class="n">band_gap</span>        <span class="c1">#(eV)</span>
<span class="mf">1.424</span>

<span class="o">&amp;</span><span class="n">Chemical_potentials</span> <span class="c1">#(Ha)</span>
<span class="n">Ga</span>  <span class="o">-</span><span class="mf">138.9838873703</span>      <span class="c1"># mu_GaAs_bulk -mu_As</span>
<span class="n">As</span>   <span class="o">-</span><span class="mf">87.9848825305</span>       <span class="c1">#mu_As</span>

<span class="o">&amp;</span><span class="n">Defects</span>        <span class="c1">#elements, number ( negative==vacancy, positive==impurity )</span>
<span class="n">Ga</span>  <span class="o">-</span><span class="mi">1</span>

<span class="o">&amp;</span><span class="n">Host_supercell_energy</span> <span class="c1">#(Ha)</span>
<span class="o">-</span><span class="mf">7263.0006368270</span>

<span class="o">&amp;</span><span class="n">Defective_supercell_energy</span> <span class="c1"># charge_state(q) and energy (Ha)</span>
<span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mf">7123.2688494462</span>
<span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mf">7123.4909799361</span>
<span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mf">7123.7111092854</span>
<span class="mi">0</span>  <span class="o">-</span><span class="mf">7123.9292947570</span>

<span class="o">&amp;</span><span class="n">Correction</span> <span class="n">energy</span> <span class="c1"># charge_state(q) and energy (eV)</span>
<span class="o">-</span><span class="mi">3</span> <span class="mf">1.1593520601</span>
<span class="o">-</span><span class="mi">2</span> <span class="mf">0.6178614391</span>
<span class="o">-</span><span class="mi">1</span> <span class="mf">0.2315198082</span>
<span class="mi">0</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>つぎのコマンドを実行すると、生成エネルギーの図 (result-Ga-rich.png及びresult-As-rich.png ) が出来ます。結果を <a class="reference internal" href="#defectq-fig1"><span class="std std-numref">図 8.9</span></a>, <a class="reference internal" href="#defectq-fig2"><span class="std std-numref">図 8.10</span></a> に示します。</p>
<p>calc_defect_formation_energy.pyの実行 (Ga欠損)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span>  <span class="n">calc_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>
<span class="n">cond_Ga_rich</span><span class="o">.</span><span class="ow">in</span>  <span class="o">-</span><span class="n">o</span> <span class="n">result_Ga_rich</span>  <span class="o">--</span><span class="n">emin</span> <span class="o">-</span><span class="mf">0.5</span>  <span class="o">--</span><span class="n">emax</span> <span class="mf">2.0</span>

<span class="n">python3</span>  <span class="n">calc_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>
<span class="n">cond_As_rich</span><span class="o">.</span><span class="ow">in</span>  <span class="o">-</span><span class="n">o</span> <span class="n">result_As_rich</span>  <span class="o">--</span><span class="n">emin</span> <span class="o">-</span><span class="mf">0.5</span>  <span class="o">--</span><span class="n">emax</span> <span class="mf">2.0</span>
</pre></div>
</div>
<figure class="align-default" id="defectq-fig1">
<img alt="../_images/defectq1.png" src="../_images/defectq1.png" />
<figcaption>
<p><span class="caption-number">図 8.9 </span><span class="caption-text">Ga-rich limit (ファイル名：result-Ga-rich.png )</span><a class="headerlink" href="#defectq-fig1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="defectq-fig2">
<img alt="../_images/defectq2.png" src="../_images/defectq2.png" />
<figcaption>
<p><span class="caption-number">図 8.10 </span><span class="caption-text">As-rich limit (ファイル名：result-As-rich.png )</span><a class="headerlink" href="#defectq-fig2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id53">
<h4><span class="section-number">8.7.4.5. </span>生成エネルギー図の作成 2.<a class="headerlink" href="#id53" title="この見出しへのパーマリンク"></a></h4>
<p>以下で、種々の欠陥構造に対する生成エネルギーをまとめた図を作成します。Ga-rich 及びAs-rich 極限のファイルが、それぞれ、 <code class="docutils literal notranslate"><span class="pre">samples/defectq/GaAs_64_lattice_opt</span></code> の下の <code class="docutils literal notranslate"><span class="pre">gather_Ga_rich.in</span></code> 及び <code class="docutils literal notranslate"><span class="pre">gather_As_rich.in</span></code> にあります。後者は、つぎに紹介する入力のresult-Ga-rich を result-As-rich に置換したものです。 なお、欠陥の種類としては、文献 <a class="reference internal" href="#broberg18" id="id54"><span>[Broberg18]</span></a> 記載のものを選択しました。</p>
<p>gather_Ga_rich.inの内容</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># title   filename ( excluding &quot;.min&quot; )</span>
<span class="c1">#</span>

<span class="o">&amp;</span><span class="n">List</span>
<span class="n">Vac_Ga</span>    <span class="n">Vacancy_Ga</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">Vac_As</span>    <span class="n">Vacancy_As</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">Ga_As</span>     <span class="n">Ga_for_As</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">As_Ga</span>     <span class="n">As_for_Ga</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">Ga_i_As4</span>  <span class="n">Ga_interstitial_As4</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">As_i_As4</span>  <span class="n">As_interstitial_As4</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">Ga_i_Ga4</span>  <span class="n">Ga_interstitial_Ga4</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>
<span class="n">As_i_Ga4</span>  <span class="n">As_interstitial_Ga4</span><span class="o">/</span><span class="n">result</span><span class="o">-</span><span class="n">Ga</span><span class="o">-</span><span class="n">rich</span>

<span class="o">&amp;</span><span class="n">band_gap</span>        <span class="c1">#(eV)</span>
<span class="mf">1.424</span>
</pre></div>
</div>
<p>つぎのコマンドを実行すると、生成エネルギーの図 (results-Ga-rich.png及びresults-As-rich.png) が出来ます。結果を <a class="reference internal" href="#defectq-fig3"><span class="std std-numref">図 8.11</span></a> および <a class="reference internal" href="#defectq-fig4"><span class="std std-numref">図 8.12</span></a> に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span>  <span class="n">plot_multiple_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>
<span class="n">gather_Ga_rich</span><span class="o">.</span><span class="ow">in</span>  <span class="o">-</span><span class="n">o</span> <span class="n">results_Ga_rich</span>  <span class="o">--</span><span class="n">emin</span> <span class="o">-</span><span class="mf">0.2</span>  <span class="o">--</span><span class="n">emax</span> <span class="mf">2.0</span> <span class="o">--</span><span class="n">vmin</span> <span class="o">-</span><span class="mf">4.0</span> <span class="o">--</span><span class="n">vmax</span> <span class="mf">5.0</span>
<span class="o">--</span><span class="n">keypos_h</span> <span class="n">left</span> <span class="o">--</span><span class="n">keypos_v</span> <span class="n">bottom</span>
<span class="n">python3</span>  <span class="n">plot_multiple_defect_formation_energy</span><span class="o">.</span><span class="n">py</span>
<span class="n">gather_As_rich</span><span class="o">.</span><span class="ow">in</span>  <span class="o">-</span><span class="n">o</span> <span class="n">results_As_rich</span>  <span class="o">--</span><span class="n">emin</span> <span class="o">-</span><span class="mf">0.2</span>  <span class="o">--</span><span class="n">emax</span> <span class="mf">2.0</span> <span class="o">--</span><span class="n">vmin</span> <span class="o">-</span><span class="mf">4.0</span> <span class="o">--</span><span class="n">vmax</span> <span class="mf">5.0</span>
<span class="o">--</span><span class="n">keypos_h</span> <span class="n">left</span> <span class="o">--</span><span class="n">keypos_v</span> <span class="n">bottom</span>
</pre></div>
</div>
<figure class="align-default" id="defectq-fig3">
<img alt="../_images/defectq3.png" src="../_images/defectq3.png" />
<figcaption>
<p><span class="caption-number">図 8.11 </span><span class="caption-text">Ga-rich limit (ファイル名：results-Ga-rich.png)</span><a class="headerlink" href="#defectq-fig3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="defectq-fig4">
<img alt="../_images/defectq4.png" src="../_images/defectq4.png" />
<figcaption>
<p><span class="caption-number">図 8.12 </span><span class="caption-text">As-rich limit (ファイル名：results-As-rich.png)</span><a class="headerlink" href="#defectq-fig4" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>文献 <a class="reference internal" href="#broberg18" id="id55"><span>[Broberg18]</span></a> と同様の生成エネルギー図が得られました (生成エネルギーの絶対値や Charge Transition Level は、完全には一致しません)。</p>
<div role="list" class="citation-list">
<div class="citation" id="freysoldt09" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Freysoldt09<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id38">1</a>,<a role="doc-backlink" href="#id40">2</a>)</span>
<p>C. Freysoldt, J. Neugebauer, and C. G. Van de Walle, Phys. Rev. Lett. 102 (2009) 016402.</p>
</div>
<div class="citation" id="kumagai14" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id42">Kumagai14</a><span class="fn-bracket">]</span></span>
<p>Y. Kumagai and F. Oba, Phys. Rev. B 89 (2014) 195205.</p>
</div>
<div class="citation" id="broberg18" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Broberg18<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id54">1</a>,<a role="doc-backlink" href="#id55">2</a>)</span>
<p>D. Broberg, B. Medasani, N. Zimmermann, A. Canning, M. Haranczyk, M. Asta, and G. Hautier,, Comput. Phys. Commun. 226 (2018) 165.</p>
</div>
</div>
</section>
</section>
</section>
<section id="xps">
<span id="section-xps"></span><h2><span class="section-number">8.8. </span>XPS<a class="headerlink" href="#xps" title="この見出しへのパーマリンク"></a></h2>
<section id="id56">
<h3><span class="section-number">8.8.1. </span>概要<a class="headerlink" href="#id56" title="この見出しへのパーマリンク"></a></h3>
<p>2020年版までのPHASE/0 では、XPS・XANES のピーク位置が実験値と異なることがありました。原因として、内殻電子の相対論的効果、スピン分裂効果が考えられます。前者については、CIAO を改変し相対論的効果を含む (DIRAC型の) 運動エネルギーを出力可能なようにしました。後者については、PHASE/0 のopencore 法を改変し、その効果を取り込めるようにしました。これによって、SiC、AlN、Li7Ti5O12 結晶の内殻軌道の結合エネルギーについて、従来法に比べて実験値との差が小さくなることなどを確認しています。</p>
</section>
<section id="id57">
<h3><span class="section-number">8.8.2. </span>理論<a class="headerlink" href="#id57" title="この見出しへのパーマリンク"></a></h3>
<section id="id58">
<h4><span class="section-number">8.8.2.1. </span>相対論的運動エネルギー<a class="headerlink" href="#id58" title="この見出しへのパーマリンク"></a></h4>
<p>Kohn-Sham 方程式は、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps1">
<span class="eqno">(8.17)<a class="headerlink" href="#equation-eq-newxps1" title="この数式へのパーマリンク"></a></span>\[\left( T+V \right) \psi_i = \varepsilon_i \psi_i\]</div>
<p>で表されます。 <span class="math notranslate nohighlight">\(T\)</span> 及び <span class="math notranslate nohighlight">\(V\)</span> はそれぞれ、運動エネルギー及びポテンシャル演算子、また <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> 及び <span class="math notranslate nohighlight">\(\psi_i\)</span> は固有値・固有波動関数です。ここで、運動エネルギー演算子は、相対論的効果の取り入れ方により、いくつかの形状が提案されています <a class="reference internal" href="#lenthe96" id="id59"><span>[Lenthe96]</span></a> 。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps2">
<span class="eqno">(8.18)<a class="headerlink" href="#equation-eq-newxps2" title="この数式へのパーマリンク"></a></span>\[\begin{split}T^{\rm NR} = \frac{1}{2} \mathbf{p}^2, \\
T^{\rm ZORA} = \mathbf{\sigma} \cdot \mathbf{p} \frac{c^2}{2c^2 - V} \bf{\sigma} \cdot \mathbf{p} , \\
T^{\rm DIRAC} = \mathbf{\sigma} \cdot \mathbf{p} \frac{c^2}{2c^2+\varepsilon_i - V} \mathbf{\sigma} \cdot \mathbf{p}.\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(T^{\rm NR}\)</span> は非相対論、  <span class="math notranslate nohighlight">\(T^{\rm ZORA}\)</span> はZORA (Zero Order Regular Approximation)、 <span class="math notranslate nohighlight">\(T^{\rm DIRAC}\)</span> はDirac相対論によるものです。ZORAの場合は、scalar relativistic 項とスピン軌道相互作用項に分解できます。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps3">
<span class="eqno">(8.19)<a class="headerlink" href="#equation-eq-newxps3" title="この数式へのパーマリンク"></a></span>\[\begin{split}T^{\rm ZORA} = T_{\rm sc}^{\rm ZORA} + T_{\rm SOC}^{\rm ZORA}, \\
T_{\rm sc}^{ZORA} = \mathbf{p} \frac{c^2}{2c^2 -V} \mathbf{p}, T_{\rm SOC}^{\rm ZORA} = \frac{c^2}{\left( 2c^2 -V \right)^2 } \sigma \cdot \left( \nabla V \times \mathbf{p} \right)\end{split}\]</div>
<p>Dirac の場合、上式にて <span class="math notranslate nohighlight">\(V\)</span> を <span class="math notranslate nohighlight">\(V-\varepsilon_i\)</span> と読み替えればよく、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps4">
<span class="eqno">(8.20)<a class="headerlink" href="#equation-eq-newxps4" title="この数式へのパーマリンク"></a></span>\[\begin{split}T^{\rm DIRAC} = T_{\rm sc}^{\rm DIRAC} + T_{\rm SOC}^{\rm DIRAC}, \\
T_{\rm sc}^{DIRAC} = \mathbf{p} \frac{c^2}{2c^2 -V - \varepsilon_i} \mathbf{p}, T_{\rm SOC}^{\rm DIRAC} = \frac{c^2}{\left( 2c^2 -V  - \varepsilon_i \right)^2 } \sigma \cdot \left( \nabla V \times \mathbf{p} \right)\end{split}\]</div>
<p>となります。
ただし、擬ポテンシャル作成時はscalar-relativisitic で解く必要があり、スピン軌道相互作用による効果は考慮されません。このため、CIAO が擬ポテンシャルファイルに出力する、内殻電子の運動エネルギーは scalar-relativisitic 項のみで評価します。</p>
<p>さて、内殻電子の運動エネルギーは</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps5">
<span class="eqno">(8.21)<a class="headerlink" href="#equation-eq-newxps5" title="この数式へのパーマリンク"></a></span>\[E_{\rm kin}^{\rm core} = \sum_{i}^{\rm core} \left&lt; \psi_i \left| V_{\rm sc}^{\rm DIRAC} \right| \psi_i \right&gt;\]</div>
<p>で表されます。上記は DIRAC の場合ですが、ZORA の場合も同様です。
最後に、CIAOではポテンシャルは球対称として扱うので、波動関数は動径方向成分のみをもちます。このため、運動エネルギー演算子は以下のように展開できます。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps6">
<span class="eqno">(8.22)<a class="headerlink" href="#equation-eq-newxps6" title="この数式へのパーマリンク"></a></span>\[\begin{split}T_{\rm sc}^{\rm ZORA} \psi_i \left( r \right) = - \frac{\partial V}{\partial r} \frac{c^2}{\left( 2c^2 - V\right)^2} \frac{\partial \psi_i}{\partial r} - \frac{c^2}{2c^2 - V} \Delta \psi_i, \\
T_{\rm sc}^{\rm DIRAC} \psi_i \left( r \right) =  - \frac{\partial V}{\partial r} \frac{c^2}{\left( 2c^2 + \varepsilon_i - V\right)^2} \frac{\partial \psi_i}{\partial r} - \frac{c^2}{2c^2 +\varepsilon_i - V} \Delta \psi_i, \\
\Delta \psi_i \left( r \right) = \frac{1}{r} \frac{\partial^2}{\partial r^2} \left( r\psi_i \right) - \frac{l \left( l+1 \right)}{r^2} \psi_i\end{split}\]</div>
</section>
<section id="id60">
<h4><span class="section-number">8.8.2.2. </span>内殻電子のスピン<a class="headerlink" href="#id60" title="この見出しへのパーマリンク"></a></h4>
<p>CIAOでは、擬ポテンシャルはスピン中性で作成します。内殻電子についても同様であり、この時の内殻電子密度を <span class="math notranslate nohighlight">\(\rho_{\rm core}\)</span> とします。ここで、ある軌道 (n,l) におけるスピン占有数 <span class="math notranslate nohighlight">\(f_{n,l}^{\uparrow}\)</span> 及び <span class="math notranslate nohighlight">\(f_{n,l}^{\downarrow}\)</span> が変わり、 <span class="math notranslate nohighlight">\(f_{n,l}^{\uparrow} \neq f_{n,l}^{\downarrow}\)</span> になったとします。ただし、  <span class="math notranslate nohighlight">\(f_{n,l}^{\uparrow} + f_{n,l}^{\downarrow}\)</span> は擬ポテンシャル作成時と同じであるとします。このとき。各スピンの内殻電子密度は以下のように表されます。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps7">
<span class="eqno">(8.23)<a class="headerlink" href="#equation-eq-newxps7" title="この数式へのパーマリンク"></a></span>\[\begin{split}\rho_{\rm core}^{\uparrow} \left( r \right) = \rho_{\rm core} \left( r \right) + \frac{1}{2} \Delta \rho \left( r \right) \\
\rho_{\rm core}^{\downarrow} \left( r \right) = \rho_{\rm core} \left( r \right) - \frac{1}{2} \Delta \rho \left( r \right)\end{split}\]</div>
<p>ここで、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps8">
<span class="eqno">(8.24)<a class="headerlink" href="#equation-eq-newxps8" title="この数式へのパーマリンク"></a></span>\[\Delta \rho \left( r \right) = \left( f_{n,l}^{\uparrow} - f_{n,l}^{\downarrow} \right) \left| \phi_{n,l}^{\rm AE} \left( r \right) \right|^2\]</div>
<p>はスピン密度の差で、波動関数 <span class="math notranslate nohighlight">\(\phi_{n,l}^{\rm AE}\)</span> はスピン状態により不変と仮定しています。
このスピン密度変化により影響を受けるエネルギーは、交換相関相互作用 (XC) エネルギー</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps9">
<span class="eqno">(8.25)<a class="headerlink" href="#equation-eq-newxps9" title="この数式へのパーマリンク"></a></span>\[\widetilde{E}_{\rm XC} \left( \rho \right) - E_{\rm XC}^{\rm PS} \left( \rho \right) + E_{\rm XC}^{\rm AE} \left( \rho \right)\]</div>
<p>です。第1項は非PAW項、第2、3項はPAW由来の項です。なお、スピン密度の和は不変であるので、Hartreeポテンシャルは変更を受けません。よって、XC ポテンシャルのみ <span class="math notranslate nohighlight">\(\Delta \rho \left( r \right)\)</span> を考慮します。</p>
</section>
<section id="id61">
<h4><span class="section-number">8.8.2.3. </span>XPSのピークエネルギーの計算方法<a class="headerlink" href="#id61" title="この見出しへのパーマリンク"></a></h4>
<p>非金属の固体のXPSにおけるピークエネルギーは、以下の結合エネルギー <span class="math notranslate nohighlight">\(E_{\rm B}\)</span> に対応します <a class="reference internal" href="#ozaki17" id="id62"><span>[Ozaki17]</span></a> 。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps10">
<span class="eqno">(8.26)<a class="headerlink" href="#equation-eq-newxps10" title="この数式へのパーマリンク"></a></span>\[E_{\rm B} = E_{\rm final} \left( N-1 \right) - E_{\rm initial} \left( N \right) + \mu_0\]</div>
<p>ここで、 <span class="math notranslate nohighlight">\(N\)</span> は系の電子数です。 <span class="math notranslate nohighlight">\(\mu_0\)</span> は系の化学ポテンシャルで、gapのある系では、価電子帯上端 (VBM) から伝導体下端 (CBM) まで取りえます。特に、真性半導体では、バンドギャップを <span class="math notranslate nohighlight">\(E_g\)</span> として、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps11">
<span class="eqno">(8.27)<a class="headerlink" href="#equation-eq-newxps11" title="この数式へのパーマリンク"></a></span>\[\mu_0 = E_{\rm VBM} + \frac{1}{2} E_g\]</div>
<p>となります。なお、VBMのエネルギー <span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> は</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps12">
<span class="eqno">(8.28)<a class="headerlink" href="#equation-eq-newxps12" title="この数式へのパーマリンク"></a></span>\[E_{\rm VBM} = \frac{E_{\rm initial} \left( N \right) - E_{\rm initial} \left( N - \Delta N \right)}{\Delta N}\]</div>
<p>で計算できます。また、帯電状態を周期的境界条件で計算するので、その補正法の1つとして、式 <a class="reference internal" href="#equation-eq-defectq2">(8.9)</a> の ( q =1 ) を加えることもできます。</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps13">
<span class="eqno">(8.29)<a class="headerlink" href="#equation-eq-newxps13" title="この数式へのパーマリンク"></a></span>\[E_{\rm B} = E_{\rm final} \left( N - 1 \right) - E_{\rm initial} \left( N \right) + \mu_0 + E_{\rm corr}^1\]</div>
<p>一方、系が金属の場合には、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps14">
<span class="eqno">(8.30)<a class="headerlink" href="#equation-eq-newxps14" title="この数式へのパーマリンク"></a></span>\[E_{\rm B} = E_{\rm final} \left( N \right) - E_{\rm initial} \left( N \right)\]</div>
<p>となります。</p>
<p>なお、固体ではなく分子の場合は、</p>
<div class="math notranslate nohighlight" id="equation-eq-newxps15">
<span class="eqno">(8.31)<a class="headerlink" href="#equation-eq-newxps15" title="この数式へのパーマリンク"></a></span>\[E_{\rm B} = E_{\rm final} \left( N-1 \right) - E_{\rm initial} \left( N \right) + E_{\rm corr}^1\]</div>
<p>となります。</p>
</section>
</section>
<section id="id63">
<h3><span class="section-number">8.8.3. </span>使い方<a class="headerlink" href="#id63" title="この見出しへのパーマリンク"></a></h3>
<section id="newxps-usage1">
<span id="id64"></span><h4><span class="section-number">8.8.3.1. </span>相対論的運動エネルギー<a class="headerlink" href="#newxps-usage1" title="この見出しへのパーマリンク"></a></h4>
<p>相対論的運動エネルギーを出力するためのCIAOの入力は下記の通り。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># PAW
sw_paw     1

# CORE ELECTRON INFO
sw_with_dipole_cor2val  1
method_ekin_core  1              ! default:0 (非相対論), 1:DIRAC, 2: ZORA
</pre></div>
</div>
<p>method_ekin_core 1 或いは 2 で、内殻電子の相対論的運動エネルギーを出力します。なお、”sw_with_dipole_cor2val 1” は、これまでと同様、内殻電子のXPS・XANES計算には必須です。</p>
<p>“method_ekin_core 1”の場合の3つのスイッチの設定は、以下の入力でも可能です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sw_write_core_full</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>結果はgncpp2ファイル(擬ポテンシャルファイル)に出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CORE ENERGY CONTRIB
  0.319190836204E+02     kin              ! 内殻電子の運動エネルギー
 -0.677766126155E+02     ion
  0.697542582590E+01     hartr
</pre></div>
</div>
</section>
<section id="id65">
<h4><span class="section-number">8.8.3.2. </span>内殻電子のスピン<a class="headerlink" href="#id65" title="この見出しへのパーマリンク"></a></h4>
<p>ある原子の内殻電子が励起された状態を考える場合、該当する軌道に正孔を入れた擬ポテンシャルを使う必要があります。例えば、1s軌道励起の場合は 1s 軌道に正孔、2p軌道励起の場合は2p軌道に正孔を入れます。
これらの原子は、内殻電子は開殻となるので、スピン自由度をもちます。内殻電子のスピンを扱うには、sw_opencore = on とします。デフォルトでは、式 <a class="reference internal" href="#equation-eq-newxps9">(8.25)</a> の全項でスピンを考慮しますが、sw_xc_opencore_ae_only = onとすると、第3項 (AE部分)のみ考慮します。
価電子が磁気モーメントをもつ磁性材料では、spin_orientation の指定により、内殻電子と (原子近傍の) 価電子の磁気モーメントの向きを、平行・反平行のいずれかに指定できます。ただし、SCF iteration で価電子の磁気モーメントが反転したりすると、内殻電子も追随するため、収束性が悪くなる場合があります。そこで、sw_fix_core_spin_pol = onとすると、初期磁気モーメントの向きに固定することが出来ます。</p>
<p>内殻電子のスピンを考慮するための入力例。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>accuracy{
    paw = on
    core_electrons{
       sw_opencore = on                        ! default :off
       sw_xc_opencore_ae_only = on             ! default :off
       spin_orientation = anti_parallel        ! anti_parallel or parallel (default)
       sw_fix_core_spin_pol = on               ! default: off
    }
}
postprocessing{
   corelevels{
     sw_calc_core_energy = on           ! XPS 計算に必要
   }
}
</pre></div>
</div>
<p>また、s軌道以外から励起する場合には、内殻電子のスピン軌道相互作用により、XPSのピークが2つに分裂します。例えば、2p軌道の場合には、2p1/2と2p3/2 に分裂します。この場合、以下のようにすると、両者の全エネルギー値を計算することが出来ます。</p>
<p>内殻電子準位のスピン軌道分裂を考慮するための入力例。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>postprocessing{
   corelevels{
     sw_calc_core_energy = on
     corehole{
         atom_id = 1　         ! 励起する原子
         orbital = 2p　　      ! 励起する軌道
     }
   }
}
</pre></div>
</div>
<p>(内殻電子のエネルギーを含む) 系の全エネルギーは、core_energy.data に出力されます。sw_calc_core_energy = onとした場合には、core_energy.data 末尾に、スピン軌道分裂したエネルギー値が追記されます。 <a class="reference internal" href="#equation-eq-newxps10">(8.26)</a> <a class="reference internal" href="#equation-eq-newxps13">(8.29)</a> <a class="reference internal" href="#equation-eq-newxps15">(8.31)</a> などの結合ネルギーの計算における <span class="math notranslate nohighlight">\(E_{\rm final}\)</span> や <span class="math notranslate nohighlight">\(E_{\rm initial}\)</span> はここに記録された値を利用します。</p>
<p>core_energy.dataの出力例</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Etotal (Core+Valence)</span>
  <span class="o">-</span><span class="mf">18558.3245482622</span>

<span class="c1"># Etotal (Core+Valence+Soc_corehole)</span>
<span class="c1"># J = 3/2:             -18558.3331659845</span>
<span class="c1"># J = 1/2:             -18558.3073128174</span>
</pre></div>
</div>
</section>
</section>
<section id="id66">
<h3><span class="section-number">8.8.4. </span>例題<a class="headerlink" href="#id66" title="この見出しへのパーマリンク"></a></h3>
<p>例題の計算結果を紹介します。XPSの例題は <code class="code docutils literal notranslate"><span class="pre">samples/XPS</span></code> ディレクトリーに配置されています。用いる擬ポテンシャルは <a class="reference internal" href="#newxps-usage1"><span class="std std-ref">相対論的運動エネルギー</span></a> において説明したsw_write_core_full の値を1として作成した擬ポテンシャルで、それぞれの例題のpseudoサブディレクトリーに配置されています。</p>
<section id="h-sic-c-1s">
<h4><span class="section-number">8.8.4.1. </span>4H-SiC結晶 (C 1s)<a class="headerlink" href="#h-sic-c-1s" title="この見出しへのパーマリンク"></a></h4>
<p>4H-SiC結晶の例は <code class="code docutils literal notranslate"><span class="pre">samples/XPS/4H-SiC</span></code> 以下に配置されています。そのディレクトリー構成は下記の通りです。</p>
<table class="docutils align-default" id="newxps-dirlist-table1">
<caption><span class="caption-number">表 8.12 </span><span class="caption-text">4H-SiC (C 1s) XPS計算のディレクトリー構造</span><a class="headerlink" href="#newxps-dirlist-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>第一階層</p></td>
<td><p>第二階層</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>Final</p></td>
<td></td>
<td><p>終状態の入力ファイル</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0_no_opencore</p></td>
<td><p>中性・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0_with_opencore</p></td>
<td><p>中性・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1_no_opencore</p></td>
<td><p>電荷+1・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_1_with_opencore</p></td>
<td><p>電荷+1・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td><p>Initial</p></td>
<td></td>
<td><p>初期状態の入力ファイル</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0</p></td>
<td><p>中性</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0.2</p></td>
<td><p>電荷+0.2</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0.5</p></td>
<td><p>電荷+0.5</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1</p></td>
<td><p>電荷+1</p></td>
</tr>
</tbody>
</table>
<p>計算条件は以下のとおりです。なお、スーパーセルの格子定数は、自動最適化により得られた値 ( a = 3.108 Å、c= 10.170 Å )を <span class="math notranslate nohighlight">\(3 \times 3 \times 3\)</span> 倍しました。</p>
<table class="docutils align-default" id="newxps-table1">
<caption><span class="caption-number">表 8.13 </span><span class="caption-text">4H-SiC (C 1s) XPS計算に用いた条件</span><a class="headerlink" href="#newxps-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>Monkhorst-Pack 2×2×2</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
<tr class="row-even"><td><p>内殻電子のスピン</p></td>
<td><p>sw_xc_opencore_ae_only = on</p></td>
</tr>
<tr class="row-odd"><td><p>CIAOの入力</p></td>
<td><p>sw_write_core_full 1</p></td>
</tr>
<tr class="row-even"><td><p>(補正項計算で使用する)誘電率</p></td>
<td><p>※9.76 (ab面内), 10.32 (c軸)</p></td>
</tr>
</tbody>
</table>
<p>※<a class="reference external" href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/9781118313534.app3">https://onlinelibrary.wiley.com/doi/pdf/10.1002/9781118313534.app3</a></p>
<p>計算結果は以下の通りです。</p>
<table class="docutils align-center" id="newxps-table2">
<caption><span class="caption-number">表 8.14 </span><span class="caption-text">4H-SiC (C 1s) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps13">(8.29)</a> により評価。</span><a class="headerlink" href="#newxps-table2" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm final} (N-1) - E_{\rm initial} (N)\)</span></p></td>
<td><p>279.258</p></td>
<td><p>272.309</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_{\rm corr}^1\)</span></p></td>
<td><p>0.237</p></td>
<td><p>0.237</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> ( <span class="math notranslate nohighlight">\(\Delta N=0.2\)</span>)</p></td>
<td colspan="2"><p>9.307</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_g\)</span></p></td>
<td colspan="2"><p>2.435</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p></td>
<td><p>289.975</p></td>
<td><p>283.026</p></td>
</tr>
<tr class="row-odd"><td><p>実験値</p></td>
<td colspan="2"><p>283 +/- 0.8 <sup>a)</sup></p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference external" href="http://www.xpsfitting.com/2012/01/silicon.html">http://www.xpsfitting.com/2012/01/silicon.html</a></p>
<p>内殻電子のスピンを考慮することにより、実験値に近い結合エネルギーが得られています。
なお、式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> を用いた場合、 <span class="math notranslate nohighlight">\(E_{\rm B}\)</span> は以下のようになりました。</p>
<table class="docutils align-default" id="newxps-table3">
<caption><span class="caption-number">表 8.15 </span><span class="caption-text">4H-SiC (C 1s) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> により評価。</span><a class="headerlink" href="#newxps-table3" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p>
</div></blockquote>
</td>
<td><p>290.815</p></td>
<td><p>283.864</p></td>
</tr>
</tbody>
</table>
</section>
<section id="w-aln-n-1s">
<h4><span class="section-number">8.8.4.2. </span>w-AlN 結晶 (N 1s)<a class="headerlink" href="#w-aln-n-1s" title="この見出しへのパーマリンク"></a></h4>
<p>w-AlN結晶 (N 1s) の例は <code class="docutils literal notranslate"><span class="pre">samples/XPS/w-AlN</span></code> 以下に配置されています。そのディレクトリー構成は下記の通りです。</p>
<table class="docutils align-default" id="newxps-dirlist-table2">
<caption><span class="caption-number">表 8.16 </span><span class="caption-text">w-AlN 結晶 (N 1s) XPS計算のディレクトリー構造</span><a class="headerlink" href="#newxps-dirlist-table2" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>第一階層</p></td>
<td><p>第二階層</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>Final_N1s</p></td>
<td></td>
<td><p>終状態の入力ファイル</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0_no_opencore</p></td>
<td><p>中性・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0_with_opencore</p></td>
<td><p>中性・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1_no_opencore</p></td>
<td><p>電荷+1・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_1_with_opencore</p></td>
<td><p>電荷+1・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td><p>Initial</p></td>
<td></td>
<td><p>初期状態の入力ファイル</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0</p></td>
<td><p>中性</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0.2</p></td>
<td><p>電荷+0.2</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0.5</p></td>
<td><p>電荷+0.5</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1</p></td>
<td><p>電荷+1</p></td>
</tr>
</tbody>
</table>
<p>計算条件は以下のとおりです。なお、スーパーセルの格子定数は、自動最適化により得られた値 ( a = 3.140 Å、c= 5.040 Å ) <span class="math notranslate nohighlight">\(3 \times 3 \times 2\)</span> 倍しました。</p>
<table class="docutils align-default" id="newxps-table4">
<caption><span class="caption-number">表 8.17 </span><span class="caption-text">w-AlN結晶 (N 1s)</span><a class="headerlink" href="#newxps-table4" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>Monkhorst-Pack 2×2×2</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
<tr class="row-even"><td><p>内殻電子のスピン</p></td>
<td><p>sw_xc_opencore_ae_only = on</p></td>
</tr>
<tr class="row-odd"><td><p>CIAOの入力</p></td>
<td><p>sw_write_core_full 1</p></td>
</tr>
<tr class="row-even"><td><p>(補正項計算で使用する)誘電率</p></td>
<td><p>※8.23 (ab面内), 9.74 (c軸)</p></td>
</tr>
</tbody>
</table>
<p>※<a class="reference external" href="https://materialsproject.org/materials/mp-661/">https://materialsproject.org/materials/mp-661/</a></p>
<table class="docutils align-center" id="newxps-table5">
<caption><span class="caption-number">表 8.18 </span><span class="caption-text">w-AlN (N 1s) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps13">(8.29)</a> により評価。</span><a class="headerlink" href="#newxps-table5" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm final} (N-1) - E_{\rm initial} (N)\)</span></p></td>
<td><p>395.772</p></td>
<td><p>387.703</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_{\rm corr}^1\)</span></p></td>
<td><p>0.310</p></td>
<td><p>0.310</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> ( <span class="math notranslate nohighlight">\(\Delta N=0.2\)</span>)</p></td>
<td colspan="2"><p>6.735</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_g\)</span></p></td>
<td colspan="2"><p>4.404</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p></td>
<td><p>405.019</p></td>
<td><p>396.550</p></td>
</tr>
<tr class="row-odd"><td><p>実験値</p></td>
<td colspan="2"><p>397.4 <sup>a)</sup></p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference internal" href="#mahmood03" id="id67"><span>[Mahmood03]</span></a></p>
<p>内殻電子のスピンを考慮することにより、実験値に近い結合エネルギーが得られています。
なお、式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> を用いた場合、 <span class="math notranslate nohighlight">\(E_{\rm B}\)</span> は以下のようになりました。</p>
<table class="docutils align-default" id="newxps-table6">
<caption><span class="caption-number">表 8.19 </span><span class="caption-text">AlN (N 1s) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> により評価。</span><a class="headerlink" href="#newxps-table6" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p>
</div></blockquote>
</td>
<td><p>406.976</p></td>
<td><p>398.889</p></td>
</tr>
</tbody>
</table>
</section>
<section id="w-aln-al-2p3-2">
<h4><span class="section-number">8.8.4.3. </span>w-AlN 結晶 (Al 2p3/2)<a class="headerlink" href="#w-aln-al-2p3-2" title="この見出しへのパーマリンク"></a></h4>
<p>w-AlN結晶 (Al 2p3/2) の例は <code class="docutils literal notranslate"><span class="pre">samples/XPS/w-AlN</span></code> 以下に配置されています。そのディレクトリー構成は下記の通りです。</p>
<table class="docutils align-default" id="newxps-dirlist-table3">
<caption><span class="caption-number">表 8.20 </span><span class="caption-text">w-AlN 結晶 (Al 2p3/2) XPS計算のディレクトリー構造</span><a class="headerlink" href="#newxps-dirlist-table3" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>第一階層</p></td>
<td><p>第二階層</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>Final_Al2p</p></td>
<td></td>
<td><p>終状態の入力ファイル</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0_no_opencore</p></td>
<td><p>中性・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0_with_opencore</p></td>
<td><p>中性・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1_no_opencore</p></td>
<td><p>電荷+1・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_1_with_opencore</p></td>
<td><p>電荷+1・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td><p>Initial</p></td>
<td></td>
<td><p>初期状態の入力ファイル</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0</p></td>
<td><p>中性</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0.2</p></td>
<td><p>電荷+0.2</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0.5</p></td>
<td><p>電荷+0.5</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_1</p></td>
<td><p>電荷+1</p></td>
</tr>
</tbody>
</table>
<p>計算条件は以下のとおりです。なお、スーパーセルの格子定数は、自動最適化により得られた値 ( a = 3.140 Å、c= 5.040 Å ) <span class="math notranslate nohighlight">\(3 \times 3 \times 2\)</span> 倍しました。</p>
<table class="docutils align-default" id="newxps-table7">
<caption><span class="caption-number">表 8.21 </span><span class="caption-text">w-AlN結晶 (Al 2p3/2)</span><a class="headerlink" href="#newxps-table7" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>Monkhorst-Pack 2×2×2</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
<tr class="row-even"><td><p>内殻電子のスピン</p></td>
<td><p>sw_xc_opencore_ae_only = on</p></td>
</tr>
<tr class="row-odd"><td><p>CIAOの入力</p></td>
<td><p>sw_write_core_full 1</p></td>
</tr>
<tr class="row-even"><td><p>(補正項計算で使用する)誘電率</p></td>
<td><p>※8.23 (ab面内), 9.74 (c軸)</p></td>
</tr>
</tbody>
</table>
<p>※<a class="reference external" href="https://materialsproject.org/materials/mp-661/">https://materialsproject.org/materials/mp-661/</a></p>
<table class="docutils align-center" id="newxps-table8">
<caption><span class="caption-number">表 8.22 </span><span class="caption-text">w-AlN (Al 2p3/2) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps13">(8.29)</a> により評価。</span><a class="headerlink" href="#newxps-table8" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm final} (N-1) - E_{\rm initial} (N)\)</span></p></td>
<td><p>64.980</p></td>
<td><p>64.212</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_{\rm corr}^1\)</span></p></td>
<td><p>0.327</p></td>
<td><p>0.327</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm VBM}\)</span> ( <span class="math notranslate nohighlight">\(\Delta N=0.2\)</span>)</p></td>
<td colspan="2"><p>6.735</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_g\)</span></p></td>
<td colspan="2"><p>4.404</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p></td>
<td><p>74.244</p></td>
<td><p>73.476</p></td>
</tr>
<tr class="row-odd"><td><p>実験値</p></td>
<td colspan="2"><p>73.3 <sup>a)</sup></p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference internal" href="#mahmood03" id="id68"><span>[Mahmood03]</span></a></p>
<p>内殻電子のスピンを考慮することにより、実験値に近い結合エネルギーが得られています。
なお、式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> を用いた場合、 <span class="math notranslate nohighlight">\(E_{\rm B}\)</span> は以下のようになりました。</p>
<table class="docutils align-default" id="newxps-table9">
<caption><span class="caption-number">表 8.23 </span><span class="caption-text">w-AlN (Al 2p3/2) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> により評価。</span><a class="headerlink" href="#newxps-table9" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p>
</div></blockquote>
</td>
<td><p>76.221</p></td>
<td><p>75.446</p></td>
</tr>
</tbody>
</table>
</section>
<section id="fcc-pt-pt-4f">
<h4><span class="section-number">8.8.4.4. </span>fcc Pt結晶 (Pt 4f)<a class="headerlink" href="#fcc-pt-pt-4f" title="この見出しへのパーマリンク"></a></h4>
<p>fcc PtN結晶 (Pt 4f) の例は <code class="docutils literal notranslate"><span class="pre">samples/XPS/Pt</span></code> 以下に配置されています。そのディレクトリー構成は下記の通りです。</p>
<table class="docutils align-default" id="newxps-dirlist-table4">
<caption><span class="caption-number">表 8.24 </span><span class="caption-text">fcc Pt結晶 (Pt 4f) XPS計算のディレクトリー構造</span><a class="headerlink" href="#newxps-dirlist-table4" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>第一階層</p></td>
<td><p>第二階層</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>Final</p></td>
<td></td>
<td><p>終状態の入力ファイル</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>q_0_no_opencore</p></td>
<td><p>中性・内殻スピンなし</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0_with_opencore</p></td>
<td><p>中性・内殻スピンあり</p></td>
</tr>
<tr class="row-odd"><td><p>Initial</p></td>
<td></td>
<td><p>初期状態の入力ファイル</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>q_0</p></td>
<td><p>中性</p></td>
</tr>
</tbody>
</table>
<p>計算条件は以下のとおりです。なお、スーパーセルの格子定数は、自動最適化により得られた値 ( a = 3.963 Å )を <span class="math notranslate nohighlight">\(2 \times 2 \times 2\)</span> 倍しました。</p>
<table class="docutils align-default" id="newxps-table10">
<caption><span class="caption-number">表 8.25 </span><span class="caption-text">fcc-Pt結晶 (Pt 4f) XPS計算に用いた条件</span><a class="headerlink" href="#newxps-table10" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>Monkhorst-Pack 2×2×2</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
<tr class="row-even"><td><p>内殻電子のスピン</p></td>
<td><p>sw_xc_opencore_ae_only = on</p></td>
</tr>
<tr class="row-odd"><td><p>CIAOの入力</p></td>
<td><p>sw_write_core_full 1</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="newxps-table11">
<caption><span class="caption-number">表 8.26 </span><span class="caption-text">fcc Pt (Pt 4f 7/2) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> により評価。</span><a class="headerlink" href="#newxps-table11" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p></td>
<td><p>70.673</p></td>
<td><p>70.380</p></td>
</tr>
<tr class="row-odd"><td><p>実験値</p></td>
<td colspan="2"><p>71 <sup>a)</sup></p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference external" href="http://techdb.podzone.net/xps/index.cgi?element=Pt">http://techdb.podzone.net/xps/index.cgi?element=Pt</a></p>
<table class="docutils align-default" id="newxps-table12">
<caption><span class="caption-number">表 8.27 </span><span class="caption-text">fcc Pt (Pt 4f 5/2) のXPS 計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps14">(8.30)</a> により評価。</span><a class="headerlink" href="#newxps-table12" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>内殻電子のスピン考慮なし</p></td>
<td><p>内殻電子のスピン考慮あり</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p></td>
<td><p>74.333</p></td>
<td><p>74.040</p></td>
</tr>
<tr class="row-odd"><td><p>実験値</p></td>
<td colspan="2"><p>71 <sup>a)</sup></p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference external" href="http://techdb.podzone.net/xps/index.cgi?element=Pt">http://techdb.podzone.net/xps/index.cgi?element=Pt</a></p>
<p>なお、CIAOにおいて内殻電子の運動エネルギーを非相対論で評価した擬ポテンシャルを用いた場合、4f 軌道の結合エネルギー ( 4f7/2 と 4f5/2 の重みつき平均 ) は 83.052 eV となり、実験値と離れてしまいます。</p>
</section>
<section id="o-2-o-1s">
<h4><span class="section-number">8.8.4.5. </span>O <sub>2</sub> 分子 (O 1s)<a class="headerlink" href="#o-2-o-1s" title="この見出しへのパーマリンク"></a></h4>
<table class="docutils align-default" id="newxps-dirlist-table5">
<caption><span class="caption-number">表 8.28 </span><span class="caption-text">O <sub>2</sub> 分子 (O 1s XPS計算のディレクトリー構造</span><a class="headerlink" href="#newxps-dirlist-table5" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>第一階層</p></td>
<td><p>説明</p></td>
</tr>
<tr class="row-even"><td><p>final_spin_antiparallel</p></td>
<td><p>終状態・スピン反平行</p></td>
</tr>
<tr class="row-odd"><td><p>final_spin_parallel</p></td>
<td><p>終状態・スピン平行</p></td>
</tr>
<tr class="row-even"><td><p>initial</p></td>
<td><p>始状態</p></td>
</tr>
</tbody>
</table>
<p>計算条件は以下のとおりです。</p>
<table class="docutils align-default" id="newxps-table13">
<caption><span class="caption-number">表 8.29 </span><span class="caption-text">O <sub>2</sub> 分子 (O 1s) XPS計算に用いた条件</span><a class="headerlink" href="#newxps-table13" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30.0</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>270.0</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><blockquote>
<div><p><span class="math notranslate nohighlight">\(\Gamma\)</span> 点のみ</p>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE, PAW</p></td>
</tr>
<tr class="row-odd"><td><p>単位胞の1辺 [Å]</p></td>
<td><p>14.0</p></td>
</tr>
<tr class="row-even"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
<tr class="row-odd"><td><p>内殻電子のスピン</p></td>
<td><p>sw_xc_opencore_ae_only = on</p></td>
</tr>
<tr class="row-even"><td><p>CIAOの入力</p></td>
<td><p>sw_write_core_full 1</p></td>
</tr>
<tr class="row-odd"><td><p>（補正後計算で使用する）誘電率</p></td>
<td><p>※1.00</p></td>
</tr>
</tbody>
</table>
<p>※真空中</p>
<table class="docutils align-default" id="newxps-table14">
<caption><span class="caption-number">表 8.30 </span><span class="caption-text">O <sub>2</sub> 分子 (O 1s) XPS計算結果 ( 単位：eV )。式 <a class="reference internal" href="#equation-eq-newxps15">(8.31)</a> により評価。</span><a class="headerlink" href="#newxps-table14" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>S=1/2</p></td>
<td><p>S=3/2</p></td>
</tr>
<tr class="row-even"><td><p>spin orientationの指定</p></td>
<td><p>anti parallel</p></td>
<td><p>parallel</p></td>
</tr>
<tr class="row-odd"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm final} \left( N-1 \right)- E_{\rm initial} \left( N \right)\)</span></p>
</div></blockquote>
</td>
<td><p>542.000</p></td>
<td><p>541.297</p></td>
</tr>
<tr class="row-even"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm corr}^1\)</span></p>
</div></blockquote>
</td>
<td><p>1.436</p></td>
<td><p>1.439</p></td>
</tr>
<tr class="row-odd"><td><blockquote>
<div><p><span class="math notranslate nohighlight">\(E_{\rm B}\)</span></p>
</div></blockquote>
</td>
<td><p>543.436</p></td>
<td><p>542.736</p></td>
</tr>
<tr class="row-even"><td><p>実験値 <sup>a)</sup></p></td>
<td><p>544.2</p></td>
<td><p>543.1</p></td>
</tr>
</tbody>
</table>
<p>a) <a class="reference external" href="https://t-ozaki.issp.u-tokyo.ac.jp/vps_pao_core2019/O/index.html">https://t-ozaki.issp.u-tokyo.ac.jp/vps_pao_core2019/O/index.html</a> and references therein.</p>
<p>2つのスピン状態とも、実験値に近い値が得られました。</p>
<div role="list" class="citation-list">
<div class="citation" id="lenthe96" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id59">Lenthe96</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.scm.com/wp-content/uploads/vlenthe.pdf">https://www.scm.com/wp-content/uploads/vlenthe.pdf</a></p>
</div>
<div class="citation" id="ozaki17" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id62">Ozaki17</a><span class="fn-bracket">]</span></span>
<p>T. Ozaki and C. Lee,  Phys. Rev. B 118 (2017) 026401.</p>
</div>
<div class="citation" id="mahmood03" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Mahmood03<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id67">1</a>,<a role="doc-backlink" href="#id68">2</a>)</span>
<p>A. Mahmood, R. Machorro, S. Muhl, J. Heiras, F. F. Castillon, M. H. Farıas, and E. Andrade, DIAM RELAT MATER 12 (2003) 1315.</p>
</div>
</div>
</section>
</section>
<section id="core-level-shift-cls">
<h3><span class="section-number">8.8.5. </span>Core Level Shift (CLS)の解析<a class="headerlink" href="#core-level-shift-cls" title="この見出しへのパーマリンク"></a></h3>
<p>内殻準位シフト(Core Level Shift, CLS) の計算はエネルギーの相対値が分かればよく、上で説明したような手続きは不要です。
ここではCLSを計算する方法について解説します。</p>
<section id="id69">
<h4><span class="section-number">8.8.5.1. </span>内殻準位シフト<a class="headerlink" href="#id69" title="この見出しへのパーマリンク"></a></h4>
<p>内殻準位とは原子の深い電子準位のことであり、化学結合には寄与しないくらい原子に
強く局在したものです。
例えばシリコン原子の場合、14個の電子は<span class="math notranslate nohighlight">\((1s)^{2}(2s)^{2}(2p)^{6}(3s)^{2}(3p)^{2}\)</span>
のように5個の準位を占有しますが、この中で<span class="math notranslate nohighlight">\(1s\)</span>、<span class="math notranslate nohighlight">\(2s\)</span>、<span class="math notranslate nohighlight">\(2p\)</span>が内殻準位です。相対論的なシリコン原子の電子準位をCIAOでGGA計算すると</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>  Energy levels [All-electron]
  Element ---&gt; Si
-----------------------------------------------------------------------
   symm    j          Energy (Ha)         Energy (eV)  nocc      focc
-----------------------------------------------------------------------
    1s    1/2      -65.6258330748    -1785.7697073691     2   2.00000
    2s    1/2       -5.1250077353     -139.4585506190     2   2.00000
    2p    1/2       -3.5260321902      -95.9482139488     2   2.00000
    2p    3/2       -3.5022484901      -95.3010265676     4   4.00000
    3s    1/2       -0.3967820153      -10.7969875601     2   2.00000
    3p    1/2       -0.1503011244       -4.0899015276     2   2.00000
    3p    3/2       -0.1491437813       -4.0584086215     4   0.00000
-----------------------------------------------------------------------
  Total number of electrons                                  14.00000
-----------------------------------------------------------------------
</pre></div>
</div>
<p>となり、内殻準位は化学結合の目安である数eVより圧倒的に深いことがわかります。
そのため内殻準位の波動関数は隣接した原子と重なりを持たず、エネルギー分散
の無い離散準位を生じます。</p>
<p>シリコン原子の内殻準位を観測する手段として 100～130 eVの軟X線領域の単色光を照射し、放出される光電子の運動エネルギーを測定する実験方法があります <a class="reference internal" href="#landemark92" id="id70"><span>[Landemark92]</span></a> 。
ちなみに、エネルギー可変の単色光は加速器のアンジュレータから放射されたシンクロトロン放射光を用います。
上記のSi原子の電子準位を参考にすれば、この方法では<span class="math notranslate nohighlight">\(2p\)</span>準位から放出される光電子に着目していることがわかります。
<span class="math notranslate nohighlight">\(2p\)</span>準位はスピン軌道相互作用のために<span class="math notranslate nohighlight">\(2p_{3/2}\)</span>と<span class="math notranslate nohighlight">\(2p_{1/2}\)</span>に<span class="math notranslate nohighlight">\(0.64\)</span>
eV程度分裂します。</p>
<p>光電子放出の理論からよく知られているように、照射光のエネルギーを<span class="math notranslate nohighlight">\(\text{hν}\)</span>とすれば放出される光電子の運動エネルギー<span class="math notranslate nohighlight">\(E_{\text{kin}}\)</span>は</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-xps1">
<span class="eqno">(8.32)<a class="headerlink" href="#equation-eq-xps1" title="この数式へのパーマリンク"></a></span>\[E_{\text{kin}} = h\nu - W - (E_{F} - E_{c})\]</div>
</div></blockquote>
<p>となります。
ここで、<span class="math notranslate nohighlight">\(W\)</span>は仕事関数、<span class="math notranslate nohighlight">\(E_{F}\)</span>はFermi準位、<span class="math notranslate nohighlight">\(E_{c}\)</span>は内殻準位です。
一般に結晶表面では電子のしみ出しによる電気二重層が形成されるため、
内殻電子の感じるポテンシャルは表面から外側になればなるほど浅くなります。そのため、内殻準位も表面では浅くなります。この関係を模式的に示したのが <a class="reference internal" href="#advanced-xps-image1"><span class="std std-numref">図 8.13</span></a> です。
その他、化学結合にともない原子のポテンシャルが上下するので、
内殻準位はこれに連動した効果も受ける。
この2つの効果のため内殻エネルギー準位<span class="math notranslate nohighlight">\(E_{c}\)</span>は原子により異なる値をとります。
内殻準位シフトの実験では、表面から十分内部に入ったバルク位置
の原子による内殻準位を基準にして表面付近の化学結合が異なる原子の内殻準位の
エネルギーの差を測定することにより、表面付近の原子の化学結合状態や構造を推定します。</p>
<figure class="align-default" id="advanced-xps-image1">
<a class="reference internal image-reference" href="../_images/image26.svg"><img alt="../_images/image26.svg" src="../_images/image26.svg" width="480px" /></a>
<figcaption>
<p><span class="caption-number">図 8.13 </span><span class="caption-text">光電子放出過程のエネルギープロファイル：図の右側が結晶表面、左側がバルクである。Fermi準位<span class="math notranslate nohighlight">\(\mathbf{E}_{\mathbf{F}}\)</span>は一定であるのに対して、内殻準位<span class="math notranslate nohighlight">\(\mathbf{E}_{\mathbf{c}}\)</span>は原子により異なり、表面付近ではバルクにくらべて内殻準位が浅くなる。</span><a class="headerlink" href="#advanced-xps-image1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>さて、内殻準位シフトを第一原理計算するためには、<a class="reference internal" href="#equation-eq-xps1">(8.32)</a> によれば
個々の原子の内殻準位<span class="math notranslate nohighlight">\(E_{c}\)</span>を計算します。
このエネルギー値<span class="math notranslate nohighlight">\(E_{c}\)</span>は内殻電子も扱う全電子計算を行えば直ちに得られますが、
価電子のみを扱う擬ポテンシャル法からは得られません。
この理由から、擬ポテンシャル法では計算できないと思われますが、この問題を見事に解決したのがSchefflerのグループ <a class="reference internal" href="#pehlke93" id="id71"><span>[Pehlke93]</span></a> です。
Schefflerらは <a class="reference internal" href="#advanced-xps-image2"><span class="std std-numref">図 8.14</span></a> に示したように、 始状態(initial state)と終状態(final
state)の違いに着目しています。</p>
<figure class="align-default" id="advanced-xps-image2">
<a class="reference internal image-reference" href="../_images/image27.svg"><img alt="../_images/image27.svg" src="../_images/image27.svg" width="480px" /></a>
<figcaption>
<p><span class="caption-number">図 8.14 </span><span class="caption-text">光電子放出過程の始状態と終状態：(I)はバルク位置の原子による光電子放出、(II)は表面付近の原子による光電子放出を表している。始状態(initial state)では、入射光(<span class="math notranslate nohighlight">\(\mathbf{\text{hν}}\)</span>)と結晶が存在するのみなので(I)と(II)は同じ状態である。終状態(final state)では、放出された光電子の運動エネルギー<span class="math notranslate nohighlight">\(\mathbf{E}_{\mathbf{\text{kin}}}\)</span>と内殻正孔(赤丸)1個をもった結晶の全エネルギー<span class="math notranslate nohighlight">\(\mathbf{E}_{\mathbf{\text{tot}}}\)</span>は(I)と(II)で異なるが、和<span class="math notranslate nohighlight">\(\mathbf{E}_{\mathbf{\text{kin}}} + \mathbf{E}_{\mathbf{\text{tot}}}\)</span>は等しい。</span><a class="headerlink" href="#advanced-xps-image2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#advanced-xps-image2"><span class="std std-numref">図 8.14</span></a> では、光電子が放出される原子の位置が異なる2つの場合
を示しています。(I)は原子がバルク位置にある場合、(II)は原子が表面付近にある場合です。
始状態では、考えている系には入射光(<span class="math notranslate nohighlight">\(\text{hν}\)</span>)と結晶が存在するのみなので(I)と(II)は同じ状態です。
一方、終状態では、系には放出された光電子(運動エネルギー<span class="math notranslate nohighlight">\(E_{\text{kin}}\)</span>)と
内殻正孔(赤丸)が残された結晶(全エネルギー<span class="math notranslate nohighlight">\(E_{\text{tot}}\)</span>)が存在します。
内殻正孔とは、光電子が放出される前に占有していた内殻準位に残された電子のぬけがらです。
(I)と(II)では<span class="math notranslate nohighlight">\(E_{\text{kin}}\)</span>と<span class="math notranslate nohighlight">\(E_{\text{tot}}\)</span>はそれぞれ異なるが、
始状態が同一ということから、終状態の系の全エネルギーも同じ値にならなければ
ならないという次の重要な関係式が導かれます。</p>
<div class="math notranslate nohighlight" id="equation-eq-xps2">
<span class="eqno">(8.33)<a class="headerlink" href="#equation-eq-xps2" title="この数式へのパーマリンク"></a></span>\[E_{\rm{kin}}\left(\rm{I}\right)+E_{\rm{tot}}\left(\rm{I}\right) = E_{\rm{kin}}\left(\rm{II}\right) + E_{\rm{tot}}\left(\rm{II}\right)\]</div>
<p>内殻準位シフト<span class="math notranslate nohighlight">\(\Delta E_{\text{kin}}\)</span>を次式で定義します。</p>
<div class="math notranslate nohighlight" id="equation-eq-xps3">
<span class="eqno">(8.34)<a class="headerlink" href="#equation-eq-xps3" title="この数式へのパーマリンク"></a></span>\[\Delta E_{\text{kin}} \equiv E_{\text{kin}}(\rm{II}) - E_{\text{kin}}(\rm{I})\]</div>
<p>ゆえに、<a class="reference internal" href="#equation-eq-xps2">(8.33)</a> を用いれば</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-xps4">
<span class="eqno">(8.35)<a class="headerlink" href="#equation-eq-xps4" title="この数式へのパーマリンク"></a></span>\[\Delta E_{\text{kin}} \equiv E_{\text{tot}}(\rm{I}) - E_{\text{tot}}(\rm{II}) = - \Delta E_{\text{tot}}\]</div>
</div></blockquote>
<p>が得られます。 <a class="reference internal" href="#equation-eq-xps2">(8.33)</a> の右辺は擬ポテンシャル法でも計算することができます。
Schefflerら <a class="reference internal" href="#pehlke93" id="id72"><span>[Pehlke93]</span></a> はこの考えに基づきSi(100)表面の表面内殻準位シフトを
擬ポテンシャル法で計算し、Landemarkらの実験結果 <a class="reference internal" href="#landemark92" id="id73"><span>[Landemark92]</span></a> を理論的に説明しています。
内殻準位<span class="math notranslate nohighlight">\(E_{c}\)</span>と結晶の全エネルギー<span class="math notranslate nohighlight">\(E_{\text{tot}}\)</span>との関係は、<a class="reference internal" href="#equation-eq-xps1">(8.32)</a> により</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-xps5">
<span class="eqno">(8.36)<a class="headerlink" href="#equation-eq-xps5" title="この数式へのパーマリンク"></a></span>\[\Delta E_{\text{kin}} = \Delta E_{c}\]</div>
</div></blockquote>
<p>が成り立つので、<a class="reference internal" href="#equation-eq-xps4">(8.35)</a> と比較して</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-xps6">
<span class="eqno">(8.37)<a class="headerlink" href="#equation-eq-xps6" title="この数式へのパーマリンク"></a></span>\[\Delta E_{c} = - \Delta E_{\text{tot}} (6)\]</div>
</div></blockquote>
<p>が導かれます。</p>
<figure class="align-default" id="advanced-xps-image3">
<a class="reference internal image-reference" href="../_images/image28.svg"><img alt="../_images/image28.svg" src="../_images/image28.svg" width="480px" /></a>
<figcaption>
<p><span class="caption-number">図 8.15 </span><span class="caption-text">実験的に得られる情報を模式的に表した図。</span><a class="headerlink" href="#advanced-xps-image3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id74">
<h4><span class="section-number">8.8.5.2. </span>内殻光電子放出のスペクトル<a class="headerlink" href="#id74" title="この見出しへのパーマリンク"></a></h4>
<p>実験的に得られる情報を模式的に表すと <a class="reference internal" href="#advanced-xps-image3"><span class="std std-numref">図 8.15</span></a> に示したようなスペクトルです。
ここでは、電子間クーロン相互作用によるオージェ過程は考えません。
横軸は光電子の運動エネルギー<span class="math notranslate nohighlight">\(E_{\text{kin}}\)</span>、縦軸は光電子数(強度)です。
また、横軸は内殻準位の結合エネルギー<span class="math notranslate nohighlight">\(E_{\text{bind}}\)</span>とみることもできて、この場合は左側ほど結合が強くなっています。
結晶バルクからの光電子スペクトルは赤色で示したように<span class="math notranslate nohighlight">\(E_{\text{kin}}(I)\)</span>に唯一のピークをもちます。
これに対して、結晶表面付近からの光電子スペクトルは青色で示したようにいくつかの
ピーク<span class="math notranslate nohighlight">\(E_{\text{kin}}(II)\)</span>に分かれます。
各ピークの強度はそのピークに関係した原子数の比から定まります。
電気二重層の効果のためピーク位置は通常右側にずれます。
光電子は結晶内部の非弾性散乱でエネルギーを失うので、バルクのピークは結晶表面から
せいぜい数nm程度の深さの原子によるものであることを注意してください。
計算できるものは、バルク位置からピーク位置のずれと
各ピークの相対的な強度です。</p>
</section>
<section id="id75">
<h4><span class="section-number">8.8.5.3. </span>内殻正孔を含む原子の擬ポテンシャル<a class="headerlink" href="#id75" title="この見出しへのパーマリンク"></a></h4>
<p>第一原理擬ポテンシャルバンド計算法では、内殻電子状態を凍結させ、価電子状態を
自己無撞着に計算します。そのためバンド計算の段階では内殻に正孔を生じさせることができません。そのかわり内殻正孔を含む擬ポテンシャルを作成することは可能です。
Schefflerら <a class="reference internal" href="#pehlke93" id="id76"><span>[Pehlke93]</span></a> は、光電子放出時に生成された内殻正孔はまわりの電子によりすみやかに遮蔽(screening)されるものと仮定しました。しかし、格子を変形させるだけの
時間はないとしています。また、電子はドープされた不純物から無尽蔵に補給される、すなわちFermi面は不純物準位にピンニングされる、と考えて電気的に中性が保たれているものとしています。これらの仮定により計算されたスペクトルは実験結果とよく一致しています。</p>
<p>以上の考え方に従えば、内殻正孔を含む原子の擬ポテンシャルを次のように作成します。
例えば<span class="math notranslate nohighlight">\(2p\)</span>準位に内殻正孔を含むシリコン原子の場合、</p>
<ol class="arabic simple">
<li><p>14個の電子からなる<span class="math notranslate nohighlight">\((1s)^{2}(2s)^{2}(2p)^{6}(3s)^{2}(3p)^{2}\)</span>の電子配置の
中性シリコン原子において、<span class="math notranslate nohighlight">\(2p\)</span>準位の電子1個を<span class="math notranslate nohighlight">\(3p\)</span>準位に移動して
<span class="math notranslate nohighlight">\((1s)^{2}(2s)^{2}(2p)^{5}(3s)^{2}(3p)^{3}\)</span>とした励起状態の中性シリコン原子を考える</p></li>
<li><p>その原子の全電子計算を自己無撞着におこなう</p></li>
<li><p>価電子として<span class="math notranslate nohighlight">\((3s)^{2}(3p)^{3}\)</span>の5個の電子をはがしてイオン化する</p></li>
<li><p>このようにして、内殻正孔を有し5価にイオン化したシリコン原子の擬ポテンシャルができる</p></li>
</ol>
<p>とします。 これは <a class="reference internal" href="#advanced-xps-image4"><span class="std std-numref">図 8.16</span></a> の2つの終状態(final state)のうち 右側のscreened
hole(遮蔽正孔)に対応します。</p>
<p>スカラー相対論での擬ポテンシャル計算では、内殻準位のスピン軌道分裂は考慮せず
縮重度に対して重み平均をとったものを内殻準位とします。
内殻準位のシフト量の計算では、この仮定により結果は変わりません。</p>
<figure class="align-default" id="advanced-xps-image4">
<img alt="../_images/image29.svg" src="../_images/image29.svg" /><figcaption>
<p><span class="caption-number">図 8.16 </span><span class="caption-text">Si原子の電子配置：左図は基底状態の電子配置、右図は内殻正孔が生じた場合の終状態の電子配置である。</span><a class="headerlink" href="#advanced-xps-image4" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id77">
<h4><span class="section-number">8.8.5.4. </span>計算の実行方法<a class="headerlink" href="#id77" title="この見出しへのパーマリンク"></a></h4>
<p>内殻正孔を含む原子の擬ポテンシャルを用いて内殻準位シフトを
バンド計算します。</p>
<p>バンド計算は次のように行います。</p>
<ol class="arabic simple">
<li><p>シリコン表面の座標を作成し、通常のシリコン擬ポテンシャルを用いて
各原子に力が働かなくなるまで十分に格子緩和させる</p></li>
<li><p>その座標を用いて、原子1個を内殻正孔を含む擬ポテンシャルに置き換えて
全エネルギーを計算する</p></li>
<li><p>すべての原子に対して順番に置き換えて全エネルギーを計算する</p></li>
<li><p>バルク位置の原子を決めて、これを基準にして他の配置の全エネルギーの差をとり、運動エネルギーのシフト量を計算する</p></li>
<li><p>強度を含めたスペクトルとして表示する</p></li>
</ol>
</section>
<section id="si-100">
<h4><span class="section-number">8.8.5.5. </span>計算例：Si(100)表面<a class="headerlink" href="#si-100" title="この見出しへのパーマリンク"></a></h4>
<p>Si(100)表面のモデル</p>
<p>まずはじめに、Si(100)
<span class="math notranslate nohighlight">\(p(2 \times 2)\)</span>再構成表面のモデルを作成します。
Si(100)表面はダングリングボンド数を減らすためダイマー構造をとり、
それらのダイマーは列方向に交互に傾くこと(バックリング)で安定化することが知られています。
この時、バックリングに連動してダイマーの低い方から高い方に電子が移動します。
実験的にはSi(100)
<span class="math notranslate nohighlight">\(c(4 \times 2)\)</span>構造が安定となるが、計算ではバックリングの性質が
似通った<span class="math notranslate nohighlight">\(p(2 \times 2)\)</span>構造を扱います。この方が計算量を減らせるからです。
この仮定はSchefflerら <a class="reference internal" href="#pehlke93" id="id78"><span>[Pehlke93]</span></a> と同様です。</p>
<figure class="align-default" id="advanced-xps-image5">
<img alt="../_images/image30.svg" src="../_images/image30.svg" /><figcaption>
<p><span class="caption-number">図 8.17 </span><span class="caption-text">Si(100)表面のモデル：表面平行方向の周期は<span class="math notranslate nohighlight">\(\mathbf{2} \times \mathbf{2}\)</span>(左図)、深さ方向は8層(右図)のモデルを採用する。8層めと9層目の中間に反転中心を考えているので、実際の計算では全部で16層64原子のスラブモデルとして扱う。単位胞の等価でない各原子に<span class="math notranslate nohighlight">\(\mathbf{1}\mathbf{u}\)</span>、<span class="math notranslate nohighlight">\(\mathbf{1}\mathbf{d}\)</span>、<span class="math notranslate nohighlight">\(\mathbf{2}\)</span>、<span class="math notranslate nohighlight">\(\mathbf{3}\mathbf{u}\)</span>、<span class="math notranslate nohighlight">\(\mathbf{3}\mathbf{d}\)</span>、などのラベルをつける。</span><a class="headerlink" href="#advanced-xps-image5" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>出発点の表面モデルは安定構造となってなければならず、十分に格子緩和します。原子に働く力の最大値を<span class="math notranslate nohighlight">\(5 \times 10^{- 4}\)</span>程度以下に抑えるのに長時間を要しました。
<a class="reference internal" href="#advanced-xps-image5"><span class="std std-numref">図 8.17</span></a> は格子緩和されたされた後の安定構造を表示しています。
計算条件は(原子単位)、 擬ポテンシャル：Si_ggapbe_nc_01.pp、
交換相関ポテンシャル：GGA-PBE、
カットオフエネルギー：<span class="math notranslate nohighlight">\(k_{c}(wf) = 3.5\)</span>、
<span class="math notranslate nohighlight">\(k_{c}(chg) = 7.0\)</span>、
ユニットセル：<span class="math notranslate nohighlight">\(a_{1} = 14.6816015290\)</span>、<span class="math notranslate nohighlight">\(a_{2} = 14.6816015290\)</span>、<span class="math notranslate nohighlight">\(a_{3} = 60.0000000000\)</span>、
<span class="math notranslate nohighlight">\(k\)</span>点：<span class="math notranslate nohighlight">\(4 \times 4 \times 1\)</span>、です。
その結果、緩和された座標と力は以下のようになります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>          x             y              z             fx          fy          fz
 1   11.654665468    7.340800747   19.731672033   -0.000108    0.000000    0.000136
 2   10.943522273    0.000000002   18.308554343   -0.000156    0.000000   -0.000260
 3    7.408260709    7.340800738   18.308043049    0.000156    0.000000   -0.000288
 4    6.696493833   -0.000000008   19.730653256    0.000095    0.000000    0.000136
 5   12.644826676   10.798805752   16.929970763   -0.000186   -0.000125   -0.000051
 6   12.644826664    3.882795799   16.929970692   -0.000187    0.000125   -0.000052
 7    5.707073513   11.223532172   16.928492210    0.000184    0.000135   -0.000066
 8    5.707073576    3.458069376   16.928492250    0.000184   -0.000135   -0.000066
 9    9.176755229   11.011875138   14.003484695    0.000002   -0.000042   -0.000291
10    9.176755074    3.669726457   14.003484706    0.000002    0.000042   -0.000291
11    1.834472402   11.011012299   14.542706201   -0.000005   -0.000002    0.000195
12    1.834472400    3.670589245   14.542706195   -0.000005    0.000002    0.000196
13    9.235196168    7.340800802   11.460786586    0.000018    0.000000   -0.000178
14    9.118076207    0.000000001   11.459447663   -0.000002    0.000000   -0.000198
15    1.882358440    7.340800774   11.863174990    0.000085    0.000000    0.000607
16    1.785205792   -0.000000009   11.863763387   -0.000075    0.000000    0.000566
17   12.980433730    7.340800764    9.066215802    0.000364    0.000000   -0.000060
18   12.895937822    0.000000005    9.076888750    0.000103    0.000000   -0.000067
19    5.455961640    7.340800779    9.081857152   -0.000145    0.000000   -0.000096
20    5.370066620   -0.000000012    9.069872950   -0.000307    0.000000    0.000025
21   12.895952884   11.013570694    6.478028955    0.000077   -0.000071    0.000099
22   12.895952919    3.668030852    6.478029019    0.000078    0.000071    0.000099
23    5.455699091   11.008682705    6.484530647   -0.000072    0.000047    0.000112
24    5.455699061    3.672918843    6.484530696   -0.000072   -0.000047    0.000112
25    9.172291984   11.011379982    3.920759253   -0.000013   -0.000002    0.000122
26    9.172291976    3.670221565    3.920759374   -0.000013    0.000002    0.000122
27    1.838705787   11.010982242    3.857185244    0.000014    0.000000   -0.000054
28    1.838705789    3.670619311    3.857185195    0.000014    0.000000   -0.000053
29    9.176000956    7.340800765    1.297682500   -0.000017    0.000000    0.002104
30    9.176000956    0.0            1.297682500    0.000472    0.000000    0.002118
31    1.835200191    7.340800765    1.297682500   -0.000774    0.000000   -0.002772
32    1.835200191    0.0            1.297682500    0.000325    0.000000   -0.002761
</pre></div>
</div>
<p>ここでは、反転対称を考えて半分の32原子の結果を示しています。
第8層の4個の原子(29番～32番)は結晶がつぶれないように固定したので力が発生しています。</p>
<p>表面内殻準位シフトの計算</p>
<p>次に、表面内殻準位シフト(Surface Core Level Shift,
SCLS)の計算を行います。
格子緩和された表面モデルの原子位置を固定したまま、シリコン原子を順に
内殻正孔を含む擬ポテンシャルに置き換えて全エネルギーを計算します。</p>
<p>この結果を <a class="reference internal" href="#advanced-xps-image6"><span class="std std-numref">図 8.18</span></a> に示します。
縦軸は光電子の運動エネルギー(単位はeV)のバルクからのずれです。
この場合、バルクを<span class="math notranslate nohighlight">\(3_{u}\)</span>位置の原子にとっています。
光電子は結晶内部で非弾性散乱されるので、あまり深い位置の原子からの
光電子は実験的に観測されません。観測されるのは表面から数nmといわれています。
このため、バルクを<span class="math notranslate nohighlight">\(3_{u}\)</span>位置としたことは正当であると考えられます。
その他、<span class="math notranslate nohighlight">\(3_{u}\)</span>と<span class="math notranslate nohighlight">\(3_{d}\)</span>の中間にとる方法も考えられるが、<a class="reference internal" href="#advanced-xps-image5"><span class="std std-numref">図 8.17</span></a>
を参考にすれば<span class="math notranslate nohighlight">\(3_{u}\)</span>はダイマー列の外側、<span class="math notranslate nohighlight">\(3_{d}\)</span>はダイマー列の内側にあるので
<span class="math notranslate nohighlight">\(3_{d}\)</span>からの放出強度は実験的には抑えられることが考えられるので、ここでは<span class="math notranslate nohighlight">\(3_{u}\)</span>を
バルクとしました。</p>
<p><a class="reference internal" href="#advanced-xps-image6"><span class="std std-numref">図 8.18</span></a> によればscreenedとunscreenedの決定的な違いは
第1層めのdownのピーク位置です。
両者のちがいは電子数がunscreenedの方がscreenedより少ないことです。
そのためunscreenedではdown位置のシリコン原子が電子により遮蔽されません。
screenedでは遮蔽されるので、このちがいのためにdownのピーク位置が異なったと考えられます。</p>
<figure class="align-default" id="advanced-xps-image6">
<img alt="../_images/image32.svg" src="../_images/image32.svg" /><figcaption>
<p><span class="caption-number">図 8.18 </span><span class="caption-text">SCLSの運動エネルギー：それぞれ青丸はunscreened、赤丸はscreenedの内殻正孔擬ポテンシャルを用いた結果である。赤丸はSchefflerと同じ方法である。縦軸は光電子の運動エネルギー(単位はeV)のバルクからのずれである。この場合、バルクを<span class="math notranslate nohighlight">\(\mathbf{3}_{\mathbf{u}}\)</span>位置の原子にとっている。</span><a class="headerlink" href="#advanced-xps-image6" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>Schefflerらの論文 <a class="reference internal" href="#pehlke93" id="id79"><span>[Pehlke93]</span></a> にある結果と比較するために、<a class="reference internal" href="#advanced-xps-image7"><span class="std std-numref">図 8.19</span></a> に表面から3層までの原子によるSCLSを表示します。
縦軸は強度であり、各強度は原子数の比をとっています。
上から順に、unscreened、screenedの各計算値、実験値を示しています。
実験値はLandemarkら <a class="reference internal" href="#landemark92" id="id80"><span>[Landemark92]</span></a> によるものです。</p>
<figure class="align-default" id="advanced-xps-image7">
<img alt="../_images/image33.svg" src="../_images/image33.svg" /><figcaption>
<p><span class="caption-number">図 8.19 </span><span class="caption-text">SCLSの強度：縦軸はSCLSの強度であり、各強度は原子数の比をとっている。上から順に、unscreened、screenedの各計算値、実験値を表示した。実験値はLandemarkら <a class="reference internal" href="#landemark92" id="id81"><span>[Landemark92]</span></a> によるものである。実験に合うのはscreenedである。XPS用の内殻正孔擬ポテンシャルはscreenedで作成しなければならない。</span><a class="headerlink" href="#advanced-xps-image7" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#advanced-xps-image7"><span class="std std-numref">図 8.19</span></a> の計算結果は実験結果 <a class="reference internal" href="#landemark92" id="id82"><span>[Landemark92]</span></a> をよく再現し、
また、Schefflerらの論文の結果 <a class="reference internal" href="#pehlke93" id="id83"><span>[Pehlke93]</span></a> に一致しています。
実験に合うのはscreenedであることがわかります。
このため、XPS用の内殻正孔擬ポテンシャルはscreenedで作成しなければなりません。</p>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="landemark92" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Landemark92<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id70">1</a>,<a role="doc-backlink" href="#id73">2</a>,<a role="doc-backlink" href="#id80">3</a>,<a role="doc-backlink" href="#id81">4</a>,<a role="doc-backlink" href="#id82">5</a>)</span>
<p>“Core-level spectroscopy of the clean Si(001) surface: Charge transfer within asymmetric dimers of the <span class="math notranslate nohighlight">\(2 \times 1\)</span> and <span class="math notranslate nohighlight">\(c(4 \times 2)\)</span> reconstructions”, E. Landemark, C.J. Karlsson, Y.-C. Chao, and R.I.G. Uhrberg, Phys. Rev. Lett. <strong>69</strong>, 1588 (1992).</p>
</div>
<div class="citation" id="pehlke93" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Pehlke93<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id71">1</a>,<a role="doc-backlink" href="#id72">2</a>,<a role="doc-backlink" href="#id76">3</a>,<a role="doc-backlink" href="#id78">4</a>,<a role="doc-backlink" href="#id79">5</a>,<a role="doc-backlink" href="#id83">6</a>)</span>
<p>“Evidence for site-sensitive screening of core holes at the Si and Ge (001) surface”, E. Pehlke and M. Scheffler, Phys. Rev. Lett. <strong>71</strong>, 2338 (1993).</p>
</div>
</div>
</section>
</section>
</section>
<section id="elnes-xanes">
<span id="section-elnes-xanes"></span><h2><span class="section-number">8.9. </span>ELNES / XANES解析機能<a class="headerlink" href="#elnes-xanes" title="この見出しへのパーマリンク"></a></h2>
<section id="id84">
<h3><span class="section-number">8.9.1. </span>はじめに<a class="headerlink" href="#id84" title="この見出しへのパーマリンク"></a></h3>
<p>EELSは電子が試料を透過する際のエネルギー損失を測定し、XAFSは試料にX線を照射した際に現れるスペクトルを測定する実験手法です。ここでは、電子線あるいはX線により、内殻電子が非占有状態に遷移する現象を対象とします。また、広範なエネルギー領域の中で、特に、吸収端付近のスペクトル構造を計算するものとします。この狭いエネルギー領域では、EELS は ELNES、XAFS は XANES と呼ばれています。</p>
<p>ELNESとXANESの二重微分散乱断面積は、双極子近似のもとで、以下のように表されます。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial^2 \sigma}{\partial E \partial\Omega} &amp;\propto \sum_{i,f} \left| \left&lt; i \left| \mathbf{q} \cdot \mathbf{R} \right| f \right&gt; \right|^2 ({\rm ELNES}), \\
\frac{\partial^2 \sigma}{\partial E \partial \Omega} &amp;\propto \sum_{i,f} \left| \left&lt; i \left| \mathbf{e} \cdot \mathbf{R} \right| f \right&gt; \right|^2 ({\rm XANES})\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(|i&gt;\)</span> <span class="math notranslate nohighlight">\(|f&gt;\)</span> は始状態 (基底状態) と終状態（ある原子の内殻電子が飛び出し、非占有状態に遷移した状態）、<strong>q</strong>は非弾性散乱時における波数の変化、<strong>e</strong>は入射X線の偏光ベクトルである。したがって、XANESの計算は、ELNES計算にて<strong>q</strong>を <strong>e</strong>と読み替えます。内殻軌道から状態<em>n</em>, <em>k</em>で指定される伝導バンドへの遷移確率は、 <a class="reference internal" href="#gao08" id="id85"><span>[Gao08]</span></a> に従い、</p>
<div class="math notranslate nohighlight">
\[\left&lt; \phi_c \left|r_{\alpha}\right|\psi_{nk} \right&gt; = \left&lt;\phi_c\left|r_{\alpha} \right| \tilde{\psi}_{nk} \right&gt; + \sum_i \left( \left&lt;\phi_c \left| r_{\alpha} \right| \phi_i \right&gt; - \left&lt;\phi_c \left|r_{\alpha}\right|\tilde{\phi}_i\right&gt;\right) \left&lt;\tilde{p}_i | \tilde{\psi}_{nk}\right&gt;\]</div>
<p>で与えられるものとします。ここで 右辺第1項は、波動関数の soft
part　の寄与、第2項は擬ポテンシャルを用いたことによる補正項です。
<span class="math notranslate nohighlight">\(|\phi_i&gt;\)</span> は原子軌道<em>i</em>の全電子波動関数、<span class="math notranslate nohighlight">\(\tilde{\phi}_i\)</span> は原子軌道<em>i</em>の擬波動関数である。</p>
<p>また、吸収端のエネルギーは、基底状態と内殻電子励起状態の全エネルギー差で与えられるものとします。</p>
</section>
<section id="section-elnes-xanes-pp">
<span id="id86"></span><h3><span class="section-number">8.9.2. </span>準備：擬ポテンシャル<a class="headerlink" href="#section-elnes-xanes-pp" title="この見出しへのパーマリンク"></a></h3>
<p>公開されている擬ポテンシャルには、内殻軌道に関する情報が含まれていません。このため、ELNES・XANES
の計算を行うためには、擬ポテンシャルをあらためて作成する必要があります。作成すべき擬ポテンシャルは、</p>
<ul class="simple">
<li><p>基底状態の擬ポテンシャル</p></li>
<li><p>内殻に空孔を入れた状態の擬ポテンシャル</p></li>
</ul>
<p>です。例えば、LiF 結晶の Li　原子のK 端のスペクトルを計算する場合には、</p>
<ul class="simple">
<li><p>Li原子の基底状態の擬ポテンシャル</p></li>
<li><p>Li原子の1s軌道に空孔を入れた擬ポテンシャル</p></li>
<li><p>F原子の基底状態の擬ポテンシャル</p></li>
</ul>
<p>を作成します。なお、いずれの擬ポテンシャル作成においても、CIAOの入力ファイルに、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sw_write_core_to_valence 1
</pre></div>
</div>
<p>を記入する必要があります。なお、上記は”sw_with_dipole_cor2val
1”でも結構です。キーワードについてはCIAO
のマニュアルを参照してください。</p>
</section>
<section id="id87">
<h3><span class="section-number">8.9.3. </span>計算の流れ<a class="headerlink" href="#id87" title="この見出しへのパーマリンク"></a></h3>
<p>　計算は以下の順で行います。</p>
<ol class="arabic simple">
<li><p>基底状態 (A) のSCF計算</p></li>
<li><p>内殻電子励起状態 (B) のSCF計算</p></li>
<li><p>内殻電子励起状態 (B) のスペクトル計算</p></li>
</ol>
<p>①と②で得られた(A)と(B)の全エネルギー差をスペクトルの吸収端エネルギーとし、③の計算に反映します。</p>
<p>なお、実行コマンドは、①及び②のSCF計算は phase、③のスペクトル計算は epsmain を使用します。</p>
</section>
<section id="a-scf">
<h3><span class="section-number">8.9.4. </span>基底状態 (A) のSCF 計算<a class="headerlink" href="#a-scf" title="この見出しへのパーマリンク"></a></h3>
<section id="id88">
<h4><span class="section-number">8.9.4.1. </span>入力<a class="headerlink" href="#id88" title="この見出しへのパーマリンク"></a></h4>
<p>　吸収端のエネルギーを計算するために、入力パラメータに以下のキーワードを設定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
  paw = on
}
Postprocessing{
  CoreLevels{
    sw_calc_core_energy = on
  }
}
</pre></div>
</div>
<p>　なお、file_names.data の F_POT
に、5.8.2で作成した擬ポテンシャルファイル名を指定します。通常の、内殻軌道情報を含まない擬ポテンシャルを指定した場合には、該当原子の内殻電子の寄与を考慮せずにエネルギー計算が行われます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = &#39;./nfinp1.data&#39;
F_POT(1) = &#39;../pp/Li_ggapbe_paw_02_no_corehole.pp&#39;
F_POT(2) = &#39;../pp/F_ggapbe_paw_02_no_corehole.pp&#39;
/
</pre></div>
</div>
</section>
<section id="id89">
<h4><span class="section-number">8.9.4.2. </span>出力<a class="headerlink" href="#id89" title="この見出しへのパーマリンク"></a></h4>
<p>core_energy.data
の最終行に、内殻電子と価電子の寄与を合わせた全エネルギー値が出力されます。core_energy.data以外のファイルに出力したい場合には、file_names.data
でF_CORE_ENERGY_OUTにファイル名を指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Etotal (Core+Valence)
-3437.92292869603
</pre></div>
</div>
</section>
</section>
<section id="b-scf">
<h3><span class="section-number">8.9.5. </span>内殻電子励起状態 (B) のSCF 計算<a class="headerlink" href="#b-scf" title="この見出しへのパーマリンク"></a></h3>
<section id="id90">
<h4><span class="section-number">8.9.5.1. </span>入力<a class="headerlink" href="#id90" title="この見出しへのパーマリンク"></a></h4>
<p>　基底状態の計算と同じキーワードを用います。その他の注意事項として、内殻電子を励起する原子には、別の原子種を割り当てる必要があります。また、励起原子は単位胞に
1 原子のみとする。以下の例では、励起原子は Li2 です。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure{
  atom_list{
    atoms{
      #tag element rx ry rz mobile
            Li2 0.0000000000 0.0000000000 0.0000000000
            F1 0.2500000000 0.0000000000 0.0000000000
            …
            (中略)
            …
            Li1 0.7500000000 0.5000000000 0.7500000000
            F1 1.0000000000 0.5000000000 0.7500000000
    }
  }
  element_list{
    #units atomic_mass
    #tag element atomicnumber zeta deviation
          Li1 3 0.00 1.5
          Li2 3 0.00 1.5
          F1 9 0.00 1.5
  }
}
</pre></div>
</div>
<p>Li2
には、内殻電子を励起させて作成した擬ポテンシャルを割り当てる。内殻電子励起状態
(B) のSCF 計算の file_names.dataの記述例です。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = &#39;./nfinp1.data&#39;
F_POT(1) = &#39;../pp/Li_ggapbe_paw_02_no_corehole.pp&#39;
F_POT(2) = &#39;../pp/Li_ggapbe_paw_02_1s_corehole.pp&#39;
F_POT(3) = &#39;../pp/F_ggapbe_paw_02_no_corehole.pp&#39;
/
</pre></div>
</div>
</section>
<section id="id91">
<h4><span class="section-number">8.9.5.2. </span>出力<a class="headerlink" href="#id91" title="この見出しへのパーマリンク"></a></h4>
<p>基底状態の計算と同様に、core_energy.data
の最終行に、内殻電子と価電子の寄与を合わせた全エネルギー値が出力されます。</p>
</section>
</section>
<section id="b">
<h3><span class="section-number">8.9.6. </span>内殻電子励起状態 (B) のスペクトル計算<a class="headerlink" href="#b" title="この見出しへのパーマリンク"></a></h3>
<section id="id92">
<h4><span class="section-number">8.9.6.1. </span>入力<a class="headerlink" href="#id92" title="この見出しへのパーマリンク"></a></h4>
<p>スペクトル計算の入力では、control ブロックにてcondition = fixed_charge
を指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  condition = fixed_charge
  use_additional_projector=on
}
</pre></div>
</div>
<p>また、structure ブロックは、基底状態の計算と同様に記述します。</p>
<p>epsilon
ブロックでは、スペクトルに関するパラメータ指定を行う。sw_corelevel_spectrum
は、内殻軌道からの励起スペクトル計算を行うためのスイッチで、onと指定します。probe
ブロック内のatom_id には、励起させる原子の番号を指定します。上記のLi2
は1番目の原子であるため、atom_id = 1 としています。また、orbital
には、擬ポテンシャル作成時に空孔を入れた軌道を指定します。この例では
orbital に 1s を指定しており、Li K端におけるスペクトルが計算されます。</p>
<p>fermi_energy ブロックでread_efermi = on
とし、efermiには、内殻電子励起状態 (B)のSCF計算の nfefermi.data
記載の値を指定します。</p>
<p>　energy
ブロックには、吸収端を基準にして観察したいエネルギー領域を指定する。low,
high, step
は、それぞれ、エネルギー領域の下端、上端、及び間隔に対応する。単位は
hartree です。</p>
<p>　XANESの計算の入力パラメータは、EELS の際は photonを eels
と書き換えます。なお、内部の処理は共通であるため、どちらのキーワードを用いても結果は変わりません。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>epsilon {
  sw_epsilon = on
  sw_corelevel_spectrum = on
  probe{
    atom_id = 1
    orbital = 1s
  }
  fermi_energy{
    read_efermi = on
    efermi = 0.21930399
  }
  photon{
    energy{
      low = -0.10, high = 2.0, step = 0.002
    }
  }
  transition_moment{
    type = ks ! {l
    symmetry =on
  }
  BZ_integration {
    method = g !{parabolic(p)
    width = 1.0 eV
  }
}
</pre></div>
</div>
<p>最後に、file_names.data では、基底状態 (A)及び内殻電子励起状態 (B)
の全エネルギー値出力ファイル名を、F_CORE_ENERGY_INITIAL
及びF_CORE_ENERGY_FINAL に指定します。また、F_CHGT 及び
F_CNTN_BIN_PAWに、内殻電子励起状態 (B)の電荷密度ファイルを指定ます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = &#39;./nfinp1.data&#39;
F_POT(1) = &#39;../pp/Li_ggapbe_paw_02_no_corehole.pp&#39;
F_POT(2) = &#39;../pp/Li_ggapbe_paw_02_1s_corehole.pp&#39;
F_POT(3) = &#39;../pp/F_ggapbe_paw_02_no_corehole.pp&#39;
F_CHGT = &#39;../scf_excited/nfchgt.data&#39;
F_CNTN_BIN_PAW = &#39;../scf_excited/continue_bin_paw.data&#39;
F_CORE_ENERGY_INITIAL = &#39;../scf_ground/core_energy.data&#39;
F_CORE_ENERGY_FINAL = &#39;../scf_excited/core_energy.data&#39;
/
</pre></div>
</div>
</section>
<section id="id93">
<h4><span class="section-number">8.9.6.2. </span>出力<a class="headerlink" href="#id93" title="この見出しへのパーマリンク"></a></h4>
<p>スペクトルの出力ファイル名はeps.data
である。以下に出力例を示す。3行目のエネルギー値は、吸収端エネルギーにe_lowを加えた値です。spectrum
はスペクトル強度、すなわち誘電関数の虚部 に対応します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Spectrum data
# Energy[eV] Spectrum
0.6018296869E+02 0.7167942086E-06
0.6023739146E+02 0.1031555487E-05
0.6029181423E+02 0.1478755242E-05
…
</pre></div>
</div>
</section>
</section>
<section id="id94">
<h3><span class="section-number">8.9.7. </span>計算事例<a class="headerlink" href="#id94" title="この見出しへのパーマリンク"></a></h3>
<section id="lif-li-k">
<h4><span class="section-number">8.9.7.1. </span>LiF 結晶の Li 原子K端のスペクトル<a class="headerlink" href="#lif-li-k" title="この見出しへのパーマリンク"></a></h4>
<p>　例題として、LiF 結晶の Li 原子K端の XANES
スペクトルを示します。計算事例は、  <code class="code docutils literal notranslate"><span class="pre">samples/XANES/LiF</span></code> です。計算は、</p>
<ol class="arabic simple">
<li><p>基底状態 (A) のSCF計算 ( フォルダ名：scf_ground )</p></li>
<li><p>内殻電子励起状態 (B) のSCF計算 ( フォルダ名：scf_excited )</p></li>
<li><p>内殻電子励起状態 (B) のスペクトル計算 ( フォルダ名：eps_excited )</p></li>
</ol>
<p>の順で行います。</p>
<p>スペクトル計算はk 点数を増やして行うことを推奨します。</p>
<figure class="align-default" id="id166">
<img alt="../_images/image237.png" src="../_images/image237.png" />
<figcaption>
<p><span class="caption-number">図 8.20 </span><span class="caption-text">(左) LiF結晶。(右)スペクトル</span><a class="headerlink" href="#id166" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="advanced-xanes-quad-section">
<span id="id95"></span><h3><span class="section-number">8.9.8. </span>四重極子成分 (バージョン2019.02以降)<a class="headerlink" href="#advanced-xanes-quad-section" title="この見出しへのパーマリンク"></a></h3>
<section id="id96">
<h4><span class="section-number">8.9.8.1. </span>概要<a class="headerlink" href="#id96" title="この見出しへのパーマリンク"></a></h4>
<p>XANESのスペクトル計算では、始状態iと終状態fの間の遷移モーメントを計算します。一般に、四極子成分は弱いことが多いですが、双極子極子遷移が禁止されているエネルギー領域に明瞭なピークを生じることがあります。この四重極成分の計算をPHASE/0で実行する方法を説明します。</p>
</section>
<section id="id97">
<h4><span class="section-number">8.9.8.2. </span>計算理論<a class="headerlink" href="#id97" title="この見出しへのパーマリンク"></a></h4>
<p>遷移モーメントの計算</p>
<p>四重極まで含めた、始状態iと終状態fの間の遷移モーメントは</p>
<div class="math notranslate nohighlight" id="equation-advanced-xanes-quad-eq1">
<span class="eqno">(8.38)<a class="headerlink" href="#equation-advanced-xanes-quad-eq1" title="この数式へのパーマリンク"></a></span>\[M_{i\rightarrow f} = \Braket{\psi_f | D | \psi_i}, D=\hat{\mathbf{\varepsilon}} \cdot \mathbf{r} + \frac{i}{2} \left(\hat{\mathbf{\varepsilon}} \cdot \mathbf{r}\right) \left( \mathbf{k}\cdot\mathbf{r}\right)\]</div>
<p>で表されます <a class="reference internal" href="#gougoussis09" id="id98"><span>[Gougoussis09]</span></a> 。<span class="math notranslate nohighlight">\(\psi_i\)</span> 及び <span class="math notranslate nohighlight">\(\psi_f\)</span> は、それぞれ始状態i及び終状態fの波動関数、<span class="math notranslate nohighlight">\(\hat{\mathbf{\varepsilon}}\)</span> 及び <span class="math notranslate nohighlight">\(k\)</span> は入射光の偏光ベクトル及び波数ベクトルです。<span class="math notranslate nohighlight">\(D\)</span> の第1項が双極子、第2項が四重極子成分に対応します。</p>
<p>ただし、PAW法では、波動関数が規格直交化されないため、は以下のように書き替えられます。</p>
<div class="math notranslate nohighlight" id="equation-advanced-xanes-quad-eq2">
<span class="eqno">(8.39)<a class="headerlink" href="#equation-advanced-xanes-quad-eq2" title="この数式へのパーマリンク"></a></span>\[\begin{split}M_{i \rightarrow f} &amp;= \Braket{\tilde{\psi}_f | D | \tilde{\psi}_i} \\
&amp;+ \sum_{\mathbf{R}} \sum_{l'm'\tau '} \sum_{nlm} \Braket{\tilde{\psi}_f | \beta_{\mathbf{R},l'm'\tau '}^{v}}  \Braket{\phi_{\mathbf{R},l'm'\tau '}^v | D | \phi_{\mathbf{R},nlm}^c} \Braket{\beta_{\mathbf{R},nlm}^c | \tilde{\psi}_i} \\
&amp;+ \sum_{\mathbf{R}} \sum_{l'm'\tau '} \sum_{nlm} \Braket{\tilde{\psi}_f | \beta_{\mathbf{R},l'm'\tau '}^{v}} \Braket{\tilde{\phi}_{\mathbf{R},l'm'\tau '}^v | D | \tilde{\phi}_{\mathbf{R},nlm}^c} \Braket{\beta_{\mathbf{R},nlm}^c | \tilde{\psi}_i}\end{split}\]</div>
<p>ここで、 <span class="math notranslate nohighlight">\(\beta_{\mathbf{R},l'm'\tau'}^v\)</span> 及び <span class="math notranslate nohighlight">\(\beta_{\mathbf{R},nlm}^c\)</span> は、それぞれ価電子及び内殻電子軌道へのプロジェクタです。また、 <span class="math notranslate nohighlight">\(\phi_{\mathbf{R},l'm'\tau'}^v\)</span> 及び <span class="math notranslate nohighlight">\(\tilde{\phi}_{\mathbf{R},l'm'\tau'}^v\)</span> は、それぞれ価電子軌道の全電子及び擬波動関数です。同様に、 <span class="math notranslate nohighlight">\(\phi_{\mathbf{R},nlm}^c\)</span> 及び <span class="math notranslate nohighlight">\(\tilde{\phi}_{\mathbf{R},nlm}^c\)</span> は、それぞれ内殻電子軌道の全電子及び擬波動関数です。</p>
<p>　なお、XANESの計算は、始状態iとして、原子位置 (<strong>R</strong><sub>0</sub>)
及び内殻電子軌道 (n,l)
を指定して行います。さらに、この軌道は原子近傍に局在していることを考えると、結局、</p>
<div class="math notranslate nohighlight" id="equation-advanced-xanes-quad-eq3">
<span class="eqno">(8.40)<a class="headerlink" href="#equation-advanced-xanes-quad-eq3" title="この数式へのパーマリンク"></a></span>\[M_{i\rightarrow f} \simeq \sum_{i'm'\tau'} \sum_{m} \Braket{\tilde{\psi}_f | \beta_{\mathbf{R}_0,l'm'\tau'}^v} \Braket{\phi_{\mathbf{R}_0,l'm'\tau'}^v | D | \phi_{\mathbf{R}_0, nlm}^c} \Braket{\beta_{\mathbf{R}_0,nlm}^c | \tilde{\psi}_i}\]</div>
<p>を計算すればよいことがわかります <a class="reference internal" href="#gougoussis09" id="id99"><span>[Gougoussis09]</span></a> 。</p>
<p>スペクトル強度の計算</p>
<p>スペクトル強度は、</p>
<div class="math notranslate nohighlight" id="equation-advanced-xanes-quad-eq4">
<span class="eqno">(8.41)<a class="headerlink" href="#equation-advanced-xanes-quad-eq4" title="この数式へのパーマリンク"></a></span>\[\begin{split}\varepsilon_2 \left(\omega\right) &amp;= 4 \pi^2 \sum_{f} \left| M_{i\rightarrow f} \right|^2 \delta \left( E_f - E_i - \hbar \omega \right) \\
                                  &amp;= 4 \pi^2 \sum_f \left[ \left| \Braket{\phi_f | \hat{\mathbf{\varepsilon}} \cdot \mathbf{r} | \psi_i} \right|^2 + \frac{1}{4} \left| \Braket{\psi_f | \left( \hat{\mathbf{\varepsilon}} \cdot \mathbf{r} \right) \left( \mathbf{k} \cdot \mathbf{r} \right) | \psi_i} \right|^2 \right] \delta \left( E_f - E_i - \hbar \omega \right)\end{split}\]</div>
<p>で与えられます <a class="reference internal" href="#cabaret10" id="id100"><span>[Cabaret10]</span></a> 。ここで、 <span class="math notranslate nohighlight">\(E_i\)</span> 及び <span class="math notranslate nohighlight">\(E_f\)</span> は、始状態及び終状態の全エネルギー、 <span class="math notranslate nohighlight">\(\hbar \omega\)</span> は入射光のエネルギーです。<a class="reference internal" href="#equation-advanced-xanes-quad-eq3">(8.40)</a> を用いれば、双極子及び四重極子成分は、それぞれ</p>
<div class="math notranslate nohighlight" id="equation-advanced-xanes-quad-eq5">
<span class="eqno">(8.42)<a class="headerlink" href="#equation-advanced-xanes-quad-eq5" title="この数式へのパーマリンク"></a></span>\[\begin{split}\varepsilon_2^{\rm E1-E1} \left(\omega\right) &amp;= 4 \pi^2 \sum_f \left| \sum_{l'm'\tau'} \sum_m \Braket{\tilde{\psi}_f | \beta_{\mathbf{R}_0,l'm'\tau'}} \Braket{\phi_{\mathbf{R}_0,l'm'\tau'}^v | D^{(1)} | \phi_{\mathbf{R}_0,nlm}^c} \Braket{\beta_{\mathbf{R}_0,nlm} | \tilde{\psi}_i} \right|^2 \\
&amp;\times \delta \left(E_f - E_i - \hbar \omega\right), \\
\varepsilon_2^{\rm E2-E2} \left(\omega\right) &amp;= 4 \pi^2 \sum_f \left| \sum_{l'm'\tau'} \sum_m \Braket{\tilde{\psi}_f | \beta_{\mathbf{R}_0,l'm'\tau'}} \Braket{\phi_{\mathbf{R}_0,l'm'\tau'}^v | D^{(2)} | \phi_{\mathbf{R}_0,nlm}^c} \Braket{\beta_{\mathbf{R}_0,nlm} | \tilde{\psi}_i} \right|^2 \\
&amp;\times \delta \left(E_f - E_i - \hbar \omega\right), \\
D^{(1)} &amp;= \hat{\mathbf{\varepsilon}} \cdot \mathbf{r}, D^{(2)} = \left( \hat{\mathbf{\varepsilon}} \cdot \mathbf{r}\right) \left( \mathbf{k} \cdot \mathbf{r} \right)\end{split}\]</div>
<p>となります。なお、E1及びE2は電気双極子、四重極子成分という意味です。</p>
</section>
<section id="id101">
<h4><span class="section-number">8.9.8.3. </span>入力<a class="headerlink" href="#id101" title="この見出しへのパーマリンク"></a></h4>
<p>内殻電子励起前後の SCF
計算は済んでいるものとします。四重極子計算機能を利用するには、以下のような入力を作成します。影を付けた箇所が、本機能特有の項目です。sw_local_approx_trans_moment=on
とすると、双極子成分に加えて四重極子成分を計算します。wave_vector
では、入射光の波数ベクトルの方向を指定します。</p>
<blockquote>
<div><p>四重極子成分を計算するための入力例</p>
</div></blockquote>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>epsilon{
  sw_epsilon = on
  sw_corelevel_spectrum = on
  sw_local_approx_trans_moment = on
  probe{
    atom_id = 2
    orbital = 1s
  }
  photon{
    polarization{
      ux = 1, uy = 0, uz = 0
    }
    wave_vector{
      kx = 0, ky = 0, kz = 1
    }
    energy_range{
      e_low= -0.10, e_high=2.0, e_step=0.002
    }
  }
  BZ_integration {
    method = g !{parabolic(p)
    width = 0.2 eV
  }
  fermi_energy{
    read_efermi = on
    efermi = 0.17409189
  }
}
</pre></div>
</div>
<p>なお、fermi__energy
ブロックは無くてもかまいませんが、このときは、必ず、内殻電子励起状態のSCF計算時に生成されたフェルミ準位ファイル名を
file_names.data 内に明記する必要があります。</p>
<p>fermi_energy ブロックを用いない場合の file_names.dataの例</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
(中略)
F_EFERMI = &#39;../scf-final/nfefermi.data&#39;
(中略)
/
</pre></div>
</div>
</section>
<section id="id102">
<h4><span class="section-number">8.9.8.4. </span>出力<a class="headerlink" href="#id102" title="この見出しへのパーマリンク"></a></h4>
<p>　双極子及び四重極子成分のスペクトルは、それぞれ、eps_E1_E1.data及びeps_E2_E2.data
に出力されます。</p>
<p>eps_E1_E1.data の出力例</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Core level spectrum ( dipole-dipole )
# atom: 2, orbital: n = 1, l = 0
#
# Energy [eV] spectrum
#
(中略)
0.4968388438E+04 0.8211847200E-07
0.4968442860E+04 0.9903378493E-07
0.4968497283E+04 0.1147357290E-06
(後略)
</pre></div>
</div>
<p>eps_E2_E2.data の出力例</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Core level spectrum ( quadrupole-quadrupole )
# atom: 2, orbital: n = 1, l = 0
#
# Energy [eV] spectrum
#
(中略)
0.5008878978E+04 0.1286045986E-09
0.5008933400E+04 0.1328488558E-09
0.5008987823E+04 0.1279594782E-09
(後略)
</pre></div>
</div>
</section>
<section id="id103">
<h4><span class="section-number">8.9.8.5. </span>計算例<a class="headerlink" href="#id103" title="この見出しへのパーマリンク"></a></h4>
<p>SrTiO<sub>3</sub>結晶の計算例を紹介します。入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/XANES/SrTiO3</span></code> にあります。</p>
<p>まず、単位胞 (5原子) の格子定数を、k点: Monk(8×8×8)
で最適化しa=3.923Åを得ました。これを各結晶軸方向に3倍したスーパーセル
(135原子、a=11.769Å)
を作成し、1つのTi原子の擬ポテンシャルを1sに内殻正孔を持つものに置き換えました。計算条件は以下の通。</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>cutoff_wf</p></td>
<td><p>25 Ry</p></td>
</tr>
<tr class="row-even"><td><p>cutoff_cd</p></td>
<td><p>225 Ry</p></td>
</tr>
<tr class="row-odd"><td><p>k点サンプリング</p></td>
<td><p>SCF: Monk (2×2×2)</p>
<p>XANES: Monk (4×4×4)</p>
</td>
</tr>
<tr class="row-even"><td><p>汎関数</p></td>
<td><p>PAW, GGAPBE</p></td>
</tr>
<tr class="row-odd"><td><p>擬ポテンシャル</p></td>
<td><p>Sr_ggapbe_paw_02.pp</p>
<p>Ti_ggapbe_paw_002_nocorehole.gncpp2</p>
<p>Ti_ggapbe_paw_005_1s_corehole.gncpp2</p>
<p>O_ggapbe_paw_02.pp</p>
</td>
</tr>
<tr class="row-even"><td><p>スペクトルのブロードニング</p></td>
<td><p>Gaussian, width = 0.5 eV</p></td>
</tr>
</tbody>
</table>
<p>また、偏光ベクトル、波数ベクトルの組み合わせとして、以下の2つを試しました。四重極子遷移において、aはt2g,
bはeg 軌道成分をプローブします。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>b</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>偏光ベクトルEの方向</p></td>
<td><p>[100]</p></td>
<td><p>[110]</p></td>
</tr>
<tr class="row-odd"><td><p>波数ベクトルkの方向</p></td>
<td><p>[010]</p></td>
<td><p>[1-10]</p></td>
</tr>
</tbody>
</table>
<p>結果を以下に示します。
SrTiO<sub>3</sub>のd軌道は、t2gの方がeg軌道よりもエネルギーが低いため、四重極子遷移で最初にピークが現れるのは
t2g 軌道をプローブするa の場合でです ( <a class="reference internal" href="#advanced-xanes-quad-fig1"><span class="std std-numref">図 8.21</span></a> 参照)。<a class="reference internal" href="#advanced-xanes-quad-fig2"><span class="std std-numref">図 8.22</span></a> は、吸収端近傍の拡大図です。</p>
<figure class="align-default" id="advanced-xanes-quad-fig1">
<img alt="../_images/image259.svg" src="../_images/image259.svg" /><figcaption>
<p><span class="caption-number">図 8.21 </span><span class="caption-text">SrTiO<sub>3</sub> のXANESスペクトル</span><a class="headerlink" href="#advanced-xanes-quad-fig1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="advanced-xanes-quad-fig2">
<img alt="../_images/image261.svg" src="../_images/image261.svg" /><figcaption>
<p><span class="caption-number">図 8.22 </span><span class="caption-text">SrTiO<sub>3</sub> のXANESスペクトル拡大図。</span><a class="headerlink" href="#advanced-xanes-quad-fig2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id104">
<h3><span class="section-number">8.9.9. </span>文献<a class="headerlink" href="#id104" title="この見出しへのパーマリンク"></a></h3>
<div role="list" class="citation-list">
<div class="citation" id="gao08" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id85">Gao08</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="19">
<li><p>-P. Gao, C. J. Pickard, M. C. Payne, J. Zhu, and J. Yuan, Phys.  Rev. B <strong>77</strong> (2008) 115122.</p></li>
</ol>
</div>
<div class="citation" id="gougoussis09" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Gougoussis09<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id98">1</a>,<a role="doc-backlink" href="#id99">2</a>)</span>
<ol class="upperalpha simple" start="3">
<li><p>Gougoussis, M. Calandra, A. P. Seitsonen, and F. Mauri, Phys. Rev. B <strong>80</strong> (2009) 075102.</p></li>
</ol>
</div>
<div class="citation" id="cabaret10" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id100">Cabaret10</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="4">
<li><p>Cabaret, A. Bordage, A. Juhin, M. Arfaoui, and E. Gaudry, Phys.  Chem. Chem. Phys. <strong>12</strong> (2010) 5619.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="xes-2024-01">
<span id="section-xes"></span><h2><span class="section-number">8.10. </span>XES解析機能 (バージョン2024.01以降)<a class="headerlink" href="#xes-2024-01" title="この見出しへのパーマリンク"></a></h2>
<section id="id105">
<h3><span class="section-number">8.10.1. </span>はじめに<a class="headerlink" href="#id105" title="この見出しへのパーマリンク"></a></h3>
<p>X-ray Emission Spectroscopy (XES, X線発光分光) では、X線照射により内殻電子が真空中に飛び出した後 (XPSと同等)、外殻電子が内殻正孔と再結合する過程で、発光する現象を観測します。特に、外殻電子が価電子帯にある場合の XES を、Valence-to-Core (V2C)-XES と呼びます。PHASE/0では、内殻電子が飛び出した状態を始状態として、V2C-XES におけるスペクトルを計算することができます。以下、断りのない限り、単純に XES と呼ぶことにします。PHASE/0 には、XANES の計算機能も実装されています。XES との電子配置の違いは以下のとおりです。なお、Nc, Nv は内殻及び価電子数を意味します。</p>
<table class="docutils align-default" id="id167">
<caption><span class="caption-number">表 8.31 </span><span class="caption-text">XANESとXESにおける電子配置</span><a class="headerlink" href="#id167" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p>XANES</p></td>
<td><p>V2C-XES</p></td>
</tr>
<tr class="row-even"><td><p>始状態</p></td>
<td><p>Nc, Nv</p></td>
<td><p>Nc-1, Nv</p></td>
</tr>
<tr class="row-odd"><td><p>終状態</p></td>
<td><p>Nc-1, Nv+1 a.</p></td>
<td><p>Nc, Nv-1 b.</p></td>
</tr>
</tbody>
</table>
<ol class="loweralpha simple">
<li><p>励起された内殻電子は伝導帯に占有されます。</p></li>
<li><p>価電子帯の電子が内殻に落ち込みます。</p></li>
</ol>
<p>XESの遷移強度は、双極子或いは四重極子近似で計算を行います。このような計算は XANES計算と同じように実行されます。</p>
</section>
<section id="id106">
<h3><span class="section-number">8.10.2. </span>準備：擬ポテンシャル<a class="headerlink" href="#id106" title="この見出しへのパーマリンク"></a></h3>
<p>XANESの場合と同様、内殻に正孔を有する擬ポテンシャルを作成する必要があります。この点については <a class="reference internal" href="#section-elnes-xanes-pp"><span class="std std-numref">8.9.2 章</span></a> を参照してください。</p>
</section>
<section id="scf">
<h3><span class="section-number">8.10.3. </span>始状態SCF計算<a class="headerlink" href="#scf" title="この見出しへのパーマリンク"></a></h3>
<p>以下に、始状態SCF計算の入力例を示します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
    paw = on
}
structure{
  atom_list{
    atoms{
     #tag element rx ry rz
     Six  0.00000   0.00000   0.00000   ← 内殻正孔を持つ原子
     Si   0.12500   0.12500   0.12500
     Si   0.25000   0.25000   0.00000
     Si   0.37500   0.37500   0.12500
    (中略)
    }
  }
  charged_state{
     additional_charge = 1.0        ← 内殻電子が真空中に飛び出し系が正に帯電
  }
  element_list{
      #tag element atomicnumber
              Si       14
              Six      14       ← 内殻正孔を持つ原子
  }
}
postprocessing{
   corelevels{
     sw_calc_core_energy = on
  }
}
</pre></div>
</div>
<p>XANESなどの場合と似ていますが、内殻電子が真空中に飛び出し、系が正に帯電することを模擬するためにstructureブロックの下のcharged_stateブロックのadditional_chargeによって電荷を追加している点が特徴的です。</p>
</section>
<section id="id107">
<h3><span class="section-number">8.10.4. </span>終状態SCF計算<a class="headerlink" href="#id107" title="この見出しへのパーマリンク"></a></h3>
<p>以下に、終状態SCF計算の入力例を示します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
    paw = on
}
structure{
  atom_list{
    atoms{
      #tag element rx ry rz
           Si   0.00000   0.00000   0.00000
           Si   0.12500   0.12500   0.12500
           Si   0.25000   0.25000   0.00000
           Si   0.37500   0.37500   0.12500
           (中略)
    }
  }
  charged_state{
     additional_charge = 1.0　　← 内殻正孔は消滅するが価電子帯に正孔ができる。系が正に帯電したまま。
  }
  element_list{
      #tag element atomicnumber
              Si       14
  }
}
postprocessing{
   corelevels{
     sw_calc_core_energy = on
  }
}
</pre></div>
</div>
<p>終状態においては内殻は消滅するのですが、価電子帯に正孔ができると考えるため、系は正に帯電する設定が施されています。</p>
</section>
<section id="id108">
<h3><span class="section-number">8.10.5. </span>スペクトル計算<a class="headerlink" href="#id108" title="この見出しへのパーマリンク"></a></h3>
<p>終状態のSCF計算で得られた電荷密度を読み込み、固定電荷モードでスペクトル計算を行います。epsilon ブロックの設定は、sw_v2c_xes = on を記述する以外、XANES計算と共通です。以下は入力例です。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
    condition = fixed_charge
    use_additional_projector = on
}
accuracy{
    paw = on
}
structure{
  atom_list{
      atoms{
          #tag element rx ry rz
      Si   0.00000   0.00000   0.00000
      Si   0.12500   0.12500   0.12500
      Si   0.25000   0.25000   0.00000
      Si   0.37500   0.37500   0.12500
      (中略)
    }
  }
}
epsilon{
      sw_epsilon = on
      sw_corelevel_spectrum = on
      sw_v2c_xes = on               　　　  ← XES 計算特有の宣言

      probe{
         atom_id = 1
         orbital = 2p
      }
      photon{
         energy{
            low = -1.5, high = 0.2, step = 0.002
         }
      }
      BZ_integration {
              method = g       !{parabolic(p)|gaussian(g)}
              width = 0.8 eV
      }
      fermi_energy{
             read_efermi = on
      }
}
</pre></div>
</div>
<p>また、file_names.data 内で、始状態及び終状態のcore_energy.dataファイルを、それぞれF_CORE_ENERGY_INITIAL及びF_CORE_ENERGY_FINALに指定します。加えて、終状態のフェルミ準位が書かれたファイルをF_EFERMIに指定します。これらの指定も、XANES計算と同様です。典型的には以下のような内容になります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_EFERMI = &#39;../scf_final/nfefermi.data&#39;
F_CHGT   = &#39;../scf_final/nfchgt.data&#39;
F_CNTN_BIN_PAW   = &#39;../scf_final/continue_bin_paw.data&#39;

F_CORE_ENERGY_INITIAL = &#39;../scf_initial/core_energy.data&#39;
F_CORE_ENERGY_FINAL   = &#39;../scf_final/core_energy.data&#39;
/
</pre></div>
</div>
<p>スペクトル計算の計算結果はeps.dataファイルに以下の要領で記録されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#             Spectrum data
#      Energy[eV]        Spectrum
  0.7176531082E+02  0.0000000000E+00
(中略)
  0.8814656534E+02  0.1416217026E-03
  0.8820098811E+02  0.1532007066E-03
(後略)
</pre></div>
</div>
</section>
<section id="id109">
<h3><span class="section-number">8.10.6. </span>計算例<a class="headerlink" href="#id109" title="この見出しへのパーマリンク"></a></h3>
<p>計算例として、Si結晶(8原子)とMgO結晶(8原子)の例を紹介します。入力ファイルはそれぞれ <code class="docutils literal notranslate"><span class="pre">samples/XES/Si</span></code>, <code class="docutils literal notranslate"><span class="pre">samples/XES/MgO</span></code> 以下にあります。各例題ディレクトリーはさらに以下のサブディレクトリーから構成されています。</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>scf_initial</p></td>
<td><p>始状態に対応するSCF計算の入力が格納されているディレクトリー</p></td>
</tr>
<tr class="row-even"><td><p>scf_final</p></td>
<td><p>終状態に対応するSCF計算の入力格納されているディレクトリー</p></td>
</tr>
<tr class="row-odd"><td><p>eps</p></td>
<td><p>スペクトル計算の入力が格納されているディレクトリー</p></td>
</tr>
<tr class="row-even"><td><p>pp</p></td>
<td><p>内殻正孔を有する元素の擬ポテンシャルファイルなどが格納されているディレクトリー</p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">scf_initial</span></code> および <code class="docutils literal notranslate"><span class="pre">scf_final</span></code> においてphaseによるSCF計算を行い、 <code class="docutils literal notranslate"><span class="pre">eps</span></code> において epsmainによるスペクトル計算を行うことによって結果を得ることができるようになっています。</p>
<section id="si-8">
<h4><span class="section-number">8.10.6.1. </span>Si結晶(8原子)<a class="headerlink" href="#si-8" title="この見出しへのパーマリンク"></a></h4>
<p>以下に、Si結晶(8原子)のXESスペクトル計算の条件を示します。なお、格子定数は、事前に最適化した値 (5.4726Å)を用いました。また、内殻正孔の入る軌道として Si 2pを選択しました。</p>
<table class="docutils align-default" id="id168">
<caption><span class="caption-number">表 8.32 </span><span class="caption-text">Si結晶(8原子)のSCF・スペクトル計算の計算条件</span><a class="headerlink" href="#id168" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>225</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>monk(4×4×4)</p></td>
</tr>
<tr class="row-even"><td><p>バンド数</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE PAW</p></td>
</tr>
<tr class="row-even"><td><p>磁性の考慮</p></td>
<td><p>ferro</p></td>
</tr>
<tr class="row-odd"><td><p>系の荷電状態</p></td>
<td><p>additional_charge = 1.0</p></td>
</tr>
<tr class="row-even"><td><p>擬ポテンシャル</p></td>
<td><p>Si_ggapbe_paw_002_nocorehole.gncpp2 Si_ggapbe_paw_005_corehole_2p.gncpp2</p></td>
</tr>
<tr class="row-odd"><td><p>初期波動関数</p></td>
<td><p>atomic_orbitals</p></td>
</tr>
<tr class="row-even"><td><p>初期電荷密度</p></td>
<td><p>atomic_charge</p></td>
</tr>
<tr class="row-odd"><td><p>スメアリング [eV]</p></td>
<td><p>0.05 (parabolic)</p></td>
</tr>
<tr class="row-even"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
</tbody>
</table>
<p>得られる結果を次の図に示します。2個のピークと１個のショルダーが見られますが、先行研究 <a class="reference internal" href="#lyalin19" id="id110"><span>[Lyalin19]</span></a> でも同様の結果が示されています。</p>
<figure class="align-default" id="advanced-xes-fig1">
<img alt="../_images/XES_Si8.png" src="../_images/XES_Si8.png" />
<figcaption>
<p><span class="caption-number">図 8.23 </span><span class="caption-text">Si 結晶(8原子)の <span class="math notranslate nohighlight">\(L_{2,3}\)</span> XESスペクトル。</span><a class="headerlink" href="#advanced-xes-fig1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="mgo-8">
<h4><span class="section-number">8.10.6.2. </span>MgO結晶 (8原子)<a class="headerlink" href="#mgo-8" title="この見出しへのパーマリンク"></a></h4>
<p>以下に、MgO結晶(8原子)のXESスペクトル計算の条件を示します。なお、格子定数は、事前に最適化した値 (4.2752Å)を用いました。また、内殻正孔の入る軌道として O 1sを選択しました。</p>
<table class="docutils align-default" id="id169">
<caption><span class="caption-number">表 8.33 </span><span class="caption-text">MgO結晶(8原子)のSCF・スペクトル計算の条件</span><a class="headerlink" href="#id169" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>225</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>monk(4×4×4)</p></td>
</tr>
<tr class="row-even"><td><p>バンド数</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE PAW</p></td>
</tr>
<tr class="row-even"><td><p>磁性の考慮</p></td>
<td><p>Ferro&quot;</p></td>
</tr>
<tr class="row-odd"><td><p>系の荷電状態</p></td>
<td><p>additional_charge = 1.0&quot;</p></td>
</tr>
<tr class="row-even"><td><p>擬ポテンシャル</p></td>
<td><p>Mg_ggapbe_paw_002_nocorehole.gncpp2 O_ggapbe_paw_002_nocorehole.gncpp2 O_ggapbe_paw_005_corehole_1s.gncpp2 Si_ggapbe_paw_005_corehole_2p.gncpp2</p></td>
</tr>
<tr class="row-odd"><td><p>初期波動関数</p></td>
<td><p>無指定</p></td>
</tr>
<tr class="row-even"><td><p>初期電荷密度</p></td>
<td><p>無指定</p></td>
</tr>
<tr class="row-odd"><td><p>スメアリング [eV]</p></td>
<td><p>0.05 (parabolic)</p></td>
</tr>
<tr class="row-even"><td><p>SCF 収束条件 [Ha/atom]</p></td>
<td><p>1.0E-8</p></td>
</tr>
</tbody>
</table>
<p>得られる結果を次の図に示します。1個のピークと1個のショルダーが見られますが、実験 <a class="reference internal" href="#galakhov20" id="id111"><span>[Galakhov20]</span></a> でも同様の結果が示されています。</p>
<figure class="align-default" id="advanced-xes-fig2">
<img alt="../_images/XES_MgO.png" src="../_images/XES_MgO.png" />
<figcaption>
<p><span class="caption-number">図 8.24 </span><span class="caption-text">MgO結晶(8原子)の <span class="math notranslate nohighlight">\(K_{\alpha}\)</span> XESスペクトル。</span><a class="headerlink" href="#advanced-xes-fig2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="lyalin19" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id110">Lyalin19</a><span class="fn-bracket">]</span></span>
<p>A. Lyalin et al, J. Electrochem. Soc. 166, A5362 (2019).</p>
</div>
<div class="citation" id="galakhov20" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id111">Galakhov20</a><span class="fn-bracket">]</span></span>
<p>V. R. Galakhov et al, Phys. Rev. B 62, 4922 (2000).</p>
</div>
</div>
</section>
</section>
</section>
<section id="section-borncharge">
<span id="id112"></span><h2><span class="section-number">8.11. </span>ボルン有効電荷<a class="headerlink" href="#section-borncharge" title="この見出しへのパーマリンク"></a></h2>
<section id="id113">
<h3><span class="section-number">8.11.1. </span>概要<a class="headerlink" href="#id113" title="この見出しへのパーマリンク"></a></h3>
<p>平面波基底を採用する第一原理計算において、原子の電荷を一意に求めることは簡単なことではありません。ボルン有効電荷はベリー位相理論に基づいて計算されるものであり、電荷を決めるための最良の方法と考えられます。その基本的な考え方は、“原子が微小に変位した場合に発生する分極”を変位量で割ることによって電荷を求めることができる、というものです。分極も変位も3方向あり得るので、ボルン有効電荷は2階のテンソルとなります。なお、ボルン有効電荷の計算はギャップのある系でのみ計算することが可能な点にご注意ください。</p>
</section>
<section id="id114">
<h3><span class="section-number">8.11.2. </span>ボルン有効電荷の計算の流れ<a class="headerlink" href="#id114" title="この見出しへのパーマリンク"></a></h3>
<p>ボルン有効電荷は、次のような表式によって計算します。</p>
<div class="math notranslate nohighlight" id="advanced-eq-born1">
<span id="equation-advanced-eq-born1"></span><span class="eqno">(8.43)<a class="headerlink" href="#advanced-eq-born1" title="この数式へのパーマリンク"></a></span>\[ Z_{\alpha \beta}^{*} = - \frac{\Omega}{q_e} \frac{\partial P_{\alpha}}{\partial u_{\beta}} = Z_{\rm ion} \delta_{\alpha \beta} + \sum_i \frac{f}{2\pi} a_{i\alpha} \cdot \frac{\partial \phi_i \left( u_{\beta} \right)}{\partial u_{\beta}} .\]</div>
<p>ここでは <span class="math notranslate nohighlight">\(Z_{\rm ion}\)</span> イオンの電荷、は<em>i</em>番目の格子ベクトルのα成分、は<em>i</em>番目の逆格子ベクトルに沿ったベリー位相、は変位のβ成分です。ベリー位相の原子変位に対する微分は、差分近似から計算します。このことから、3通りの変位に対して3つの逆格子ベクトルのベリー位相を計算する必要があり、ボルン電荷を計算するためには考慮する原子数の9倍のベリー位相計算が必要になることが分かります（実際には変位しないケースも必要なので、必要なベリー位相計算は原子数×9
+ 3
です）。また、ベリー位相の計算はekcalの固定電荷計算によって行うので、さらに固定電荷計算用の電荷を作成するSCF計算をベリー位相計算に先立って行う必要があります。この一連の計算を行うために、PHASE/0に付属するberry.plというPerlスクリプトを利用します。</p>
<p>計算は、PHASE/0に付属するberry.plというPerlスクリプトを利用して行います。berry.plは、binディレクトリーの下にあります。ボルン有効電荷の場合、berry.plは以下のような流れで計算を行います。</p>
<ol class="arabic simple">
<li><p>対象とする原子すべてのSCF計算を行う。</p></li>
<li><p>対象とする原子すべてを3方向変位させた計算を行う。</p></li>
<li><p>1.,
2.で得られた電荷密度を入力とした固定電荷計算によって、ベリー位相計算を3つの逆格子ベクトルに対して行う。</p></li>
<li><p>3.
で得られたベリー位相データを結合し、 <a class="reference internal" href="#equation-advanced-eq-born1">()</a> を利用してボルン有効電荷を計算する。</p></li>
</ol>
<p>入力として必要なのは、SCF計算およびベリー位相計算の入力の元となるテンプレート入力ファイルと、berry.plの動作を制御するコントロールファイルです。</p>
</section>
<section id="id115">
<h3><span class="section-number">8.11.3. </span>入力データ<a class="headerlink" href="#id115" title="この見出しへのパーマリンク"></a></h3>
<section id="id116">
<h4><span class="section-number">8.11.3.1. </span>概要<a class="headerlink" href="#id116" title="この見出しへのパーマリンク"></a></h4>
<p>ボルン有効電荷の計算は、複数回のPHASEによるSCF計算と、ekcalによるベリー位相計算が必要となります。PHASE/0には、これらの計算を正しい手順で実行するberry.plというPerlスクリプトが付属しています。berry.plを実行するためには、SCF計算およびベリー位相計算用のテンプレートとなる入力ファイルと、berry.plの振る舞いを制御するコントロールファイルを作成する必要があります。</p>
</section>
<section id="id117">
<h4><span class="section-number">8.11.3.2. </span>SCF計算およびベリー位相計算用テンプレート入力データの作成<a class="headerlink" href="#id117" title="この見出しへのパーマリンク"></a></h4>
<p>ボルン有効電荷の計算を行うため、“テンプレート入力データ”を作成します。作成するテンプレート入力は、SCF計算用とベリー位相計算用のテンプレート入力です。それぞれについてberry.plを実行するディレクトリーの下にディレクトリーを作成し、その下にSCF計算用の入力データと固定電荷計算用の入力データを作成します。SCF計算はPHASE,
固定電荷計算は2次元版の場合はPHASEもしくはekcal,
3次元版の場合はPHASEプログラムを利用します。作成する入力データは通常の計算と同じですが、以下のような点に留意して入力を作成してください。</p>
<ul class="simple">
<li><p>座標データは、構造最適化や格子最適化がなされたものを採用してください。</p></li>
<li><p>構造最適化などが行われない設定にしてください。</p></li>
<li><p>計算は、実行ディレクトリーの一階層下において行われます。すなわち、テンプレート入力が置かれるディレクトリーと同じ階層で行われます。この点に留意してfile_names.dataにおける擬ポテンシャルの指定を行ってください。</p></li>
<li><p>通常、固定電荷計算用の入力のfile_names.dataファイルにおいてはファイルポインターF_CHGTを利用してSCF計算によって得られたF_CHGTファイル（電荷密度ファイル）を指定します。ボルン有効電荷計算においては実際に参照するSCF計算はberry.plが動的に決めるので、この部分を正しく指定する必要はありません（指定があっても、berry.plによって書き換えられてしまいます）。</p></li>
<li><p>固定電荷計算でPHASEを利用する場合以下のような設定をしてください。この設定を施すことによって、固定電荷計算は“k点を一点ずつ処理する”モードで動作します。ベリー位相計算はこのモードでないと正しく計算できません。</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  condition = fixed_charge
  fixed_charge_option{
    kparallel = one_by_one
  }
}
</pre></div>
</div>
<ul class="simple">
<li><p>ベリー位相計算の<strong>k</strong>点サンプリングは、berry.plのコントロールファイルにおけるmesh1, mesh2, mesh3パラメーターによって決まるので、ekcalの入力パラメーターファイルにおけるksamplingブロックの設定は無視されます。</p></li>
</ul>
</section>
<section id="berry-pl">
<h4><span class="section-number">8.11.3.3. </span>berry.pl用のコントロールファイルの作成<a class="headerlink" href="#berry-pl" title="この見出しへのパーマリンク"></a></h4>
<p>berry.plの振る舞いは、コントロールファイルを介して指定します。ボルン有効電荷計算の場合、典型的には以下のような内容になります（#で始まる文はコメント文）。コントロールファイルのファイル名はberry.pl実行時に指定する仕様となっているので、任意のものを採用してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#overall control
property = zeff
cpumax = 1000

#directories under which the template files reside
template_scf = scf
template_berry = berry

#parameters for the berry-phase calculation
atom_list = 1 3
displacement = 0.1
mesh1 = 6 6 15
mesh2 = 6 6 15
mesh3 = 6 6 15

#execution control
np = 4
ndir = 2
ne = 1
nk = 2
ne_b = 2
scf_command = mpiexec –np NP phase ne=NE nk=NK
berry_command = mpiexec –np NP ekcal ne=NE_B

#unit cell info, optional
a_vector = 5.01 0.0 0.0
b_vector = 0.0 5.01 0.0
c_vector = 0.0 0.0 5.01
</pre></div>
</div>
<p>この例からわかるように、パラメータ1つにつき1行を利用し、“キーワード=値”という形式でパラメータを指定します。ボルン有効電荷計算の場合に考慮する必要のあるキーワードとその説明を以下に記します。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>キーワード</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>property</p></td>
<td><p>どのような計算を行うかを指定します。zeff, piezo,
strfrcのいずれかです。zeffを指定するとボルン有効電荷用のベリー位相計算が行われます。デフォルト値はzeffなので、ボルン電荷計算の場合未指定でも構いません。</p></td>
</tr>
<tr class="row-odd"><td><p>cpumax</p></td>
<td><p>計算の最大時間を秒の単位で指定します。ここで指定した時間よりも経過時間が長い場合、計算はすみやかに終了します。0以下の値を指定すると、
この条件では計算は終了しません。デフォルト値は-1。</p></td>
</tr>
<tr class="row-even"><td><p>stopcheck</p></td>
<td><p>計算停止条件を満たしているかどうかをチェックする間隔を秒の単位で指定します。デフォルト値は10。</p></td>
</tr>
<tr class="row-odd"><td><p>length_unit</p></td>
<td><p>コントロールファイル中に利用される長さの単位を指定します。bohr,
angstrom,
nmのいずれかを指定します。デフォルト値はbohr。</p></td>
</tr>
<tr class="row-even"><td><p>template_scf</p></td>
<td><p>SCF計算用のテンプレートディレクトリーのディレクトリ名を指定します。デフォルト値はtemplate_scf。</p></td>
</tr>
<tr class="row-odd"><td><p>template_berry</p></td>
<td><p>ベリー位相計算用のテンプレートディレクトリのディレク
トリ名を指定します。デフォルト値はtemplate_berry。</p></td>
</tr>
<tr class="row-even"><td><p>atom_list</p></td>
<td><p>変位させる原子のIDを、空白区切りで指定します。</p></td>
</tr>
<tr class="row-odd"><td><p>displacement</p></td>
<td><p>原子の変位量を指定します。property =
zeffの場合に指定します。デフォルト値は0.1 bohr。</p></td>
</tr>
<tr class="row-even"><td><p>mesh1</p></td>
<td><p>1番目の逆格子ベクトルに沿ったベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezoの場合必須の指定です。</p></td>
</tr>
<tr class="row-odd"><td><p>mesh2</p></td>
<td><p>2番目の逆格子ベクトルに沿ったベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezo の場合必須の指定です。</p></td>
</tr>
<tr class="row-even"><td><p>mesh3</p></td>
<td><p>3番目の逆格子ベクトルに沿ったベリー位相計算のメッシュパラメーターを空白区切りで
n1 n2 J のように指定します。property = zeff および
piezo の場合必須の指定です。</p></td>
</tr>
<tr class="row-odd"><td><p>np</p></td>
<td><p>MPIプロセス数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>ndir</p></td>
<td><p>ディレクトリー並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ne</p></td>
<td><p>バンド並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>nk</p></td>
<td><p><strong>k</strong>点並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ng</p></td>
<td><p>(三次元版のみ)<strong>G</strong>点並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>ne_b</p></td>
<td><p>ベリー位相計算時に
おけるバンド並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-odd"><td><p>ng_b</p></td>
<td><p>（三次元版のみ）ベリー位相計算時にお
ける<strong>G</strong>並列数を指定します。デフォルト値は1。</p></td>
</tr>
<tr class="row-even"><td><p>scf_command</p></td>
<td><p>SCF計算の実行方法を指定します。たとえば、</p>
<p>scf_command = mpirun –np NP phase ne=NE nk=NK
(2D版)</p>
<p>scf_command = mpirun -np NP phase ne=NE nk=NK
ng=NG (3D版)</p>
<p>などと指定します。NP, NE, NK,
NGは、計算実行時に上述のnp, ne, nk,
ngに置き換わります。ただし、ディレクトリ並列の数によっ
ては“あまり”が発生することがあり、その場合はne=NE
nk=NKng=NGは省略されて計算が投入されます。デフォルト値はmpirun
phaseですが、利用して
いる環境に合わせて適切な指定をする必要があります。</p>
</td>
</tr>
<tr class="row-odd"><td><p>berry_command</p></td>
<td><p>ベリー位相計算の実行方法を指定します。たとえば、</p>
<p>berry_command = mpirun –np NP ekcal ne=NE_B (2D版)</p>
<p>berry_command = mpirun -np NP phase ne=NE_B
ng=NG_B (3D版)</p>
<p>などと指定します。NE_Bは上述のne_bに、NG_Bはng_bに置き換わります。デフォルト値はmpirun
ekcalです、利用している環境に合わせて適切な指定をする必要があります。</p>
</td>
</tr>
<tr class="row-even"><td><p>a_vector</p></td>
<td><p><em>a</em>軸の三成分を空白区切りで指定します。必須ではありませんが、指定しておくとベリー位相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
<tr class="row-odd"><td><p>b_vector</p></td>
<td><p><em>b</em>軸の三成分を空白区切りで指定します。必須ではありませんが、指定しておくとベリー位相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
<tr class="row-even"><td><p>c_vector</p></td>
<td><p><em>c</em>軸の三成分を空白区切りで指定します。必須ではありませんが、指定しておくとベリー位相計算のメッシュパラメーターの参照値を算出します。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id118">
<h4><span class="section-number">8.11.3.4. </span>注意点<a class="headerlink" href="#id118" title="この見出しへのパーマリンク"></a></h4>
<p>mesh1, mesh2, mesh3パラメーターについて</p>
<p>ベリー位相の計算においては、対象としたい逆格子ベクトル <span class="math notranslate nohighlight">\({\mathbf b}_i\)</span> に垂直な面の面積分と、<span class="math notranslate nohighlight">\({\mathbf b}_i\)</span> に沿った線積分が実行されます。この積分のメッシュは、コントロールファイルのmesh1,
mesh2,
mesh3パラメーターを利用して行います。<em>i</em>番目の逆格子ベクトルに対し、mesh<em>i</em>
= n1 n2 Jと空白区切りでメッシュを指定します。ここで面積分のメッシュがn1 n2、線積分のメッシュがJです。</p>
<p><span class="math notranslate nohighlight">\({\mathbf b}_i\)</span> 以外の2つの逆格子ベクトルを <span class="math notranslate nohighlight">\({\mathbf b}_j\)</span> とすると <span class="math notranslate nohighlight">\({\mathbf b}_j\)</span> を <span class="math notranslate nohighlight">\({\mathbf b}_i\)</span> に垂直な面に射影したベクトル、<span class="math notranslate nohighlight">\({\mathbf b}_j - \left| \mathbf{b}_j \right| \cos \theta_{ji} \frac{\mathbf{b}_i}{\left| \mathbf{b}_i \right|}\)</span> 、が面積分のメッシュの見積もりの基準となるので、その長さから決めます。線積分のパラメータは、<span class="math notranslate nohighlight">\(\mathbf{b}_i\)</span> の長さをもとに決定します。コントロールファイルにa_vector, b_vector, c_vectorの指定を行っておくと、この長さの計算（bohr<sup>-1</sup>単位）とそこから見積もられる参考のメッシュパラメーターが以下のように標準出力に出力されます（あくまで参照値であり、得られる結果の妥当性を保証するものではありません）。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>|b_para1|, |b_para2| and |b_perp| (in bohr^-1 units)
for reciprocal vector no. 1 : 0.172224346323159, 0.107572987734313, 0.198867545420854
for reciprocal vector no. 2 : 0.172224346322494, 0.107572987734313, 0.198867545421622
for reciprocal vector no. 3 : 0.198867545420854, 0.198867545421622, 0.107572987734313

reference value for mesh parameters n1, n2 and J
for reciprocal vector no. 1 : 8, 5, 19
for reciprocal vector no. 2 : 8, 5, 19
for reciprocal vector no. 3 : 9, 9, 10
</pre></div>
</div>
<p>並列計算について</p>
<p>並列計算の設定について注意すべき点を挙げます。berry.plによる計算は、通常のバンド、<strong>k</strong>点による並列(3D版の場合さらに<strong>G</strong>点並列)に加え、複数のディレクトリにまたがって並列計算を行う“ディレクトリ並列”によって行われます。したがって、ディレクトリ並列数（パラメーターndir）を2以上にする場合、SCF計算の場合はnp=ne×nkではなくnp=ndir×ne×nk
(3D版の場合np=ne x nk x ngではなくnp=ndir x ne x nk x
ng)となるように、ベリー位相計算の場合はnp=ne_bではなくnp=ne_b×ndir(3D版の場合np=ne_b
x ng_bではなくnp=ne_b x ng_b x
ndir)となるように並列数を調整してください。SCF計算とベリー位相計算とでバンド並列数が異なるのは、ベリー位相計算は<strong>k</strong>点並列に未対応のためです。また、ディレクトリー並列数を2以上にする場合、以下の要領でScaLAPACKを無効にしてください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>wavefunction_solver{
  submat{
    scalapack{
      sw_scalapack = off
    }
  }
}
</pre></div>
</div>
<p>3D版について</p>
<p>バージョン2019.02から、3D版でもベリー位相計算が実行できるようになりました。3D版でベリー位相計算を行うには、固定電荷計算にekcalではなくphaseを使います。また、以下のような設定を施すようにしてください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  fixed_charge_option{
    kparallel = one_by_one
  }
}
</pre></div>
</div>
</section>
</section>
<section id="id119">
<h3><span class="section-number">8.11.4. </span>berry.plの実行<a class="headerlink" href="#id119" title="この見出しへのパーマリンク"></a></h3>
<p>berry.plを引数なしで実行すると、以下のようなメッセージが得られます。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl
Usage<span class="w"> </span>:<span class="w"> </span>berry.pl<span class="w"> </span>control<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p>第一引数にコントロールファイルのファイル名を指定し、さらに必要に応じてオプションを指定して制御する仕組みになっています。</p>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のみ行います。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl<span class="w"> </span>control<span class="w"> </span>–-mode<span class="o">=</span>analyze
</pre></div>
</div>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のあと、計算用のディレクトリを作成します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl<span class="w"> </span>control<span class="w"> </span>--mode<span class="o">=</span>gendir
</pre></div>
</div>
<p>以下のようなコマンドを実行すると、コントロールファイルの解釈と解析のあと、計算用のディレクトリを作成し、さらに計算を実行します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl<span class="w"> </span>control<span class="w"> </span>--mode<span class="o">=</span><span class="nb">exec</span>
</pre></div>
</div>
<p>--mode オプションのデフォルト値はgendir です。また、</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl<span class="w"> </span>--clean
</pre></div>
</div>
<p>とすると、berry.plが作成したディレクトリーなどを一括削除することができます。</p>
<p>実行すると、以下のようなログを出力しながらPHASEもしくはekcalによる計算が進行します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>berry.pl<span class="w"> </span>:<span class="w"> </span>script<span class="w"> </span>to<span class="w"> </span>calculate<span class="w"> </span>the<span class="w"> </span>berry<span class="w"> </span>phase<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>PHASE<span class="w"> </span>System
Copyright<span class="w"> </span><span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">2012</span>-2013,<span class="w"> </span>IIS,<span class="w"> </span>The<span class="w"> </span>University<span class="w"> </span>of<span class="w"> </span>Tokyo
script<span class="w"> </span>start<span class="w"> </span><span class="nb">time</span><span class="w"> </span>:<span class="w"> </span>Tue<span class="w"> </span>Mar<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">18</span>:12:13<span class="w"> </span><span class="m">2017</span>
--<span class="w"> </span>parsing<span class="w"> </span>the<span class="w"> </span>control<span class="w"> </span>file<span class="w"> </span>–
…
…
--<span class="w"> </span>generating<span class="w"> </span>directories<span class="w"> </span>--
number<span class="w"> </span>of<span class="w"> </span>SCF<span class="w"> </span>directories<span class="w"> </span>:<span class="w"> </span><span class="m">7</span>
number<span class="w"> </span>of<span class="w"> </span>berry<span class="w"> </span>directories<span class="w"> </span>:<span class="w"> </span><span class="m">21</span>
--<span class="w"> </span>doing<span class="w"> </span>SCF<span class="w"> </span>calculations<span class="w"> </span>--
running<span class="w"> </span><span class="o">[</span>mpiexec<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="nv">$HOME</span>/phase0/binN/phase<span class="w"> </span><span class="nv">ne</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">nk</span><span class="o">=</span><span class="m">2</span><span class="o">]</span><span class="w"> </span>under<span class="w"> </span>the
following<span class="w"> </span>directories
scf_a0
<span class="nb">time</span><span class="w"> </span>spent<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span>calculation<span class="w"> </span>:<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="o">(</span>s<span class="o">)</span>,<span class="w"> </span>total<span class="w"> </span><span class="nb">time</span><span class="w"> </span>:<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="o">(</span>s<span class="o">)</span>
…
…
</pre></div>
</div>
<p>まずコントロールファイルの中身が読み込まれ、その内容が出力されます。ついで、計算に必要なディレクトリーが作成されます。その後SCF計算が必要な回数だけ行われ、さらにベリー位相計算が必要な回数だけ行われます。実行中のコマンドと計算中のディレクトリーは、以下のような形式で出力されます。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>running<span class="w"> </span><span class="o">[</span>mpiexec<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="nv">$HOME</span>/phase0/bin/phase<span class="w"> </span><span class="nv">ne</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">nk</span><span class="o">=</span><span class="m">2</span><span class="o">]</span><span class="w"> </span>under<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>directories
scf_a0
</pre></div>
</div>
<p>作成される計算用ディレクトリーは、以下のようなものです。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ディレクトリー名</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scf_a0</p></td>
<td><p>参照用の、原子を変位させない系の</p>
<p>SCF計算が行われるディレクトリー。</p>
</td>
</tr>
<tr class="row-odd"><td><p>scf_a<em>aid</em>_u<em>uid</em></p></td>
<td><p><em>aid</em>番目の原子を、<em>uid</em>の方向に変位させた系のSCF
計算が行われるディレクトリー。<em>aid</em>は1始まりであり、テンプレ
ート入力データに記述した原子配置
の順序に対応する。<em>uid</em>は1,
2,
3のい
ずれかの値をとり、それぞれ<em>x</em>,
<em>y</em>, <em>z</em>方向に相当する。</p></td>
</tr>
<tr class="row-even"><td><p>berry_a0_g<em>gid</em></p></td>
<td><p>参照用の、原子を変位させない系
における、<em>gid</em>方向の逆格子
ベクトルのベリー位相計算が行われ
るディレクトリー。<em>gid</em>は1,
2,
3のい
ずれかの値をとり、それぞれ1番目,
2番目,
3
番目の逆格子ベクトルに相当する。</p></td>
</tr>
<tr class="row-odd"><td><p>berry_
a<em>aid</em>_u<em>uid_</em>g<em>gid</em></p></td>
<td><p><em>aid</em>番目の原子を、<em>uid</em>の方向に
変位させた系における、<em>gid</em>方向の逆格子ベクトルのベリー位相
計算が行われるディレクトリー。<em>aid</em>は1始まりであり、テンプレ
ート入力データに記述した原子配置
の順序に対応する。<em>uid</em>は1,
2,
3のい
ずれかの値をとり、それぞれ<em>x</em>,
<em>y</em>,
<em>z</em>
方向に相当する。<em>gid</em>は1,
2,
3のい
ずれかの値をとり、それぞれ1番目,
2番目,
3
番目の逆格子ベクトルに相当する。</p></td>
</tr>
</tbody>
</table>
<p>ボルン有効電荷計算の場合、ベリー位相計算のあとにボルン有効電荷計算用のPHASE計算が行われます。この計算は、zeffディレクトリーにおいて行われます。この計算は非並列で行われ、通常数秒から数十秒程度で終了します。</p>
</section>
<section id="advanced-berry-results">
<span id="id120"></span><h3><span class="section-number">8.11.5. </span>計算結果<a class="headerlink" href="#advanced-berry-results" title="この見出しへのパーマリンク"></a></h3>
<p>計算が最後まで実行されると、以下のようなログが得られます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>--- Calculated effective charges ---
           [ 2.98266 0.00512 -0.00454 ]
Zeff( 2) = [ 0.00001 3.62664 -0.32666 ]
           [ -0.00010 0.27925 3.42264 ]
...
...
--- Symmetrized effective charges ---
           [ 2.98266 0.00000 -0.00000 ]
Zsym( 2) = [ 0.00000 3.62664 -0.32666 ]
           [ 0.00000 0.27925  3.42264 ]
...
...
--- Effective charges of all atoms ---
           [ 3.46565 -0.27885 -0.28289 ]
Zeff( 1) = [ -0.27885 3.14366  0.16333 ]
           [ 0.24184 -0.13963  3.42264 ]
...
...
--- Averaged effective charges ---
       [ 0.00151 -0.00000 0.00000 ]
Zave = [ 0.00000 0.00151 -0.00000 ]
       [ 0.00000 0.00000 -0.00587 ]
...
...
--- Corrected effective charges ---
           [ 3.46414 -0.27885 -0.28289 ]
Zeff( 1) = [ -0.27885 3.14215  0.16333 ]
           [ 0.24184 -0.13963  3.42850 ]
...
...
</pre></div>
</div>
<p>--- Calculated effective charges --- 以下に、計算された生のボルン電荷テンソルが、計算対象となった原子数分出力されます。次に、
--- Symmetrized effective charges ---
以下に対称化を施したボルン有効電荷テンソルが出力されます。その次に、 ---
Effective charges of all atoms ---
以下に、あらわに計算しなかった原子のボルン有効電荷も含めた結果が出力されます。あらわに計算しなかった原子のボルン有効電荷テンソルは、対称性を利用して計算されます。
--- Averaged effective charges
---には全原子で平均したボルン有効電荷テンソルが出力されます。全原子で平均したボルン有効電荷はすべての要素がゼロになるはずなので、この総和則を満たすように補正したボルン有効電荷テンソルが---
Corrected effective charges ---以下に出力されます。</p>
<p>基本的には、--- Corrected effective charges ---
以下の結果が最もよい結果となります。ただし、対称性の与え方が適切でない場合、またはあらわに計算した原子の数が中途半端な場合に「あらわに計算しなかった原子のボルン有効電荷を、対称性を利用して計算する」ことができなくなってしまうことがあります。このような場合は、--- Calculated effective charges ---
以下の結果を利用するようにしてください。</p>
</section>
<section id="id121">
<h3><span class="section-number">8.11.6. </span>例題<a class="headerlink" href="#id121" title="この見出しへのパーマリンク"></a></h3>
<p>AlNのボルン有効電荷を計算する例を紹介します。</p>
<p>入力データ</p>
<p>入力データは、PHASEによるSCF計算用のテンプレート入力、ekcalによるベリー位相計算によるテンプレート入力、そしてberry.pl用のコントロールファイルから成ります。</p>
<p>PHASEによるSCF計算用のテンプレート入力は、 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/born_revised/AlN/born/template_scf</span></code> の下にあります。この入力に特殊な設定はありませんが、構造最適化がなされないよう原子のmobile属性値はすべてoffと設定されています。また、対称性を自動的に処理する機能を有効にしています。</p>
<p>ekcalによるベリー位相計算のテンプレート入力は、 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/born_revised/AlN/born/template_berry</span></code> の下にあります。この入力も、通常の固定電荷計算の入力と全く同じです。</p>
<p>berry.plのコントロールファイルは、 <code class="code docutils literal notranslate"><span class="pre">samples/dielectric/lattice/born_revised/AlN/born/control</span></code> です。その内容は以下の通り。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>property=zeff
atom_list = 1 3
mesh1 = 6 6 15
mesh2 = 6 6 15
mesh3 = 6 6 15
scf_command = mpiexec -n NP $HOME/phase0/bin/phase ne=NE nk=NK
berry_command = mpiexec -n NP $HOME/phase0/bin/ekcal ne=NE_B
np = 1
ndir = 1
ne = 1
nk = 1
ne_b = 1
</pre></div>
</div>
<p>property = zeffとすることによって、ボルン有効電荷を計算することを指定しています。atom_listに13 とすることによって対象とする原子を指定しています。1番目の原子はAl,
3番目の原子はNです。AlNは計4つの原子から成る結晶ですが、2番目と4番目の原子のボルン有効電荷は対称性から求まるので計算の対象にはしていません。mesh1
mesh2,
mesh3によって逆格子ベクトルのメッシュを指定しています。この例では、すべての逆格子ベクトルに対してn1
= n2 = 6, J = 15としています。scf_command,
berry_commandによってPHASEおよびekcalの実行方法を指定しています。ここは、計算に利用する環境に合わせて適宜修正する必要があります。np,
ndir, ne, nk,
ne_bによって並列のさせ方を指定することができます。この例では、すべて1,
すなわち非並列で計算を行う指定となっています。</p>
<p>計算の実行</p>
<p>以下の要領で、berry.plを実行することができます。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>berry.pl<span class="w"> </span>control<span class="w"> </span>--mode<span class="o">=</span><span class="nb">exec</span>
</pre></div>
</div>
<p>計算時間は利用するCPUやコンパイラーなどに大きく依存します。Intel Core i7-2600&#64;3.40 GHzのCPUを搭載したマシンで実行したところ、ボルン有効電荷が得られるまで1,760秒かかりました。</p>
<p>計算結果</p>
<p>この計算によって得られた各原子のボルン有効電荷テンソルは、下記の通りです。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>           [ 2.50916 0.00000 -0.00000 ]
Zeff( 1) = [ 0.00000 2.50916  0.00000 ]
           [ 0.00000 0.00000  2.64124 ]
           [ 2.50916 0.00000 -0.00000 ]
Zeff( 2) = [ 0.00000 2.50916 -0.00000 ]
           [ 0.00000 0.00000  2.64124 ]
           [ -2.50916 -0.00000  0.00000 ]
Zeff( 3) = [ -0.00000 -2.50916 -0.00000 ]
           [ 0.00000 -0.00000  -2.64124 ]
           [ -2.50916 -0.00000  0.00000 ]
Zeff( 4) = [ -0.00000 -2.50916 -0.00000 ]
           [ 0.00000 -0.00000  -2.64124 ]
</pre></div>
</div>
<p>1番目と2番目の原子がAl, 3番目と4番目の原子がNです。</p>
</section>
<section id="id122">
<h3><span class="section-number">8.11.7. </span>berry.plを使わずにボルン有効電荷を計算する方法<a class="headerlink" href="#id122" title="この見出しへのパーマリンク"></a></h3>
<p>ボルン有効電荷の計算は、berry.plを利用せずとも行うことはできます。その手続きを説明します。</p>
<section id="id123">
<h4><span class="section-number">8.11.7.1. </span>SCF計算<a class="headerlink" href="#id123" title="この見出しへのパーマリンク"></a></h4>
<p>ボルン有効電荷を計算するためには、対象としたい原子を変位させたSCF計算を実行する必要があります。また、原子を変位させていないSCF計算も実行しておく必要があります。まずは変位させないSCF計算を通常通りに行います。ついで、対象とする原子ごとにその位置を<em>x</em>,
<em>y</em>, <em>z</em>方向に微小量（たとえば0.1
bohr）変位させた計算を行います。変位させる計算を行うためには、入力パラメーターファイルのatom_listブロック以下に定義できるdisplacementブロックを利用すると便利です。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure{
  …
  …
  atom_list{
    …
    …
    displacement{
      sw_displace_atom = on
      displaced_atom = 1
      ux = 0.1
      uy = 0
      uz = 0
    }
  }
}
</pre></div>
</div>
<p>sw_displace_atom = onとすると原子を変位させます。displaced_atomによって変位させる原子を指定します。ux,
uy, uzによって変位の<em>x,y,z</em>の値を長さの指定します。</p>
<p>以上の入力が作成できたら、通常通りPHASEを必要な回数実行します。</p>
</section>
<section id="id124">
<h4><span class="section-number">8.11.7.2. </span>ベリー位相計算<a class="headerlink" href="#id124" title="この見出しへのパーマリンク"></a></h4>
<p>SCF計算のあとに、ベリー位相計算を行います。前節で行ったすべてのSCF計算をもとに、固定電荷計算の入力を作成します。各々のSCF計算について、3方向の逆格子ベクトルのベリー位相計算用入力を作成します。ベリー位相計算を実行するには、入力パラメーターファイルに以下のように最上位にberry_phaseブロックを作成し、設定を行います。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>berry_phase{
  sw_berry_phase = on
  g_index = 1
  mesh{ n1 = 3, n2 = 3, J = 5 }
}
</pre></div>
</div>
<p>sw_berry_phase = onとするとベリー位相計算が有効になります。g_indexによって対象とする逆格子ベクトルを指定します。meshブロックを作成し、n1, n2,
Jによってメッシュパラメーターを指定します。このほか、SCF計算に対応するdisplacementブロックを作成しておくことと、file_names.dataにおいて対応するSCF計算のディレクトリーの下の電荷密度データを指すようにすることなどを忘れないようにしてください。</p>
<p>以上の入力が作成できたら、通常通りekcalを必要な回数実行します。</p>
</section>
<section id="id125">
<h4><span class="section-number">8.11.7.3. </span>ボルン有効電荷の計算<a class="headerlink" href="#id125" title="この見出しへのパーマリンク"></a></h4>
<p>最後にボルン有効電荷を計算します。以下の手続きを踏みます。</p>
<ol class="arabic simple">
<li><p>ボルン有効電荷計算用のディレクトリーを作成します（たとえば、zeff）。</p></li>
<li><p>ベリー位相データファイルberry.dataをすべて連結し、ファイルの先頭にその数を指定します。たとえば、21のベリー位相計算を行ったならばファイルの先頭に21と記述します。</p></li>
<li><p>ボルン有効電荷計算用のディレクトリーに、SCF計算用の入力ファイルと2.で得たberry.dataファイルをコピーします。</p></li>
<li><p>コピーした入力ファイルからdisplacementブロックを削除し、以下を挿入します。
ボルン有効電荷の計算においてSCF計算を行う必要はないので、controlブロックにおいてmax_iteration = 0とします。postprocessing以下の設定が、ボルン有効電荷を計算するための指示です。</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  condition = initial
  max_iteration = 0
}
postprocessing{
  polarization{
    sw_bp_property = on
    property = effective_charge
  }
}
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>PHASEを<em>非並列で</em>実行します。結果は、outputxxxファイルに、<a class="reference internal" href="#advanced-berry-results"><span class="std std-numref">8.11.5 章</span></a> 節で説明する形式で出力されます。</p></li>
</ol>
</section>
</section>
</section>
<section id="section-finite-electric-field">
<span id="id126"></span><h2><span class="section-number">8.12. </span>有限電場計算機能 (バージョン2019.02以降)<a class="headerlink" href="#section-finite-electric-field" title="この見出しへのパーマリンク"></a></h2>
<section id="id127">
<h3><span class="section-number">8.12.1. </span>概要<a class="headerlink" href="#id127" title="この見出しへのパーマリンク"></a></h3>
<p>有限電場計算機能とは、一様有限電場下において分極と電場のエネルギーを通常のエネルギーに加えた“エンタルピー”を極小化する計算機能です。この計算機能によって、印加した電場に対する応答としての巨視的な分極を求めることができます。得られた分極から誘電率を計算することや、有限電場下での原子に働く力よりボルン有効電荷を得ることも可能となっています。</p>
</section>
<section id="id128">
<h3><span class="section-number">8.12.2. </span>計算理論<a class="headerlink" href="#id128" title="この見出しへのパーマリンク"></a></h3>
<p>一様有限電場下の計算は、 <a class="reference internal" href="#souza02" id="id129"><span>[Souza02]</span></a> において提案されている処方箋に従って行われます。一様電場下におけるエンタルピーを、以下のように定義します。</p>
<div class="math notranslate nohighlight" id="advanced-finite-electric-field-eq1">
<span id="equation-advanced-finite-electric-field-eq1"></span><span class="eqno">(8.44)<a class="headerlink" href="#advanced-finite-electric-field-eq1" title="この数式へのパーマリンク"></a></span>\[F = E_{\rm KS} - \Omega \mathbf{P}_{\rm mac} \cdot \mathbf{E}\]</div>
<p><span class="math notranslate nohighlight">\(E_{\rm KS}\)</span> が通常のコーン・シャムハミルトニアンから得られる全エネルギー、<span class="math notranslate nohighlight">\(\Omega\)</span> が単位胞の体積、<span class="math notranslate nohighlight">\(\mathbf{P}_{\rm mac}\)</span> が巨視的な電気分極、<span class="math notranslate nohighlight">\(\mathbf{E}\)</span> が一様有限電場です。<span class="math notranslate nohighlight">\(\mathbf{P}_{\rm mac}\)</span> はベリー位相分極理論から計算することができます。<span class="math notranslate nohighlight">\(\mathbf{E}\)</span> は入力パラメーターです。このエンタルピーを極小化するために必要な微分は下記のように計算できます。</p>
<div class="math notranslate nohighlight" id="advanced-finite-electric-field-eq2">
<span id="equation-advanced-finite-electric-field-eq2"></span><span class="eqno">(8.45)<a class="headerlink" href="#advanced-finite-electric-field-eq2" title="この数式へのパーマリンク"></a></span>\[\begin{split}\ket{g_{n\mathbf{k}}} &amp;= \frac{f}{N_k} \hat{H}_{\rm KS} \ket{u_{n\mathbf{k}}} \\
 &amp;+ \frac{ife}{4\pi} \sum_{i=1}^3 \frac{\mathbf{E}\cdot\mathbf{a}_i}{N_{\perp}^{(i)}} \sum_{m=1}^{M} \left[ \ket{u_{m\mathbf{k}_+^{(i)}}} S_{mn}^{-1} \left( \mathbf{k},\mathbf{k}_+^{(i)} \right) - \ket{u_{m\mathbf{k}_-^{(i)}}} S_{mn}^{-1} \left( \mathbf{k},\mathbf{k}_-^{(i)} \right) \right]\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\ket{u_{n\mathbf{k}}}\)</span> が周期的な波動関数です。<span class="math notranslate nohighlight">\(\mathbf{k}_+, \mathbf{k}_-\)</span> は、逆格子ベクトルを<strong>b</strong><sub>i</sub>とするとそれぞれ<strong>k</strong>+<strong>b</strong><sub>i</sub>/<em>N</em><sub>i
,</sub>
<strong>k-b</strong><sub>i</sub>/<em>N</em><sub>i­</sub>です<span class="math notranslate nohighlight">\(S_{mn}\left( \mathbf{k},\mathbf{k}' \right)\)</span> は波動関数の重なりであり、<span class="math notranslate nohighlight">\(\Braket{u_{m\mathbf{k}} | u_{n\mathbf{k}'}}\)</span> と表すことができます。</p>
<p>このようにして計算された勾配を利用してエンタルピーを最適化すると、一様電場下での巨視的な分極 <span class="math notranslate nohighlight">\(\mathbf{P}_{\rm mac}\)</span> を計算することができます。この量から、さらに様々な誘電応答解析を実施することも可能です。たとえば、電場を印加した状態の分極から差分によって誘電率を得ることが可能です（微弱な電場 <span class="math notranslate nohighlight">\(\delta E\)</span> を与えた際に発生する分極 <span class="math notranslate nohighlight">\(\delta P\)</span> から、誘電率は <span class="math notranslate nohighlight">\(\varepsilon = 1+4\pi \frac{\delta P}{\delta E}\)</span> と計算することができる）。あるいは、有限電場下での原子に働く力から <span class="math notranslate nohighlight">\(eZ = \frac{\delta F}{\delta E}\)</span> という関係を用いてボルン電荷を得ることも可能です。</p>
</section>
<section id="id130">
<h3><span class="section-number">8.12.3. </span>入力<a class="headerlink" href="#id130" title="この見出しへのパーマリンク"></a></h3>
<p>一様有限電場下の計算をPHASE/0で実行するには、controlブロックの下でsw_fef
=
onとすることによって一様有限電場機能を利用することを指定し、さらにaccuracyブロックの下のfefブロックの下のelectric_filedブロックにおいて電場を入力します。具体的には以下のように指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>control{
  sw_fef = on
}
...
...
accuracy{
  fef{
    electric_field{
      ex = 1e-5
      ey = 1e-5
      ez = 1e-5
    }
  }
}
...
...
</pre></div>
</div>
<p>変数ex, ey, ezによって電場の<em>x</em>, <em>y</em>,
<em>z</em>成分を指定します。また、有限電場法を利用する場合はk点サンプリング手法に制限があります。以下のようにkshiftパラメーターをすべて0と設定してください（methodは無指定もしくはmonkとする）</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ksampling{
  kshift{ k1=0, k2=0, k3=0 }
}
</pre></div>
</div>
</section>
<section id="id131">
<h3><span class="section-number">8.12.4. </span>計算ソルバーについて<a class="headerlink" href="#id131" title="この見出しへのパーマリンク"></a></h3>
<p>有限電場法においては利用可能な計算ソルバーに本質的な制限があります。これは、有限電場法は非周期的な項
( <span class="math notranslate nohighlight">\(\mathbf{P}_{\rm mac} \cdot \mathbf{E}\)</span> )を追加するため、波動関数がハミルトニアンの固有状態ではなくなってしまうことに起因します。自由にユニタリ変換することができないため、たとえば部分空間対角化は利用できません（したがって部分空間対角化が必須であるDavidson系ソルバーはすべて利用不可です）。検証の結果「部分空間対角化を伴わないCG法」が最も収束の速い手法であることが分かったので、有限電場計算機能利用時はこのソルバーがデフォルトになります。</p>
</section>
<section id="id132">
<h3><span class="section-number">8.12.5. </span>出力<a class="headerlink" href="#id132" title="この見出しへのパーマリンク"></a></h3>
<p>PHASEを実行すると、ログファイル(output000ファイル)には以下の要領で各SCFイテレーションにおける電気分極の情報が出力されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>BP   = 0.006502276 0.006502276 0.006502276
Pel  = 0.000078647 0.000078647 0.000078647
Pion = 0.000000000 0.000000000 0.000000000
Pmac = 0.000078647 0.000078647 0.000078647
</pre></div>
</div>
<p>BP = の後にベリー位相が、Pelの後に分極の電子からの寄与が、Pionのあとに分極のイオンからの寄与が、Pmacに電子とイオンの分極の合計が出力されます。単位はすべて原子単位です。得られた分極から、誘電率やボルン電荷を以下の要領で計算することができます。</p>
<p>誘電率 <span class="math notranslate nohighlight">\(\varepsilon = 1+4\pi \frac{\delta P}{\delta E}\)</span></p>
<p>ボルン電荷 <span class="math notranslate nohighlight">\(eZ = \frac{\delta F}{\delta E}\)</span></p>
<p>電場が0なら分極も0, もしくは原子間力も0というケースでは一点の計算で上述の量を計算することができますが、そうでない場合は2点以上の計算の結果から <span class="math notranslate nohighlight">\(\frac{\delta P}{\delta E}\)</span> や <span class="math notranslate nohighlight">\(\frac{\delta F}{\delta E}\)</span> の値を計算するようにしてください。</p>
</section>
<section id="id133">
<h3><span class="section-number">8.12.6. </span>計算例<a class="headerlink" href="#id133" title="この見出しへのパーマリンク"></a></h3>
<p>AlP結晶の計算を有限電場法および従来法で行いました。その入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/FEF/AlP</span></code> にあります。8原子の系を採用しました。計算結果を以下にまとめます。</p>
<section id="id134">
<h4><span class="section-number">8.12.6.1. </span>計算結果<a class="headerlink" href="#id134" title="この見出しへのパーマリンク"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>物性値</p></th>
<th class="head"><p>計算結果</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>電子分極</p></td>
<td><p>0.000050916</p></td>
</tr>
<tr class="row-odd"><td><p>誘電率（有限電場法）</p></td>
<td><p>7.40</p></td>
</tr>
<tr class="row-even"><td><p>誘電率（従来法）</p></td>
<td><p>7.40</p></td>
</tr>
<tr class="row-odd"><td><p>ボルン電荷（有限電場法）</p></td>
<td><p>Al : 2.25, P : -2.27</p></td>
</tr>
<tr class="row-even"><td><p>ボルン電荷（従来法）</p></td>
<td><p>Al : 2.227, P : -2.227</p></td>
</tr>
</tbody>
</table>
<p>従来法とよく一致する結果が得られました。ボルン電荷の方も従来法とよく一致しています。有限電場法のボルン電荷の和がゼロになっていないのは、数値誤差によるものと考えられます。</p>
</section>
</section>
<section id="id135">
<h3><span class="section-number">8.12.7. </span>注意点<a class="headerlink" href="#id135" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p>有限電場機能を利用する場合、まずは通常のSCF計算を実施し、収束した波動関数と電荷密度を得ておくことが推奨されます。したがって、計算の手続きは以下のようになります。</p>
<ol class="arabic simple">
<li><p>対象としたい系のSCF計算を行う。</p></li>
<li><p>有限電場計算用のディレクトリーを作成し、そこに1.
で利用した入力ファイルと得られた波動関数データと電荷密度データをコピーする（ファイル名はそれぞれzaj.dataとnfchgt.data）</p></li>
<li><p>入力パラメーターファイルに有限電場計算用の入力の設定をほどこし、さらに初期波動関数・初期電荷密度はファイルから読み込むように設定する。具体的には下記のような記述を行う。</p></li>
</ol>
</li>
<li><p>分極を収束させるためにはSCF計算の収束判定として通常よりも厳しいものを採用する必要があることが多いです。Pelの収束具合を確かめながら必要な収束判定条件を決めていくことが推奨されます。上述のようにinitial_wavefunctionsとinitial_charge_densityをfileに設定しておけばそれまでの計算の結果を読み込んで動作するので、それまで行った計算は無駄にはなりません。</p></li>
<li><p>原子間力の計算結果からボルン電荷を得ることができますが、この機能はノルム保存擬ポテンシャルのみ対応しています。ウルトラソフト擬ポテンシャルの場合に得られる原子間力は不正確なので利用しないでください。</p></li>
</ul>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="souza02" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id129">Souza02</a><span class="fn-bracket">]</span></span>
<p>I. Souza, J. Íñiguez and D. Vanderbilt, “First-Principles Approach to Insulators in Finite Electric Fields” Physical Review Letters vol. 89 (2002) pp. 117602 1-4.</p>
</div>
</div>
</section>
</section>
<section id="id136">
<h2><span class="section-number">8.13. </span>陽電子寿命解析<a class="headerlink" href="#id136" title="この見出しへのパーマリンク"></a></h2>
<section id="id137">
<h3><span class="section-number">8.13.1. </span>機能の概要<a class="headerlink" href="#id137" title="この見出しへのパーマリンク"></a></h3>
<p>電子の反粒子である陽電子は、電子と同じ質量を持ち、正の電荷を持ちます。陽電子は電子と対消滅し、<span class="math notranslate nohighlight">\(\gamma\)</span>線を放出します。この陽電子消滅の現象を利用して、結晶の品質や、欠陥の研究が可能です。
ここで、陽電子消滅実験から有用な情報を引き出すのに、第一原理計算に基づいて陽電子寿命を予測し、実験結果と比較することが重要です。PHASEには、完全結晶における陽電子寿命を予測する機能があります。</p>
<p>陽電子寿命解析、以下の手順で計算を行います。</p>
<blockquote>
<div><ol class="upperalpha">
<li><p>はじめに
通常の電子状態計算（バンド計算）を実行します。PHASEには、擬ポテンシャル・平面波法が実装されているので、この手法に基づいて計算を行います。バンド計算により、価電子の電荷密度
<span class="math notranslate nohighlight">\(\rho_{v}\)</span>が得られます。全電子の電荷密度は次式で与えられます。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq1">
<span class="eqno">(8.46)<a class="headerlink" href="#equation-advanced-positron-eq1" title="この数式へのパーマリンク"></a></span>\[\rho_{e} = \rho_{v} + \rho_{c}\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(\rho_{c}\)</span>は、コア
電子の電荷密度です。CIAOで作成し公開されている擬ポテンシャル
のデータファイルには、自由な原子におけるコア電子の電荷密度の
情報が含まれています。このデータを読み込み <a class="reference internal" href="#equation-advanced-positron-eq1">(8.46)</a> を評価します。</p>
</li>
<li><p>陽電子波
動関数<span class="math notranslate nohighlight">\(\psi_{+}\)</span>は次式で与えられます（原子単位）。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq2">
<span class="eqno">(8.47)<a class="headerlink" href="#equation-advanced-positron-eq2" title="この数式へのパーマリンク"></a></span>\[\left\lbrack - \frac{1}{2}\Delta - \int_{}^{}d\overrightarrow{r^{'}}\frac{\rho_{e}\left( \overrightarrow{r^{'}} \right) - \rho_{n}\left( \overrightarrow{r^{'}} \right)}{\left| \overrightarrow{r} - \overrightarrow{r^{'}} \right|} + \mu_{c}\left( \rho\left( \overrightarrow{r} \right) \right) \right\rbrack\psi_{+}\left( \overrightarrow{r} \right) = \varepsilon\psi_{+}\left( \text{cr} \right)\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(\mu_{c}\)</span>
は、電子・陽電子相関に由来する
ポテンシャルエネルギーであり、<span class="math notranslate nohighlight">\(\rho_{n}\)</span>は、原子核
の点電荷を表します。いま、陽電子は固体中に1個しかないと仮定す
るので、最も安定な固有状態のみを求めればよいことになります。
したがって、陽電子の固有状態はブリルアンゾーン中の<span class="math notranslate nohighlight">\(\Gamma\)</span>点に属します。この波動関数を平面波によって展開します。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq3">
<span class="eqno">(8.48)<a class="headerlink" href="#equation-advanced-positron-eq3" title="この数式へのパーマリンク"></a></span>\[\psi_{+} = \sum_{\overrightarrow{G}} C_{\overrightarrow{G}} \exp \left( i\overrightarrow{G} \cdot \overrightarrow{r} \right)\]</div>
<p>ここで、逆格子周期ベクトル<span class="math notranslate nohighlight">\(\overrightarrow{G}\)</span>の和を有限に抑えるため、平面波の運動エネルギーの上限を設定します。</p>
</li>
<li><p>陽電子密度を求めます。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq4">
<span class="eqno">(8.49)<a class="headerlink" href="#equation-advanced-positron-eq4" title="この数式へのパーマリンク"></a></span>\[\rho_{p}\left( \overrightarrow{r} \right) = \left| \psi_{+} \right|^{2}\]</div>
</li>
<li><p>電子及び陽電子の
電荷密度を用いて、下記の式を評価し、陽電子寿命を計算します。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq5">
<span class="eqno">(8.50)<a class="headerlink" href="#equation-advanced-positron-eq5" title="この数式へのパーマリンク"></a></span>\[\frac{1}{\tau} = \pi r_{e}^{2}c\int_{}^{}dr\rho_{e}\left( r\right)\rho_{p}\left( r \right)\Gamma\left( \rho_{e} \right)\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(r_{e}\)</span> は、電子
の古典半径、<span class="math notranslate nohighlight">\(c\)</span>は光速を表します。<span class="math notranslate nohighlight">\(\Gamma\)</span> は、増大因子であり、電子・陽電子間の相関に由来するものです。PHASEでは、上式の評価において、下記の近似を用いています。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq6">
<span class="eqno">(8.51)<a class="headerlink" href="#equation-advanced-positron-eq6" title="この数式へのパーマリンク"></a></span>\[\rho_{e}\Gamma\left( \rho_{e} \right) \cong \rho_{v}\Gamma\left( \rho_{v} \right) + \rho_{c}\Gamma\left( \rho_{c} \right)\]</div>
<p>この近似が成り立つためには、
価電子とコア電子の分布の重なりが小さいことが条件となります。</p>
</li>
</ol>
</div></blockquote>
<p>本計算では、電子・陽電子間の相関に対して、局所密度近似を用いています。すなわち、相関ポテンシャルと増大因子は、均一な電子ガス中に陽電子が1個ある場合に計算された結果をもとに、電子密度の関数として与えられます。増大因子に関しては、次式が提案されています <a class="reference internal" href="#puska95" id="id138"><span>[Puska95]</span></a> 。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq7">
<span class="eqno">(8.52)<a class="headerlink" href="#equation-advanced-positron-eq7" title="この数式へのパーマリンク"></a></span>\[\Gamma = 1 + 1.23r_{s} + 0.9889r_{s}^{3/2} - 1.482r_{s}^{2} + 0.3956_{s}^{5/2} + r_{s}^{3}/6\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(\frac{4\pi}{3}r_{s}^{3} = 1/\rho_{e}\)</span>です。また、ギャップのある系、すなわち誘電体においては、金属よりも電子のスクリーニング効果が小さいため、次の補正を行う事を推奨します <a class="reference internal" href="#puska91" id="id139"><span>[Puska91]</span></a> , <a class="reference internal" href="#nakamoto08" id="id140"><span>[Nakamoto08]</span></a> 。</p>
<div class="math notranslate nohighlight" id="equation-advanced-positron-eq8">
<span class="eqno">(8.53)<a class="headerlink" href="#equation-advanced-positron-eq8" title="この数式へのパーマリンク"></a></span>\[\Gamma = 1 + 1.23r_{s} + 0.9889r_{s}^{3/2} - 1.482r_{s}^{2} + 0.3956_{s}^{5/2} + \left( 1 - 1/\varepsilon_{\text{ele}} \right)r_{s}^{3}/6\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(\varepsilon_{\text{ele}}\)</span>は電子系誘電率です。その値が実験により測定されていない場合には、UVSORにより、密度汎関数理論に基づいて評価することができます。計算手法の詳細については、 <a class="reference internal" href="#nakamoto08" id="id141"><span>[Nakamoto08]</span></a> を参照ください。</p>
</section>
<section id="id142">
<h3><span class="section-number">8.13.2. </span>入力パラメータ<a class="headerlink" href="#id142" title="この見出しへのパーマリンク"></a></h3>
<p>Si結晶中における陽電子寿命の計算を例とします。
計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/positron/Si</span></code> です。</p>
<p>Si結晶中における陽電寿命計算の入力パラメータファイルにおいて、陽電子計算に関する部分のみを説明します。</p>
<p>Controlタグで陽電子寿命計算を有効に設定</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Control{
   positron = BULK
}
</pre></div>
</div>
<p>Controlタグ中に　positron=BULK　と宣言すると、
通常の電子状態計算(バンド計算）を行った後に、陽電子寿命計算を行います。</p>
<p>accuracy　タグで陽電子寿命計算のオプションを指定</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
  cutoff_pwf = 50.00 rydberg
  positron_convergence{
    num_extra_bands = 8
    delta_eigenvalue = 1.d-8 rydberg
    succession = 6
    num_max_iteration = 32000
    dtim = 0.01
    epsilon_ele = 12
  }
}
</pre></div>
</div>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p>cutoff_pwf = 50.00 rydberg</p></td>
<td><p>これは、陽電子の波動関数を</p>
<p>展開する際の[
<a class="reference internal" href="#equation-advanced-positron-eq3">(8.48)</a>
参照]カットオフエネルギーです。</p>
</td>
</tr>
<tr class="row-even"><td><p>positron_convergence｛｝</p></td>
<td><p>このタグの中
で、陽電子波動関数を反復計算によ
って求める、すなわち
<a class="reference internal" href="#equation-advanced-positron-eq2">(8.47)</a>
を解く
、際に、どのように収束解を得よう
とするのか、その指定を行います。</p></td>
</tr>
<tr class="row-odd"><td><p>num_extra_bands = 8</p></td>
<td><p>陽電子の固有状態
は、基底状態1個のみを計算すれば
充分です。しかし、反復計算で収束
解を得るには、それ以外に、基底状
態よりもエネルギーの高い状態の波
動関数も計算する必要があり、その
個数を指定します。なお、求める波
動関数は全てブリルアンゾーン中の
<span class="math notranslate nohighlight">\(\Gamma\)</span>点に属します。</p></td>
</tr>
<tr class="row-even"><td><p>delta_eigenvalue = 1.d-8 rydberg</p></td>
<td><p>5.の説明参照</p></td>
</tr>
<tr class="row-odd"><td><p>succession = 6</p></td>
<td><p>反復計算において、前回と今回の
物理量（7.参照）が4.で与えられた
範囲内で一致し、5.で指定された回
数だけ連続して、この条件を満たせ
ば、計算は収束したとみなします。</p></td>
</tr>
<tr class="row-even"><td><p>num_max_iteration = 32000</p></td>
<td><p>計算は、この数繰り返すと
、収束していなくても終了します。</p></td>
</tr>
<tr class="row-odd"><td><p>dtim = 0.01</p></td>
<td><p>繰り返し計算において、次の波動関
数をどれだけ大きく変化させるかの
尺度であり、dtimが大きいほど収束
が早くなります。しかし、あまり大
きいと収束解が得られなくなり、こ
の値が小さいほど、安定に収束解が
得られますが、小さくするほど収束
が遅くなります。したがって、この
値は計算する系により、ユーザーが
最適な値を探すことを推奨します。</p></td>
</tr>
<tr class="row-even"><td><p>epsilon_ele = 12</p></td>
<td><p>epsilon_eleは、ギャップのある系に
対して、LDAの電子系誘電率補正を
行う際に用いるtagです。=の後には
、誘電率（Siの場合12）を用います
。もし、誘電率の補正を行わないの
であれば（たとえば、金属の計算を
行う場合）、8.の行は削除します。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id143">
<h3><span class="section-number">8.13.3. </span>計算結果の出力<a class="headerlink" href="#id143" title="この見出しへのパーマリンク"></a></h3>
<p>陽電子寿命予測計算を行うと、output000フィルと3個のcube
fileが出力されます。</p>
<p>ログ出力ファイル　output000</p>
<p>このファイルの最初の部分は、Siの電子バンドの計算に関するものです。電子のバンド計算が終わり、電子の電荷密度が得られた後、陽電子の計算が行われます。</p>
<p>出力における“--- initial positron energy eigen values ---”からが陽電子計算に関するものです。繰り返し計算により、陽電子の波動関数が決定されます。下記の
出力は、繰り返し計算のはじめにおいて、固有値が、14.6379(eV)であることを示しています。extra
bandsはそれよりもエネルギーの
高い固有値(14.9628460558-15.0292289699）を表します。繰り返し計算の2回目では、固有値が、
0.0021898139(eV)　となっています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>--- initial positron energy eigen values ---
 === positron eigen values ===
     14.6378982055
 -- extra_bands --
     14.9628460558     14.6842242625     14.9879179620     15.2755174303
     14.8070539395     14.6061318397     14.8086346971     15.0292289699
 === positron eigen values ===
      0.0021898139
 -- extra_bands --
      0.0892687578      0.1056325893      0.2037689630      0.2140559068
      0.3115605599      0.3359746459      0.3540270556      0.4738130045
</pre></div>
</div>
<p>ファイルの下の方には、次のような出力があります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>***************************************************
 positron lifetime(ps)   220.184723312044
 core rate   3.79328791767622      %
</pre></div>
</div>
<p>これは、陽電子の固有値を求める計算が収束し、陽電子の寿命が220psと計算されたことを示しています。core
rateは、全消滅速度に対するコア電子の消滅速度の割合を示します。</p>
<p>Cubeファイル</p>
<p>計算が終了すると、電子の電荷分布、陽電子の電荷分布、電子・陽電子ペアの分布が、ファイルelectron.cube、positron.cube、ep_pair.cubeに出力されます。これらのファイルはGaussian
cube 形式であり、可視化できます。 図
5‑22にSi結晶における計算結果を示します。価電子は主として、結合領域に存在し、陽電子は、隙間領域に存在することが分かります。陽電子の波動関数が広がり運動エネルギーが低下した方がエネルギー的に有利であることから、一般に陽電子は隙間領域に存在する傾向があります。電子・陽電子対分布を <a class="reference internal" href="#advanced-positron1"><span class="std std-numref">図 8.25</span></a> (c)に示します。この分布が高いところで、陽電子が大きな確率で消滅することになります。</p>
<figure class="align-default" id="advanced-positron1">
<img alt="../_images/image36.svg" src="../_images/image36.svg" /><figcaption>
<p><span class="caption-number">図 8.25 </span><span class="caption-text">Si結晶中の価電子分布(a)、陽電子分布(b)、電子・陽電子対分布(c)</span><a class="headerlink" href="#advanced-positron1" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id144">
<h3><span class="section-number">8.13.4. </span>使用上の注意<a class="headerlink" href="#id144" title="この見出しへのパーマリンク"></a></h3>
<p>陽電子寿命の計算における注意点です。</p>
<ul class="simple">
<li><p>擬ポテンシャルの選択</p></li>
</ul>
<p>元素によっては、セミコア状態を持つものがあります。ここで、セミコア状態とは、コア電子の内、軌道が空間的に広がり、コア電子の分布と価電子の分布との重なりが無視できない場合のことです。この場合、セミコア電子を価電子として取り扱い、擬ポテンシャルを作成することが望まれます。公開されている擬ポテンシャルには、元素によっては、このようにして作成されたものがあり、その際はこれを利用することを推奨します。もし、そのような擬ポテンシャルが作成されていなければ、CIAOを用いて作成することもできます。</p>
<ul class="simple">
<li><p>カットオフエネルギーの選択</p></li>
</ul>
<p>Si結晶のバンド計算において、電子波動関数、電荷密度、陽電子波動関数に対するカットオフエネルギーを以下のように指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
  cutoff_wf =  50.00  rydberg  ! cke_wf
  cutoff_cd =  200.00  rydberg  ! cke_cd
  cutoff_pwf = 50.00 rydberg
}
</pre></div>
</div>
<p>これらの値を変化させて、計算された寿命が十分収束していることを確かめる必要があります。</p>
<ul class="simple">
<li><p>出力</p></li>
</ul>
<p>陽電子の波動関数は、電子の波動関数と同様、繰り返し計算によって求められます。各繰り返しにおいてoutput000ファイルには、次のような出力があります（ここでは、繰り返しの最後における出力を表示しています）。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=== positron eigen values ===
     -0.5674635596
 -- extra_bands --
     -0.0490686179     -0.0460091253     -0.0446118499     -0.0275856742
     -0.0102856694      0.0069403602      0.0274419414      0.2284487012
lifetime:    220.180365487100        220.179503204077
</pre></div>
</div>
<p>ここで、計算終了近くで、陽電子の固有値（positron eigen value）が十分収束していることを確かめます。サンプルでの出力（output000)では、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-0.5674635596
-0.5674635638
</pre></div>
</div>
<p>などとなっており、十分収束していることが分かります。
また、上記の出力で220.180365487100, 220.179503204077といった数値がありますが、これは、繰り返し計算において、
前回計算された、寿命と今回計算された寿命を示しており、繰り返し計算により、寿命の値が収束に近づいている事を示唆しています。</p>
<p>通常の電子のバンド計算が十分収束しており、かつ使用上の注意の事項を確認できれば、計算は十分考慮されたものであると考えてよいでしょう。</p>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="puska95" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id138">Puska95</a><span class="fn-bracket">]</span></span>
<p>M. J. Puska, A. P. Seitsonen, and R. M. Nieminen, ``Electron-positron Car-Parrinello Methods: Self-consistent Treatment of Charge Densities and Ionic Rel axations'', Phys. Rev. B <strong>52</strong> (1995) p. 10947.</p>
</div>
<div class="citation" id="puska91" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id139">Puska91</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="13">
<li><ol class="upperalpha simple" start="10">
<li><p>Puska, ``Ab-initio Calculations of Positron Annihilation Rates in Solids'', J. Phys. Condens. Matter <strong>3</strong> (1991) p. 3455.</p></li>
</ol>
</li>
</ol>
</div>
<div class="citation" id="nakamoto08" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Nakamoto08<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id140">1</a>,<a role="doc-backlink" href="#id141">2</a>)</span>
<p>A. Nakamoto, M. Saito, T. Yamasaki, M. Okamoto, T. Hamada, and T. Ohno, ``Two-Component Density Functional Calculations on Positron Lifetimes for Band-Gap Crystals'', Jpn. J. Appl. Phys. <strong>47</strong> (2008) p. 2213.</p>
</div>
</div>
</section>
</section>
<section id="section-wannier">
<span id="id145"></span><h2><span class="section-number">8.14. </span>ワニエ関数<a class="headerlink" href="#section-wannier" title="この見出しへのパーマリンク"></a></h2>
<section id="id146">
<h3><span class="section-number">8.14.1. </span>機能の概要<a class="headerlink" href="#id146" title="この見出しへのパーマリンク"></a></h3>
<p>電子状態は結晶全体に広がったブロッホ波と呼ばれる波として表されます。ブロッホ波をk空間に関してフーリ
エ変換することにより得られる局在した関数をワニエ関数と呼びます。ワニエ関数の中心位置は電子分布の平均
位置を表すため、その和から結晶の分極を容易に知ることができます。また、ワニエ関数の2乗は電子の分布を
表すため、化学結合に関する知見が得られます。
一般にワニエ関数は一意に定まりません。ワニエ関数の広がりが最小になるように変換することにより得られ
る、一意に定まる関数を最大局在ワニエ関数といいます。</p>
<p>最大局在ワニエ関数はワニエ関数の広がりを表す汎関数（広がり汎関数）を最小にするようにブロッホ波をユ
ニタリー変換して求めます。広がり汎関数はユニタリー変換行列の関数で、広がり汎関数をユニタリー変換行列
に関して微分して得られる行列はワニエ関数の広がりを狭めるユニタリー変換の方向になっています。この方向
にわずかにユニタリー変換していくことで、ワニエ関数の広がりを最小にすることができます。</p>
</section>
<section id="si">
<h3><span class="section-number">8.14.2. </span>計算例：Siの最大局在ワニエ関数<a class="headerlink" href="#si" title="この見出しへのパーマリンク"></a></h3>
<p>最大局在ワニエ関数を計算するには、PostprocessingでWannier
関数を計算することを指定します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Postprocessing{
    wannier{
        sw_wannier = ON
        eps_grad = 1.d-3
        dt = 1.d-4
        max_iteration = 1000
        filetype = cube
    }
}
</pre></div>
</div>
<p>汎関数の勾配の大きさがeps_grad 以下になったら計算は終了します。dt
は最急降下法の仮想的な時間刻みです。 繰り返しがmax_iteration
を超えたら計算は停止します。ワニエ関数の出力ファイルはGauusian
cube形式に指定します。ワニエ関数のファイルの拡張子がcube
になるように、以下のよう にfile_names.data にファイルポインタF_WANNIER
を記述します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&amp;fnames
F_INP = &#39;./nfinput.data&#39;
F_POT(1) = &#39;./Si_ldapw91_nc_01.pp&#39;
F_WANNIER = &#39;./nfwannier.cube&#39;
/
</pre></div>
</div>
<p>この機能は<span class="math notranslate nohighlight">\(\Gamma\)</span>点のみの計算でしか使用できません。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ksampling{
    method = gamma
}
</pre></div>
</div>
<p>また、並列計算には対応していません。並列計算で収束した結果を得ている場合は、非並列の継続処理としてワニエ関数の計算をしてください。</p>
<p>Si のワニエ関数の計算例題は、 <code class="code docutils literal notranslate"><span class="pre">samples/wannier/Si8</span></code>
です。計算を実行すると、ワニエ関数の出力として、nfwannier.00001.cube
といったファイルが16 個出力されます。それらの一つを可視化した結果を <a class="reference internal" href="#advanced-wan-for-si-and-gaas"><span class="std std-numref">図 8.26</span></a> に示します。最大ワニエ関数はSi-Si
結合間に局在していることがわかります。これは、Si
結晶の結合が共有結合であることを示しています。</p>
<figure class="align-default" id="advanced-wan-for-si-and-gaas">
<img alt="../_images/image23.png" src="../_images/image23.png" />
<figcaption>
<p><span class="caption-number">図 8.26 </span><span class="caption-text">Si 結晶(a)とGaAs 結晶(b)の最大局在ワニエ関数</span><a class="headerlink" href="#advanced-wan-for-si-and-gaas" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>期待しない局所極小に収束してしまうことがありますが、sw_random_wannier
をON
にしてランダムな状態から計算を始めることでこの問題が解決できることがあります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Postprocessing{
    wannier{
        ...
        sw_randomize = ON
        ...
    }
}
</pre></div>
</div>
<p>また、収束が不十分な状態で計算が終了しているようでしたら、sw_continue
をON にして計算を継続してください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Postprocessing{
    wannier{
        ...
        sw_continue = ON
        ...
    }
}
</pre></div>
</div>
</section>
<section id="wannier90">
<h3><span class="section-number">8.14.3. </span>Wannier90を用いたワニエ関数解析<a class="headerlink" href="#wannier90" title="この見出しへのパーマリンク"></a></h3>
<section id="id147">
<h4><span class="section-number">8.14.3.1. </span>機能の概要<a class="headerlink" href="#id147" title="この見出しへのパーマリンク"></a></h4>
<p>Wannier90プログラム(<a class="reference external" href="http://www.wannier.org/">http://www.wannier.org/</a>) と連携することによってワニエ関数を出力することも可能です。Wannier90プログラムと連携することによって、PHASEに組み込まれたワニエ関数解析機能では実施することのできない、以下の計算を行うことが可能です。</p>
<ul class="simple">
<li><p>Γ点だけでなく、一般の<strong>k</strong>点サンプリングでワニエ関数を出力することが可能</p></li>
<li><p>ワニエ補間により、バンド構造を得ることが可能</p></li>
<li><p>ワニエ補間により、フェルミ面や逆空間における等エネルギー面の描画が可能</p></li>
</ul>
<p>ここでは、PHASEをWannier90と連携させて上記のような計算を行う方法を説明します。本機能を利用する場合は、上述のウェブサイトからWannier90プログラムを入手し、コンパイル作業を行っておいてください。</p>
<p>計算方法</p>
<p>Wannier90と連携して解析を行うには、以下のような処理を行います。Wannier90の入力ファイル作成方法は、Wannier90のユーザーマニュアルを参照してください。</p>
<ol class="arabic simple">
<li><p>Wannier90の入力データを作成します。ファイル名は<em>seedname</em>.winとします。<em>seedname</em>は任意の文字列で、系の名前などを指定します。</p></li>
<li><p>Wannier90を、以下のように“プリプロセスモード”で実行します。</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wannier90.x -pp seedname
</pre></div>
</div>
<p>この作業によって、Wannier90が必要とするデータの情報を記録したファイルが作成されます。このファイルの情報をもとにPHASEの入力ファイルを作成します。</p>
<ol class="arabic simple" start="3">
<li><p>PHASEの入力パラメータファイルを作成します。格子定数や<strong>k</strong>点サンプリングをWannier90の入力に合わせて編集します。その具体例は例題において紹介します。さらに、<strong>postprocessing</strong>ブロックに以下を追記します。</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  wannier{
    seedname = &quot;seedname&quot;
    sw_wannier90 = on
    nb_wan90 = wannier90で利用するバンド数
  }
}
</pre></div>
</div>
<p>変数seednameに上述のseednameを二重引用符で指定します。<strong>sw_wannier90</strong>を<strong>on</strong>とすることによってWannier90が必要とするファイルを出力することができます。<strong>nb_wan90</strong>には、Wannier90で利用するバンド数を指定します。PHASEのバンド数以下の数値にする必要があります。</p>
<ol class="arabic simple" start="4">
<li><p>PHASEを通常通り実行します。その結果、Wannier90が必要とする行列要素データや固有値データの記録されたファイルが得られます。ただし、Wannier90が利用するデータの出力は非並列計算で行う必要があるので、並列計算をしたい場合はひとまずsw_wannier90をoffとして計算を収束させたあとにsw_wannier90をonとし、非並列の継続計算でWannier90用の出力を行います。</p></li>
<li><p>Wannier90を実行します。</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wannier90.x seedname
</pre></div>
</div>
<p>その結果、Wannier90のログ出力やワニエ関数データのほか、Wannier基底のタイトバインディングハミルトニアンデータなどが得られます。seedname.winの設定によっては、そのほかバンド構造やフェルミ面を構築するために必要なデータ、1次元伝導解析の結果なども得られます。</p>
</section>
<section id="id148">
<h4><span class="section-number">8.14.3.2. </span>ワニエ補間<a class="headerlink" href="#id148" title="この見出しへのパーマリンク"></a></h4>
<p>wan_interpプログラムは、ワニエ補間を行ってバンド構造やフェルミ面の計算を行うプログラムです。そのソースコードは、src_wan_interp以下にあります。コンパイルするにはこのディレクトリーへ移り、コンパイル用のシェルスクリプト、make.sh中のFortran90コンパイラーとLAPACKライブラリーの設定を行ったあとmake.shを実行してください。なお、ワニエ補間によるバンド構造やフェルミ面の計算は、Wannier90本体によって実施することも可能です。その方法は、Wannier90のユーザーマニュアルを参照してください。Wannier90によって行う場合は、band.plによるバンド構造図の作成やPHASE-Viewerによるフェルミ面の描画などは行えません。</p>
<p>wan_interpプログラムは、以下のファイルを必要とします。</p>
<ul class="simple">
<li><p>seedname_hr.datファイル：Wannier90プログラムによって出力される、ワニエ基底のタイトバインディングハミルトニアンデータです。</p></li>
<li><p>seedname.nnkpファイル：Wannier90が必要とするデータを作成するために必要な情報が記録されたファイルです。Wannier90を“プリプロセスモード”で実行すると得られるファイルです。</p></li>
<li><p>kpoint.dataファイル：計算したい<strong>k</strong>点の情報が記録されたファイル。データフォーマットは、PHASEの標準のkpoint.dataファイルのフォーマットです。その作成方法は、バンド構造図の場合はバンド計算の項を、フェルミ面の場合はPHASE-Viewerユーザーマニュアルの逆空間ビューアーの項を参照してください。</p></li>
<li><p>nfefermi.dataファイル：フェルミエネルギーの値が記録されたファイルです。PHASEから出力されますので、wan_interpプログラムを実行するディレクトリーにコピーしておいてください。</p></li>
<li><p>fs.dataファイル（フェルミ面の場合）：PHASE-Viewerがフェルミ面を描画する際に利用する補助データが記録されたファイルです。PHASE-Viewerの手続きによってフェルミ面用の<strong>k</strong>点データファイルを作成した場合自動的に作成されます。</p></li>
</ul>
<p>以上のファイルを揃えたら、つぎの要領で実行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wan_interp seedname
</pre></div>
</div>
</section>
<section id="id149">
<h4><span class="section-number">8.14.3.3. </span>計算例題<a class="headerlink" href="#id149" title="この見出しへのパーマリンク"></a></h4>
<p>具体例として、GaAs結晶のケースを説明します。この例題の入力ファイルは、 <code class="code docutils literal notranslate"><span class="pre">samples/wan90/GaAs</span></code> 以下にあります。</p>
<ul class="simple">
<li><p>ワニエ関数の出力</p></li>
</ul>
<p>まず、Wannier90を以下のように実行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wannier90.x –pp gaa
</pre></div>
</div>
<p>この操作によって、必要な情報がgaas.nnkpというファイルに出力されます。このファイルの記述をもとにPHASEの入力ファイルを作成します。</p>
<p>まず、gaas.nnkpファイルには次のような書式で単位胞の情報がÅ単位で記述されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>begin real_lattice
0.0000000 2.8265001 2.8265001
2.8265001 0.0000000 2.8265001
2.8265001 2.8265001 0.0000000
end real_lattice
</pre></div>
</div>
<p>この指定に従い、PHASEの入力パラメーターファイルの単位胞の指定は以下のようになっています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>structure{
  unit_cell{
    #units angstrom
    a=5.653, b=5.653, c=5.653
    alpha=90, beta=90, gamma=90
  }
  symmetry{
    tspace{
      lattice_system = facecentered
    }
  }
}
</pre></div>
</div>
<p>この例では、ブラベー格子を利用して単位胞の指定を行っています。GaAsは面心立方格子なので、<strong>lattice_system</strong>パラメーターに<strong>facecentered</strong>が指定されています。</p>
<p>また、gaas.nnkpにおいては<strong>k</strong>点サンプリングの方法が次のように指定されています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>begin kpoints
64
0.00000000 0.00000000 0.00000000
0.00000000 0.00000000 0.25000000
0.00000000 0.00000000 0.50000000
0.00000000 0.00000000 0.75000000
0.00000000 0.25000000 0.00000000
0.00000000 0.25000000 0.25000000
0.00000000 0.25000000 0.50000000
…
…
end kpoints
</pre></div>
</div>
<p>この通りに指定するため、PHASEの入力ファイルにおいては以下のように<strong>k</strong>点サンプリングを“直接指定モード”を利用して指定しています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>accuracy{
  ksampling{
    method = directin
    kpoints{
      #tag kx ky kz denom weight
          0 0 0 4 1
          0 0 1 4 1
          0 0 2 4 1
          0 0 3 4 1
          0 1 0 4 1
          0 1 1 4 1
          0 1 2 4 1
            …
            …
    }
  }
}
</pre></div>
</div>
<p>“method=directin”によってサンプルする<strong>k</strong>点を直接指定することが可能です。kpointsテーブルにおいて、<strong>kx</strong>,
<strong>ky</strong>, <strong>kz</strong>,
<strong>denom</strong>,<strong>weight</strong>によって<strong>k</strong>点を指定します。<strong>k</strong>点の座標は(kx/denom,
ky/denom, kz/denom)、その重みがweightです。</p>
<p>Postprocessingブロックでは、Wannier90用の出力を行う設定が施されています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  wannier{
    seedname = &quot;gaas&quot;
    sw_wannier90 = ON
    nb_wan90 = 8
  }
}
</pre></div>
</div>
<p>Wannier90用の出力は非並列計算で行う必要があるので、並列計算をしたい場合はひとまずsw_wannier90をoffとして計算を収束させたあとにsw_wannier90をonとし、継続計算で非並列の計算を行い、Wannier90用の出力を行います。</p>
<p>PHASEを実行し、Wannier90用のデータが得られたら、Wannier90を-ppをつけずに行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wannier90.x gaas
</pre></div>
</div>
<p>Wannier90による計算が終了すると、gaas_00001.xsf, gaas_00002.xsf,…
などのファイルが作成されますが、これはXCrysDenプログラム（<a class="reference external" href="http://www.xcrysden.org/">http://www.xcrysden.org/</a>）を利用して可視化することのできるワニエ関数データです。XCrysDenプログラムを利用すればワニエ関数を可視化することができますが、PHASE-Viewerによって可視化を行う場合はGaussian
cube形式に変換する必要があります。この作業は、PHASEパッケージに含まれるconv.pyというPythonスクリプトを利用することによって実現することができます。<a class="reference internal" href="#advanced-wan90-gaas"><span class="std std-numref">図 8.27</span></a>
に、本例題によって得られるワニエ関数をXCrysDenで可視化した図を示します。</p>
<figure class="align-default" id="advanced-wan90-gaas">
<img alt="../_images/image24.png" src="../_images/image24.png" />
<figcaption>
<p><span class="caption-number">図 8.27 </span><span class="caption-text">GaAsのワニエ関数</span><a class="headerlink" href="#advanced-wan90-gaas" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>ワニエ補間</p></li>
</ul>
<p>Wannier90には、計算したワニエ関数を基底にタイトバインディングハミルトニアンを構築する機能が備わっており、この機能を利用することによって通常の方法よりも少ない計算量でバンド構造やフェルミ面、等エネルギー面などの描画などを行うことが可能です。この作業は、wan_interpプログラムを利用して行います。この例では、GaAsの伝導体下端付近の等エネルギー面を描画する方法を紹介します。</p>
<p>等エネルギー面の描画に必要なデータを計算するためには、PHASE-Viewerの“逆空間ビューアー”を利用します。その方法はPHASE-Viewerユーザーマニュアルを参照してください。“逆空間ビューアー”によってkpoint.dataファイルが作成されるので、このファイルと、ワニエ関数計算によって得られたgaas.nnkpファイル、gaas_hr.datファイルのほか、PHASEによって得られたnfefermi.dataファイルを一つのディレクトリーにまとめ、そのディレクトリーにおいてwan_interpプログラムを実行します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% wan_interp gaas
</pre></div>
</div>
<p>すると、ワニエ補間によってkpoint.dataファイルに記録された<strong>k</strong>点の固有値データが計算され、nfenergy.dataというファイルに記録されます。得られたファイルを、“逆空間ビューアー”によってkpoint.dataファイルを作成したディレクトリーにコピーします。以上の作業で等エネルギー面を描画するための準備は完了です。得られた伝導体下端付近の等エネルギー面をPHASE-Viewerで可視化した図 <a class="reference internal" href="#advanced-wan90-gaas-isosurface"><span class="std std-numref">図 8.28</span></a>
に示します。</p>
<figure class="align-default" id="advanced-wan90-gaas-isosurface">
<img alt="../_images/image25.png" src="../_images/image25.png" />
<figcaption>
<p><span class="caption-number">図 8.28 </span><span class="caption-text">GaAs結晶の伝導体下端の等エネルギー面</span><a class="headerlink" href="#advanced-wan90-gaas-isosurface" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id150">
<h3><span class="section-number">8.14.4. </span>使用上の注意<a class="headerlink" href="#id150" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p>ワニエ関数出力は、非並列計算で行う必要があります。並列計算を行う場合はひとまず<strong>sw_wannier90</strong>を<strong>off</strong>として計算を収束させたあとに<strong>sw_wannier90</strong>を<strong>on</strong>とし、非並列の継続計算でWannier90用の出力を行ってください。</p></li>
<li><p>本機能で利用できる擬ポテンシャルは、ノルム保存型のみです。</p></li>
</ul>
</section>
</section>
<section id="boltztrap-2019-01">
<span id="section-boltztrap"></span><h2><span class="section-number">8.15. </span>BoltzTraPを利用した解析(バージョン2019.01以降)<a class="headerlink" href="#boltztrap-2019-01" title="この見出しへのパーマリンク"></a></h2>
<p>BoltzTraP <a class="reference internal" href="#madsen06" id="id151"><span>[Madsen06]</span></a> , <a class="reference internal" href="#madsen18" id="id152"><span>[Madsen18]</span></a> とは、Boltzman理論を利用し、バンド構造から輸送係数などを計算するプログラムです。必要な情報は結晶の対称性とバンドエネルギーです。BoltzTraPを利用すると、温度および化学ポテンシャルの関数として以下のような量を求めることができます。</p>
<ul class="simple">
<li><p>ゼーベック係数</p></li>
<li><p>伝導度（緩和時間で割った値が出力される）</p></li>
<li><p>ホール係数</p></li>
<li><p>熱伝導率（電子からの寄与分のみ；緩和時間で割った値が出力される）</p></li>
<li><p>電子比熱</p></li>
<li><p>磁化率</p></li>
</ul>
<p>ここでは、PHASE/0が計算するバンド構造からBoltzTraPを利用する方法を説明します。BoltzTraPにはその使い方が大きく異なるバージョン1.とバージョン2.がありますが、PHASE/0はどちらのバージョンにも対応しています。</p>
<section id="id153">
<h3><span class="section-number">8.15.1. </span>入力ファイル<a class="headerlink" href="#id153" title="この見出しへのパーマリンク"></a></h3>
<p>BoltzTraPが必要とするファイルを出力するには、入力パラメーターファイルのPostprocessingブロックにおいてboltztrapブロックを作成し、設定を施します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Postprocessing{
  boltztrap{
    sw_boltztrap = on
    version = 2
    prefix = CoSb3
    header = &quot;CoSb3 calculated by PHASE/0&quot;
  }
}
</pre></div>
</div>
<p>boltztrapで定義できるタグは下記の通り。</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>タグ名</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sw_boltztrap</p></td>
<td><p>Boltz
TraPで利用できるデータファイルを出力するかどうかを指
定するスイッチ。</p>
<p>onとするとデータファイルを出力する。</p>
</td>
</tr>
<tr class="row-odd"><td><p>version</p></td>
<td><p>BoltzTraPのバージョンを指定する整数。1もしくは2を指定する。デフォルト値は1.</p></td>
</tr>
<tr class="row-even"><td><p>prefix</p></td>
<td><p>BoltzTraP用データファイルの接頭辞を指定する文字列。デフォルト値は実行ディレクトリー名。</p></td>
</tr>
<tr class="row-odd"><td><p>header</p></td>
<td><p>BoltzTraP用データファイルのヘッダーを指定する文字列。デフォルト値はprefixと同じ値。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id154">
<h3><span class="section-number">8.15.2. </span>PHASE/0の実行<a class="headerlink" href="#id154" title="この見出しへのパーマリンク"></a></h3>
<p>PHASE/0の実行は通常通り行います。計算機能の制限などは特にありません。構造最適化、格子最適化が収束するとBoltzTraPで必要なデータファイルが出力されます。SCF計算でも固定電荷計算でもBoltzTraPによる計算は可能ですが、BoltzTraPの解析は<strong>k</strong>点数に対する収束性が悪い場合があり、<strong>k</strong>点数を変えながら収束を確かめる、という手続きを踏む必要があります。そのため、固定電荷計算を活用することを推奨します。</p>
</section>
<section id="boltztrap">
<h3><span class="section-number">8.15.3. </span>BoltzTraPの実行<a class="headerlink" href="#boltztrap" title="この見出しへのパーマリンク"></a></h3>
<p>ここでは、BoltzTraPによる解析を実施する方法を簡単に説明します。詳細はBoltzTraPのマニュアル、チュートリアルをご覧ください。なお、ここでの説明はBoltzTraPのインストールは終了していることを前提としています。</p>
<section id="id155">
<h4><span class="section-number">8.15.3.1. </span>バージョン1.<a class="headerlink" href="#id155" title="この見出しへのパーマリンク"></a></h4>
<p>バージョン1.を実行するために必要なファイルは<em>prefix</em>.intrans,
<em>prefix</em>.struct,
<em>prefix</em>.energyの3つです。この3つのファイルはいずれもPHASE/0から出力されますが、<em>prefix</em>.intransファイルはBoltzTraPの動作を制御する“入力ファイル”なので実行したい解析に応じてユーザーが編集する必要があります。<em>prefix</em>.intransの内容は、典型的には下記のようになっています。なお、行頭の数値は説明用なので、実際には記述しないでください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1:  GENE # Format of DOS
2:  0 0 0 0.0 # iskip idebug setgap shiftgap
3:  0.17267 0.0005 0.4 58 # Fermilevel (Ry), energygrid, …
4:  CALC # CALC (calculate expansion coeff), NOCALC
5:  5 # lpfac, number of latt-points per k-point
6:  BOLTZ # run mode (only BOLTZ is supported)
7:  .15 # (efcut) energy range of chemical potential
8:  800. 50. # Tmax, temperature grid
9:  -1. # energyrange of bands
10: TETRA
11: 0 0 0 0 0 # For scattering model undocumented
12: 2 # number of
13: 1E20 -1E20 # fixed doping levels in cm-3
</pre></div>
</div>
<p>この入力の#以降はコメントとなっています。また、ファイルは固定形式なので、記述された数値や文字列を削除してしまうとエラーになります。</p>
<p>重要と思われる（変更する機会が比較的多い）設定値について説明します。2行目後半2つの数値は、バンドギャップのシフトを行うかどうかを指定します。3つめの数値に1を指定するとバンドギャップの補正が行われます。4つめの数値にシフト量をRydberg単位で指定します。7行目は、考慮する化学ポテンシャルの幅をRydberg単位で指定します。8行目は、考慮する温度を指定します。まず最高温度を指定し、次いで温度の刻み幅を指定します。0Kから最高温度まで、温度の刻み幅で分割した温度について計算がなされます。12行目、13行目では考慮するドーピングレベルを指定します。まず12行目でドーピングレベルの数を指定し、さらに13行目でドーピング濃度をcm<sup>-3</sup>単位でドーピングレベル数分指定します。なお、ドーピングを考慮するといっても特別な計算が別途行われるわけではありません。ドーピングレベルに応じた化学ポテンシャルによってデータを並べ替え、結果を出力してくれるという計算機能です。</p>
<p><em>prefix</em>.intransファイルを望みのものに変更したら、以下の要領でBoltzTraPを実行します。PATH_TO_BOLTZTRAPはBoltzTraPをインストールしたディレクトリーに読み替えてください。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%PATH_TO_BOLTZTRAP/src/x_trans BoltzTraP
 (スピン軌道を考慮していない場合)
%PATH_TO_BOLTZTRAP/src/x_trans BoltzTraP -so
 (スピン軌道を考慮している場合)
</pre></div>
</div>
<p>なお、BoltzTraPの計算結果は<strong>k</strong>点数をある程度多くしないと収束しません。結果が収束しているかどうか、<strong>k</strong>点数を変えた計算を行い確認することが推奨されます。BoltzTraPのマニュアルによると、目安として<span class="math notranslate nohighlight">\(\frac{16 \times 10^{6}}{V}\ (V\mathrm{は単位胞の体積})\)</span> 程度の<strong>k</strong>点を取ることが推奨されています。</p>
<p>BoltzTraPによる計算が終了すると、下記のようないろいろなファイルが結果として出力されます。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ファイル名</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>prefix</em>.outtrace</p></td>
<td><p>ログファイル</p></td>
</tr>
<tr class="row-odd"><td><p><em>prefix</em>.trace</p></td>
<td><p>各種テンソルのtraceが出力される</p></td>
</tr>
<tr class="row-even"><td><p><em>prefix</em>.condtens</p></td>
<td><p>伝導テンソルの全要素が出力される</p></td>
</tr>
<tr class="row-odd"><td><p><em>prefix</em>.halltens</p></td>
<td><p>ホ
ール係数テンソルの全要素が出力される</p></td>
</tr>
<tr class="row-even"><td><p><em>prefix.</em>trace_fixdoping,</p>
<p><em>prefix</em>.condtens_fixdoping,</p>
<p><em>prefix</em>.halltens_fixdoping</p>
</td>
<td><p>ドーピング
を考慮している場合に、<em>prefix</em>.xx</p>
<p>の内容を濃度
に合わせて加工したデータが出力される</p>
</td>
</tr>
</tbody>
</table>
<p>これらのファイルの形式については、BoltzTraPのマニュアルを参照してください。</p>
</section>
<section id="id156">
<h4><span class="section-number">8.15.3.2. </span>バージョン2.<a class="headerlink" href="#id156" title="この見出しへのパーマリンク"></a></h4>
<p>BoltzTraPバージョン2はPythonのモジュール群であり、Pythonスクリプトの中で利用できるように設計されていますが、btp2というフロントエンドとなるコマンドも用意されています。btp2コマンドに様々な副コマンドやオプションを渡すことによってBoltzTraPバージョン2.による計算を行うことができます。ここでは、このコマンドの使い方について説明します。</p>
<p>btp2を実行するために必要なファイルは<em>prefix</em>.energyと<em>prefix</em>.structureファイルです。これらのファイルが置かれたディレクトリーを<em>prefix</em>とすると、<em>prefix</em>の親ディレクトリーにおいて以下の要領で“フーリエ補間”を行います。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% btp2 interpolate -m 5 prefix
</pre></div>
</div>
<p>interpolateは“フーリエ補間を行う”ことをbtp2に伝える副コマンド、-m
5はk点1点あたり5点の補間を行う、というオプションです。これによってinterpolation.bt2というファイルが作成されます。この補間の結果が記録されたファイルを入力として様々な解析が行えるようになっています。たとえば、ある温度範囲で輸送係数の計算を行いたい場合以下のようなコマンドを利用します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>% btp2 integrate interpolation.bt2 300:500:1
</pre></div>
</div>
<p>integrateは“輸送係数の計算を行う”ことをbtp2に伝える副コマンドです。そのあとに作成した補間の結果ファイルinterpolation.bt2を渡し、さらに温度範囲を最低温度:最高温度:温度の刻み幅という形式指定しています。
得られるファイルなどについては、BoltzTraPのバージョン1.と違いはありません。</p>
</section>
</section>
<section id="id157">
<h3><span class="section-number">8.15.4. </span>計算例<a class="headerlink" href="#id157" title="この見出しへのパーマリンク"></a></h3>
<p>体心立方CoSb<sub>3</sub>結晶のゼーベック係数の計算例を紹介します。CoSb<sub>3</sub>の原子配置は <a class="reference internal" href="#advanced-bt-cosb3"><span class="std std-numref">図 8.29</span></a> に示すとおり。</p>
<figure class="align-default" id="advanced-bt-cosb3">
<img alt="../_images/image45.png" src="../_images/image45.png" />
<figcaption>
<p><span class="caption-number">図 8.29 </span><span class="caption-text">CoSb<sub>3</sub>の結晶構造（体心立方構造）</span><a class="headerlink" href="#advanced-bt-cosb3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>なお、この例題の入力ファイルは <code class="code docutils literal notranslate"><span class="pre">samples/BoltzTraP/CoSb3</span></code> 以下に置かれています。</p>
<p>まずSCFディレクトリーにある入力ファイルを用いて通常のSCF計算を行います。このSCF計算においては<strong>k</strong>点サンプリングは4×4×4のMonkhorst-Packメッシュを採用しています。つづいて、fc_5x5x5,
fc_10x10x10, fc_20x20x20,
fc_30x30x30ディレクトリーにおいて<strong>k</strong>点メッシュを変更した固定電荷の計算を行います。固定電荷計算の入力ファイルには、以下のようにBoltTraPが読み込める形式の固有値データなどが出力されるような設定が施されています。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  boltztrap{
    sw_boltztrap = on
    version = 1
    header = &quot;CoSb3 ksamp 10x10x10 bands 96&quot;
  }
}
</pre></div>
</div>
<p>ekcalもしくはphaseによる固定電荷計算を行うと、以下の3つのファイルが得られるはずです（fc_5x5x5ディレクトリーの場合）</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fc_5x5x5.energy fc_5x5x5.struct, fc_5x5x5.intrans
</pre></div>
</div>
<p>*.energy, *.structファイルは固有エネルギーと座標データが記録されているファイルですが、通常編集する必要はありません。*.intransはBoltTraPの入力ファイルなので目的によっては編集する必要があるかもしれませんが、編集せずともBoltzTraPによる基本的な計算は行うことができるようになっています。</p>
<p>BoltzTraPは以下の要領で実行できます
(BoltzTraPの実行ファイルであるx_transにパスが通っていると仮定)。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ x_trans BoltzTraP
</pre></div>
</div>
<p>これによって、ディレクトリー名を接頭辞としてもつ多くのファイルが出力されます。ゼーベック係数などの輸送係数の計算結果が出力されるのが*.traceファイルです。たとえば、fc_5x5x5の場合その内容は下記のようになります。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Ef[Ry] T [K] N DOS(Ef) S s/t R_H kappa0 ...
0.02274  50.0000 34.92246648 0.45246722E+03 -0.16967269E-04 0.94428193E+20 0.15114046E-08 ...
0.02274 100.0000 34.89576852 0.46772674E+03 -0.82371993E-05 0.95266319E+20 0.11470114E-08 ...
0.02274 150.0000 34.86708620 0.47412414E+03 -0.53033332E-05 0.94512268E+20 0.10363499E-08 ...
0.02274 200.0000 34.83810551 0.47509694E+03 -0.38465950E-05 0.94664477E+20 0.93685045E-09 ...
0.02274 250.0000 34.80983692 0.47363201E+03 -0.18452224E-05 0.95321416E+20 0.85951902E-09 ...
...
...
</pre></div>
</div>
<p>結果は、同じ化学ポテンシャルのデータがセットで出力されます。ゼーベック係数は5カラム目のデータです。300Kにおけるゼーベック係数を、<strong>k</strong>点サンプリングを変化させながら計算した結果を <a class="reference internal" href="#advanced-bt-cosb3-s"><span class="std std-numref">図 8.30</span></a> に図示します。この結果から、5×5×5のケースはそのほかの場合と比較し明らかに異なる傾向を示しているため、不十分な<strong>k</strong>点サンプリングであるといえます。10×10×10,
20×20×20,
30×30×30はおおよそ一致していますが、10×10×10のケースではたとえば化学ポテンシャルが0.25から0.3
Rydbergの領域で異なっているように見えます。20×20×20,
30×30×30はほぼ見分けがつきません。したがって、この例では20×20×20のサンプリングでほぼ収束した結果が得られていると考えられます。</p>
<figure class="align-default" id="advanced-bt-cosb3-s">
<img alt="../_images/image46.png" src="../_images/image46.png" />
<figcaption>
<p><span class="caption-number">図 8.30 </span><span class="caption-text">CoSb<sub>3</sub>の300Kにおけるゼーベック係数</span><a class="headerlink" href="#advanced-bt-cosb3-s" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="madsen06" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id151">Madsen06</a><span class="fn-bracket">]</span></span>
<p>Georg K.H.Madsen and David J.Singh, “BoltzTraP. A code for calculating band-structure dependent quantities”, Computer Physics Communications <strong>175</strong>, 67, (2006)URL: <a class="reference external" href="https://www.imc.tuwien.ac.at/forschungsbereich_theoretische_chemie/forschungsgruppen/prof_dr_gkh_madsen_theoretical_materials_chemistry/boltztrap/">https://www.imc.tuwien.ac.at/forschungsbereich_theoretische_chemie/forschungsgruppen/prof_dr_gkh_madsen_theoretical_materials_chemistry/boltztrap/</a></p>
</div>
<div class="citation" id="madsen18" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id152">Madsen18</a><span class="fn-bracket">]</span></span>
<p>Georg K.H.Madsen, JesúsCarrete, and Matthieu J.Verstraete, “BoltzTraP2, a program for interpolating band structures and calculating semi-classical transport coefficients”, Computer Physics Communications <strong>231</strong>, 140, (2018) URL: <a class="reference external" href="https://www.imc.tuwien.ac.at/index.php?id=21094">https://www.imc.tuwien.ac.at/index.php?id=21094</a></p>
</div>
</div>
</section>
</section>
<section id="energy-density-analysis-2022-01">
<span id="section-analysis-eda"></span><h2><span class="section-number">8.16. </span>Energy Density Analysis(バージョン2022.01以降)<a class="headerlink" href="#energy-density-analysis-2022-01" title="この見出しへのパーマリンク"></a></h2>
<section id="id158">
<h3><span class="section-number">8.16.1. </span>概要<a class="headerlink" href="#id158" title="この見出しへのパーマリンク"></a></h3>
<p>Energy Density Analysis法（以降EDA法）とは、平面波基底に基づく第一原理擬ポテンシャル法によって得られるエネルギーを原子ごとに分割する計算手法です <a class="reference internal" href="#imamura10" id="id159"><span>[Imamura10]</span></a> 。</p>
</section>
<section id="id160">
<h3><span class="section-number">8.16.2. </span>使い方<a class="headerlink" href="#id160" title="この見出しへのパーマリンク"></a></h3>
<section id="id161">
<h4><span class="section-number">8.16.2.1. </span>入力<a class="headerlink" href="#id161" title="この見出しへのパーマリンク"></a></h4>
<p>Energy Density Analysis法を用いる場合、入力パラメーターファイルに以下のような記述を施します。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>postprocessing{
  eda{
    sw_eda = on
  }
}
</pre></div>
</div>
<p>この設定によってSCF計算が収束したあとEDAによるエネルギー分割が行われます。</p>
</section>
<section id="id162">
<h4><span class="section-number">8.16.2.2. </span>出力<a class="headerlink" href="#id162" title="この見出しへのパーマリンク"></a></h4>
<p>EDAの結果は、以下のような形式でログファイル(output000ファイル)に記録されます。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>atom        density        kinetic        hartree            exc          local       nonlocal          ewald            epc          total
   1  Si        5.1757754      2.3466162      1.7801385     -1.9146166     -2.9861858      0.1762697     -3.5142150      0.0000000     -4.1119930
   2  Si        6.4835609      4.5278124      3.6036561     -2.8902079     -6.0099149      0.1762698     -3.5142143      0.0000000     -4.1065988
   3  Si        5.0811369      2.2787530      1.7134662     -1.8694366     -2.9032419      0.1785505     -3.5142143      0.0000000     -4.1161231
   4  O         5.3960516      6.5742616      5.4242108     -3.2629480    -17.7140909      3.1079633    -10.1029037      0.0000000    -15.9735069
   5  O         5.3919542      6.5371767      5.4250548     -3.2620495    -17.7156335      3.0784449    -10.1029039      0.0000000    -16.0399105
   6  O         4.8630732      5.5310349      4.5725356     -2.8276341    -16.2893323      3.0828468    -10.1029028      0.0000000    -16.0334519
   7  O         4.8607947      5.8746188      4.8724768     -2.9345568    -16.8295440      3.0784455    -10.1029028      0.0000000    -16.0414625
   8  O         5.4033197      6.5416558      5.4209469     -3.2641048    -17.7094035      3.0828468    -10.1029037      0.0000000    -16.0309626
   9  O         5.3443334      6.1435650      5.0619129     -3.1196637    -17.0611132      3.1079635    -10.1029039      0.0000000    -15.9702393
  total        48.0000000     46.3554944     37.8743987    -25.3452180   -115.2184601     19.0696009    -71.1600644      0.0000000   -108.4242486
</pre></div>
</div>
<p>エネルギー種別ごとに結果が記録されます。一行が1つの原子の結果に対応します。
1カラム目が原子のID, 2カラム目が元素名, 3カラム目が電子密度, 4カラム目が電子の運動エネルギー, 5カラム目がハートリーエネルギー, 6カラム目が交換相関エネルギー, 7カラム目が局所エネルギー, 8カラム目が非局所エネルギー, 9カラム目が原子核間のエネルギー, 10カラム目がpartial core correctionエネルギー, 11カラム目がすべての貢献分の和に対応します。</p>
</section>
<section id="id163">
<h4><span class="section-number">8.16.2.3. </span>計算例<a class="headerlink" href="#id163" title="この見出しへのパーマリンク"></a></h4>
<p>EDAを用いた計算例として、Si(001)面にC2H2分子が吸着した系の最適化計算例を紹介します。吸着様式としてはdimerized model (DM,  <a class="reference internal" href="#eda-example-dm-dcm"><span class="std std-numref">図 8.31</span></a> (a)) およびdimer-cleaved model (DCM, <a class="reference internal" href="#eda-example-dm-dcm"><span class="std std-numref">図 8.31</span></a> (b))を採用しました。サンプルの入力ファイルは <code class="docutils literal notranslate"><span class="pre">samples/EDA/Si001_C2H2</span></code> の <code class="docutils literal notranslate"><span class="pre">DCM</span></code> および <code class="docutils literal notranslate"><span class="pre">DM</span></code> 以下に配置されています。</p>
<p>採用した計算条件は下記の通り。</p>
<table class="docutils align-default" id="eda-example-table1">
<caption><span class="caption-number">表 8.34 </span><span class="caption-text">計算条件</span><a class="headerlink" href="#eda-example-table1" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>平面波カットオフ [Ry]</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>電荷密度カットオフ [Ry]</p></td>
<td><p>300</p></td>
</tr>
<tr class="row-odd"><td><p>k 点サンプリング</p></td>
<td><p>monk (2×2×2)</p></td>
</tr>
<tr class="row-even"><td><p>交換相関相互作用</p></td>
<td><p>GGAPBE</p></td>
</tr>
<tr class="row-odd"><td><p>SCF計算収束判定条件</p></td>
<td><p>1e-10 hartree</p></td>
</tr>
<tr class="row-even"><td><p>構造最適化収束判定条件</p></td>
<td><p>2e-4 hartree/bohr</p></td>
</tr>
<tr class="row-odd"><td><p>擬ポテンシャル</p></td>
<td><p>Si_ggapbe_paw_nc_01m.pp C_ggapbe_paw_us_01.pp H_ggapbe_paw_nc_01m.pp</p></td>
</tr>
</tbody>
</table>
<figure class="align-default" id="eda-example-dm-dcm">
<img alt="../_images/dm_dcm.svg" src="../_images/dm_dcm.svg" /><figcaption>
<p><span class="caption-number">図 8.31 </span><span class="caption-text">Si(001)面にC2H2分子が吸着した系。(a) dimerized model, (b) dimer-cleaved model</span><a class="headerlink" href="#eda-example-dm-dcm" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>構造最適化の結果DMのエネルギーがDCMと比較して1.03 eVほど低いという結果になりました。これは文献値 <a class="reference internal" href="#imamura10" id="id164"><span>[Imamura10]</span></a> の1.04 eVと近い結果です。</p>
<p>EDA法を適用した結果得られた各原子のエネルギーは次表に報告する通り。
この結果から、最表面のSi原子の違いが二つの構造のエネルギー差に最も寄与しているなどの情報を読み取ることができます。</p>
<table class="docutils align-default" id="eda-example-table2">
<caption><span class="caption-number">表 8.35 </span><span class="caption-text">DMおよびCDMの原子ごとのエネルギー。原子の並びはz座標の降順。</span><a class="headerlink" href="#eda-example-table2" title="このテーブルへのパーマリンク"></a></caption>
<tbody>
<tr class="row-odd"><td><p>原子</p></td>
<td><p>DM (Hatree)</p></td>
<td><p>DCM (Hartree)</p></td>
<td><p>DMとDCMの差 (Hartree)</p></td>
</tr>
<tr class="row-even"><td><p>H1</p></td>
<td><p>-0.5685776</p></td>
<td><p>-0.5637801</p></td>
<td><p>-0.0047975</p></td>
</tr>
<tr class="row-odd"><td><p>H2</p></td>
<td><p>-0.5685893</p></td>
<td><p>-0.5637711</p></td>
<td><p>-0.0048182</p></td>
</tr>
<tr class="row-even"><td><p>C1</p></td>
<td><p>-5.6106157</p></td>
<td><p>-5.6098881</p></td>
<td><p>-0.0007276</p></td>
</tr>
<tr class="row-odd"><td><p>C2</p></td>
<td><p>-5.6106366</p></td>
<td><p>-5.6099246</p></td>
<td><p>-0.000712</p></td>
</tr>
<tr class="row-even"><td><p>Si1</p></td>
<td><p>-3.9844977</p></td>
<td><p>-3.9695297</p></td>
<td><p>-0.014968</p></td>
</tr>
<tr class="row-odd"><td><p>Si2</p></td>
<td><p>-3.9844253</p></td>
<td><p>-3.9695649</p></td>
<td><p>-0.0148604</p></td>
</tr>
<tr class="row-even"><td><p>Si3</p></td>
<td><p>-3.9372327</p></td>
<td><p>-3.9407006</p></td>
<td><p>0.0034679</p></td>
</tr>
<tr class="row-odd"><td><p>Si4</p></td>
<td><p>-3.9371766</p></td>
<td><p>-3.9407006</p></td>
<td><p>0.003524</p></td>
</tr>
<tr class="row-even"><td><p>Si5</p></td>
<td><p>-3.9401731</p></td>
<td><p>-3.9412468</p></td>
<td><p>0.0010737</p></td>
</tr>
<tr class="row-odd"><td><p>Si6</p></td>
<td><p>-3.9411641</p></td>
<td><p>-3.9368933</p></td>
<td><p>-0.0042708</p></td>
</tr>
<tr class="row-even"><td><p>Si7</p></td>
<td><p>-3.9425975</p></td>
<td><p>-3.9430295</p></td>
<td><p>0.000432</p></td>
</tr>
<tr class="row-odd"><td><p>Si8</p></td>
<td><p>-3.9427341</p></td>
<td><p>-3.9419992</p></td>
<td><p>-0.0007349</p></td>
</tr>
<tr class="row-even"><td><p>Si9</p></td>
<td><p>-4.0002908</p></td>
<td><p>-4.0002038</p></td>
<td><p>-0.0000870</p></td>
</tr>
<tr class="row-odd"><td><p>Si10</p></td>
<td><p>-4.0002711</p></td>
<td><p>-4.0002176</p></td>
<td><p>-0.0000535</p></td>
</tr>
<tr class="row-even"><td><p>H1</p></td>
<td><p>-0.5335011</p></td>
<td><p>-0.5334118</p></td>
<td><p>-0.0000893</p></td>
</tr>
<tr class="row-odd"><td><p>H2</p></td>
<td><p>-0.5334932</p></td>
<td><p>-0.5333809</p></td>
<td><p>-0.0001123</p></td>
</tr>
<tr class="row-even"><td><p>H3</p></td>
<td><p>-0.5335100</p></td>
<td><p>-0.5334081</p></td>
<td><p>-0.0001019</p></td>
</tr>
<tr class="row-odd"><td><p>H4</p></td>
<td><p>-0.5335023</p></td>
<td><p>-0.5333772</p></td>
<td><p>-0.0001251</p></td>
</tr>
</tbody>
</table>
<p><strong>参考文献</strong></p>
<div role="list" class="citation-list">
<div class="citation" id="imamura10" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Imamura10<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id159">1</a>,<a role="doc-backlink" href="#id164">2</a>)</span>
<p>Yutaka Imamura,Asuka Takahashi, Takeshi Okada, Takahisa Ohno, and Hiromi Nakai &quot;Extension of energy density analysis to periodic-boundary-condition calculations with plane-wave basis functions&quot; Physical Review Letters vol. 89 (2002) pp. 117602 1-4.</p>
</div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../advanced_electronic_structure/advanced_electronic_structure.html" class="btn btn-neutral float-left" title="7. 高度な電子状態計算" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ion_dynamics/ion_dynamics.html" class="btn btn-neutral float-right" title="9. 原子ダイナミクス" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, PHASEシステム研究会.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>